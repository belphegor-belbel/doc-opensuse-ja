# SOME DESCRIPTIVE TITLE.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"Report-Msgid-Bugs-To: http://bugs.kde.org\n"
"POT-Creation-Date: 2018-06-28 08:17+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <kde-i18n-doc@kde.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: application/x-xml2pot; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. Tag: title
#: hardening.xml:22
#, no-c-format
msgid "Security and Hardening Guide"
msgstr ""

#. Tag: para
#: hardening.xml:27
#, no-c-format
msgid "&abstract_hardening;"
msgstr ""

#. Tag: title
#: hardening.xml:33
#, no-c-format
msgid "About This Guide"
msgstr ""

#. Tag: para
#: hardening.xml:34
#, no-c-format
msgid "The &productname; Security and Hardening Guide deals with the particulars of installation and set up of a secure &productname; and additional post-install processes required to further secure and harden that installation. Security and hardening elements and procedures are best applied to a server both during installation and post-installation and aim to improve the fitness of the system for the purposes demanded by its administrator."
msgstr ""

#. Tag: para
#: hardening.xml:43
#, no-c-format
msgid "This guide supports administrator in making security related choices and decisions. The individual steps and procedures should be seen as proposals, not as strict rules. You will often need to evaluate the usefulness of measures for your organization yourself."
msgstr ""

#. Tag: para
#: hardening.xml:49
#, no-c-format
msgid "The objective is to improve the security value of the system. Definitions about the meaning of the term security vary, but we want to settle on one that is both simple and abstract:"
msgstr ""

#. Tag: emphasis
#: hardening.xml:55
#, no-c-format
msgid "A good system does what it is expected to do, and it does it well."
msgstr ""

#. Tag: emphasis
#: hardening.xml:59
#, no-c-format
msgid "A secure system is a good system that does nothing else."
msgstr ""

#. Tag: para
#: hardening.xml:62
#, no-c-format
msgid "The focus of this guide lies on doing <quote>nothing else</quote>. The Linux system is constructed in such way that security policies are enforced. These policies consist of the following concepts (fairly generic and incomplete list):"
msgstr ""

#. Tag: para
#: hardening.xml:70
#, no-c-format
msgid "DAC (Discretionary Access Control): File and directory permissions, as set by <command>chmod</command> and <command>chown</command>."
msgstr ""

#. Tag: para
#: hardening.xml:76
#, no-c-format
msgid "Privileged ports: TCP and UDP ports 0-1023 and raw sockets can only be used by &rootuser;."
msgstr ""

#. Tag: para
#: hardening.xml:82
#, no-c-format
msgid "Other privileged operations: Loading kernel modules, configuring network interfaces, all security relevant settings of the Linux kernel. These are operations that can only be done by the root user, that is the user with the user ID 0, or any other process with the necessary capabilities."
msgstr ""

#. Tag: para
#: hardening.xml:90
#, no-c-format
msgid "Attacking a system means to attempt to overcome privilege boundaries, for example by circumventing or breaking them. That means the administrator or programmer of the system has not anticipated this scenario."
msgstr ""

#. Tag: para
#: hardening.xml:95
#, no-c-format
msgid "A hardened system raises the bar by reducing the area that the system exposes to the attacker (often called attack surface). A hardened system can also provide measures to reduce the impact of vulnerabilities in the parts of the systems that must be exposed to a potential attacker."
msgstr ""

#. Tag: para
#: hardening.xml:101
#, no-c-format
msgid "Security is about decisions, and whenever security is in (apparent) opposition to function, these decisions become trade-offs. While it can be argued that all systems should be set up to be as securely as possible, some levels of security and hardening may very well be overkill in some cases. Each system's operational environment has its own security requirements derived from business drivers or regulatory compliance mandates. &sls; can, for example, be configured to comply with security standards, such as SOX, HIPAA and PCIDSS. It can also be set up to fulfill the requirements from the German Federal Office of Information Security (Bundesamt f√ºr Sicherheit in der Informationstechnik) as described in BSI TR-02102-1. An effective business requirements analysis should be performed to determine the right level of security and hardening to be applied to a server or defined as part of a baseline server build."
msgstr ""

#. Tag: para
#: hardening.xml:116
#, no-c-format
msgid "As a final note before we begin: You may encounter individual requirements in regulatory compliance frameworks that may not make sense from a technical perspective, or they do not serve the purpose of improving security. It may be a productive attitude to simply implement what is required, but whenever there is a contradiction to security, an informed discussion in the documentation serves the overall purpose of your regulative compliance framework much more than blindly obeying the specifications. Feel encouraged to dispute list items that you think are counterproductive."
msgstr ""

#. Tag: title
#: hardening.xml:127
#, no-c-format
msgid "Assumptions and Scope"
msgstr ""

#. Tag: para
#: hardening.xml:129
#, no-c-format
msgid "References in this document will usually be made to a single server target or host, however the scope can generally be applied to more than one machine. We generally assume that the security target can cover one or more systems running &productname;."
msgstr ""

#. Tag: para
#: hardening.xml:136
#, no-c-format
msgid "We explicitly do <emphasis>not</emphasis> make any assumptions about the hostility of the network that the systems are connected to, or the cooperative nature of the users that leverage the services provided by the systems."
msgstr ""

#. Tag: para
#: hardening.xml:143
#, no-c-format
msgid "In turn, this means that you partially define your context on your own when reading through this document. You will need to broaden the meaning of individual portions to adapt it to your environment. In some cases, such as the use case of a server that is exposed to the Internet, this document may even be insufficient or incomplete; however, it may still serve as a good starting point on your journey toward an increased level of confidence that your system will behave like you want it to."
msgstr ""

#. Tag: para
#: hardening.xml:153
#, no-c-format
msgid "About trust: Trust relationships exist among all systems that participate in networked transactions. In this way, the trust relationship between the people that use the systems is transported across these systems. The chain that is formed by your trust relationships is only as strong as the weakest link. It is good practice to graphically visualize the trust relationships with the services in a schematic overview or map of your network. Generally, it is up to the owner of a resource to enforce the policies imposed on that resource; this would usually be the server that provides the resource. The client that opens a connection to request the resource can only be made responsible for the actions that it performs. This refers to the action of opening the connection to start with, but to nothing else as such."
msgstr ""

#. Tag: para
#: hardening.xml:168
#, no-c-format
msgid "The case of hostile users is special and unique: The Human Resources department may be able to solve some security problems in your computing environment; in addition, some technical measures can be taken. Make sure that the necessary regulations in your environment fit your needs, and that they back your intentions instead of obstructing them if you need to work around a missing support from your HR department (and your management)."
msgstr ""

#. Tag: para
#: hardening.xml:177
#, no-c-format
msgid "Persons that have administrative privileges on a system are automatically considered trusted."
msgstr ""

#. Tag: para
#: hardening.xml:182
#, no-c-format
msgid "A Linux system&mdash;without any additional security frameworks such as &selnx;&mdash;is a single level security system: From a security policy perspective there is only the superuser (root) and non-privileged users. System users are non-root user IDs that have access to files specific to their purpose. The separation of administrative duties is complicated by this simplicity. Some tools help: Use sudo(8) for administrative tasks, but be aware that after the privilege boundary is crossed, a program running with root privileges does not enforce any file access policies for non-privileged users anymore. vi(1) that runs as root can read and write to any file in the system."
msgstr ""

#. Tag: para
#: hardening.xml:195
#, no-c-format
msgid "Another tool to mitigate the risk of abuse or accidental misuse of administrative privileges is NetIQ's Privileged User Manager product. More information is available here:"
msgstr ""

#. Tag: para
#: hardening.xml:209
#, no-c-format
msgid "Physical security of the server is another assumption made here, where the server is protected from theft and manipulation by unauthorized persons. A common sobering thought among security professionals is the <quote>ten-second Denial of Service</quote>: Unplug the wires and reboot the server. Physical security must be ensured and physical access must be controlled. Otherwise, all assumptions about at least the availability of these systems are void."
msgstr ""

#. Tag: title
#: hardening.xml:220
#, no-c-format
msgid "Cryptography"
msgstr ""

#. Tag: para
#: hardening.xml:221
#, no-c-format
msgid "The use of cryptography to protect the confidentiality of transactions with the services that your system provides is generally encouraged. The need to implement cryptographic enhancements is strongly dependent on the operational environments of all participating systems. Keep in mind that you need to verify all of the possible security benefits that cryptography can provide, for all of your services, and that these benefits are not delivered automatically by turning on the <quote>encrypt</quote> option of your service (if you can enjoy the idyllic situation where encryption is available as a button to check):"
msgstr ""

#. Tag: term
#: hardening.xml:234
#, no-c-format
msgid "Confidentiality"
msgstr ""

#. Tag: para
#: hardening.xml:236
#, no-c-format
msgid "Protection against reading the content of a transaction"
msgstr ""

#. Tag: term
#: hardening.xml:242
#, no-c-format
msgid "Privacy"
msgstr ""

#. Tag: para
#: hardening.xml:244
#, no-c-format
msgid "Protection against knowing that a transaction exists, and some properties that it may have, such as size, identities of involved parties, their presence, etc."
msgstr ""

#. Tag: term
#: hardening.xml:252
#, no-c-format
msgid "Integrity"
msgstr ""

#. Tag: para
#: hardening.xml:254
#, no-c-format
msgid "Protection against alteration of content. Be aware that cryptography does not automatically provide this kind of protection."
msgstr ""

#. Tag: term
#: hardening.xml:261
#, no-c-format
msgid "Authenticity"
msgstr ""

#. Tag: para
#: hardening.xml:263
#, no-c-format
msgid "Protection against identity fraud. Cryptography that does not know about identities of participating entities cannot deliver this value."
msgstr ""

#. Tag: para
#: hardening.xml:270
#, no-c-format
msgid "Keep in mind that encryption of data for confidentiality purposes can merely reduce the size of the data to protect from the actual size to the size of the key that is used to encrypt the data. This results in a key exchange problem for encrypted transactions, and in a key management problem for encrypted data storage. Since data is (typically, there are exceptions!) processed in clear, you need your vault unlocked while data within is being worked with. The encryption of such data on the file system or block device layer helps against the theft of the system, but it does not help the confidentiality of the data while the system is running."
msgstr ""

#. Tag: para
#: hardening.xml:283
#, no-c-format
msgid "If you want to implement a consistent security policy covering multiple hosts on a network then organizational procedures <emphasis>must</emphasis> ensure that all those hosts can be trusted and are configured with compatible security configurations enforcing an organization wide security policy. Isolation of groups of systems that maintain data of the same trust domain can provide an adequate means of control; ultimately, the access controls to these systems, both for end users and for other systems, need to be carefully designed, configured, inspected and monitored."
msgstr ""

#. Tag: title
#: hardening.xml:295
#, no-c-format
msgid "Trusting Data"
msgstr ""

#. Tag: para
#: hardening.xml:296
#, no-c-format
msgid "Data can only be trusted to the degree that is associated with the domain it comes from. If data leaves the domain in which security policies can be enforced, it should consequently be associated with the trust of the target domain."
msgstr ""

#. Tag: para
#: hardening.xml:304
#, no-c-format
msgid "For a review of industry best practices on security, the development of sound security processes, controls, development, reviews, audit practices and incident management, you can review a public RFC (request for comments). RFC 2196 is the ongoing work of the world-wide community and individual security and process experts. You can review it online here: <link xlink:href=\"http://www.faqs.org/rfcs/rfc2196.html\"></link>. An RFC is an open and living document that invites comments and review. Enhancements and improvements are welcome; you will find instructions on where to send those suggestions within the document itself."
msgstr ""

#. Tag: para
#: hardening.xml:316
#, no-c-format
msgid "This guide provides initial guidance on how to set up and secure a &productname; installation but it is not intended to be the only information required for a system administrator to learn how to operate Linux securely. Assumptions are made within this guide that the reader has knowledge and understanding of operating security principles in general, and of Linux administrative commands and configuration options in particular."
msgstr ""

#. Tag: title
#: hardening.xml:327
#, no-c-format
msgid "Contents of this Book"
msgstr ""

#. Tag: para
#: hardening.xml:329
#, no-c-format
msgid "contains a reference to Common Criteria and &productname;. <xref linkend=\"cha.security_protection\"/> contains more general system security and service protection schemes."
msgstr ""

#. Tag: title
#: hardening.xml:340
#, no-c-format
msgid "Common Criteria"
msgstr ""

#. Tag: title
#: hardening.xml:347
#, no-c-format
msgid "Introduction"
msgstr ""

#. Tag: para
#: hardening.xml:349
#, no-c-format
msgid "Common Criteria is the best known and most widely used methodology to evaluate and measure the security value of an IT product. The methodology aims to be independent, as an independent laboratory conducts the evaluation, which a certification body will certify afterward. Security Functional Requirements (SFR) are summarized in so-called Protection Profiles (PP), which allows the comparison of security functions of different products if the definition of the Security Target (ST) (which typically uses a reference to the PP if one exists that fits the purpose of the product) and the Evaluation Assurance Levels are comparable."
msgstr ""

#. Tag: para
#: hardening.xml:361
#, no-c-format
msgid "A clear definition of security in IT products is challenging. Security should be considered a process that never ends, not a static condition that can be met or not. A Common Criteria certificate (below EA7) does not make a clear statement about error proneness of the system (while many of the flaws that exist specifically in operating systems are security-relevant), but it adds an important value to the product that cannot be described with the presence of technology alone: That someone has independently inspected the design of the system in such way that it corresponds to the claims that are made, and that explicit care has been taken in producing and maintaining the product."
msgstr ""

#. Tag: para
#: hardening.xml:374
#, no-c-format
msgid "The certificate states a degree of maturity of both the product with its security functions and the processes of the company that has designed, built and engineered the product, and that will maintain the product across its life cycle. As such, Common Criteria aims to be fairly holistic with its approach to take everything into account that is relevant for the security of an IT product."
msgstr ""

#. Tag: para
#: hardening.xml:383
#, no-c-format
msgid "The Evaluation Assurance Level (EAL) shall denote the degree of confidence that the product fulfills the described claims. The levels are from 1 through 7:"
msgstr ""

#. Tag: para
#: hardening.xml:391
#, no-c-format
msgid "EAL1: Functionally tested"
msgstr ""

#. Tag: para
#: hardening.xml:396
#, no-c-format
msgid "EAL2: Structurally tested"
msgstr ""

#. Tag: para
#: hardening.xml:401
#, no-c-format
msgid "EAL3: Methodically tested and checked"
msgstr ""

#. Tag: para
#: hardening.xml:406
#, no-c-format
msgid "EAL4: Methodically designed, tested and reviewed"
msgstr ""

#. Tag: para
#: hardening.xml:411
#, no-c-format
msgid "EAL5: Semi-formally designed and tested"
msgstr ""

#. Tag: para
#: hardening.xml:416
#, no-c-format
msgid "EAL6: Semi-formally verified design and tested"
msgstr ""

#. Tag: para
#: hardening.xml:421
#, no-c-format
msgid "EAL7: Formally verified design and tested"
msgstr ""

#. Tag: para
#: hardening.xml:427
#, no-c-format
msgid "While EAL1 only provides basic assurance for products to meet security requirements, EAL2 to 4 are medium assurance levels. EAL5-EAL7 describe medium-to-high and high assurance; EAL4 is expected to be the highest level of assurance that a product can have if it has not been designed from the start to achieve a higher level of assurance."
msgstr ""

#. Tag: para
#: hardening.xml:435
#, no-c-format
msgid "Many commonly known General Purpose/Utility Computing operating systems have been awarded a Common Criteria certificate at EAL4. A \"+\" after the assurance level denotes an augmentation to the EAL, an addition that is useful for the articulation of security value, but formally not needed at the corresponding EAL."
msgstr ""

#. Tag: para
#: hardening.xml:443
#, no-c-format
msgid "The &productname; version 8 was the first Linux system to achieve EAL3+ (Augmentation: Basic Flaw Remediation) in 2003; Version 9 of SLES was the first Linux based operating system to reach EAL4+ in 2004. More certifications and re-certifications have followed targeting SLES 9 and SLES 10-SP1, until the &productname; version Service Pack 2 was evaluated in 2011/2012."
msgstr ""

#. Tag: para
#: hardening.xml:452
#, no-c-format
msgid "The Common Criteria evaluations inspect a specific configuration of the product in an evaluated setup. The <quote>Administrator's Guide</quote> is a document that comes with a Common Criteria certified product and describes the individual steps that need to be taken to install and configure the product to a state like it was evaluated."
msgstr ""

#. Tag: para
#: hardening.xml:460
#, no-c-format
msgid "Very often, the evaluated configuration is used as a reference for the secure installation of the &productname;. It is however incorrect to understand the evaluated configuration as a hardened configuration: the removal of setuid bits and the prescription of administrative procedures after installation is there to reach a specific configuration that is sane, but this process is clearly insufficient for a hardening claim."
msgstr ""

#. Tag: para
#: hardening.xml:469
#, no-c-format
msgid "Earlier versions of this document have contained a substantial part that links to Common Criteria evaluated configurations. For clarity and to avoid confusion these chapters have been removed."
msgstr ""

#. Tag: para
#: hardening.xml:475
#, no-c-format
msgid "Instead, this guide recommends the lecture the documentation that comes with the Common Criteria certificate to understand the Common Criteria evaluation of &productname; in general, the security functions that are in place within the operating system and how these security functions are relevant for the mitigation of threats. The High Level Design documentation encompasses the design specifics of the &productname;: Authentication mechanisms, access controls, audit subsystem and system log files, to name a few of them. The accumulated knowledge contained in the documentation allows decision making for hardening purposes at an informed level&mdash;find it at <link xlink:href=\"http://www.suse.com/security/\"></link>."
msgstr ""

#. Tag: para
#: hardening.xml:488
#, no-c-format
msgid "Apart from the valuable documentation that comes with the Common Criteria effort, the following manual pages may be of greater interest to the inclined reader:"
msgstr ""

#. Tag: quote
#: hardening.xml:495
#, no-c-format
msgid "pam(8), pam(5)"
msgstr ""

#. Tag: para
#: hardening.xml:498
#, no-c-format
msgid "<quote>apparmor(7)</quote> and referred man pages"
msgstr ""

#. Tag: quote
#: hardening.xml:503
#, no-c-format
msgid "rsyslogd(8), syslog(8), syslogd(8)"
msgstr ""

#. Tag: quote
#: hardening.xml:507
#, no-c-format
msgid "fstab(5), mount(8), losetup(8), cryptsetup(8)"
msgstr ""

#. Tag: quote
#: hardening.xml:511
#, no-c-format
msgid "haveged(8), random(4)"
msgstr ""

#. Tag: quote
#: hardening.xml:515
#, no-c-format
msgid "ssh(1), sshd(8), ssh_config(5), sshd_config(5), ssh-agent(1), ssh-add(1), ssh-keygen(1)"
msgstr ""

#. Tag: quote
#: hardening.xml:520
#, no-c-format
msgid "cron(1), crontab(5), at(1), atd(8)"
msgstr ""

#. Tag: quote
#: hardening.xml:524
#, no-c-format
msgid "systemctl(1), daemon(7), systemd.unit(5), systemd.special(5), kernel-command-line(7), bootup(7), systemd.directives"
msgstr ""

#. Tag: title
#: hardening.xml:531
#, no-c-format
msgid "Generic Guiding Principles"
msgstr ""

#. Tag: para
#: hardening.xml:533
#, no-c-format
msgid "The following guiding principles motivate much of the advice in this guide, and security processes in general, and should also influence any configuration decisions that are not explicitly covered."
msgstr ""

#. Tag: term
#: hardening.xml:541
#, no-c-format
msgid "Use Data Encryption Whenever Possible"
msgstr ""

#. Tag: para
#: hardening.xml:543
#, no-c-format
msgid "Refer to the <xref linkend=\"pre.hardening.about\"/> section of this guide. In <xref linkend=\"pre.hardening.about.assumptions\"/>, the limitations of cryptography are briefly outlined."
msgstr ""

#. Tag: para
#: hardening.xml:548
#, no-c-format
msgid "Be aware that cryptography is certainly useful, but only for the specific purposes that it is good for. It is not a generic recipe for better security in a system, its use may even impose additional risk on the system. Make informed decisions about the use of cryptography, and feel obliged to have a reason for your decisions, no matter if they are for or against cryptography. A false sense of security can be more harmful than the weakness itself."
msgstr ""

#. Tag: para
#: hardening.xml:558
#, no-c-format
msgid "&productname; supports encryption for:"
msgstr ""

#. Tag: para
#: hardening.xml:563
#, no-c-format
msgid "Network connections (the <command>openssl</command> command, <command>stunnel</command>), for remote login (<command>openssh</command>, <command>man ssh(1)</command>)"
msgstr ""

#. Tag: para
#: hardening.xml:571
#, no-c-format
msgid "Files (<command>gpg</command>)"
msgstr ""

#. Tag: para
#: hardening.xml:576
#, no-c-format
msgid "Entire file systems at block layer (<literal>dm-crypt</literal>, <command>cryptsetup</command>)"
msgstr ""

#. Tag: para
#: hardening.xml:582
#, no-c-format
msgid "VPN (<command>ipsec</command>, <command>openvpn</command>)"
msgstr ""

#. Tag: term
#: hardening.xml:590
#, no-c-format
msgid "Minimal Package Installation"
msgstr ""

#. Tag: para
#: hardening.xml:592
#, no-c-format
msgid "Generally, an RPM software package consists of the package's meta data that is written to the RPM database upon installation, the package's files and directories and scripts that are being executed before and after installation and removal."
msgstr ""

#. Tag: para
#: hardening.xml:598
#, no-c-format
msgid "Packages generally do not impose any security risk to the system, if they do <emphasis>not</emphasis> contain:"
msgstr ""

#. Tag: para
#: hardening.xml:604
#, no-c-format
msgid "setuid- or setgid bits on any of the installed files"
msgstr ""

#. Tag: para
#: hardening.xml:609
#, no-c-format
msgid "group- or world-writable files or directories"
msgstr ""

#. Tag: para
#: hardening.xml:614
#, no-c-format
msgid "a service that is activated upon installation/activated by default."
msgstr ""

#. Tag: para
#: hardening.xml:619
#, no-c-format
msgid "Under the above condition, the package is merely a collection of files, and their use shall not be automatically assumed if you do not have any local users on your system. Since the installation of such packages does not have any influence on the security value of the system, the uninstallation of them should not either."
msgstr ""

#. Tag: para
#: hardening.xml:627
#, no-c-format
msgid "However, a fairly simple reason to keep to a minimal set of packages in your installation is that something that is not present cannot get used. Binaries not installed cannot be executed."
msgstr ""

#. Tag: para
#: hardening.xml:632
#, no-c-format
msgid "A straight forward way of keeping to a minimal set of packages begins with the installation of the system. You can start the installation of your system by deselecting all packages and then select only those that you want to use. As an example, the selection of the apache2-mod_perl package in &yast; would automatically cause all packages to be selected for installation that are needed for the Apache package to operate. Dependencies have often been artificially cut down to be able to handle the system's dependency tree more flexibly. You should be safe if you chose the minimal system, and build the dependency tree from there with your (leaf) package selection."
msgstr ""

#. Tag: term
#: hardening.xml:647
#, no-c-format
msgid "Service Isolation&mdash;Run Different Services on Separate Systems"
msgstr ""

#. Tag: para
#: hardening.xml:650
#, no-c-format
msgid "Whenever possible, a server should be dedicated to serving exactly one service or application. This limits the number of other services that could be compromised in the event an attacker can successfully exploit a software flaw in one service (assuming that flaw allows access to others)."
msgstr ""

#. Tag: para
#: hardening.xml:657
#, no-c-format
msgid "This point can lead to healthy and robust dialog on system sizing and even further to consolidation or virtualization. The intent with this guidance is to reduce the fault domain and risk where possible."
msgstr ""

#. Tag: para
#: hardening.xml:662
#, no-c-format
msgid "The use of AppArmor for services that are provided on a system is an effective means of containment. Refer to the AppArmor documentation on your system to learn more. <command>man apparmor</command> is a good starting point."
msgstr ""

#. Tag: para
#: hardening.xml:668
#, no-c-format
msgid "The use of virtualization technology with &kvm; or with &xen; is supported with the &productname; version &productnumber;. While virtualization is generally designed for server consolidation purposes, its usefulness for service isolation is another good argument. Be aware that the capability of the hypervisor to separate virtual machines is not higher or stronger than the Linux kernel's capability to separate processes and their address spaces. The granularity at which virtualization technology tackles separation may however come with its benefits, being resource-hungry and somewhat clumsy on the other hand."
msgstr ""

#. Tag: para
#: hardening.xml:680
#, no-c-format
msgid "Virtualization technology cannot match or substitute the separation strength that is given by running services on different physical machines!"
msgstr ""

#. Tag: term
#: hardening.xml:689
#, no-c-format
msgid "System fingerprinting and backups"
msgstr ""

#. Tag: para
#: hardening.xml:693
#, no-c-format
msgid "In the case of the suspicion of an attack against the system, nothing can provide more comfort than"
msgstr ""

#. Tag: para
#: hardening.xml:699
#, no-c-format
msgid "a backup"
msgstr ""

#. Tag: para
#: hardening.xml:704
#, no-c-format
msgid "a fingerprint of your system to detect modifications"
msgstr ""

#. Tag: para
#: hardening.xml:709
#, no-c-format
msgid "having done your homework."
msgstr ""

#. Tag: para
#: hardening.xml:714
#, no-c-format
msgid "Several tools exist on &productname; &productnumber; which can be effectively used for the detection of unknown, but yet successful attacks. These tools come at the cost of relatively little configuration effort, but with the benefit of being able to actually know what has been changed in your system."
msgstr ""

#. Tag: para
#: hardening.xml:721
#, no-c-format
msgid "In particular, the use of <systemitem class=\"resource\">AIDE</systemitem> is strongly encouraged. <systemitem class=\"resource\">AIDE</systemitem>, when run for initialization, creates a hash database of all files in the system that are listed in its configuration file. This allows to verify the integrity of all cataloged files at a later time."
msgstr ""

#. Tag: para
#: hardening.xml:730
#, no-c-format
msgid "You need to copy the hash database that AIDE creates to a place that is inaccessible for potential attackers. Otherwise, the attacker may modify the integrity database after planting a backdoor, thereby defeating the purpose of the integrity measurement."
msgstr ""

#. Tag: para
#: hardening.xml:738
#, no-c-format
msgid "An attacker may have planted a backdoor in the kernel. This has an entire variety of consequences: Apart from being very hard to detect, the kernel-based backdoor can effectively remove all traces of the system compromise to the degree that system alterations are almost invisible. By consequence, an integrity check needs to be done from a rescue system (or any other system where an independent system runs, and the target system's file systems are mounted manually)."
msgstr ""

#. Tag: para
#: hardening.xml:749
#, no-c-format
msgid "Security is a lively process. Essentially, in this context, this means that the application of security updates invalidates the integrity database. <command>rpm</command> <option>-qlv packagename</option> lists the files that are contained in a package. Generally spoken, the RPM subsystem is very powerful with the data that it maintains, and that is accessible with the <option>--queryformat</option> command line option. A differential update of integrity database with the changed files becomes more manageable with some fine-grained usage of RPM."
msgstr ""

#. Tag: para
#: hardening.xml:761
#, no-c-format
msgid "A fast and directly accessible backup adds distinct confidence about the integrity of your system and can substitute an integrity check such as described above with AIDE. It is important, though, that the backup mechanism/solution has adequate versioning support so that you can trace changes in the system. As an example: The installation times of packages (<command>rpm</command> <option>-q</option> <option>--queryformat='%{INSTALLTIME} %{NAME}\\n'</option> <replaceable>PACKAGE NAME</replaceable>) must correspond to the changed files in the backup log files."
msgstr ""

#. Tag: para
#: hardening.xml:773
#, no-c-format
msgid "Make it an integral part of your security routine to verify that your backups work."
msgstr ""

#. Tag: title
#: hardening.xml:785
#, no-c-format
msgid "Linux Security and Service Protection Methods"
msgstr ""

#. Tag: para
#: hardening.xml:788
#, no-c-format
msgid "In <xref linkend=\"cha.common_criteria\"/> we mentioned the Common Criteria EAL 4+ certified installation and setup that was sponsored by IBM for a select subset of hardware. This certified build is a great first step for customers wanting to build a secure and hardened base system, yet might not address all of the services and software specifics that many customers would be interested in."
msgstr ""

#. Tag: para
#: hardening.xml:796
#, no-c-format
msgid "This next part will present a more general view and give recommendations and guidance for &productname; system security. Some topics may seem repeated here (from the previous part) yet the context is very different. More detail will be provided in some sections and certainly some more general examples for a greater number of services."
msgstr ""

#. Tag: para
#: hardening.xml:805
#, no-c-format
msgid "This portion of the guide will only give basic recommendations instead of strict rules. The procedures and examples here should give you the ability to apply security enhancement techniques to a wider variety of server-based services and programs."
msgstr ""

#. Tag: para
#: hardening.xml:811
#, no-c-format
msgid "Some subjects of this chapter have been discussed before. However, you will find more details and explanations in this chapter. Selected general topics are:"
msgstr ""

#. Tag: para
#: hardening.xml:818
#, no-c-format
msgid "Physical Security ‚Äì Protection of the server from environmental threats (people, places, things)."
msgstr ""

#. Tag: para
#: hardening.xml:824
#, no-c-format
msgid "Security Policies and Procedures ‚Äì Server life cycle management, disk/media reclamation, backup and archive security."
msgstr ""

#. Tag: para
#: hardening.xml:830
#, no-c-format
msgid "Systems Monitoring ‚Äì Procedures around event notification/management."
msgstr ""

#. Tag: para
#: hardening.xml:835
#, no-c-format
msgid "Systems Automation ‚Äì Mechanisms and/or procedures for automatic security measures. Heuristics, account control, security reporting and remediation, automated shutdown, etc."
msgstr ""

#. Tag: para
#: hardening.xml:842
#, no-c-format
msgid "Systems Management ‚Äì Methods to obtaining packages, verification and signing keys, patching procedures and recommendations."
msgstr ""

#. Tag: para
#: hardening.xml:848
#, no-c-format
msgid "Securing Network ‚Äì Addition programs, ports and service wrappers ‚Äì iptables, tcpwrappers, services."
msgstr ""

#. Tag: para
#: hardening.xml:854
#, no-c-format
msgid "Remote Access ‚Äì extra SSH information and key federation. CA integration."
msgstr ""

#. Tag: para
#: hardening.xml:860
#, no-c-format
msgid "Common Services ‚Äì mail, NFS and automount."
msgstr ""

#. Tag: para
#: hardening.xml:865
#, no-c-format
msgid "Securing the kernel and Init Process ‚Äì parameters, systemd targets, and boot scripts."
msgstr ""

#. Tag: para
#: hardening.xml:871
#, no-c-format
msgid "Access Control ‚Äì user/groups/permissions."
msgstr ""

#. Tag: para
#: hardening.xml:876
#, no-c-format
msgid "Password Security and Warnings ‚Äì Proper setup of passwords and banners."
msgstr ""

#. Tag: para
#: hardening.xml:881
#, no-c-format
msgid "Miscellaneous Security ‚Äì Assorted security settings and miscellany."
msgstr ""

#. Tag: para
#: hardening.xml:886
#, no-c-format
msgid "Resources ‚Äì Web links, documentation and example references, howtos and general information, product links."
msgstr ""

#. Tag: para
#: hardening.xml:892
#, no-c-format
msgid "The sections will again be organized by a topical hierarchy for continuity-sake. Refer to the main table of contents for easy reference."
msgstr ""

#. Tag: title
#: hardening.xml:897
#, no-c-format
msgid "Physical Security"
msgstr ""

#. Tag: para
#: hardening.xml:899
#, no-c-format
msgid "Physical security should be one of the utmost concerns. Linux production servers should be in locked data centers where only people have access that have passed security checks. Depending on the environment and circumstances, you can also consider boot loader passwords."
msgstr ""

#. Tag: para
#: hardening.xml:906
#, no-c-format
msgid "Additionally, consider questions like:"
msgstr ""

#. Tag: para
#: hardening.xml:912
#, no-c-format
msgid "Who has direct physical access to the host?"
msgstr ""

#. Tag: para
#: hardening.xml:917
#, no-c-format
msgid "Of those that do, should they?"
msgstr ""

#. Tag: para
#: hardening.xml:922
#, no-c-format
msgid "Can the host be protected from tampering and should it be?"
msgstr ""

#. Tag: para
#: hardening.xml:928
#, no-c-format
msgid "The amount of physical security needed on a particular system depends on the situation, and can also vary widely by available funds."
msgstr ""

#. Tag: title
#: hardening.xml:934
#, no-c-format
msgid "System Locks"
msgstr ""

#. Tag: para
#: hardening.xml:935
#, no-c-format
msgid "Most server racks in data centers include a locking feature. Usually this will be a hasp/cylinder lock on the front of the rack that allows you to turn an included key to a locked or unlocked position ‚Äì granting or denying entry. Cage locks can help prevent someone from tampering or stealing devices/media from the servers, or opening the cases and directly manipulating/sabotaging the hardware. Preventing system reboots or the booting from alternate devices is also important (for example CD/DVDs/USB drives/etc.)."
msgstr ""

#. Tag: para
#: hardening.xml:945
#, no-c-format
msgid "Some servers also have case locks. These locks can do different things according to the designs of the system vendor and construction. Many systems are designed to self-disable if attempts are made to open the system without unlocking. Others have device covers that will not let you plug in or unplug keyboards or mice. While locks are sometimes a useful feature, they are usually lower quality and easily defeated by attackers with ill intent."
msgstr ""

#. Tag: title
#: hardening.xml:957
#, no-c-format
msgid "Locking Down the BIOS"
msgstr ""

#. Tag: title
#: hardening.xml:960
#, no-c-format
msgid "Secure Boot"
msgstr ""

#. Tag: para
#: hardening.xml:961
#, no-c-format
msgid "This section describes only basic methods to secure the boot process. To find out about more advanced boot protection using UEFI and the secure boot feature, see <xref linkend=\"sec.uefi.secboot\"/>."
msgstr ""

#. Tag: para
#: hardening.xml:968
#, no-c-format
msgid "The BIOS (Basic Input/Output System) or its successor UEFI (Unified Extensible Firmware Interface) is the lowest level of software/firmware on PC class systems. Other hardware types (&ipseries;, &zseries;) that run Linux also have low-level firmware that performs similar functions as the PC BIOS. When this document references the BIOS, it usually means BIOS and/or UEFI. The BIOS dictates system configuration, puts the system into a well defined state and provides routines for accessing low-level hardware. The BIOS executes the configured Linux boot loader (like &grub;) to boot the host."
msgstr ""

#. Tag: para
#: hardening.xml:981
#, no-c-format
msgid "Most BIOS implementations can be configured to prevent unauthorized users from manipulating system and boot settings. This is typically done by setting a BIOS admin or boot password. The admin password only needs to be entered for changing the system configuration but the boot password will be required during every normal boot. For most use cases it is enough to set an admin password and restrict booting to the builtin hard disk. This way an attacker will not be able to simply boot a Linux live CD or USB thumb drive, for example. Although this does not provide a high level of security (a BIOS can be reset, removed or modified ‚Äì assuming case access), it can be another deterrent."
msgstr ""

#. Tag: para
#: hardening.xml:994
#, no-c-format
msgid "Many BIOS firmwares have various other security related settings. Check with the system vendor, the system documentation or examine the BIOS during a system boot to find out more."
msgstr ""

#. Tag: title
#: hardening.xml:1001
#, no-c-format
msgid "Booting when a BIOS Boot Password is Set"
msgstr ""

#. Tag: para
#: hardening.xml:1002
#, no-c-format
msgid "If a system has been set up with a boot password, the host will not boot up unattended (for example in case of a system reboot or power failure). This is a trade-off."
msgstr ""

#. Tag: title
#: hardening.xml:1009
#, no-c-format
msgid "Losing the BIOS Admin Password"
msgstr ""

#. Tag: para
#: hardening.xml:1010
#, no-c-format
msgid "Once a system is setup the first time, the BIOS admin password will not be required often. Don't forget the password or you will need to clear the BIOS memory via hardware manipulation to get access again."
msgstr ""

#. Tag: title
#: hardening.xml:1018
#, no-c-format
msgid "Security via the Boot Loaders"
msgstr ""

#. Tag: para
#: hardening.xml:1020
#, no-c-format
msgid "The Linux boot loader &grub;, which is used by default in &productname;, can have a boot passwords set. It also provides a password feature, so that only administrators can start the interactive operations (for example editing menu entries and entering the command line interface). If a password is specified, &grub; will disallow any interactive control until you press the key <keycap>C</keycap> and <keycap>E</keycap> and enter a correct password."
msgstr ""

#. Tag: para
#: hardening.xml:1030
#, no-c-format
msgid "You can refer to the &grub; man page for examples."
msgstr ""

#. Tag: para
#: hardening.xml:1034
#, no-c-format
msgid "It is very important to keep in mind that when setting these passwords they will need to be remembered! Also, enabling these passwords might merely slow an intrusion, not necessarily prevent it. Again, someone could boot from a removable device, and mount your root partition. If you are using BIOS-level security and a boot loader, it is a good practice to disable the ability to boot from removable devices in your computer's BIOS, and then also password-protecting the BIOS itself."
msgstr ""

#. Tag: para
#: hardening.xml:1044
#, no-c-format
msgid "Also keep in mind that the boot loader configuration files will need to be protected by changing their mode to <literal>600</literal> (read/write for &rootuser; only), or others will be able to read your passwords or hashes!"
msgstr ""

#. Tag: title
#: hardening.xml:1051
#, no-c-format
msgid "Verifying Security Action with <command>seccheck</command>"
msgstr ""

#. Tag: para
#: hardening.xml:1053
#, no-c-format
msgid "It is highly recommended to have scripts in place which can verify that security actions or procedures have been run. Even the best systems administrators can make errors or forget something. If you have a small or large Linux installation or environment, you should consider the use of the <command>seccheck</command> scripts."
msgstr ""

#. Tag: para
#: hardening.xml:1061
#, no-c-format
msgid "<command>seccheck</command> is the &suse; Security Checker. It is a set of several shell scripts designed to check the local security of the system on a regular basis. There are three main scripts that are executed at different time intervals. They are <literal>security-daily,</literal> <literal>security-weekly</literal> and <literal>security-monthly</literal>. If <command>seccheck</command> is not installed on your system, install it with <command>sudo zypper in seccheck</command>. These scripts all have schedule entries that get placed in cron that determine when they run. Although cron scheduling is the default behavior, this can be controlled via configuration settings (see next section). The daily script runs at midnight, and if changes are detected since the last run (the night before), an e-mail noting the differences will be sent. The weekly script runs every Monday at 1:00 am, and only if changes to the last run (the week before) are found, a mail with the differences will be sent. The monthly script runs every on every 1st of the month and sends the full last daily and weekly report via e-mail."
msgstr ""

#. Tag: title
#: hardening.xml:1082
#, no-c-format
msgid "Seccheck Configuration"
msgstr ""

#. Tag: para
#: hardening.xml:1083
#, no-c-format
msgid "Note that you can change the receiver of the seccheck mails from root to anyone else if you add an entry like this one to <filename>/etc/sysconfig/seccheck</filename>:"
msgstr ""

#. Tag: screen
#: hardening.xml:1088
#, no-c-format
msgid "SECCHK_USER=\"firewall\" # exchange firewall is an admin user's account name"
msgstr ""

#. Tag: para
#: hardening.xml:1089
#, no-c-format
msgid "Also note that the <envar>START_SECCHK</envar> variable from <filename>/etc/sysconfig/seccheck</filename> controls whether the security check will be run from cron. (It is ignored if you call <command>security-control</command> manually.)"
msgstr ""

#. Tag: para
#: hardening.xml:1095
#, no-c-format
msgid "The following daily checks are done:"
msgstr ""

#. Tag: para
#: hardening.xml:1105
#, no-c-format
msgid "<filename>/etc/passwd</filename> check"
msgstr ""

#. Tag: para
#: hardening.xml:1110
#, no-c-format
msgid "length/number/contents of fields, accounts with same uid accounts with uid/gid of 0 or 1 beside root and bin"
msgstr ""

#. Tag: para
#: hardening.xml:1118
#, no-c-format
msgid "<filename>/etc/shadow</filename> check"
msgstr ""

#. Tag: para
#: hardening.xml:1123
#, no-c-format
msgid "length/number/contents of fields, accounts with no password"
msgstr ""

#. Tag: para
#: hardening.xml:1130
#, no-c-format
msgid "<filename>/etc/group</filename> check"
msgstr ""

#. Tag: para
#: hardening.xml:1135
#, no-c-format
msgid "length/number/contents of fields"
msgstr ""

#. Tag: para
#: hardening.xml:1142
#, no-c-format
msgid "user root checks"
msgstr ""

#. Tag: para
#: hardening.xml:1147
#, no-c-format
msgid "secure umask and <envar>PATH</envar>"
msgstr ""

#. Tag: filename
#: hardening.xml:1155
#, no-c-format
msgid "/etc/ftpusers"
msgstr ""

#. Tag: para
#: hardening.xml:1159
#, no-c-format
msgid "checks if important system users are put there"
msgstr ""

#. Tag: filename
#: hardening.xml:1167
#, no-c-format
msgid "/etc/aliases"
msgstr ""

#. Tag: para
#: hardening.xml:1171
#, no-c-format
msgid "checks for mail aliases which execute programs"
msgstr ""

#. Tag: para
#: hardening.xml:1178
#, no-c-format
msgid "<filename>.rhosts</filename> check"
msgstr ""

#. Tag: para
#: hardening.xml:1183
#, no-c-format
msgid "checks if users' <filename>.rhosts</filename> file contain + signs"
msgstr ""

#. Tag: para
#: hardening.xml:1190
#, no-c-format
msgid "homedirectory"
msgstr ""

#. Tag: para
#: hardening.xml:1195
#, no-c-format
msgid "checks if home directories are writable or owned by someone else"
msgstr ""

#. Tag: para
#: hardening.xml:1202
#, no-c-format
msgid "dot-files check"
msgstr ""

#. Tag: para
#: hardening.xml:1207
#, no-c-format
msgid "checks many dot-files in the home directories if they are writable or owned by someone else"
msgstr ""

#. Tag: para
#: hardening.xml:1215
#, no-c-format
msgid "mailbox check"
msgstr ""

#. Tag: para
#: hardening.xml:1220
#, no-c-format
msgid "checks if user mailboxes are owned by user and are readable"
msgstr ""

#. Tag: para
#: hardening.xml:1227
#, no-c-format
msgid "NFS export check"
msgstr ""

#. Tag: para
#: hardening.xml:1232
#, no-c-format
msgid "exports should not be exported globally"
msgstr ""

#. Tag: para
#: hardening.xml:1239
#, no-c-format
msgid "NFS import check"
msgstr ""

#. Tag: para
#: hardening.xml:1244
#, no-c-format
msgid "NFS mounts should have the <option>nosuid</option> option set"
msgstr ""

#. Tag: para
#: hardening.xml:1251
#, no-c-format
msgid "promisc check"
msgstr ""

#. Tag: para
#: hardening.xml:1256
#, no-c-format
msgid "checks if network cards are in promiscuous mode"
msgstr ""

#. Tag: para
#: hardening.xml:1263
#, no-c-format
msgid "list modules"
msgstr ""

#. Tag: para
#: hardening.xml:1268
#, no-c-format
msgid "lists loaded modules"
msgstr ""

#. Tag: para
#: hardening.xml:1275
#, no-c-format
msgid "list sockets"
msgstr ""

#. Tag: para
#: hardening.xml:1280
#, no-c-format
msgid "lists open ports"
msgstr ""

#. Tag: para
#: hardening.xml:1287
#, no-c-format
msgid "Weekly Checks are as follows:"
msgstr ""

#. Tag: para
#: hardening.xml:1294
#, no-c-format
msgid "password check"
msgstr ""

#. Tag: para
#: hardening.xml:1299
#, no-c-format
msgid "runs <command>john</command> to crack the password file, user will get an e-mail notice to change his password"
msgstr ""

#. Tag: para
#: hardening.xml:1307
#, no-c-format
msgid "RPM md5 check"
msgstr ""

#. Tag: para
#: hardening.xml:1312
#, no-c-format
msgid "checks for changed files via RPM's MD5 checksum feature"
msgstr ""

#. Tag: para
#: hardening.xml:1319
#, no-c-format
msgid "suid/sgid check"
msgstr ""

#. Tag: para
#: hardening.xml:1324
#, no-c-format
msgid "lists all suid and sgid files"
msgstr ""

#. Tag: para
#: hardening.xml:1331
#, no-c-format
msgid "exec group write"
msgstr ""

#. Tag: para
#: hardening.xml:1336
#, no-c-format
msgid "lists all executables which are group/world-writable"
msgstr ""

#. Tag: para
#: hardening.xml:1343
#, no-c-format
msgid "writable check"
msgstr ""

#. Tag: para
#: hardening.xml:1348
#, no-c-format
msgid "lists all files which are world-writable (including executables)"
msgstr ""

#. Tag: para
#: hardening.xml:1355
#, no-c-format
msgid "device check"
msgstr ""

#. Tag: para
#: hardening.xml:1360
#, no-c-format
msgid "lists all devices"
msgstr ""

#. Tag: para
#: hardening.xml:1368
#, no-c-format
msgid "Additional monthly checks are also run, however the key difference is mainly that the monthly file is not a diff like the daily/weekly ones but the full reports in one file."
msgstr ""

#. Tag: title
#: hardening.xml:1374
#, no-c-format
msgid "Auditing Passwords with <command>john</command>"
msgstr ""

#. Tag: para
#: hardening.xml:1375
#, no-c-format
msgid "To enable password auditing, it is necessary to first install the package <package>john</package>. The package is available on the &osbs; at <link xlink:href=\"https://build.opensuse.org/package/show/security/john\"></link>."
msgstr ""

#. Tag: title
#: hardening.xml:1384
#, no-c-format
msgid "Automatic Logout"
msgstr ""

#. Tag: para
#: hardening.xml:1385
#, no-c-format
msgid "The <systemitem>seccheck</systemitem> package provides an automatic logout feature. It is a script that runs every 10 minutes and checks both remote or local terminal sessions for inactivity, and terminates them if an idle time is exceeded."
msgstr ""

#. Tag: para
#: hardening.xml:1391
#, no-c-format
msgid "You can configure the functionality in the <filename>/etc/security/autologout.conf</filename> file. Parameters include default idle and logout delay times, and the configuration for limiting maximum idle times specific to users, groups, TTY devices and SSH sessions. <filename>/etc/security/autologout.conf</filename> also includes several configuration examples."
msgstr ""

#. Tag: para
#: hardening.xml:1400
#, no-c-format
msgid "The automatic logout feature is not enabled by default. To enable it, edit <filename>/etc/cron.d/autologout</filename> and uncomment the example cron line."
msgstr ""

#. Tag: title
#: hardening.xml:1409
#, no-c-format
msgid "Retiring Linux Servers with Sensitive Data"
msgstr ""

#. Tag: para
#: hardening.xml:1411
#, no-c-format
msgid "Security policies usually contain some procedures for the treatment of storage media that is going to be retired or disposed of. Disk and media wipe procedures are frequently prescribed as is complete destruction of the media. You can find several free tools on the Internet. A search of <quote>dod disk wipe utility</quote> will yield several variants. To retire servers with sensitive data, it is important to ensure that data cannot be recovered from the hard disks. To ensure that all traces of data are removed, a wipe utility&mdash;such as <command>scrub</command>&mdash;can be used. Many wipe utilities overwrite the data several times. This assures that even sophisticated methods are not able to retrieve any parts of the wiped data. Some tools can even be operated from a bootable removable device and remove data according to the U.S. Department of Defense (DoD) standards. Note that many government agencies specify their own standards for data security. Some standards are stronger than others, yet may require more time to implement."
msgstr ""

#. Tag: title
#: hardening.xml:1431
#, no-c-format
msgid "Wiping Wear Leveling Devices"
msgstr ""

#. Tag: para
#: hardening.xml:1432
#, no-c-format
msgid "Some devices, like SSDs, use wear leveling and do not necessarily write new data in the same physical locations. Such devices usually provide their own erasing functionality."
msgstr ""

#. Tag: title
#: hardening.xml:1440
#, no-c-format
msgid "scrub: Disk Overwrite Utility"
msgstr ""

#. Tag: para
#: hardening.xml:1441
#, no-c-format
msgid "<command>scrub</command> overwrites hard disks, files, and other devices with repeating patterns intended to make recovering data from these devices more difficult. It operates in three basic modes: on a character or block device, on a file, or on a directory specified. For more information, set the manual page <command>man 1 scrub</command>."
msgstr ""

#. Tag: title
#: hardening.xml:1449
#, no-c-format
msgid "Supported Scrub Methods"
msgstr ""

#. Tag: term
#: hardening.xml:1451
#, no-c-format
msgid "nnsa"
msgstr ""

#. Tag: para
#: hardening.xml:1453
#, no-c-format
msgid "4-pass NNSA Policy Letter NAP-14.1-C (XVI-8) for sanitizing removable and non-removable hard disks, which requires overwriting all locations with a pseudo random pattern twice and then with a known pattern: ran- dom(x2), 0x00, verify."
msgstr ""

#. Tag: term
#: hardening.xml:1462
#, no-c-format
msgid "<term>dod</term>"
msgstr ""

#. Tag: para
#: hardening.xml:1464
#, no-c-format
msgid "4-pass DoD 5220.22-M section 8-306 procedure (d) for sanitizing removable and non-removable rigid disks which requires overwriting all addressable locations with a character, its complement, a random character, then verify. NOTE: scrub performs the random pass first to make verification easier: random, 0x00, 0xff, verify."
msgstr ""

#. Tag: term
#: hardening.xml:1474
#, no-c-format
msgid "<term>bsi</term>"
msgstr ""

#. Tag: para
#: hardening.xml:1476
#, no-c-format
msgid "9-pass method recommended by the German Center of Security in Information Technologies (<link xlink:href=\"http://www.bsi.bund.de\"></link>): 0xff, 0xfe, 0xfd, 0xfb, 0xf7, 0xef, 0xdf, 0xbf, 0x7f."
msgstr ""

#. Tag: term
#: hardening.xml:1485
#, no-c-format
msgid "gutmann"
msgstr ""

#. Tag: para
#: hardening.xml:1487
#, no-c-format
msgid "The canonical 35-pass sequence described in Gutmann's paper cited below."
msgstr ""

#. Tag: term
#: hardening.xml:1494
#, no-c-format
msgid "schneier"
msgstr ""

#. Tag: para
#: hardening.xml:1496
#, no-c-format
msgid "7-pass method described by Bruce Schneier in \"Applied Cryptography\" (1996): 0x00, 0xff, random(x5)"
msgstr ""

#. Tag: term
#: hardening.xml:1503
#, no-c-format
msgid "pfitzner7"
msgstr ""

#. Tag: para
#: hardening.xml:1505
#, no-c-format
msgid "Roy Pfitzner's 7-random-pass method: random(x7)."
msgstr ""

#. Tag: term
#: hardening.xml:1511
#, no-c-format
msgid "pfitzner33"
msgstr ""

#. Tag: para
#: hardening.xml:1513
#, no-c-format
msgid "Roy Pfitzner's 33-random-pass method: random(x33)."
msgstr ""

#. Tag: term
#: hardening.xml:1519
#, no-c-format
msgid "usarmy"
msgstr ""

#. Tag: para
#: hardening.xml:1521
#, no-c-format
msgid "US Army AR380-19 method: 0x00, 0xff, random. (Note: identical to DoD 522.22-M section 8-306 procedure (e) for sanitizing magnetic core memory)."
msgstr ""

#. Tag: term
#: hardening.xml:1529
#, no-c-format
msgid "fillzero"
msgstr ""

#. Tag: para
#: hardening.xml:1531
#, no-c-format
msgid "1-pass pattern: 0x00."
msgstr ""

#. Tag: term
#: hardening.xml:1537
#, no-c-format
msgid "fillff"
msgstr ""

#. Tag: para
#: hardening.xml:1539
#, no-c-format
msgid "1-pass pattern: 0xff."
msgstr ""

#. Tag: term
#: hardening.xml:1545
#, no-c-format
msgid "random"
msgstr ""

#. Tag: para
#: hardening.xml:1547
#, no-c-format
msgid "1-pass pattern: random(x1)."
msgstr ""

#. Tag: term
#: hardening.xml:1553
#, no-c-format
msgid "random2"
msgstr ""

#. Tag: para
#: hardening.xml:1555
#, no-c-format
msgid "2-pass pattern: random(x2)."
msgstr ""

#. Tag: term
#: hardening.xml:1561
#, no-c-format
msgid "<term>old</term>"
msgstr ""

#. Tag: para
#: hardening.xml:1563
#, no-c-format
msgid "6-pass pre-version 1.7 scrub method: 0x00, 0xff, 0xaa, 0x00, 0x55, verify."
msgstr ""

#. Tag: term
#: hardening.xml:1570
#, no-c-format
msgid "fastold"
msgstr ""

#. Tag: para
#: hardening.xml:1572
#, no-c-format
msgid "5-pass pattern: 0x00, 0xff, 0xaa, 0x55, verify."
msgstr ""

#. Tag: term
#: hardening.xml:1578
#, no-c-format
msgid "custom=string"
msgstr ""

#. Tag: para
#: hardening.xml:1580
#, no-c-format
msgid "1-pass custom pattern. String may contain C-style numerical escapes: \\nnn (octal) or \\xnn (hex)."
msgstr ""

#. Tag: title
#: hardening.xml:1590
#, no-c-format
msgid "Backups"
msgstr ""

#. Tag: para
#: hardening.xml:1592
#, no-c-format
msgid "If your system is compromised, backups can be used to restore a prior system state. When bugs or accidents occur, backups can also be used to compare the current system against an older version. For production systems, it is very important to take some backups off-site for cases like disasters (for example off-site storage of tapes/recordable media, or off-site initiated)."
msgstr ""

#. Tag: para
#: hardening.xml:1601
#, no-c-format
msgid "For legal reasons, some firms and organizations must be careful about backing up too much information and holding it too long. If your environment has a policy regarding the destruction of old paper files, you might need to extend this policy to Linux backup tapes as well."
msgstr ""

#. Tag: para
#: hardening.xml:1608
#, no-c-format
msgid "The rules about physical security of servers apply to backups as well. Additionally it is advisable to encrypt backup data. This can be done either per individual backup archive or for the complete backup file system, if applicable. Should a backup medium ever be lost, for example during transportation, the data will be protected against unauthorized access. The same applies if a backup system itself is compromised. To some extent encryption also ensures the integrity of the backups. Keep in mind, however, that the appropriate people need to be able to decrypt backups in emergency situations. Also, the case that an encryption key itself is compromised and needs to be replaced should be considered."
msgstr ""

#. Tag: para
#: hardening.xml:1621
#, no-c-format
msgid "If a system is known to be compromised or suspected to be compromised, then it is vital to determine the integrity status of backups. If a system compromise has not been detected for a longer time, then it is possible that backups already include manipulated configuration files or malicious programs. Keeping a long enough history of backups allows to inspect for possible unwarranted differences."
msgstr ""

#. Tag: para
#: hardening.xml:1630
#, no-c-format
msgid "Even in the absence of any known security breach, a regular inspection of differences of important configuration files in backups can help finding security issues (maybe even accidental misconfigurations). This approach is best suited for files and environments where the content doesn't change too frequently."
msgstr ""

#. Tag: title
#: hardening.xml:1639
#, no-c-format
msgid "Disk Partitions"
msgstr ""

#. Tag: para
#: hardening.xml:1641
#, no-c-format
msgid "Servers should have separate file systems for at least <filename>/</filename>, <filename>/boot</filename>, <filename>/usr</filename>, <filename>/var</filename>, <filename>/tmp</filename>, and <filename>/home</filename>. This prevents, for example, that logging space and temporary space under <filename>/var</filename> and <filename>/tmp</filename> fill up the root partition. Third-party applications should be on separate file systems as well, for example under <filename>/opt</filename>."
msgstr ""

#. Tag: para
#: hardening.xml:1652
#, no-c-format
msgid "Another advantage of separate file systems is the possibility to choose special mount options that are only suitable for certain regions in the file system hierarchy. A number of interesting mount options are:"
msgstr ""

#. Tag: para
#: hardening.xml:1660
#, no-c-format
msgid "<literal>noexec</literal>: prevents execution of files."
msgstr ""

#. Tag: para
#: hardening.xml:1665
#, no-c-format
msgid "<literal>nodev</literal>: prevents character or block special devices to be usable."
msgstr ""

#. Tag: para
#: hardening.xml:1671
#, no-c-format
msgid "<literal>nosuid</literal>: prevents the <literal>set-user-ID</literal> or <literal>set-group-ID</literal> bits to be effective."
msgstr ""

#. Tag: para
#: hardening.xml:1677
#, no-c-format
msgid "<literal>ro</literal>: mounts the file system <literal>read-only</literal>."
msgstr ""

#. Tag: para
#: hardening.xml:1684
#, no-c-format
msgid "Each of these options needs to be carefully considered before applying it to a partition mount. Applications may stop working, or the support status may be violated. When applied correctly, mount options can help against some types of security attacks or misconfigurations. For example, there should be no need for <literal>set-user-ID</literal> binaries to be placed in <filename>/tmp</filename>."
msgstr ""

#. Tag: para
#: hardening.xml:1693
#, no-c-format
msgid "You are advised to review <xref linkend=\"cha.common_criteria\"/>. It is important to understand the need to separate the partitions that could impact a running system (for example, log files filling up <filename>/var/log</filename> are a good reason to separate <filename>/var</filename> from the <filename>/</filename> partition). Another thing to keep in mind is that you will likely need to leverage LVM or another volume manager or at the very least the extended partition type to work around the limit of four primary partitions on PC class systems."
msgstr ""

#. Tag: para
#: hardening.xml:1704
#, no-c-format
msgid "Another capability in &productname; is encrypting a partition or even a single directory or file as a container. Refer to <xref linkend=\"cha.security.cryptofs\"/> for details."
msgstr ""

#. Tag: title
#: hardening.xml:1711
#, no-c-format
msgid "Firewall (iptables)"
msgstr ""

#. Tag: para
#: hardening.xml:1713
#, no-c-format
msgid "Setting up a Linux firewall from scratch will not be covered in detail in this guide. Most companies use dedicated firewalls or appliances to protect their servers in a production network. This is strongly recommended for secure environments."
msgstr ""

#. Tag: para
#: hardening.xml:1720
#, no-c-format
msgid "&productname; also includes &firewalld;. This is a firewall daemon that can be configured from the command line using <command>firewall-cmd</command> or in a graphical user interface using <command>firewall-config</command>. Basic settings of &firewalld; can also be configured via the &yast; firewall interface. For detailed information on how &firewalld; works, refer to <link xlink:href=\"http://www.firewalld.org/documentation/\"></link>."
msgstr ""

#. Tag: para
#: hardening.xml:1729
#, no-c-format
msgid "If you are also interested in directly scripting firewall rules using <command>iptables</command>, there are many guides on the Internet. See the Appendix for resources. For lots of iptables tutorials and examples, see <link xlink:href=\"http://www.linuxguruz.com/iptables/\"></link>. There is also the next generation Linux firewall implementation called <command>nftables</command>. Using it can be simpler and more powerful when scripting firewall rules. You can find more information about <command>nftables</command> in <link xlink:href=\"https://wiki.nftables.org/wiki-nftables/index.php/Main_Page\"></link>."
msgstr ""

#. Tag: title
#: hardening.xml:1743
#, no-c-format
msgid "Security Features in the Kernel"
msgstr ""

#. Tag: para
#: hardening.xml:1745
#, no-c-format
msgid "The following list shows tunable kernel parameters you can use to secure your Linux server against attacks. Some are defaults already within the SLE distributions. To check the current status of any of these settings, you can query the kernel (<filename>/proc/sys/...</filename> contents). For example, the Source Routing setting is located in the <filename>/proc/sys/net/ipv4/conf/all/accept_source_route</filename> file. Simply display the contents of a file to see how the current running kernel is set up."
msgstr ""

#. Tag: para
#: hardening.xml:1756
#, no-c-format
msgid "For each tunable kernel parameter shown, the change to the entry that needs to be affected can be modified or added to the <filename>/etc/sysctl.conf</filename> configuration file to make the change persistent after a reboots."
msgstr ""

#. Tag: para
#: hardening.xml:1763
#, no-c-format
msgid "You can get a list of current kernel settings by using the command:"
msgstr ""

#. Tag: screen
#: hardening.xml:1767
#, no-c-format
msgid "&prompt.root;sysctl -a"
msgstr ""

#. Tag: para
#: hardening.xml:1769
#, no-c-format
msgid "It is even a very good idea to store the output of the kernel settings (for comparison or reference) by redirecting the output of the sysctl command to a file, for example"
msgstr ""

#. Tag: screen
#: hardening.xml:1775
#, no-c-format
msgid "&prompt.root;sysctl -A &gt; /root/sysctl.settings.store"
msgstr ""

#. Tag: para
#: hardening.xml:1777
#, no-c-format
msgid "Because &productname; includes, by default, security-focused kernel tuning parameters, you will find the existing <filename>/etc/sysctl.conf</filename> file to be sparsely populated. You may choose to use the above mentioned <quote>catalog</quote> method of storing the complete gamut of kernel settings and then choose those parameters you want to be reset at reboot. You can place these in the <filename>/etc/sysctl.conf</filename> file where they will be picked up upon a reboot or they can be inserted immediately (into the running kernel) by running the command <command>sysctl</command> <option>-p</option>."
msgstr ""

#. Tag: para
#: hardening.xml:1790
#, no-c-format
msgid "Many third-party applications like Oracle, SAP, DB2, Websphere, etc. recommend changing kernel parameters to ensure high performance for I/O or CPU processing. Having a full list of current settings can be helpful for reference."
msgstr ""

#. Tag: title
#: hardening.xml:1798
#, no-c-format
msgid "Enable TCP SYN Cookie Protection (default in &productname; &productnumber;)"
msgstr ""

#. Tag: para
#: hardening.xml:1799
#, no-c-format
msgid "A SYN attack is a denial of service attack that consumes all the resources on a machine. Any server that is connected to a network is potentially subject to this attack. To enable TCP SYN Cookie Protection, edit the <filename>/etc/sysctl.conf</filename> file and ensure the following line and value exists:"
msgstr ""

#. Tag: screen
#: hardening.xml:1806
#, no-c-format
msgid "net.ipv4.tcp_syncookies = 1"
msgstr ""

#. Tag: para
#: hardening.xml:1808
#, no-c-format
msgid "Despite the name of the configuration option, it applies to IP version 6 as well."
msgstr ""

#. Tag: title
#: hardening.xml:1816
#, no-c-format
msgid "Disable IP Source Routing (default in &productname; &productnumber;)"
msgstr ""

#. Tag: para
#: hardening.xml:1817
#, no-c-format
msgid "Source Routing is used to specify a path or route through the network from source to destination. This feature can be used by network people for diagnosing problems. However, if an intruder was able to send a source routed packet into the network, then he could intercept the replies and your server might not know that it is not communicating with a trusted server."
msgstr ""

#. Tag: screen
#: hardening.xml:1825
#, no-c-format
msgid "net.ipv4.conf.all.accept_source_route = 0"
msgstr ""

#. Tag: para
#: hardening.xml:1826 hardening.xml:1843
#, no-c-format
msgid "<para>or</para>"
msgstr ""

#. Tag: screen
#: hardening.xml:1829
#, no-c-format
msgid "net.ipv6.conf.all.accept_source_route = 0"
msgstr ""

#. Tag: title
#: hardening.xml:1833
#, no-c-format
msgid "Disable ICMP Redirect Acceptance"
msgstr ""

#. Tag: para
#: hardening.xml:1834
#, no-c-format
msgid "ICMP redirects are used by routers to tell the server that there is a better path to other networks than the one chosen by the server. However, an intruder could potentially use ICMP redirect packets to alter the host's routing table by causing traffic to use a path you did not intend. To disable ICMP Redirect Acceptance, edit the <filename>/etc/sysctl.conf</filename> file and add the following line:"
msgstr ""

#. Tag: screen
#: hardening.xml:1842
#, no-c-format
msgid "net.ipv4.conf.all.accept_redirects = 0"
msgstr ""

#. Tag: screen
#: hardening.xml:1846
#, no-c-format
msgid "net.ipv6.conf.all.accept_redirects = 0"
msgstr ""

#. Tag: title
#: hardening.xml:1850
#, no-c-format
msgid "Enable IP Spoofing Protection (default in &productname; &productnumber;)"
msgstr ""

#. Tag: remark
#: hardening.xml:1851
#, no-c-format
msgid "krahmer 2014-08-14: IPv6 should be handled separately"
msgstr ""

#. Tag: para
#: hardening.xml:1852
#, no-c-format
msgid "IP spoofing is a technique where an intruder sends out packets which claim to be from another host by manipulating the source address. IP spoofing is very often used for denial of service attacks. For more information on IP Spoofing, see <link xlink:href=\"http://en.wikipedia.org/wiki/IP_address_spoofing\"></link>"
msgstr ""

#. Tag: screen
#: hardening.xml:1859
#, no-c-format
msgid "net.ipv4.conf.all.rp_filter = 1"
msgstr ""

#. Tag: title
#: hardening.xml:1863
#, no-c-format
msgid "Enable Ignoring to ICMP Requests"
msgstr ""

#. Tag: para
#: hardening.xml:1864
#, no-c-format
msgid "If you want or need Linux to ignore <command>ping</command> requests, edit the <filename>/etc/sysctl.conf</filename> file and add the following line:"
msgstr ""

#. Tag: screen
#: hardening.xml:1869
#, no-c-format
msgid "net.ipv4.icmp_echo_ignore_all = 1"
msgstr ""

#. Tag: para
#: hardening.xml:1870
#, no-c-format
msgid "This cannot be done in many environments, as some monitoring systems use a rudimentary ICMP (ping) to determine the health of the device on the network (or at least its ability to respond)."
msgstr ""

#. Tag: title
#: hardening.xml:1878
#, no-c-format
msgid "Enable Ignoring Broadcasts Request (default in &productname; &productnumber;)"
msgstr ""

#. Tag: para
#: hardening.xml:1879
#, no-c-format
msgid "If you want or need Linux to ignore broadcast requests."
msgstr ""

#. Tag: screen
#: hardening.xml:1882
#, no-c-format
msgid "net.ipv4.icmp_echo_ignore_broadcasts = 1"
msgstr ""

#. Tag: title
#: hardening.xml:1886
#, no-c-format
msgid "Enable Bad Error Message Protection (default in &productname; &productnumber;)"
msgstr ""

#. Tag: para
#: hardening.xml:1887
#, no-c-format
msgid "To alert you about bad error messages in the network."
msgstr ""

#. Tag: screen
#: hardening.xml:1890
#, no-c-format
msgid "net.ipv4.icmp_ignore_bogus_error_responses = 1"
msgstr ""

#. Tag: title
#: hardening.xml:1894
#, no-c-format
msgid "Enable Logging of Spoofed Packets, Source Routed Packets, Redirect Packets"
msgstr ""

#. Tag: para
#: hardening.xml:1895
#, no-c-format
msgid "To turn on logging for Spoofed Packets, Source Routed Packets, and Redirect Packets, edit the <filename>/etc/sysctl.conf</filename> file and add the following line:"
msgstr ""

#. Tag: screen
#: hardening.xml:1900
#, no-c-format
msgid "net.ipv4.conf.all.log_martians = 1"
msgstr ""

#. Tag: para
#: hardening.xml:1902
#, no-c-format
msgid "Because of the way &productname; is set up (with rsyslog) for network event tracking, keep in mind that this can cause a large amount of messages to be logged."
msgstr ""

#. Tag: title
#: hardening.xml:1911
#, no-c-format
msgid "Buffer Overflow Attack Mitigation"
msgstr ""

#. Tag: para
#: hardening.xml:1912
#, no-c-format
msgid "Starting with the 2.6.x kernel releases, Linux offers <emphasis>Address Space Layout Randomization</emphasis> (ASLR) and the <emphasis>No-eXecute</emphasis> (NX bit) for mitigation of buffer overflow attacks. For more information, see:"
msgstr ""

#. Tag: para
#: hardening.xml:1935
#, no-c-format
msgid "Since version 12, &productname; already comes with some buffer overflow attack mitigation techniques being enabled by default."
msgstr ""

#. Tag: para
#: hardening.xml:1939
#, no-c-format
msgid "ASLR is enabled by default. This can be verified with the output of the following command. The expected result is 2:"
msgstr ""

#. Tag: screen
#: hardening.xml:1943
#, no-c-format
msgid ""
      "&prompt.user;cat /proc/sys/kernel/randomize_va_space\n"
      "2"
msgstr ""

#. Tag: para
#: hardening.xml:1944
#, no-c-format
msgid "This randomizes the heap, stack, and load addresses of dynamically linked libraries. Programs that run privileged or process network data are already built using special compiler flags (PIE and _FORTIFY_SOURCE) to take even more advantage of randomizing the text and data segments as well."
msgstr ""

#. Tag: para
#: hardening.xml:1951
#, no-c-format
msgid "Executable space protection prevents the execution of memory space that is not intended for execution. Linux makes use of the <emphasis>No eXecute bit</emphasis>. This is enabled by default on the &productname; kernel for the &x86; and &x86-64; architecture. Use of the NX bit has to be supported by each individual program. You can check if your system supports the NX bit:"
msgstr ""

#. Tag: screen
#: hardening.xml:1959
#, no-c-format
msgid ""
      "&prompt.user;dmesg | grep '[NX|DX]*protection'\n"
      "[    0.000000] NX (Execute Disable) protection: active"
msgstr ""

#. Tag: para
#: hardening.xml:1960
#, no-c-format
msgid "If NX is disabled, check your BIOS or UEFI for a setting that enables it and make sure that it is supported by your CPU."
msgstr ""

#. Tag: para
#: hardening.xml:1964
#, no-c-format
msgid "Furthermore, since version 12, &productname; prevents leaking of internal kernel addresses to make kernel exploits harder by setting the <literal>kptr_restrict</literal>:"
msgstr ""

#. Tag: screen
#: hardening.xml:1969
#, no-c-format
msgid ""
      "&prompt.user;cat /proc/sys/kernel/kptr_restrict\n"
      "1"
msgstr ""

#. Tag: para
#: hardening.xml:1970
#, no-c-format
msgid "On CPU's that support it (newer &x86-64; CPUs) the kernel also uses the SMEP protection by default that prevents direct execution of user space code from inside the kernel. This is often used by kernel exploits and therefore a good hardening measure."
msgstr ""

#. Tag: title
#: hardening.xml:1979
#, no-c-format
msgid "File system hardening"
msgstr ""

#. Tag: para
#: hardening.xml:1980
#, no-c-format
msgid "To mitigate vulnerabilities based on insecure file system access by privileged programs (tmp-races, TOCTOU) the Linux kernel offers two <command>sysctl</command> variables which should already be enabled by default on &productname; &productnumber;: <literal>fs.protected_hardlinks</literal> and <literal>fs.protected_symlinks</literal> or their corresponding <filename>/proc</filename> entries:"
msgstr ""

#. Tag: screen
#: hardening.xml:1989
#, no-c-format
msgid ""
      "&prompt.user;cat /proc/sys/fs/protected_hardlinks\n"
      "1"
msgstr ""

#. Tag: para
#: hardening.xml:1990
#, no-c-format
msgid "By setting this to <literal>1</literal>, users can no longer create soft or hard links to files which they do not own. This mitigates a commonly used exploitation vector for programs which call open(2), creat(2) or similar functions without care."
msgstr ""

#. Tag: screen
#: hardening.xml:1996
#, no-c-format
msgid ""
      "&prompt.user;cat /proc/sys/fs/protected_symlinks\n"
      "1"
msgstr ""

#. Tag: para
#: hardening.xml:1997
#, no-c-format
msgid "By setting this to <literal>1</literal>, symbolic links are permitted to be followed only when outside a sticky world-writable directory, or when the uid of the link and follower match, or when the directory owner matches the symlink's owner."
msgstr ""

#. Tag: title
#: hardening.xml:2006
#, no-c-format
msgid "Increased <command>dmesg</command> Restrictions"
msgstr ""

#. Tag: para
#: hardening.xml:2007
#, no-c-format
msgid "<command>dmesg</command> provides all kinds of system internal information, such as kernel addresses, crashes of services, and similar things that could be used by local attackers. This is why the access to <command>dmesg</command> is restricted to &rootuser; by default. The behavior is controlled by the <literal>kernel.dmesg_restrict</literal> option (defaults to 1). If set to 0, any user can view the output of <command>dmesg</command>."
msgstr ""

#. Tag: title
#: hardening.xml:2019
#, no-c-format
msgid "Filter access to <filename>/dev/mem</filename> (default in &productname; 12)"
msgstr ""

#. Tag: para
#: hardening.xml:2020
#, no-c-format
msgid "<filename>/dev/mem</filename> hosts an image of the system's main memory, including kernel and user space memory. Allowing unfiltered access to this information is dangerous and therefore the kernel on &productname; has been compiled with <envar>CONFIG_STRICT_DEVMEM</envar> enabled. This setting restricts user space access to <filename>/dev/mem</filename> to memory mapped peripherals."
msgstr ""

#. Tag: title
#: hardening.xml:2031
#, no-c-format
msgid "&aa;"
msgstr ""

#. Tag: para
#: hardening.xml:2033
#, no-c-format
msgid "Included with &productname;, &aa; is an application security tool designed to provide an easy-to-use security framework for your applications. &aa; proactively protects the operating system and applications from external or internal threats, even zero-day attacks, by enforcing a specified behavior and preventing some unknown application flaws from being exploited. &aa; security policies, called <quote>profiles</quote>, completely define which system resources and files can be accessed by each application. The profiles also define the access mode, for example read or write. Several default profiles are included with &aa;, and using a combination of advanced static analysis and learning-based tools, &aa; profiles for even very complex applications can be deployed successfully in a matter of hours."
msgstr ""

#. Tag: para
#: hardening.xml:2048
#, no-c-format
msgid "&aa; consists of:"
msgstr ""

#. Tag: para
#: hardening.xml:2054
#, no-c-format
msgid "A kernel extension which enforces the security profiles."
msgstr ""

#. Tag: para
#: hardening.xml:2059
#, no-c-format
msgid "A collection of RPMs, also shipped with &productname; that provides:"
msgstr ""

#. Tag: para
#: hardening.xml:2064
#, no-c-format
msgid "A set of &aa; profiles for numerous programs that ship with &productname;."
msgstr ""

#. Tag: para
#: hardening.xml:2070
#, no-c-format
msgid "Tools to create and manage new and existing &aa; profiles."
msgstr ""

#. Tag: para
#: hardening.xml:2075
#, no-c-format
msgid "A &yast; user interface to manage reports and notification of security events."
msgstr ""

#. Tag: para
#: hardening.xml:2081
#, no-c-format
msgid "Documentation about the &aa; tools."
msgstr ""

#. Tag: para
#: hardening.xml:2088
#, no-c-format
msgid "It is best to reboot a system after completing installation, so that &aa; can confine all system daemons."
msgstr ""

#. Tag: para
#: hardening.xml:2092
#, no-c-format
msgid "For additional details and step-by-step instructions on the usage and configuration of &aa; you can also refer to <xref linkend=\"part.apparmor\"/>."
msgstr ""

#. Tag: title
#: hardening.xml:2100
#, no-c-format
msgid "&selnx;"
msgstr ""

#. Tag: para
#: hardening.xml:2102
#, no-c-format
msgid "&selnx; is an advanced technology for securing Linux systems. It is included with <quote>basic enablement</quote> in &productname; &productnumber;, and is included with some other distributions by default. Hardening Linux using &selnx; technology, on its own, warrants its own security HOWTO and is out of scope for this guide. The book <link xlink:href=\"http://shop.oreilly.com/product/9780596007164.do\">&selnx;: NSA's Open Source Security Enhanced Linux</link> contains a very good description of its setup and usage. As part of the <quote>basic enablement</quote>, &selnx; will not be officially supported, but packages have now been added to &productname; &productnumber; to enable its usage with minimal effort. While &aa; is much easier to use and has a similar feature set, knowing both will most certainly be beneficial."
msgstr ""

#. Tag: title
#: hardening.xml:2119
#, no-c-format
msgid "FTP, <command>telnet</command>, and <command>rlogin</command> (rsh)"
msgstr ""

#. Tag: para
#: hardening.xml:2121
#, no-c-format
msgid "The programs/protocols of FTP, <command>telnet</command>, and <command>rlogin</command> (<command>rsh</command>) are vulnerable to eavesdropping, which is one of the main reasons secure alternatives such as <command>ssh</command>, <command>scp</command> or <command>sftp</command> should be used instead. It is highly recommended not to run these insecure services. Because of the high risk, this guide does not cover these services (other than vsftp). It would also be a good idea (and part of our guidance, see next section) not to have FTP and Telnet server RPMs installed on the system. Note that the EAL 4+ evaluation had vsftp installed. The <quote>vs</quote> stands for <quote>very secure</quote>&mdash;which is a differentiator here when compared to normal FTP."
msgstr ""

#. Tag: title
#: hardening.xml:2137
#, no-c-format
msgid "Removing Unnecessary Software Packages (RPMs)"
msgstr ""

#. Tag: para
#: hardening.xml:2139
#, no-c-format
msgid "A very important step in securing a Linux system is to determine the primary function(s) or role(s) of the Linux server. Otherwise, it can be difficult to understand what needs to be secured and securing these Linux systems can prove ineffective. Therefore, it is critical to look at the default list of software packages and remove any unnecessary packages or packages that do not comply with your defined security policies."
msgstr ""

#. Tag: para
#: hardening.xml:2148
#, no-c-format
msgid "Doing this will result in fewer packages that require updates and will simplify maintenance efforts when security alerts and patches are released. It is a best practice not to install, among others, development packages or desktop software packages (for example, an X Server) on production servers. If you do not need them, you should also not install, for example, the Apache Web server or Samba file sharing server."
msgstr ""

#. Tag: title
#: hardening.xml:2158
#, no-c-format
msgid "Requirements of Third-party Installers"
msgstr ""

#. Tag: para
#: hardening.xml:2159
#, no-c-format
msgid "Many third-party vendors like Oracle and IBM require a desktop environment and development libraries to run installers. To avoid this from having an impact on the security of their production servers, many organizations work around this by creating a silent installation (response file) in a development lab."
msgstr ""

#. Tag: para
#: hardening.xml:2168
#, no-c-format
msgid "Also, other packages like FTP and Telnet daemons should not be installed as well unless there is a justified business reason for it. <command>ssh</command>, <command>scp</command> or <command>sftp</command> should be used as replacements, see <xref linkend=\"sec.sec_prot.general.remote\"/>."
msgstr ""

#. Tag: para
#: hardening.xml:2176
#, no-c-format
msgid "One of the first action items should be to create a Linux image that <emphasis>only</emphasis> contains RPMs needed by the system and applications, and those needed for maintenance and troubleshooting purposes. A good approach is to start with a minimum list of RPMs and then add packages as needed. This process is time-consuming but usually worth the effort."
msgstr ""

#. Tag: title
#: hardening.xml:2186
#, no-c-format
msgid "Just Enough Operating System (JeOS)"
msgstr ""

#. Tag: para
#: hardening.xml:2187
#, no-c-format
msgid "The &suse; Appliance Program includes a component called JeOS (Just Enough Operating System). JeOS has a very small footprint and can be customized to fit the specific needs of a system developer. Main uses of JeOS are for hardware/software appliance or virtual machine development. Key benefits of JeOS are efficiency, higher performance, increased security and simplified management."
msgstr ""

#. Tag: para
#: hardening.xml:2195
#, no-c-format
msgid "If JeOS is not an option for you, a good choice is the minimal installation pattern."
msgstr ""

#. Tag: para
#: hardening.xml:2201
#, no-c-format
msgid "To generate a list of all installed packages, use the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2205
#, no-c-format
msgid "&prompt.root;zypper packages -i"
msgstr ""

#. Tag: para
#: hardening.xml:2207
#, no-c-format
msgid "To retrieve details about a particular package run:"
msgstr ""

#. Tag: screen
#: hardening.xml:2211
#, no-c-format
msgid "&prompt.root;zypper info <replaceable>PACKAGE_NAME</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:2213
#, no-c-format
msgid "To check for and report potential conflicts and dependencies when deleting a package, run:"
msgstr ""

#. Tag: screen
#: hardening.xml:2218
#, no-c-format
msgid "&prompt.root;zypper rm -D <replaceable>PACKAGE_NAME</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:2220
#, no-c-format
msgid "This can be very useful, as running the removal command without a test can often yield a lot of complaints and require manual recursive dependency hunting."
msgstr ""

#. Tag: title
#: hardening.xml:2227
#, no-c-format
msgid "Removal of Essential System Packages"
msgstr ""

#. Tag: para
#: hardening.xml:2228
#, no-c-format
msgid "When removing packages, be careful not to remove any essential system packages. This could put your system into a broken state in which it can no longer be booted or repaired. If you are uncertain about this, then it is best to do a complete backup of your system before you start to remove any packages."
msgstr ""

#. Tag: para
#: hardening.xml:2237
#, no-c-format
msgid "For the final removal of one or more packages use the following <command>zypper</command> command with the added <quote>-u</quote> switch, which causes any dependencies that are becoming unused by removing the named packages, to be removed as well:"
msgstr ""

#. Tag: screen
#: hardening.xml:2244
#, no-c-format
msgid "&prompt.root;zypper rm -u <replaceable>PACKAGE_NAME</replaceable>"
msgstr ""

#. Tag: title
#: hardening.xml:2248
#, no-c-format
msgid "Patching Linux Systems"
msgstr ""

#. Tag: para
#: hardening.xml:2250
#, no-c-format
msgid "Building an infrastructure for patch management is another very important part of a proactive and secure production Linux environment."
msgstr ""

#. Tag: para
#: hardening.xml:2255
#, no-c-format
msgid "It is recommended to have a written security policy and procedure to handle Linux security updates and issues. For example, a security policy should detail the time frame for assessment, testing, and roll out of patches. Network related security vulnerabilities should get the highest priority and should be addressed immediately within a short time frame. The assessment phase should occur within a testing lab, and initial roll out should occur on development systems first"
msgstr ""

#. Tag: para
#: hardening.xml:2265
#, no-c-format
msgid "A separate security log file should contain details on which Linux security announcements have been received, which patches have been researched and assessed, when patches have been applied, etc."
msgstr ""

#. Tag: para
#: hardening.xml:2271
#, no-c-format
msgid "&suse; releases their patches in three categories, security, recommended and optional. There are a few options that can be used to keep systems patched, up to date and secure. Each system can register and then retrieve updates via the &suse; Update Web site using the included &yast; tool&mdash;&yast; Online Update. &suse; has also created the &rmtool; (&rmt;), an efficient way to maintain a local repository of available/released patches/updates/fixes that systems can then pull from (reducing Internet traffic). &suse; also offers &susemgr; for the maintenance, patching, reporting and centralized management of Linux systems, not only &suse;, but other distributions as well."
msgstr ""

#. Tag: title
#: hardening.xml:2285
#, no-c-format
msgid "&yast; Online Update"
msgstr ""

#. Tag: para
#: hardening.xml:2286
#, no-c-format
msgid "On a per-server basis, installation of important updates and improvements is possible using the &yast; Online Update tool. Current updates for the &sle; family are available from the product specific update catalogs containing patches. Installation of updates and improvements is accomplished using &yast; and selecting <guimenu>Online Update</guimenu> in the <guimenu>Software</guimenu> Group. All new patches (except the optional ones) that are currently available for your system will already be marked for installation. Clicking <guimenu>Accept</guimenu> will then automatically install these patches."
msgstr ""

#. Tag: title
#: hardening.xml:2300
#, no-c-format
msgid "Automatic Online Update"
msgstr ""

#. Tag: para
#: hardening.xml:2301
#, no-c-format
msgid "&yast; also offers the possibility to set up an automatic update. Select <menuchoice> <guimenu>Software</guimenu> <guimenu> Automatic Online Update</guimenu></menuchoice>. Configure a Daily or a Weekly update. Some patches, such as kernel updates, require user interaction, which would cause the automatic update procedure to stop. Check <guimenu>Skip Interactive Patches</guimenu> for the update procedure to proceed automatically."
msgstr ""

#. Tag: para
#: hardening.xml:2310
#, no-c-format
msgid "In this case, run a manual Online Update from time to install patches that require interaction."
msgstr ""

#. Tag: para
#: hardening.xml:2314
#, no-c-format
msgid "When <guimenu>Only Download Patches</guimenu> is checked, the patches are downloaded at the specified time but not installed. They must be installed manually using <command>rpm</command>or <command>zypper</command>."
msgstr ""

#. Tag: title
#: hardening.xml:2323
#, no-c-format
msgid "&rmtool;&mdash;&rmt;"
msgstr ""

#. Tag: para
#: hardening.xml:2324
#, no-c-format
msgid "The &rmtool; for &sle; goes one step further than the Online Update process by establishing a proxy system with repository and registration targets. This helps customers centrally manage software updates within the firewall on a per-system basis, while maintaining their corporate security policies and regulatory compliance."
msgstr ""

#. Tag: para
#: hardening.xml:2331
#, no-c-format
msgid "The downloadable &rmt; (<link xlink:href=\"http://download.suse.com/\"></link>) is integrated with &scc; (<link xlink:href=\"&sccurl;\"></link>) and provides a repository and registration target that is synchronized with it. This can be very helpful in tracking entitlements in large deployments. The &rmt; maintains all the capabilities of &scc;, while allowing a more secure centralized deployment. It is included with every &sle; subscription and is therefore fully supported."
msgstr ""

#. Tag: para
#: hardening.xml:2340
#, no-c-format
msgid "The &rmt; provides an alternative to the default configuration, which requires opening the firewall to outbound connections for each device to receive updates. That requirement often violates corporate security policies and can be seen as a threat to regulatory compliance by some organizations. Through its integration with &scc;, the &rmt; ensures that each device can receive its appropriate updates without the need to open the firewall, and without any redundant bandwidth requirements."
msgstr ""

#. Tag: para
#: hardening.xml:2349
#, no-c-format
msgid "The &rmt; also enables customers to locally track their &sle; devices (that is servers, desktops, or Point of Service terminals) throughout their enterprise. Now they can easily determine how many entitlements are in need of renewal at the end of a billing cycle without having to physically walk through the data center to manually update spreadsheets."
msgstr ""

#. Tag: para
#: hardening.xml:2356
#, no-c-format
msgid "The &rmt; informs the &sle; devices of any available software updates. Each device then obtains the required software updates from the &rmt;. The introduction of the &rmt; improves the interaction among &sle; devices within the network and simplifies how they receive their system updates. The &rmt; enables an infrastructure for several hundred &sle; devices per instance of each installation (depending on the specific usage profile). This offers more accurate and efficient server tracking."
msgstr ""

#. Tag: para
#: hardening.xml:2365
#, no-c-format
msgid "In a nutshell, the &rmtool; for &sle; provides customers with:"
msgstr ""

#. Tag: para
#: hardening.xml:2370
#, no-c-format
msgid "Assurance of firewall and regulatory compliance"
msgstr ""

#. Tag: para
#: hardening.xml:2375
#, no-c-format
msgid "Reduced bandwidth usage during software updates"
msgstr ""

#. Tag: para
#: hardening.xml:2380
#, no-c-format
msgid "Full support under active subscription from &suse;"
msgstr ""

#. Tag: para
#: hardening.xml:2385
#, no-c-format
msgid "Maintenance of existing customer interface with &ncc;"
msgstr ""

#. Tag: para
#: hardening.xml:2390
#, no-c-format
msgid "Accurate server entitlement tracking and effective measurement of subscription usage"
msgstr ""

#. Tag: para
#: hardening.xml:2396
#, no-c-format
msgid "Automated process to easily tally entitlement totals (no more spreadsheets!)"
msgstr ""

#. Tag: para
#: hardening.xml:2402
#, no-c-format
msgid "Simple installation process that automatically synchronizes server entitlement with &ncc;"
msgstr ""

#. Tag: title
#: hardening.xml:2411
#, no-c-format
msgid "&susemgr;"
msgstr ""

#. Tag: para
#: hardening.xml:2412
#, no-c-format
msgid "&susemgr; automates Linux server management, allowing you to provision and maintain your servers faster and more accurately. It monitors the health of each Linux server from a single console so you can identify server performance issues before they impact your business. And it lets you comprehensively manage your Linux servers across physical, virtual and cloud environments while improving data center efficiency. &susemgr; delivers complete life cycle management for Linux:"
msgstr ""

#. Tag: para
#: hardening.xml:2423
#, no-c-format
msgid "Asset management"
msgstr ""

#. Tag: para
#: hardening.xml:2428
#, no-c-format
msgid "Provisioning"
msgstr ""

#. Tag: para
#: hardening.xml:2433
#, no-c-format
msgid "Package management"
msgstr ""

#. Tag: para
#: hardening.xml:2438
#, no-c-format
msgid "Patch management"
msgstr ""

#. Tag: para
#: hardening.xml:2443
#, no-c-format
msgid "Configuration management"
msgstr ""

#. Tag: para
#: hardening.xml:2448
#, no-c-format
msgid "Redeployment"
msgstr ""

#. Tag: para
#: hardening.xml:2453
#, no-c-format
msgid "For more information on &susemgr; refer to <link xlink:href=\"https://www.suse.com/products/suse-manager/\"></link>."
msgstr ""

#. Tag: title
#: hardening.xml:2460
#, no-c-format
msgid "Securing the Network&mdash;Open Network Ports Detection"
msgstr ""

#. Tag: para
#: hardening.xml:2462
#, no-c-format
msgid "Securing a server requires that you know what it is serving; what services are running. Default server installations may have services running that aren't self apparent and open network ports that they are using. One of the most important tasks is to detect and close network ports that are not needed. To get a list of listening network ports (TCP and UDP sockets), you can use the <command>netstat</command> service run the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2472
#, no-c-format
msgid "&prompt.root;netstat -ntulp"
msgstr ""

#. Tag: para
#: hardening.xml:2474
#, no-c-format
msgid "Be aware that <command>netstat</command> output can be wider than a default terminal screen. If the screen is too narrow, the options described above will likely cause the output to wrap and be less legible."
msgstr ""

#. Tag: para
#: hardening.xml:2480
#, no-c-format
msgid "Below is an example of output from the above command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2484
#, no-c-format
msgid ""
      "Proto Recv-Q Send-Q Local            Foreign         State   PID/Program\n"
      "                    Address          Address                 name\n"
      "tcp   0      0      *:69             *.*             LISTEN  2328/tftpd\n"
      "tcp   0      0      127.0.0.1:25     *.*             LISTEN  2360/sendmail:acce\n"
      "tcp   0      0      *:22             *.*             LISTEN  2317/sshd"
msgstr ""

#. Tag: para
#: hardening.xml:2486
#, no-c-format
msgid "From the output above you can see that three TCP-based services are running and listening: tftpd, sendmail, and sshd. Sendmail should not be configured to listen for incoming network connections unless the server running it is a designated as a mail or relay server. Running a port scan from another server can confirm that, but make sure to obtain proper permissions to scan/probe a machine on a production network."
msgstr ""

#. Tag: para
#: hardening.xml:2496
#, no-c-format
msgid "Some organizations consider port scans without permission a security offense."
msgstr ""

#. Tag: para
#: hardening.xml:2502
#, no-c-format
msgid "Using the <command>nmap</command> command, such a scan can be conducted:"
msgstr ""

#. Tag: screen
#: hardening.xml:2506
#, no-c-format
msgid ""
      "&prompt.root;nmap -sS -sU <replaceable>REMOTE_HOST</replaceable>\n"
      "Starting nmap 3.70 ( http://www.insecure.org/nmap/ ) at 2004-12-10 22:51 CST\n"
      "Interesting ports on &wsII; (&wsIIip;):\n"
      "(The 3131 ports scanned but not shown below are in state: closed)\n"
      "PORT     STATE         SERVICE\n"
      "22/tcp   open          ssh\n"
      "69/tcp   open          auth\n"
      "\n"
      "Nmap run completed -- 1 IP address (1 host up) scanned in 221.669 seconds"
msgstr ""

#. Tag: para
#: hardening.xml:2508
#, no-c-format
msgid "Note that running the <command>nmap</command> command will only scan certain well-known ports by default. If you want to scan all ports you need to specify <command>-p 1-65535</command>. Doing this will slow down the scan considerably. Especially for UDP scans the use of an asynchronous scanner such as masscan <link xlink:href=\"https://software.opensuse.org/package/masscan\"></link> is recommended."
msgstr ""

#. Tag: screen
#: hardening.xml:2518
#, no-c-format
msgid ""
      "&prompt.root;masscan <replaceable>REMOTE_HOST</replaceable>/32 -p 1-65535\n"
      "\n"
      "Starting masscan 1.0.4 (http://bit.ly/14GZzcT) at 2017-11-28 10:51:58 GMT\n"
      " -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth\n"
      "Initiating SYN Stealth Scan\n"
      "Scanning 1 hosts [65535 ports/host]\n"
      "Discovered open port 222/tcp on 192.168.1.2\n"
      "Discovered open port 443/tcp on 192.168.1.2\n"
      "Discovered open port 25/tcp on 192.168.1.2\n"
      "Discovered open port 9030/tcp on 192.168.1.2\n"
      "Discovered open port 587/tcp on 192.168.1.2\n"
      "Discovered open port 80/tcp on 192.168.1.2"
msgstr ""

#. Tag: para
#: hardening.xml:2520
#, no-c-format
msgid "If you want to scan UDP specify the ports with a <command>U:</command> prefix: <command>masscan <replaceable>REMOTE_HOST</replaceable>/32 -p U:1-65535</command>"
msgstr ""

#. Tag: para
#: hardening.xml:2525
#, no-c-format
msgid "The results of the scans can vary widely and might not show all listening network sockets depending on the status of the firewall."
msgstr ""

#. Tag: para
#: hardening.xml:2531
#, no-c-format
msgid "From the first sample run above, you see that the <systemitem class=\"daemon\">tftpd</systemitem> daemon is listening on port auth (port 69) for <literal>IDENT</literal>. You can also see that sendmail is not listening for remote incoming network connections."
msgstr ""

#. Tag: para
#: hardening.xml:2538
#, no-c-format
msgid "Another method to list all of the TCP and UDP sockets to which programs are listening (on a host) is to use the <command>lsof</command> command ‚Äì which lists open files:"
msgstr ""

#. Tag: screen
#: hardening.xml:2544
#, no-c-format
msgid ""
      "&prompt.root;lsof -i -n | egrep 'COMMAND|LISTEN|UDP'\n"
      "COMMAND  PID   USER   FD   TYPE    DEVICE SIZE/OFF NODE NAME\n"
      "sshd     2317  root   3u   IPv6    6579   0t0      TCP *:ssh (LISTEN)\n"
      "tftpd    2328  root   5u   IPv4    6698   0t0      TCP *:auth (LISTEN)\n"
      "sendmail 2360  root   3u   IPv4    6729   0t0      TCP 127.0.0.1:smtp (LISTEN)"
msgstr ""

#. Tag: para
#: hardening.xml:2546
#, no-c-format
msgid "You should always check the results you get from a command run on a machine with an external scan."
msgstr ""

#. Tag: title
#: hardening.xml:2553
#, no-c-format
msgid "Securing Postfix"
msgstr ""

#. Tag: para
#: hardening.xml:2555
#, no-c-format
msgid "Postfix is a replacement for Sendmail and has several security advantages over Sendmail. Postfix is the default mail system in &productname; and consists of several small programs that each perform their own small task&mdash;most of these programs run in a chroot jail. This is one of the reasons Postfix is recommended over Sendmail."
msgstr ""

#. Tag: para
#: hardening.xml:2563
#, no-c-format
msgid "Linux servers that are not dedicated mail or relay servers should not accept external e-mails. However, it is important for production servers to send local e-mails to a relay server&mdash;some security setups (for example the seccheck scripts) can be configured to send e-mails to someone other than &rootuser;, even off the local system."
msgstr ""

#. Tag: para
#: hardening.xml:2571
#, no-c-format
msgid "Verify the following parameters in <filename>/etc/postfix/main.cf</filename> are set to ensure that Postfix accepts only local e-mails for delivery (look toward the bottom of the file as the top portion is mostly commented-out example entries and explanations):"
msgstr ""

#. Tag: screen
#: hardening.xml:2579
#, no-c-format
msgid ""
      "mydestination = $myhostname, localhost.$mydomain, localhost\n"
      "inet_interfaces = localhost"
msgstr ""

#. Tag: para
#: hardening.xml:2581
#, no-c-format
msgid "The <literal>mydestination</literal> parameter lists all domains to receive e-mails for. The <literal>inet_interfaces</literal> parameter specifies the network to listen on. After reconfiguring Postfix, a restart of the mail system is necessary:"
msgstr ""

#. Tag: screen
#: hardening.xml:2588
#, no-c-format
msgid "&prompt.root;systemctl restart postfix"
msgstr ""

#. Tag: para
#: hardening.xml:2590
#, no-c-format
msgid "Verify that Postfix is not listening for network requests (incoming) by running one of these commands from another host:"
msgstr ""

#. Tag: screen
#: hardening.xml:2595
#, no-c-format
msgid ""
      "nmap -sT -p 25 <replaceable>REMOTE_HOST</replaceable>\n"
      "telnet &lt;remote_host&gt; 25"
msgstr ""

#. Tag: para
#: hardening.xml:2598
#, no-c-format
msgid "Running these commands on the local host will provide inaccurate results because Postfix is supposed to accept connections from the local node. Use an external host for correct results."
msgstr ""

#. Tag: title
#: hardening.xml:2606
#, no-c-format
msgid "File Systems: Securing NFS"
msgstr ""

#. Tag: para
#: hardening.xml:2608
#, no-c-format
msgid "NFS (Network File System) allows servers to share files over a network. But like all network services using NFS involves risks."
msgstr ""

#. Tag: para
#: hardening.xml:2613
#, no-c-format
msgid "Here are some basic rules:"
msgstr ""

#. Tag: para
#: hardening.xml:2619
#, no-c-format
msgid "NFS should not be enabled if not needed."
msgstr ""

#. Tag: para
#: hardening.xml:2624
#, no-c-format
msgid "If NFS is truly needed, use a TCP wrapper to restrict remote access."
msgstr ""

#. Tag: para
#: hardening.xml:2629
#, no-c-format
msgid "Ensure to export only to those hosts that really need access."
msgstr ""

#. Tag: para
#: hardening.xml:2634
#, no-c-format
msgid "Use a fully qualified domain name to diminish any spoofing attempts."
msgstr ""

#. Tag: para
#: hardening.xml:2639
#, no-c-format
msgid "Export only as read-only whenever possible."
msgstr ""

#. Tag: para
#: hardening.xml:2644
#, no-c-format
msgid "Use NFS only over TCP."
msgstr ""

#. Tag: para
#: hardening.xml:2650
#, no-c-format
msgid "If you do not have shared directories to export, then ensure that the NFS service is <emphasis>not</emphasis> enabled nor running on the system:"
msgstr ""

#. Tag: para
#: hardening.xml:2655
#, no-c-format
msgid "Check the NFS service status:"
msgstr ""

#. Tag: screen
#: hardening.xml:2659
#, no-c-format
msgid "&prompt.root;systemctl status nfsserver"
msgstr ""

#. Tag: para
#: hardening.xml:2661
#, no-c-format
msgid "Check the current targets:"
msgstr ""

#. Tag: screen
#: hardening.xml:2665
#, no-c-format
msgid "&prompt.root;ls /etc/systemd/system/*.wants/nfsserver.service"
msgstr ""

#. Tag: title
#: hardening.xml:2668
#, no-c-format
msgid "Enabling and Starting NFS Server"
msgstr ""

#. Tag: para
#: hardening.xml:2669
#, no-c-format
msgid "If NFS must be used, it can be activated using the following commands on &productname; or more simply and securely with the &yast; plug-in (ncurses). Access it directly from command line with <command>yast nfs_server</command> or <command>yast nfs_client</command> ‚Äì or manually:"
msgstr ""

#. Tag: screen
#: hardening.xml:2676
#, no-c-format
msgid ""
      "&prompt.root;systemctl enable nfs\n"
      "systemctl start nfs"
msgstr ""

#. Tag: para
#: hardening.xml:2677
#, no-c-format
msgid "Portmapper information:"
msgstr ""

#. Tag: screen
#: hardening.xml:2680
#, no-c-format
msgid ""
      "&prompt.root;rpcinfo -p <replaceable>SERVERNAME</replaceable>\n"
      "   program vers proto   port\n"
      "    100000    2   tcp    111  portmapper\n"
      "    100000    2   udp    111  portmapper\n"
      "    100003    2   udp   2049  nfs\n"
      "    100003    3   udp   2049  nfs\n"
      "    100003    2   tcp   2049  nfs\n"
      "    100003    3   tcp   2049  nfs\n"
      "    100005    1   udp    623  mountd\n"
      "    100005    1   tcp    626  mountd\n"
      "    100005    2   udp    623  mountd\n"
      "    100005    2   tcp    626  mountd\n"
      "    100005    3   udp    623  mountd\n"
      "    100005    3   tcp    626  mountd"
msgstr ""

#. Tag: para
#: hardening.xml:2681
#, no-c-format
msgid "If you run it from an \"untrusted\" server or network, you should get the following output:"
msgstr ""

#. Tag: screen
#: hardening.xml:2685
#, no-c-format
msgid ""
      "&prompt.root;rpcinfo -p <replaceable>SERVERNAME</replaceable>\n"
      "No remote programs registered."
msgstr ""

#. Tag: title
#: hardening.xml:2689
#, no-c-format
msgid "Exporting NFS"
msgstr ""

#. Tag: para
#: hardening.xml:2690
#, no-c-format
msgid "To allow a client access to a file system or directory, the <filename>/etc/exports</filename> file serves as the access control list. To give the network \"network.&exampledomain;\" read-only access to <filename>/pub</filename>, the entries in <filename>/etc/exports</filename> would look like as follows:"
msgstr ""

#. Tag: screen
#: hardening.xml:2697
#, no-c-format
msgid "/pub *.network.&exampledomain;(ro,sync)"
msgstr ""

#. Tag: para
#: hardening.xml:2698
#, no-c-format
msgid "It is very important <emphasis>not</emphasis> to give write access to NFS clients if not absolutely needed! Entries in <filename>/etc/exports</filename> are exported read-only (<option>ro</option> option) by default. To allow servers <systemitem class=\"systemname\">sles-ha1</systemitem>, <systemitem class=\"systemname\">sles-ha2</systemitem> and <systemitem class=\"systemname\">sles-ha3</systemitem> read-write access to the <filename>/data/MYSQL</filename> directory, the entries in <filename>/etc/exports</filename> would look like as follows:"
msgstr ""

#. Tag: screen
#: hardening.xml:2709
#, no-c-format
msgid "/data/MYSQL sles-ha1.&exampledomain;(rw,sync) sles-ha2.&exampledomain;(rw,sync) sles-ha3.&exampledomain;(rw,sync)"
msgstr ""

#. Tag: para
#: hardening.xml:2710
#, no-c-format
msgid "Note that the options <emphasis>must not</emphasis> be separated from the host names or networks with whitespace(s). Also, fully qualified domain names should <emphasis>always</emphasis> be used to diminish spoofing attempts. All entries in <filename>/etc/exports</filename> are exported with the <option>root_squash</option> option (<quote>root squashing</quote>) by default. This means that a root user on a client machine does not have root privileges (root access) to files on exported NFS. It is not recommended to turn <quote>root squashing</quote> off using the <option>no_root_squash</option> option! After you have made all your entries in <filename>/etc/exports</filename>, you can export all file systems/directories using the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2723
#, no-c-format
msgid "&prompt.root;exportfs -a"
msgstr ""

#. Tag: para
#: hardening.xml:2724
#, no-c-format
msgid "To unexport all shared file systems/directories, run:"
msgstr ""

#. Tag: screen
#: hardening.xml:2727
#, no-c-format
msgid "&prompt.root;exportfs -ua"
msgstr ""

#. Tag: para
#: hardening.xml:2728
#, no-c-format
msgid "To see all shared file systems/directories, run:"
msgstr ""

#. Tag: screen
#: hardening.xml:2731
#, no-c-format
msgid ""
      "&prompt.root;showmount -e localhost\n"
      "Export list for localhost:\n"
      "\n"
      "/pub *.network.&exampledomain;/data/MYSQL\n"
      "sles-ha1.&exampledomain;,sles-ha2.&exampledomain;,sles-ha3.&exampledomain;"
msgstr ""

#. Tag: title
#: hardening.xml:2735
#, no-c-format
msgid "Using NFS over TCP"
msgstr ""

#. Tag: para
#: hardening.xml:2736
#, no-c-format
msgid "If you need NFS, it is recommended to use NFS only over TCP since NFS over UDP is not secure. All 2.4 and later kernels support NFS over TCP on the client side. Server support for TCP appeared in later 2.4 kernels and beyond. To mount a shared directory using NFS over TCP, it is necessary to use the <option>proto=tcp</option> mount option:"
msgstr ""

#. Tag: screen
#: hardening.xml:2743
#, no-c-format
msgid "&prompt.root;mount -o proto=tcp <replaceable>SERVERNAME</replaceable>:/pub /usr/local/pub"
msgstr ""

#. Tag: para
#: hardening.xml:2744
#, no-c-format
msgid "Verify that the target directory, in this case <filename>/usr/local/pub</filename>, exists on the client:"
msgstr ""

#. Tag: screen
#: hardening.xml:2748
#, no-c-format
msgid ""
      "&prompt.root;mount [...] <replaceable>SERVERNAME</replaceable>:/pub on\n"
      "/usr/local/pub type nfs (rw,proto=tcp,addr=&nfsip;)"
msgstr ""

#. Tag: para
#: hardening.xml:2749
#, no-c-format
msgid "To have the shared directory mounted on the client at boot time, use the <filename>/etc/fstab</filename> file. For the above example, the <filename>/etc/fstab</filename> entry could look like this:"
msgstr ""

#. Tag: screen
#: hardening.xml:2754
#, no-c-format
msgid "<replaceable>SERVERNAME</replaceable>:/pub /usr/local/pub nfs rsize=8192,wsize=8192,timeo=14,intr,tcp 0 0"
msgstr ""

#. Tag: title
#: hardening.xml:2758
#, no-c-format
msgid "Copying Files Using SSH Without Providing Login Prompts"
msgstr ""

#. Tag: para
#: hardening.xml:2760
#, no-c-format
msgid "This example is needed in some cases to enable files to be copied over the network using SSH without providing an interactive login prompt. This allows trusted hosts to be set up&mdash;an example of federation."
msgstr ""

#. Tag: para
#: hardening.xml:2766
#, no-c-format
msgid "SSH can allow a forced command using the <quote>command</quote> option. Using this option it is possible to disable scp (secure copy) and enforce every passed <command>ssh</command> command to be ignored. On the server side where you want to retrieve the file from, add the following entry to the beginning of the SSH key in the <filename>~/.ssh/authorized_keys</filename> file (the <filename>~</filename> represents a particular users home directory ‚Äì &rootuser;'s home directory is <filename>/root</filename> ‚Äì other users typically reside in <filename>/home/<replaceable>USERNAME</replaceable></filename>):"
msgstr ""

#. Tag: screen
#: hardening.xml:2779
#, no-c-format
msgid "command=\"/bin/cat ~/&lt;file_name&gt;\" ssh-rsa AAAAB3N...{etc}"
msgstr ""

#. Tag: para
#: hardening.xml:2781
#, no-c-format
msgid "To copy now the file from the remote server, run the following command:"
msgstr ""

#. Tag: para
#: hardening.xml:2785
#, no-c-format
msgid "ssh <replaceable>USER</replaceable>@<replaceable>SERVERNAME</replaceable> <replaceable>LOCAL_FILE</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:2790
#, no-c-format
msgid "Since <command>/bin/cat</command> is run on the server side, its output needs to be redirected to the local file."
msgstr ""

#. Tag: para
#: hardening.xml:2795
#, no-c-format
msgid "Another approach is to replace the <command>/bin/cat</command> (referenced above) with your own script that checks the passed SSH commands by reading the environment variable <envar>$SSH_ORIGINAL_COMMAND</envar>. For example:"
msgstr ""

#. Tag: screen
#: hardening.xml:2802
#, no-c-format
msgid ""
      "#!/bin/ksh\n"
      " if [[ $SSH_ORIGINAL_COMMAND = \"File1\" ||\n"
      "       $SSH_ORIGINAL_COMMAND = \"File2\" ]]\n"
      " then\n"
      "     /bin/cat $SSH_ORIGINAL_COMMAND\n"
      " else\n"
      "     echo \"Invalid file name!\"\n"
      "     exit 1\n"
      " fi"
msgstr ""

#. Tag: para
#: hardening.xml:2804
#, no-c-format
msgid "So you replace the <command>/bin/cat</command> portion with the script name in <filename>~/.ssh/authorized_keys</filename>, and run the following command to copy <filename>Foo1</filename>:"
msgstr ""

#. Tag: screen
#: hardening.xml:2810
#, no-c-format
msgid "&prompt.user;ssh <replaceable>USER</replaceable>@<replaceable>SERVERNAME</replaceable> Foo1 &gt; <replaceable>LOCAL_FILE</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:2812
#, no-c-format
msgid "To copy <filename>Foo 2</filename>, run:"
msgstr ""

#. Tag: screen
#: hardening.xml:2816
#, no-c-format
msgid "&prompt.user;ssh <replaceable>USER</replaceable>@<replaceable>SERVERNAME</replaceable> Foo2 &gt; <replaceable>LOCAL_FILE</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:2818
#, no-c-format
msgid "With the modifications above, every other variety of passed parameters will return errors."
msgstr ""

#. Tag: title
#: hardening.xml:2824
#, no-c-format
msgid "Checking File Permissions and Ownership"
msgstr ""

#. Tag: para
#: hardening.xml:2826
#, no-c-format
msgid "The following sections deal with some ways the default permissions and file settings can be modified to enhance the security of a host. It is important to note that the use of the default &productname; utilities like <command>seccheck</command> - can be run to lock down and improve the general file security and user environment. However, it is beneficial to understand how to modify these things."
msgstr ""

#. Tag: para
#: hardening.xml:2835
#, no-c-format
msgid "&productname; hosts include 3 defaults settings for file permissions: <filename>permissions.easy</filename>, <filename>permissions.secure</filename>, and <filename>permissions.paranoid</filename>, all located in the <filename>/etc</filename> directory. The purpose of these files is to define special permissions, such as world-writable directories or, for files, the setuser ID bit (programs with the setuser ID bit set do not run with the permissions of the user that has launched it, but with the permissions of the file owner, usually &rootuser;)."
msgstr ""

#. Tag: para
#: hardening.xml:2847
#, no-c-format
msgid "Administrators can use the file <filename>/etc/permissions.local</filename> to add their own settings. The easiest way to implement one of the default permission rule-sets above is to use the <guimenu>Local Security</guimenu> module in &yast;."
msgstr ""

#. Tag: para
#: hardening.xml:2854
#, no-c-format
msgid "Each of the following topics will be modified by a selected rule-set, but the information is important to understand on its own."
msgstr ""

#. Tag: title
#: hardening.xml:2860
#, no-c-format
msgid "Default umask"
msgstr ""

#. Tag: para
#: hardening.xml:2862
#, no-c-format
msgid "The <command>umask</command> (user file-creation mode mask) command is a shell built-in command which determines the default file permissions for newly created files and directories. This can be overwritten by system calls but many programs and utilities use <command>umask</command>. By default, <command>umask</command> is set to <literal>022</literal>. You can modify this globally by changing the value in <filename>/etc/profile</filename> or for each user in the startup files of the shell."
msgstr ""

#. Tag: para
#: hardening.xml:2872
#, no-c-format
msgid "To determine the active umask, use the <command>umask</command> command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2877
#, no-c-format
msgid ""
      "&prompt.user;umask\n"
      "022"
msgstr ""

#. Tag: para
#: hardening.xml:2879
#, no-c-format
msgid "The umask is subtracted from the access mode <literal>777</literal> if at least on bit is set."
msgstr ""

#. Tag: para
#: hardening.xml:2884
#, no-c-format
msgid "With the default umask you see the behavior most users expect to see on a Linux system."
msgstr ""

#. Tag: screen
#: hardening.xml:2888
#, no-c-format
msgid ""
      "&prompt.user;touch a\n"
      "&prompt.user;mkdir b\n"
      "&prompt.user;ls -on\n"
      "total 16\n"
      "-rw-r--r--. 1 17086    0 Nov 29 15:05 a\n"
      "drwxr-xr-x. 2 17086 4096 Nov 29 15:05 b"
msgstr ""

#. Tag: para
#: hardening.xml:2890
#, no-c-format
msgid "You can specify arbitrary umask values, depending on you needs."
msgstr ""

#. Tag: screen
#: hardening.xml:2893
#, no-c-format
msgid ""
      "&prompt.user;umask 111\n"
      "&prompt.user;touch c\n"
      "&prompt.user;mkdir d\n"
      "&prompt.user;ls -on\n"
      "total 16\n"
      "-rw-rw-rw-. 1 17086    0 Nov 29 15:05 c\n"
      "drw-rw-rw-. 2 17086 4096 Nov 29 15:05 d"
msgstr ""

#. Tag: para
#: hardening.xml:2895
#, no-c-format
msgid "Based on your thread model you can use a stricter umask like <literal>037</literal> to prevent accidential data leakage."
msgstr ""

#. Tag: screen
#: hardening.xml:2899
#, no-c-format
msgid ""
      "&prompt.user;umask 037\n"
      "&prompt.user;touch e\n"
      "&prompt.user;mkdir f\n"
      "&prompt.user;ls -on\n"
      "total 16\n"
      "-rw-r-----. 1 17086    0 Nov 29 15:06 e\n"
      "drwxr-----. 2 17086 4096 Nov 29 15:06 f"
msgstr ""

#. Tag: title
#: hardening.xml:2903
#, no-c-format
msgid "SUID/SGID Files"
msgstr ""

#. Tag: para
#: hardening.xml:2905
#, no-c-format
msgid "When the SUID (set user ID) or SGID (set group ID) bits are set on an executable, it executes with the UID or GID of the owner of the executable rather than that of the person executing it. This means that, for example, all executables that have the SUID bit set and are owned by &rootuser; are executed with the UID of &rootuser;. A good example is the <command>passwd</command> command that allows ordinary users to update the password field in the <filename>/etc/shadow</filename> file which is owned by &rootuser;."
msgstr ""

#. Tag: para
#: hardening.xml:2915
#, no-c-format
msgid "But SUID/SGID bits can be misused when the executable has a security hole. Therefore, you should search the entire system for SUID/SGID executables and document it. To search the entire system for SUID or SGID files, you can run the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2922
#, no-c-format
msgid "&prompt.root;find /bin /boot /etc /home /lib /lib64 /opt /root /sbin /srv /tmp /usr /var -type f -perm '/6000' -ls"
msgstr ""

#. Tag: para
#: hardening.xml:2924 hardening.xml:2968 hardening.xml:3013
#, no-c-format
msgid "You might need to extend the list of directories that are searched if you have a different filesystem structure."
msgstr ""

#. Tag: para
#: hardening.xml:2929
#, no-c-format
msgid "&suse; only sets the SUID/SGID bit on binary if it is really necessary. Ensure that code developers do not set SUID/SGID bits on their programs if it is not an absolute requirement. Very often you can use workarounds like removing the executable bit for world/others. However, a better approach is to change the design of the software or use capabilities."
msgstr ""

#. Tag: para
#: hardening.xml:2938
#, no-c-format
msgid "&productname; supports file capabilities to allow more fine grained privileges to be given to programs rather than the full power of &rootuser;:"
msgstr ""

#. Tag: screen
#: hardening.xml:2943
#, no-c-format
msgid ""
      "&prompt.root;getcap -v /usr/bin/ping\n"
      "      /usr/bin/ping = cap_new_raw+eip"
msgstr ""

#. Tag: para
#: hardening.xml:2945
#, no-c-format
msgid "The previous command only grants the CAP_NET_RAW capability to whoever executes <command>ping</command>. In case of vulnerabilities inside <command>ping</command>, an attacker can gain at most this capability in contrast to full &rootuser;. Whenever possible, file capabilities should be chosen in favor of the SUID bit. But this only applies when the binary is suid to &rootuser; not to other users such as <literal>news</literal>, <literal>lp</literal> and alike."
msgstr ""

#. Tag: title
#: hardening.xml:2957
#, no-c-format
msgid "World-Writable Files"
msgstr ""

#. Tag: para
#: hardening.xml:2959
#, no-c-format
msgid "World-writable files are a security risk since they can be modified by any user on the system. Additionally, world-writable directories allow anyone to add or delete files. To locate world-writable files and directories, you can use the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:2966
#, no-c-format
msgid "&prompt.root;find /bin /boot /etc /home /lib /lib64 /opt /root /sbin /srv /tmp /usr /var -type f -perm -2 ! -type l -ls"
msgstr ""

#. Tag: para
#: hardening.xml:2972
#, no-c-format
msgid "The <option>! -type l</option> parameter skips all symbolic links since symbolic links are always world-writable. However, this is not a problem as long as the target of the link is not world-writable, which is checked by the above find command."
msgstr ""

#. Tag: para
#: hardening.xml:2979
#, no-c-format
msgid "World-writable directories with the sticky bit such as the <filename>/tmp</filename> directory do not allow anyone except the owner of a file to delete or rename it in this directory. The sticky bit makes files stick to the user who created it and it prevents other users from deleting and renaming the files. Therefore, depending on the purpose of the directory, world-writable directories with sticky are usually not an issue. An example is the <filename>/tmp</filename> directory:"
msgstr ""

#. Tag: screen
#: hardening.xml:2989
#, no-c-format
msgid ""
      "&prompt.user;ls -ld /tmp\n"
      "drwxrwxrwt 18 root root 16384 Dec 23 22:20 /tmp"
msgstr ""

#. Tag: para
#: hardening.xml:2991
#, no-c-format
msgid "The <literal>t</literal> mode bit in the output denotes the sticky bit."
msgstr ""

#. Tag: title
#: hardening.xml:2997
#, no-c-format
msgid "Orphaned or Unowned Files"
msgstr ""

#. Tag: para
#: hardening.xml:2999
#, no-c-format
msgid "Files not owned by any user or group might not necessarily be a security problem in itself. However, unowned files could pose a security problem in the future. For example, if a new user is created and the new users happens to get the same UID as the unowned files have, then this new user will automatically become the owner of these files."
msgstr ""

#. Tag: para
#: hardening.xml:3007
#, no-c-format
msgid "To locate files not owned by any user or group, use the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:3011
#, no-c-format
msgid "&prompt.root;find /bin /boot /etc /home /lib /lib64 /opt /root /sbin /srv /tmp /usr /var -nouser -o -nogroup"
msgstr ""

#. Tag: para
#: hardening.xml:3017
#, no-c-format
msgid "A different problem are files that were not installed via the packaging system and therefor don't receive updates. You can check for such files with the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:3023
#, no-c-format
msgid "&prompt.user;find /bin /lib /lib64 /usr -path /usr/local -prune -o -type f -a -exec /bin/sh -c \"rpm -qf {} &amp;> /dev/null || echo {}\" \\;"
msgstr ""

#. Tag: para
#: hardening.xml:3025
#, no-c-format
msgid "Run this command as an untrusted user (for example nobody) since crafted filenames might lead to command execution. This shouldn't be a problem since these directories should only be writeable by &rootuser;, but it's still a good security precaution."
msgstr ""

#. Tag: para
#: hardening.xml:3031
#, no-c-format
msgid "This will show you all files under <filename>/bin</filename>, <filename>/lib</filename>, <filename>/lib64</filename> and <filename>/usr</filename> (with the exception of files in <filename>/usr/local</filename>) that are not tracked by the package manager. These files might not represent a security issue, but you should be aware what is not tracked and take the necessary precautions to keep these files up to date."
msgstr ""

#. Tag: title
#: hardening.xml:3043
#, no-c-format
msgid "Restricting Access to Removable Media"
msgstr ""

#. Tag: para
#: hardening.xml:3047
#, no-c-format
msgid "In some environments it is required to restrict access to removable media such as USB storage or optical devices. The tools coming with the <systemitem>udisks2</systemitem> package help with such a configuration."
msgstr ""

#. Tag: para
#: hardening.xml:3055
#, no-c-format
msgid "Create a rules file <filename>/etc/polkit-1/rules.d/01-restrict-removable-media.rules</filename> similar to the following:"
msgstr ""

#. Tag: screen
#: hardening.xml:3060
#, no-c-format
msgid ""
      "// Allow users in group 'mmedia_all' to mount/unmount all type of drives\n"
      "// Allow users in group 'mmedia_removable' to mount/umount USB storage drives\n"
      "// Allow users in group 'mmedia_optical' to mount/unmount Optical drives\n"
      "polkit.addRule(function(action, subject) {\n"
      "  if (/^org\\.freedesktop\\.udisks2\\.filesystem-.*mount.*$/.test(action.id) &amp;&amp;\n"
      "  action.lookup(\"drive.removable\") == \"true\") {\n"
      "    if (subject.isInGroup(\"mmedia_all\")) {\n"
      "      return polkit.Result.YES;\n"
      "    } else {\n"
      "      if (/.*optical.*/.test(action.lookup(\"drive.removable.media\"))) {\n"
      "        if (subject.isInGroup(\"mmedia_optical\"))\n"
      "        return polkit.Result.YES;\n"
      "      } else if (action.lookup(\"drive.removable.bus\") == \"usb\") {\n"
      "        if (subject.isInGroup(\"mmedia_removable\"))\n"
      "        return polkit.Result.YES;\n"
      "      }\n"
      "      return polkit.Result.NO;\n"
      "    }\n"
      "  }\n"
      "});"
msgstr ""

#. Tag: title
#: hardening.xml:3062
#, no-c-format
msgid "Naming of the Rules File"
msgstr ""

#. Tag: para
#: hardening.xml:3063
#, no-c-format
msgid "Rules files are processed in alphabetical order. Functions are called in the order they were added until one of the functions returns a value. Hence, to add an authorization rule that is processed before other rules, put it in a file in /etc/polkit-1/rules.d with a name that sorts before other rules files, for example <filename>01-restrict-removable-media.rules</filename>. Each function should return a value from <literal>polkit.Result</literal>."
msgstr ""

#. Tag: para
#: hardening.xml:3072
#, no-c-format
msgid "The name of a rules file must start with a digit, otherwise it will be ignored."
msgstr ""

#. Tag: para
#: hardening.xml:3080
#, no-c-format
msgid "Restart <systemitem>udisks2</systemitem>:"
msgstr ""

#. Tag: screen
#: hardening.xml:3083
#, no-c-format
msgid "&prompt.root;systemctl restart udisks2"
msgstr ""

#. Tag: para
#: hardening.xml:3086
#, no-c-format
msgid "Restart <systemitem>polkit</systemitem>"
msgstr ""

#. Tag: screen
#: hardening.xml:3089
#, no-c-format
msgid "&prompt.root;systemctl restart polkit"
msgstr ""

#. Tag: para
#: hardening.xml:3092
#, no-c-format
msgid "In &yast;, click <menuchoice><guimenu>Security and Users</guimenu><guimenu>User and Group Management</guimenu><guimenu>Groups</guimenu></menuchoice> to create the three groups <literal>mmedia_all</literal>, <literal>mmedia_optical</literal>, and <literal>mmedia_removable</literal>. Then add the users to these groups as wanted."
msgstr ""

#. Tag: title
#: hardening.xml:3106
#, no-c-format
msgid "Various Account Checks"
msgstr ""

#. Tag: title
#: hardening.xml:3111
#, no-c-format
msgid "Unlocked Accounts"
msgstr ""

#. Tag: para
#: hardening.xml:3112
#, no-c-format
msgid "It is important that all system and vendor accounts that are not used for logins are locked. To get a list of unlocked accounts on your system, you can check for accounts that do <emphasis>not</emphasis> have an encrypted password string starting with <literal>!</literal> or <literal>*</literal> in the <filename>/etc/shadow</filename> file. If you lock an account using <command>passwd</command> <option>-l</option>, it will put a <literal>!!</literal> in front of the encrypted password, effectively disabling the password. If you lock an account using <command>usermod</command> <option>-L</option>, it will put a <literal>!</literal> in front of the encrypted password. Many system and shared accounts are usually locked by default by having a <literal>*</literal> or <literal>!!</literal> in the password field which renders the encrypted password into an invalid string. Hence, to get a list of all unlocked (encryptable) accounts, run (<command>egrep</command> is used to allow use of regular-expressions):"
msgstr ""

#. Tag: screen
#: hardening.xml:3129
#, no-c-format
msgid "&prompt.root;egrep -v ':\\*|:\\!' /etc/shadow | awk -F: '{print $1}'"
msgstr ""

#. Tag: para
#: hardening.xml:3130
#, no-c-format
msgid "Also make sure all accounts have a <literal>x</literal> in the password field in <filename>/etc/passwd</filename>. The following command lists all accounts that do not have a <literal>x</literal> in the password field:"
msgstr ""

#. Tag: screen
#: hardening.xml:3136
#, no-c-format
msgid "&prompt.root;grep -v ':x:' /etc/passwd"
msgstr ""

#. Tag: para
#: hardening.xml:3137
#, no-c-format
msgid "An <literal>x</literal> in the password fields means that the password has been shadowed, for example the encrypted password needs to be looked up in the <filename>/etc/shadow</filename> file. If the password field in <filename>/etc/passwd</filename> is empty, then the system will not look up the shadow file and it will not prompt the user for a password at the login prompt."
msgstr ""

#. Tag: title
#: hardening.xml:3148
#, no-c-format
msgid "Unused Accounts"
msgstr ""

#. Tag: para
#: hardening.xml:3149
#, no-c-format
msgid "All system or vendor accounts that are not being used by users, applications, by the system or by daemons should be removed from the system. You can use the following command to find out if there are any files owned by a specific account:"
msgstr ""

#. Tag: screen
#: hardening.xml:3155
#, no-c-format
msgid "&prompt.root;find / -path /proc -prune -o -user <replaceable>ACCOUNT</replaceable> -ls"
msgstr ""

#. Tag: para
#: hardening.xml:3156
#, no-c-format
msgid "The <option>-prune</option> option in this example is used to skip the /proc file system. If you are sure that an account can be deleted, you can remove the account using the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:3161
#, no-c-format
msgid "&prompt.root;userdel -r <replaceable>ACCOUNT</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:3162
#, no-c-format
msgid "Without the <option>-r</option> option <command>userdel</command> will not delete the user's home directory and mail spool (<filename>/var/spool/mail/<replaceable>USER</replaceable></filename>). Note that many system accounts have no home directory."
msgstr ""

#. Tag: title
#: hardening.xml:3171
#, no-c-format
msgid "Enabling Password Aging"
msgstr ""

#. Tag: para
#: hardening.xml:3173
#, no-c-format
msgid "Password expirations are a general best practice&mdash;but might need to be excluded for some system and shared accounts (for example Oracle, etc.). Expiring password on those accounts could lead to system outages if the application account expires."
msgstr ""

#. Tag: para
#: hardening.xml:3180
#, no-c-format
msgid "Typically a corporate policy should be developed that dictates rules/procedures regarding password changes for system and shared accounts. However, normal user account passwords should expire automatically. The following example shows how password expiration can be set up for individual user accounts."
msgstr ""

#. Tag: para
#: hardening.xml:3188
#, no-c-format
msgid "The following files and parameters in the table can be used when a new account is created with the <command>useradd</command> command. Settings such as these are stored for each user account in the <filename>/etc/shadow</filename> file. If using the &yast; tool (<guimenu>User and Group Management</guimenu>) to add users, the settings are available on a per-user basis. Here are the various settings&mdash;some of which can also be system-wide (for example modification of <filename>/etc/login.defs</filename> and <filename>/etc/default/useradd</filename>):"
msgstr ""

#. Tag: filename
#: hardening.xml:3206 hardening.xml:3223 hardening.xml:3241
#, no-c-format
msgid "/etc/login.defs"
msgstr ""

#. Tag: literal
#: hardening.xml:3211
#, no-c-format
msgid "PASS_MAX_DAYS"
msgstr ""

#. Tag: para
#: hardening.xml:3215
#, no-c-format
msgid "Maximum number of days a password is valid."
msgstr ""

#. Tag: literal
#: hardening.xml:3228
#, no-c-format
msgid "PASS_MIN_DAYS"
msgstr ""

#. Tag: para
#: hardening.xml:3232
#, no-c-format
msgid "Minimum number of days before a user can change the password since the last change."
msgstr ""

#. Tag: literal
#: hardening.xml:3246
#, no-c-format
msgid "PASS_WARN_AGE"
msgstr ""

#. Tag: para
#: hardening.xml:3250
#, no-c-format
msgid "Number of days when the password change reminder starts."
msgstr ""

#. Tag: filename
#: hardening.xml:3258 hardening.xml:3275
#, no-c-format
msgid "/etc/default/useradd"
msgstr ""

#. Tag: literal
#: hardening.xml:3263
#, no-c-format
msgid "INACTIVE"
msgstr ""

#. Tag: para
#: hardening.xml:3267
#, no-c-format
msgid "Number of days after password expiration that account is disabled."
msgstr ""

#. Tag: literal
#: hardening.xml:3280
#, no-c-format
msgid "EXPIRE"
msgstr ""

#. Tag: para
#: hardening.xml:3284
#, no-c-format
msgid "Account expiration date in the format YYYY-MM-DD."
msgstr ""

#. Tag: para
#: hardening.xml:3294
#, no-c-format
msgid "Users created prior to these modifications will not be affected."
msgstr ""

#. Tag: para
#: hardening.xml:3299
#, no-c-format
msgid "Ensure that the above parameters are changed in the <filename>/etc/login.defs</filename> and <filename>/etc/default/useradd</filename> files. Review of the <filename>/etc/shadow</filename> file will show how these settings get stored after adding a user."
msgstr ""

#. Tag: para
#: hardening.xml:3307
#, no-c-format
msgid "To create a new user account, execute the following command:"
msgstr ""

#. Tag: screen
#: hardening.xml:3311
#, no-c-format
msgid "&prompt.root;useradd -c \"<replaceable>TEST_USER</replaceable>\" -g <replaceable>USERS</replaceable> <replaceable>TEST</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:3313
#, no-c-format
msgid "The <option>-g</option> option specifies the primary group for this account:"
msgstr ""

#. Tag: screen
#: hardening.xml:3318
#, no-c-format
msgid ""
      "&prompt.root;id <replaceable>TEST</replaceable>\n"
      "uid=509(test) gid=100(users) groups=100(users)"
msgstr ""

#. Tag: para
#: hardening.xml:3320
#, no-c-format
msgid "The settings in <filename>/etc/login.defs</filename> and <filename>/etc/default/useradd</filename> are recorded for the test user in the <filename>/etc/shadow</filename> file as follows:"
msgstr ""

#. Tag: screen
#: hardening.xml:3326
#, no-c-format
msgid ""
      "&prompt.root;grep <replaceable>TEST</replaceable> /etc/shadow\n"
      "test:!!:12742:7:60:7:14::"
msgstr ""

#. Tag: para
#: hardening.xml:3328
#, no-c-format
msgid "Password aging can be modified at any time by use of the <command>chage</command> command. To disable password aging for system and shared accounts, you can run the following <command>chage</command> command:"
msgstr ""

#. Tag: screen
#: hardening.xml:3335
#, no-c-format
msgid "&prompt.root;chage -M -1 <replaceable>SYSTEM_ACCOUNT_NAME</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:3337
#, no-c-format
msgid "To get password expiration information:"
msgstr ""

#. Tag: screen
#: hardening.xml:3341
#, no-c-format
msgid "&prompt.root;chage -l <replaceable>SYSTEM_ACCOUNT_NAME</replaceable>"
msgstr ""

#. Tag: para
#: hardening.xml:3343
#, no-c-format
msgid "For example:"
msgstr ""

#. Tag: screen
#: hardening.xml:3347
#, no-c-format
msgid ""
      "&prompt.root;chage -l <replaceable>TEST</replaceable>\n"
      "Minimum: 7\n"
      "Maximum: 60\n"
      "Warning: 7\n"
      "Inactive: 14\n"
      "Last Change: Jan 11, 2015\n"
      "Password Expires: Mar 12, 2015\n"
      "Password Inactive: Mar 26, 2015\n"
      "Account Expires: Never"
msgstr ""

#. Tag: title
#: hardening.xml:3350
#, no-c-format
msgid "Stronger Password Enforcement"
msgstr ""

#. Tag: para
#: hardening.xml:3352
#, no-c-format
msgid "On an audited system it is important to restrict people from using simple passwords that can be cracked too easily. Writing down complex passwords is all right as long as they are stored securely. Some will argue that strong passwords protect you against dictionary attacks and those type of attacks can be defeated by locking accounts after a few failed attempts. However, this is not always an option. If set up like this, locking system accounts could bring down your applications and systems which would be nothing short of a denial of service attack ‚Äì another issue."
msgstr ""

#. Tag: para
#: hardening.xml:3363
#, no-c-format
msgid "At any rate, it is important to practice effective password management safety. Most companies require that passwords have at the very least a number, one lowercase letter, and one uppercase letter. Policies vary, but maintaining a balance between password strength/complexity and management is sometimes difficult."
msgstr ""

#. Tag: title
#: hardening.xml:3373
#, no-c-format
msgid "Preventing Accidental Denial of Service"
msgstr ""

#. Tag: para
#: hardening.xml:3375
#, no-c-format
msgid "Linux allows you to set limits on the amount of system resources that users and groups can consume. This is also very handy if bugs in programs cause them to use up too much resources (for example memory leaks), slow down the machine, or even render the system unusable. Incorrect settings can allow programs to use too many resources which may make the server unresponsive to new connections or even local logins (for example if a program uses up all available file handles on the host). This can also be a security concern if someone is allowed to consume all system resources and therefore cause a denial of service attack ‚Äì either unplanned or worse, planned. Setting resource limits for users and groups may be an effective way to protect systems, depending on the environment."
msgstr ""

#. Tag: title
#: hardening.xml:3390
#, no-c-format
msgid "Example for Restricting System Resources"
msgstr ""

#. Tag: para
#: hardening.xml:3391
#, no-c-format
msgid "The following example demonstrates the practical usage of setting or restricting system resource consumption for an Oracle user account. For a list of system resource settings, see <filename>/etc/security/limits.conf</filename> or <command>man limits.conf</command>."
msgstr ""

#. Tag: para
#: hardening.xml:3398
#, no-c-format
msgid "Most shells like Bash provide control over various resources (for example the maximum allowable number of open file descriptors or the maximum number of processes) that are available on a per/user basis. To examine all current limits in the shell execute:"
msgstr ""

#. Tag: screen
#: hardening.xml:3404
#, no-c-format
msgid "&prompt.root;ulimit -a"
msgstr ""

#. Tag: para
#: hardening.xml:3405
#, no-c-format
msgid "For more information on <command>ulimit</command> for the Bash shell, examine the Bash man pages."
msgstr ""

#. Tag: title
#: hardening.xml:3410
#, no-c-format
msgid "Setting Limits for SSH Sessions"
msgstr ""

#. Tag: para
#: hardening.xml:3411
#, no-c-format
msgid "Setting \"hard\" and \"soft\" limits might not behave as expected when using an SSH session. To see valid behavior it may be necessary to login as root and then su to the id with limits (for example, <literal>oracle</literal> in these examples). Resource limits should also work assuming the application has been started automatically during the boot process. It may be necessary to set <option>UsePrivilegeSeparation</option> in <filename>/etc/ssh/sshd_config</filename> to \"no\" and restart the SSH daemon (<command>systemctl restart sshd</command>) if it seems that the changes to resource limits are not working (via SSH). However this is not generally recommended ‚Äì as it weakens a systems security."
msgstr ""

#. Tag: title
#: hardening.xml:3426
#, no-c-format
msgid "Disabling Password Logins via <command>ssh</command>"
msgstr ""

#. Tag: para
#: hardening.xml:3427
#, no-c-format
msgid "You can add some extra security to your server by disabling password authentication for SSH. Remember that you need to have SSH keys configured, otherwise you cannot access the server. To disable password login, add the following lines to <filename>/etc/ssh/sshd_config</filename>:"
msgstr ""

#. Tag: screen
#: hardening.xml:3434
#, no-c-format
msgid ""
      "UseLogin no\n"
      "UsePAM no\n"
      "PasswordAuthentication no\n"
      "PubkeyAuthentication yes"
msgstr ""

#. Tag: para
#: hardening.xml:3436
#, no-c-format
msgid "In this example, a change to the number of file handles or open files that the user <literal>oracle</literal> can use is made by editing <filename>/etc/security/limits.conf</filename> as &rootuser; making the following changes:"
msgstr ""

#. Tag: screen
#: hardening.xml:3442
#, no-c-format
msgid ""
      "oracle           soft    nofile          4096\n"
      "oracle           hard    nofile          63536"
msgstr ""

#. Tag: para
#: hardening.xml:3443
#, no-c-format
msgid "The soft limit in the first line defines the limit on the number of file handles (open files) that the <systemitem class=\"username\">oracle</systemitem> user will have after login. If the user sees error messages about running out of file handles, then the user can increase the number of file handles like in this example up to the hard limit (in this example 63536) by executing:"
msgstr ""

#. Tag: screen
#: hardening.xml:3451
#, no-c-format
msgid "&prompt.root;ulimit -n 63536"
msgstr ""

#. Tag: para
#: hardening.xml:3452
#, no-c-format
msgid "You can set the soft and hard limits higher if necessary."
msgstr ""

#. Tag: para
#: hardening.xml:3456
#, no-c-format
msgid "It is important to be judicious with the usage of ulimits. Allowing a \"hard\" limit for <quote>nofile</quote> for a user that equals the kernel limit (<filename>/proc/sys/fs/file-max</filename>) is very bad! If the user consumes all the available file handles, the system cannot initiate new logins as accessing (opening) PAM modules which are required for performing a login will not be possible."
msgstr ""

#. Tag: para
#: hardening.xml:3465
#, no-c-format
msgid "You also need to ensure that <literal>pam_limits</literal> is either configured globally in <filename>/etc/pam.d/common-auth</filename>, or for individual services like SSH, su, login, and telnet in:"
msgstr ""

#. Tag: member
#: hardening.xml:3471
#, no-c-format
msgid "<filename>/etc/pam.d/sshd</filename> (for SSH)"
msgstr ""

#. Tag: member
#: hardening.xml:3472
#, no-c-format
msgid "<filename>/etc/pam.d/su</filename> (for su)"
msgstr ""

#. Tag: member
#: hardening.xml:3473
#, no-c-format
msgid "<filename>/etc/pam.d/login</filename> (local logins and telnet)"
msgstr ""

#. Tag: para
#: hardening.xml:3475
#, no-c-format
msgid "If you do not want to enable it for all logins, there is a specific PAM module that will read the <filename>/etc/security/limits.conf</filename> file. Entries in pam configuration directives will have entries like:"
msgstr ""

#. Tag: screen
#: hardening.xml:3480
#, no-c-format
msgid ""
      "session     required      /lib/security/pam_limits.so\n"
      "session     required      /lib/security/pam_unix.so"
msgstr ""

#. Tag: para
#: hardening.xml:3481
#, no-c-format
msgid "It is important to note that changes are not immediate and require a new login session:"
msgstr ""

#. Tag: screen
#: hardening.xml:3485
#, no-c-format
msgid ""
      "&prompt.root;su ‚Äì oracle\n"
      "&prompt.user;ulimit -n\n"
      "4096"
msgstr ""

#. Tag: para
#: hardening.xml:3486
#, no-c-format
msgid "Note that these examples are specific to the Bash shell - <command>ulimit</command> options are different for other shells. The default limit for the user <literal>oracle</literal> is <literal>4096</literal>. To increase the number of file handles the user <literal>oracle</literal> can use to <literal>63536</literal>, do:"
msgstr ""

#. Tag: screen
#: hardening.xml:3493
#, no-c-format
msgid ""
      "&prompt.root;su ‚Äì oracle\n"
      "&prompt.user;ulimit -n\n"
      "4096\n"
      "&prompt.user;ulimit -n 63536\n"
      "&prompt.user;ulimit -n\n"
      "63536"
msgstr ""

#. Tag: para
#: hardening.xml:3494
#, no-c-format
msgid "Making this permanent requires the addition of the setting, <literal>ulimit -n 63536</literal>, (again, for Bash) to the users profile (<filename>~/.bashrc</filename> or <filename>~/.profile</filename> file) which is the user start-up file for the Bash shell on &productname; (to verify your shell run: echo <envar>$SHELL</envar>). To do this you could simply type (or copy/paste ‚Äì if you are reading this on the system) the following commands for the Bash shell of the user <literal>oracle</literal>:"
msgstr ""

#. Tag: screen
#: hardening.xml:3504
#, no-c-format
msgid ""
      "&prompt.root;su - oracle\n"
      "&prompt.user;cat &gt;&gt; ~oracle/.bash_profile &lt;&lt; EOF\n"
      "ulimit -n 63536\n"
      "EOF"
msgstr ""

#. Tag: title
#: hardening.xml:3508
#, no-c-format
msgid "Displaying Login Banners"
msgstr ""

#. Tag: para
#: hardening.xml:3510
#, no-c-format
msgid "It is often necessary to place a banner on login screens on all servers for legal/audit policy reasons or to give security instructions to users."
msgstr ""

#. Tag: para
#: hardening.xml:3516
#, no-c-format
msgid "If you want to print a login banner <emphasis>after</emphasis> a user logs in on a text based terminal for example using SSH or on a local console, you can leverage the file <filename>/etc/motd</filename> (motd = message of the day). The file exists by default on &productname;, but it is empty. Simply add content to the file that is applicable/required by the organization."
msgstr ""

#. Tag: title
#: hardening.xml:3526
#, no-c-format
msgid "Banner Length"
msgstr ""

#. Tag: para
#: hardening.xml:3527
#, no-c-format
msgid "Try to keep the login banner content to a single terminal page (or less), as it will scroll the screen if it does not fit, making it more difficult to read."
msgstr ""

#. Tag: para
#: hardening.xml:3534
#, no-c-format
msgid "You can also have a login banner printed <emphasis>before</emphasis> a user logs in on a text based terminal. For local console logins you can edit the <filename>/etc/issue</filename> file which will cause the banner to the displayed before the login prompt. For logins via SSH you can edit the <quote>Banner</quote> parameter in the <filename>/etc/ssh/sshd_config</filename> file which will then appropriately display the banner text before the SSH login prompt."
msgstr ""

#. Tag: para
#: hardening.xml:3544
#, no-c-format
msgid "For graphical logins via GDM, you can follow <link xlink:href=\"https://help.gnome.org/admin/system-admin-guide/stable/login-banner.html.en\"> the GNOME admin guide</link> to setup a login banner. Furthermore you can make the following changes to require a user to acknowledge the legal banner by selecting <guimenu>Yes</guimenu> or <guimenu>No</guimenu>. Edit the <filename>/etc/gdm/Xsession</filename> file and add the following lines at the <emphasis>beginning</emphasis> of the script:"
msgstr ""

#. Tag: screen
#: hardening.xml:3554
#, no-c-format
msgid ""
      "if ! /usr/bin/gdialog --yesno '\\n<replaceable>This system is classified...</replaceable>\\n' 10 10; then\n"
      "    /usr/bin/gdialog --infobox 'Aborting login'\n"
      "    exit 1;\n"
      "fi"
msgstr ""

#. Tag: para
#: hardening.xml:3556
#, no-c-format
msgid "The text <replaceable>This system is classified...</replaceable> needs to be replaced with the desired banner text. It is important to note that this dialog will not prevent a login from progressing. For more information about GDM scripting, refer to the <link xlink:href=\"https://help.gnome.org/admin/gdm/stable/configuration.html.en#scripting\"> GDM Admin Manual</link>."
msgstr ""

#. Tag: title
#: hardening.xml:3567
#, no-c-format
msgid "Miscellaneous"
msgstr ""

#. Tag: title
#: hardening.xml:3572
#, no-c-format
msgid "Host-Based Linux Monitoring and Intrusion Detection"
msgstr ""

#. Tag: para
#: hardening.xml:3573
#, no-c-format
msgid "Before you place a host into production or even on a network, consider the use of a system integrity checker, like <command>seccheck</command> (already discussed in <xref linkend=\"sec.sec_prot.general.seccheck\"/>), so in case of unauthorized changes, notifications will be issued. Also consider the use of an intrusion detection environment, like AIDE, the Advanced Intrusion Detection Environment."
msgstr ""

#. Tag: para
#: hardening.xml:3581
#, no-c-format
msgid "AIDE is a GPL licensed and open source intrusion detection system. It could be considered a system fingerprinting mechanism. AIDE works by creating a database containing information about the files on your system. The database is created from rules laid out in the configuration file aide.conf. When AIDE is run, this database is referenced to check for changes (or created for the first time). Assuming a comparison check is being run, any changes not permitted by the configuration file are reported."
msgstr ""

#. Tag: para
#: hardening.xml:3591
#, no-c-format
msgid "By leveraging AIDE&mdash;storing a copy of the host's database in a secure location&mdash;and comparing it (on a scheduled basis or as part of a forensic effort), system integrity/insurance can be a matter of heuristics and procedure. If an intruder compromises your system, the comparison effort will enable an administrator or security officer to know what has changed on the host. The initial database should be created as a final step&mdash;<emphasis>before</emphasis> a system gets deployed into production."
msgstr ""

#. Tag: para
#: hardening.xml:3601
#, no-c-format
msgid "It is outside the scope of this article to cover Linux Monitoring and detailed Intrusion Detection systems (IDS) or solutions, however there is a plethora of information about configuring AIDE or other solutions and many informative articles on the Web."
msgstr ""

#. Tag: title
#: hardening.xml:3610
#, no-c-format
msgid "Connect Accounting Utilities"
msgstr ""

#. Tag: para
#: hardening.xml:3611
#, no-c-format
msgid "Here is a list of commands you can use to get data about user logins:"
msgstr ""

#. Tag: command
#: hardening.xml:3615
#, no-c-format
msgid "<command>who</command>"
msgstr ""

#. Tag: para
#: hardening.xml:3616
#, no-c-format
msgid "Lists currently logged in users."
msgstr ""

#. Tag: command
#: hardening.xml:3621
#, no-c-format
msgid "<command>w</command>"
msgstr ""

#. Tag: para
#: hardening.xml:3622
#, no-c-format
msgid "Shows who is logged in and what they are doing."
msgstr ""

#. Tag: command
#: hardening.xml:3627
#, no-c-format
msgid "last"
msgstr ""

#. Tag: para
#: hardening.xml:3628
#, no-c-format
msgid "Shows a list of last logged in users, including login time, logout time, login IP address, etc."
msgstr ""

#. Tag: command
#: hardening.xml:3634
#, no-c-format
msgid "lastb"
msgstr ""

#. Tag: para
#: hardening.xml:3635
#, no-c-format
msgid "Same as <command>last</command>, except that by default it shows <filename>/var/log/btmp</filename>, which contains all the bad login attempts."
msgstr ""

#. Tag: command
#: hardening.xml:3642
#, no-c-format
msgid "lastlog"
msgstr ""

#. Tag: para
#: hardening.xml:3643
#, no-c-format
msgid "This command reports data maintained in <filename>/var/log/lastlog</filename>, which is a record of the last time a user logged in."
msgstr ""

#. Tag: command
#: hardening.xml:3650
#, no-c-format
msgid "<command>ac</command>"
msgstr ""

#. Tag: para
#: hardening.xml:3651
#, no-c-format
msgid "Available after installing the <systemitem>acct</systemitem> package. Prints the connect time in hours on a per-user basis or daily basis, etc. This command reads <filename>/var/log/wtmp</filename>."
msgstr ""

#. Tag: command
#: hardening.xml:3658
#, no-c-format
msgid "dump-utmp"
msgstr ""

#. Tag: para
#: hardening.xml:3659
#, no-c-format
msgid "Converts raw data from /var/run/utmp or <filename>/var/log/wtmp</filename> into ASCII-parseable format."
msgstr ""

#. Tag: para
#: hardening.xml:3664
#, no-c-format
msgid "Also check the <filename>/var/log/messages</filename> file, or the output of <command>journalctl</command> if no logging facility is running. See <xref linkend=\"cha.journalctl\"/> for more information on the &systemd; journal."
msgstr ""

#. Tag: title
#: hardening.xml:3673
#, no-c-format
msgid "Other"
msgstr ""

#. Tag: para
#: hardening.xml:3674
#, no-c-format
msgid "Finally, the following items are relevant to the system security as well, and misconfiguration can cause many problems ‚Äì and should be reviewed:"
msgstr ""

#. Tag: para
#: hardening.xml:3680
#, no-c-format
msgid "Resolver (<filename>/etc/hosts</filename>, <filename>/etc/resolv.conf</filename>, <filename>/etc/nsswitch.conf</filename>)."
msgstr ""

#. Tag: para
#: hardening.xml:3687
#, no-c-format
msgid "NTP configuration (<filename>/etc/chrony.conf</filename>)."
msgstr ""

