# SOME DESCRIPTIVE TITLE.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"Report-Msgid-Bugs-To: https://github.com/belphegor-belbel/doc-opensuse-ja\n"
"POT-Creation-Date: 2020-06-08 22:24+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <someuser@example.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/x-po; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. Tag: title
#: tuning_cgroups.xml:13
#, no-c-format
msgid "Kernel Control Groups"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:16
#, no-c-format
msgid "Kernel Control Groups ( <quote>cgroups</quote> ) are a kernel feature that allows assigning and limiting hardware and system resources for processes. Processes can also be organized in a hierarchical tree structure."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:29
#, no-c-format
msgid "Overview"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:30
#, no-c-format
msgid "Every process is assigned exactly one administrative cgroup. cgroups are ordered in a hierarchical tree structure. You can set resource limitations, such as CPU, memory, disk I/O, or network bandwidth usage,for single processes or for whole branches of the hierarchy tree."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:36
#, no-c-format
msgid "On &productname;, &systemd; uses cgroups to organize all processes in groups, which &systemd; calls slices. &systemd; also provides an interface for setting cgroup properties."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:41
#, no-c-format
msgid "The command <command>systemd-cgls</command> displays the hierarchy tree."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:45
#, no-c-format
msgid "This chapter is an overview. For more details, refer to the listed references."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:52
#, no-c-format
msgid "Setting Resource Limits"
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:54
#, no-c-format
msgid "Implicit Resource Consumption"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:55
#, no-c-format
msgid "Be aware that resource consumption implicitly depends on the environment where your workload executes (e.g. size of data structures in libraries/kernel, forking behavior of utilities, computational efficiency), hence it is recommended to (re)calibrate your limits should the environment change."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:62
#, no-c-format
msgid "Limitations to <literal>cgroups</literal> can be set with the <command>systemctl set-property</command> command. The syntax is:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:66
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property [--runtime] <replaceable>NAME</replaceable> <replaceable>PROPERTY1</replaceable>=<replaceable>VALUE</replaceable> [<replaceable>PROPERTY2</replaceable>=<replaceable>VALUE</replaceable>]</command>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:67
#, no-c-format
msgid "Optionally, use the <option>--runtime</option> option. With this option, set limits do not persist after the next reboot."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:71
#, no-c-format
msgid "Replace <replaceable>NAME</replaceable> with a &systemd; service slice, scope, socket, mount, or swap name. Replace properties with one or more of the following:"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:78
#, no-c-format
msgid "<literal>CPUAccounting=</literal> <option>[yes|no]</option>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:80
#, no-c-format
msgid "Turns on CPU usage accounting. This property takes <literal>yes</literal> and <literal>no</literal> as arguments."
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:87
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property user.slice CPUAccounting=yes</command>"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:91
#, no-c-format
msgid "<literal>CPUQuota=</literal> <replaceable>PERCENTAGE</replaceable>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:93
#, no-c-format
msgid "Assigns a CPU time to processes. The value is a percentage followed by a <literal>%</literal> as suffix. This implies <literal>CPUAccounting=yes</literal> ."
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:101
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property user.slice CPUQuota=50%</command>"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:105
#, no-c-format
msgid "<literal>MemoryAccounting=</literal> <option>[yes|no]</option>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:107
#, no-c-format
msgid "Turns on memory usage accounting. This property takes <literal>yes</literal> and <literal>no</literal> as arguments."
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:114
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property user.slice MemoryAccounting=yes</command>"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:118
#, no-c-format
msgid "<literal>MemoryLow=</literal> <replaceable>BYTES</replaceable>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:120
#, no-c-format
msgid "Unused memory from processes below this limit will not be reclaimed for other use. Use suffixes K, M, G or T for <replaceable>BYTES</replaceable> . This implies <literal>MemoryAccounting=yes</literal> ."
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:129
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property nginx.service MemoryLow=512M</command>"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:144
#, no-c-format
msgid "<literal>MemoryHigh=</literal> <replaceable>BYTES</replaceable>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:146
#, no-c-format
msgid "If more memory above this limit is used, memory is aggressively taken away from the processes. Use suffixes K, M, G or T for <replaceable>BYTES</replaceable> . This implies <literal>MemoryAccounting=yes</literal> ."
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:156
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property nginx.service MemoryHigh=2G</command>"
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:158
#, no-c-format
msgid "Unified Control Group Hierarchy"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:159
#, no-c-format
msgid "This setting is available only if the unified control group hierarchy is used, and disables <option>MemoryLimit=</option> . To enable the unified control group hierarchy, append <option>systemd.unified_cgroup_hierarchy=1</option> as a kernel command line parameter to the &grub; boot loader. Refer to <xref linkend=\"cha-grub2\"/> for more details about configuring &grub;."
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:171
#, no-c-format
msgid "<literal>MemoryMax=</literal> <replaceable>BYTES</replaceable>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:173
#, no-c-format
msgid "Sets a maximum limit for used memory. Processes will be killed if they use more memory than allowed. Use suffixes K, M, G or T for <replaceable>BYTES</replaceable> . This implies <literal>MemoryAccounting=yes</literal> ."
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:182
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property nginx.service MemoryMax=4G</command>"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:186
#, no-c-format
msgid "<literal>DeviceAllow=</literal>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:188
#, no-c-format
msgid "Allows read ( <literal>r</literal> ), write ( <literal>w</literal> ) and mknod ( <literal>m</literal> ) access. The command takes a device node specifier and a list of <literal>r</literal> , <literal>w</literal> or <literal>m</literal> , separated by a white space."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:194
#, no-c-format
msgid "Example:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:197
#, no-c-format
msgid "&prompt.root;<command>systemctl set-property system.slice DeviceAllow=\"/dev/sdb1 r\"</command>"
msgstr ""

#. Tag: term
#: tuning_cgroups.xml:201
#, no-c-format
msgid "<literal>DevicePolicy=</literal> <option>[auto|closed|strict]</option>"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:203
#, no-c-format
msgid "When set to <literal>strict</literal> , only access to devices that are listed in <literal>DeviceAllow</literal> is allowed. <literal>closed</literal> additionally allows access to standard pseudo devices including <filename>/dev/null</filename> , <filename>/dev/zero</filename> , <filename>/dev/full</filename> , <filename>/dev/random</filename> , and <filename>/dev/urandom</filename> . <literal>auto</literal> allows access to all devices if no specific rule is defined in <literal>DeviceAllow</literal> . <literal>auto</literal> is the default setting."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:218
#, no-c-format
msgid "For more details and a complete list of properties, see <command>man systemd.resource-control</command> ."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:225
#, no-c-format
msgid "Preventing Fork Bombs with TasksMax"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:226
#, no-c-format
msgid "&systemd; 228 shipped with a <literal>DefaultTasksMax</literal> limit of 512. This limited the number of processes any system unit can create at one time to 512. Previous versions had no default limit. The goal was to improve security by preventing runaway processes from creating excessive forks, or spawning enough threads to exhaust system resources."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:234
#, no-c-format
msgid "However, it soon became apparent that there is not a single default that applies to all use cases. 512 is not low enough to prevent a runaway process from crashing a system, especially when other resources such as CPU and RAM are not restricted, and not high enough for processes that create a lot of threads, such as databases. In &systemd; 234 the default was changed to 15%, which is 4915 tasks (15% of the kernel limit of 32768; see <command>cat /proc/sys/kernel/pid_max</command> ). This default is compiled, and can be changed in configuration files. The compiled defaults are documented in <filename>/etc/systemd/system.conf</filename> . You can edit this file to override the defaults, though there are other methods we will show in the following sections."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:251
#, no-c-format
msgid "Finding the Current Default TasksMax Values"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:252
#, no-c-format
msgid "&sle; ships with two custom configurations that override the upstream defaults for system units and for user slices, and sets them both to <literal>infinity</literal> . <filename>/usr/lib/systemd/system.conf.d/20-suse-defaults.conf</filename> contains these lines:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:259
#, no-c-format
msgid "\n"
      "[Manager]\n"
      "DefaultTasksMax=infinity\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:263
#, no-c-format
msgid "<filename>/usr/lib/systemd/system/user-.slice.d/20-suse-defaults.conf</filename> contains these lines:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:267
#, no-c-format
msgid "[Slice]\n"
      "TasksMax=infinity\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:270
#, no-c-format
msgid "<literal>infinity</literal> means having no limit. It is not a requirement to change the default, but setting some limits may help to prevent system crashes from runaway processes."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:278
#, no-c-format
msgid "Overriding the DefaultTasksMax Value"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:279
#, no-c-format
msgid "Change the global <literal>DefaultTasksMax</literal> value by creating a new override file, <filename>/etc/systemd/system.conf.d/10-system-tasksmax.conf</filename> , and write the following lines to set new default limit of 256 tasks per system unit:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:286
#, no-c-format
msgid "\n"
      "[Manager]\n"
      "DefaultTasksMax=256\n"
      ""
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:290
#, no-c-format
msgid "Load the new setting, then verify that it changed:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:293
#, no-c-format
msgid "&prompt.sudo;systemctl daemon-reload\n"
      "&prompt.user;systemctl show --property DefaultTasksMax\n"
      "DefaultTasksMax=256\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:297
#, no-c-format
msgid "Adjust this default value to suit your needs. You can set higher limits on individual services as needed. This example is for MariaDB. First check the current active value:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:302
#, no-c-format
msgid "\n"
      "&prompt.user;systemctl status mariadb.service\n"
      "  ● mariadb.service - MariaDB database server\n"
      "   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; disabled; vendor preset&gt;\n"
      "   Active: active (running) since Tue 2020-05-26 14:15:03 PDT; 27min ago\n"
      "     Docs: man:mysqld(8)\n"
      "           https://mariadb.com/kb/en/library/systemd/\n"
      " Main PID: 11845 (mysqld)\n"
      "   Status: \"Taking your SQL requests now...\"\n"
      "    Tasks: 30 (limit: 256)\n"
      "   CGroup: /system.slice/mariadb.service\n"
      "           └─11845 /usr/sbin/mysqld --defaults-file=/etc/my.cnf --user=mysql\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:315
#, no-c-format
msgid "The Tasks line shows that MariaDB currently has 30 tasks running, and has an upper limit of the default 256, which is inadequate for a database. The following example demonstrates how to raise MariaDB's limit to 8192. Create a new override file with <command>systemctl edit</command> , and enter the new value:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:320
#, no-c-format
msgid "&prompt.sudo;systemctl edit mariadb.service\n"
      "       \n"
      "[Service]\n"
      "TasksMax=8192\n"
      "\n"
      "&prompt.user;systemctl status mariadb.service \n"
      "● mariadb.service - MariaDB database server\n"
      "   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; disabled; vendor preset: disab&gt;\n"
      "  Drop-In: /etc/systemd/system/mariadb.service.d\n"
      "           └─override.conf\n"
      "   Active: active (running) since Tue 2020-06-02 17:57:48 PDT; 7min ago\n"
      "     Docs: man:mysqld(8)\n"
      "           https://mariadb.com/kb/en/library/systemd/\n"
      "  Process: 3446 ExecStartPre=/usr/lib/mysql/mysql-systemd-helper upgrade (code=exited, sta&gt;\n"
      "  Process: 3440 ExecStartPre=/usr/lib/mysql/mysql-systemd-helper install (code=exited, sta&gt;\n"
      " Main PID: 3452 (mysqld)\n"
      "   Status: \"Taking your SQL requests now...\"\n"
      "    Tasks: 30 (limit: 8192)\n"
      "   CGroup: /system.slice/mariadb.service\n"
      "           └─3452 /usr/sbin/mysqld --defaults-file=/etc/my.cnf --user=mysql\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:341
#, no-c-format
msgid "<command>systemctl edit</command> creates an override file, <filename>/etc/systemd/system/mariadb.service.d/override.conf</filename> , that contains only the changes you want to apply to the existing unit file. The value does not have to be 8192, but should be whatever limit is appropriate for your workloads."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:351
#, no-c-format
msgid "Deafult TasksMax Limit on Users"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:352
#, no-c-format
msgid "The default limit on users should be fairly high, because user sessions need more resources. Set your own default for users by creating a new file, for example <filename>/etc/systemd/system/user-.slice.d/user-taskmask.conf</filename> . The following example sets a default of 16284:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:359
#, no-c-format
msgid "\n"
      "[Slice]\n"
      "TasksMax=16284\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:363
#, no-c-format
msgid "Then reload systemd to load the new value, and verify the change:"
msgstr ""

#. Tag: screen
#: tuning_cgroups.xml:366
#, no-c-format
msgid "&prompt.sudo;systemctl daemon-reload\n"
      "       \n"
      "&prompt.user;systemctl show --property TasksMax user-.slice\n"
      "TasksMax=16284\n"
      "\n"
      "&prompt.user;systemctl show --property TasksMax user-1000.slice\n"
      "TasksMax=16284\n"
      "   "
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:374
#, no-c-format
msgid "How do you know what values to use? This varies according to your workloads, system resources, and other resource configurations. When your TasksMax value is too low, you will see error messages like \"Failed to fork (Resources temporarily unavailable)\", \"Can't create thread to handle new connection\" and \"Error: Function call 'fork' failed with error code 11, 'Resource temporarily unavailable'\"."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:382
#, no-c-format
msgid "For more information on configuring system resources in systemd, see <literal>systemd.resource-control (5)</literal> ."
msgstr ""

#. Tag: title
#: tuning_cgroups.xml:390
#, no-c-format
msgid "For More Information"
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:394
#, no-c-format
msgid "Kernel documentation (package <systemitem>kernel-source</systemitem> ): files in <filename>/usr/src/linux/Documentation/cgroups</filename> ."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:400
#, no-c-format
msgid "<link xlink:href=\"http://lwn.net/Articles/604609/\"/> &mdash;Brown, Neil: Control Groups Series (2014, 7 parts)."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:406
#, no-c-format
msgid "<link xlink:href=\"http://lwn.net/Articles/243795/\"/> &mdash;Corbet, Jonathan: Controlling memory use in containers (2007)."
msgstr ""

#. Tag: para
#: tuning_cgroups.xml:412
#, no-c-format
msgid "<link xlink:href=\"http://lwn.net/Articles/236038/\"/> &mdash;Corbet, Jonathan: Process containers (2007)."
msgstr ""

