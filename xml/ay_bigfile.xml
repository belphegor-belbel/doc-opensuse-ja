<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook50-profile.xsl"
 type="text/xml"
 title="Profiling step"?>
<!DOCTYPE book [
<!ENTITY % entities SYSTEM "entity-decl.ent">
%entities;
]>
<book xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:lang="ja" xml:id="book.autoyast">
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker>
    <dm:assignee>belphegor@belbel.or.jp</dm:assignee>
   </dm:bugtracker>
  </dm:docmanager>
  <title>&ayguide;</title>
  <productname>&productname;</productname>
  <productnumber>&productnumber;</productnumber>
  <date><?dbtimestamp format="Y/m/d" ?></date>
  <xi:include href="common_copyright_gfdl.xml"/>
  <abstract>
   <para>&abstract_autoyast;</para>
  </abstract>
 </info>
 <chapter xml:id="introduction">
  <title>紹介</title>
  <info/>
  <para>&ay; は &productname; システムを無人で一括配置するためのシステムです。 &ay; の無人インストールは、インストールデータや設定データを含む制御ファイル (<quote>プロファイル</quote> と呼ぶ場合もあります) で制御します。制御ファイルは &ay; の設定インターフェイスを利用して作成し、様々な方法で &yast; の起動時にそれを指定して &ay; を起動します。</para>
  <sect1 xml:id="motiv">
   <title>&ay; の存在理由</title>

   <para>&productname; の標準的なインストール方式はウイザード形式になっています。これは一般的なユーザにとっては分かりやすいもので、少数のマシンにインストールするだけであれば、十分に効率的な仕組みです。ところが、多数のマシンにインストールを行なう場合、このようなウイザード形式は手間になってしまうばかりか、時間のかかるものになってしまいます。</para>
   <para>このような問題を避けるには、特定のマシンにインストールしたものをハードディスクごと複製して配置する方法もあります。ただし、このような仕組みで大量配置を行なう場合、配置後のさまざまな個別設定が面倒になってしまいます。たとえばそれぞれのマシンが固定の IP アドレスでなければならないような場合、配置後にそれぞれの IP アドレスを設定する手間が生じることになってしまいます。</para>

   <para>&productname; の通常のインストールであっても、半自動化が実現できています。インストールの冒頭で必要な情報 (通常は言語) を選択したあと、 &yast; はさまざまな要素とシステムのパラメータを考慮して提案を作成しますので、そのまま進めていくだけでインストールが完了します。提案内容を受け入れたあとは、残りの作業は自動的に実施されます。</para>

   <para>&ay; はユーザ側での操作を一切不要にしたい場合や、カスタマイズが必要な場合に有用です。 &ay; の制御ファイルを使用することで、 &yast; は独自の方式でインストールを行ない、制御ファイル内に敢えて記述されている場合を除き、ユーザに一切尋ねることなく処理を進めることができます。</para>

   <para>&ay; は GUI システムの自動化ではありません。そのため、通常は表示される多くの画面 (たとえば言語選択の画面など) が表示されないまま処理が行なわれます。 &ay; では言語関連のユーザインターフェイスを表示することなく、サブシステムに言語パラメータを渡して処理を進めます。</para>
  </sect1>
  <sect1 xml:id="overviewandconcept">
   <title>概要と考え方</title>

   <para>&ay; を使用することで、多数のシステムを同時並行で素早くインストールすることができるようになります。これらは同じ環境を共有する必要がありますが、ハードウエアについては全く同一でなくてもかまいません。インストール処理は XML 形式の設定ファイル (通常は <filename>autoinst.xml</filename> というファイル名です) 、<quote>&ay; 制御ファイル</quote> で制御します。制御ファイルは既存の設定リソースから作成しておいて、後から必要に応じて調整することができます。</para>

   <para>&ay; はシステムに完全に統合されているほか、インストールや設定に対してさまざまなオプションを提供しています。その他の自動インストールシステムと比較しても、既存のモジュールを利用してコンピュータを設定することができたり、通常はインストールの終了時に実行するスクリプトなどを設定できる点が利点となっています。</para>

   <para>本文書では、自動インストールに関わる 3 種類のステップを説明しています:</para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>準備: インストール先のシステムに関する全ての情報を収集し、制御ファイル内の対応するディレクティブに変換します。制御ファイルはインストール先のシステムに転送され、ディレクティブを処理したあと &yast; に渡されます。</para>
    </listitem>
    <listitem>
     <para>インストール: &yast; は &ay; 制御ファイルに書かれたデータをもとにして、基本的なシステムのインストールを実施します。</para>
    </listitem>
    <listitem>
     <para>設定: 基本的なシステムのインストールが完了したら、インストールの第 2 ステージでシステムの設定を行ないます。このステージでは、 &ay; の制御ファイル内に書かれたインストール後スクリプトも実行されます。</para>
    </listitem>
   </itemizedlist>

   <note>
    <title>第 2 ステージについて</title>
    <para>&productname; &productnumber; の通常のインストールは、単一のステージで実施されます。自動インストールの場合にのみ、 2 つのステージに分割して実行されます。基本的なシステムのインストールが終わったあと、システムは第 2 ステージとしてインストール後のシステムを起動します。</para>
    <para>第 2 ステージで自動インストールを正しく動作させるには、インストール先のシステムに <literal>autoyast2</literal> と <literal>autoyast2-installation</literal> のパッケージをインストールしておく必要があります。これらをインストールしておかないと、インストール済みのシステムを起動する際にエラーメッセージが表示されます。</para>
    <para>なお、第 2 ステージを無効化したい場合は、 <literal>second_stage</literal> パラメータを設定してください:</para>
<screen>&lt;general&gt;
  &lt;mode&gt;
    &lt;confirm config:type="boolean"&gt;false&lt;/confirm&gt;
    &lt;second_stage config:type="boolean"&gt;false&lt;/second_stage&gt;
  &lt;/mode&gt;
&lt;/general&gt;</screen>
   </note>

   <para>処理の流れは下記の図のようになっています:</para>

   <figure xml:id="process">
    <title>自動インストール処理</title>
    <mediaobject>
     <imageobject role="html">
      <imagedata fileref="autoyast-oview.png"/>
     </imageobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast-oview.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect1>
 </chapter>
 <chapter xml:id="Profile">
  <title>制御ファイル</title>
  <info/>
  <para/>
  <sect1 xml:id="Profile.Intro">
   <title>紹介</title>

   <para>制御ファイルは通常、単一のシステムに対する設定を記述します。リストやレコード、ツリーや巨大組み込み形式や参照オブジェクトなど、複雑な構造に対応したプロパティリソースから構成されています。</para>

   <important>
    <title>&slea; 11 リリース以降の制御ファイルの非互換性について</title>
    <para>&productname; 12 では多数の大規模変更 (systemd への切り替えや &grub; など) が加えられています。これらの変更に伴い、 &ay; も大きく変更が加えられていますので、 &productname; 11 で作成された &ay; の制御ファイルは &productname; &productnumber; で使用することができません。逆に &productname; &productnumber; 向けの制御ファイルを &productname; 11 で使用することもできません。</para>
   </important>
  </sect1>
  <sect1 xml:id="Profile.Format">
   <title>書式</title>

   <para>設定ファイルの形式に XML を採用していることにより、ファイル構造の一貫性が保たれているほか、新しいシステムを設定しようとする場合でも、学びやすく覚えやすい仕組みになっています。</para>

   <para>&ay; の制御ファイルでは、 XML を利用してシステムのインストールや設定を表現します。 XML は汎用目的のマークアップ言語で、多くのユーザが慣れ親しんでいる構造であるほか、 XML ファイルを処理するためのツールも多数用意されています。既存の制御ファイルを編集する場合でも、何もない状態から制御ファイルを作成する場合でも、制御ファイルの構造が正しいことを検証しておくことを強くお勧めします。これは <literal>xmllint</literal> や <literal>jing</literal> のような検証型 XML パーサーを使用することで行なうことができます (たとえば <xref linkend="CreateProfile.Manual"/> をご覧ください) 。</para>

   <para>下記は XML 形式での制御ファイルの例です:</para>

   <example>
    <title>&ay; の制御ファイル (プロファイル)</title>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile
  xmlns="http://www.suse.com/1.0/yast2ns"
  xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;partitioning config:type="list"&gt;
    &lt;drive&gt;
      &lt;device&gt;/dev/sda&lt;/device&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;btrfs&lt;/filesystem&gt;
          &lt;size&gt;10G&lt;/size&gt;
          &lt;mount&gt;/&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
          &lt;size&gt;120G&lt;/size&gt;
          &lt;mount&gt;/data&lt;/mount&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
    &lt;/drive&gt;
  &lt;/partitioning&gt;
  &lt;scripts&gt;
    &lt;pre-scripts&gt;
      &lt;script&gt;
        &lt;interpreter&gt;shell&lt;/interpreter&gt;
        &lt;filename&gt;start.sh&lt;/filename&gt;
        &lt;source&gt;
        &lt;![CDATA[
#!/bin/sh
echo "Starting installation"
exit 0

]]&gt;

        &lt;/source&gt;
      &lt;/script&gt;
    &lt;/pre-scripts&gt;
  &lt;/scripts&gt;
&lt;/profile&gt;</screen>
   </example>
  </sect1>
  <sect1 xml:id="Profile.Structure">
   <title>構造</title>

   <para>下記は制御ファイルのコンテナで、この中に実際の設定を書き込んでいくものです。</para>

   <example>
    <title>制御ファイルのコンテナ</title>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile
  xmlns="http://www.suse.com/1.0/yast2ns"
  xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;!-- リソース --&gt;
&lt;/profile&gt;</screen>
   </example>

   <para><literal>&lt;profile&gt;</literal> の要素 (ルートノード) には、 1 つもしくは複数のリソース要素を追加します。指定可能なリソース要素は、スキーマファイル内で指定されています。</para>

   <sect2 xml:id="Profile.Format.ressources">
    <title>リソースとプロパティ</title>
    <para>リソース要素には複数の重複しないプロパティ要素や子リソース要素を含めることができるほか、同じ子リソース要素を複数インスタンスとして追加することもできます。もちろん何も含めない指定も行なうことができます。リソース要素内に含めることのできる要素は、スキーマファイル内で指定されています。</para>
    <para>プロパティ要素には値としてリテラルを指定することができます。もちろん値を指定しなくてもかまいません。それぞれのリソース要素内で指定可能なプロパティ要素とその値についても、スキーマファイル内で指定がされています。</para>
    <para>要素は他の要素に対するコンテナとする (リソース) ことができるほか、値としてリテラルを持つ (プロパティ) こともできますが、両方を同時に使用することはできません。この制限についても、スキーマファイル内に記述されています。 1 つ以上の値を持つ設定のコンポーネントは、プロパティ値内で組み込みのリストとして表現するか、入れ子型のリソースとして表現します。</para>
    <para><literal>&lt;foo&gt;&lt;/foo&gt;</literal> や <literal>&lt;bar/&gt;</literal> のような空要素は、処理済みのデータモデル内に存在すべきでは <emphasis>ありません</emphasis> 。通常、これらには適切な既定値を設定すべきです。意図的に空要素を指定したい場合は、 CDATA セクションを使用して <literal>&lt;foo&gt;&lt;![CDATA[]]&gt;&lt;/foo&gt;</literal> のように指定し、空文字列を設定してください。</para>
   </sect2>

   <sect2 xml:id="Profile.Format.ressources_nested">
    <title>入れ子になったリソース設定</title>
    <para>入れ子になったリソース要素を使用することで、任意の階層構造からなるツリー状の設定コンポーネントを作成することができます。</para>
    <para>入れ子になったリソースとしては、マップとリストの 2 種類が存在します。マップ (連想配列やハッシュ、辞書と呼ばれることもあります) にはタグ名とそれに対応する値の対を含めることができます。リスト (配列と呼ばれることもあります) には、単純に値の羅列を含めることができます。</para>
    <example>
     <title>入れ子になったリソース設定</title>
<screen>...
&lt;drive&gt;
  &lt;device&gt;/dev/sda&lt;/device&gt;
  &lt;partitions config:type="list"&gt;
     &lt;partition&gt;
        &lt;size&gt;10G&lt;/size&gt;
        &lt;mount&gt;/&lt;/mount&gt;
     &lt;/partition&gt;
     &lt;partition&gt;
        &lt;size&gt;1G&lt;/size&gt;
        &lt;mount&gt;/tmp&lt;/mount&gt;
     &lt;/partition&gt;
  &lt;/partitions&gt;
&lt;/drive&gt;
....</screen>
    </example>
    <para>上記の例では、 <literal>drive</literal> リソースは <literal>device</literal> プロパティと <literal>partitions</literal> リソースから構成されるマップの形態になっています。 <literal>partitions</literal> リソースは複数の <literal>partition</literal> から構成されるリストで、その <literal>partition</literal> リソースは <literal>size</literal> と <literal>mount</literal> のプロパティを含むマップの形態になっています。</para>
    <para>入れ子になったリソースの場合、既定ではマップとして処理されます。リストを使用したい場合は、 <literal>config:type="list"</literal> の属性を明示的に指定しなければなりません。</para>
   </sect2>

   <sect2 xml:id="Profile.Format.attributes">
    <title>属性</title>
    <para>グローバル属性は、リソースやプロパティ内のメタデータを定義する際に使用します。属性はコンテキストの切り替えを定義するために使用します。これらは上記の章に示されているプロパティの名前付けや型指定で使用されます。属性については独自のネームスペース内に存在していることから、既定のネームスペース内で予約語として扱う必要はありません。</para>
    <para><literal>config:type</literal> 属性は処理済みのデータモデル内で、リソースやプロパティの型を設定するためのものです。リソースの場合、リスト型を指定したい場合は <literal>list</literal> を設定する必要がありますが、マップ型の場合は既定の型であるため、属性の設定は不要となります。プロパティの場合、 <literal>boolean</literal> , <literal>symbol</literal> , <literal>integer</literal> の各型を指定することができます。こちらの場合は既定値は <literal>string</literal> となります。</para>
    <para>属性は基本的に任意指定ではありません。ただし、スキーマ内のさまざまな場所でさまざまな指定がされていて一貫性が無いことから、中には任意指定の属性も存在します。また、場所によっては、値を列挙するのにシンボルで表わす場合があるほか、文字列を必要とするような場合も存在します。また一方のリソースでは <literal>config:type="integer"</literal> の指定が必要となるのに対して、他方では文字列属性で数値を処理する箇所もあります。またリソースによっては <literal>config:type="boolean"</literal> を使用するのに対して、他のリソースでは <literal>yes</literal> や <literal>1</literal> などを使用することもあります。詳しくはスキーマファイルをご覧ください。</para>
   </sect2>
  </sect1>
 </chapter>
 <chapter xml:id="CreateProfile">
  <title>制御ファイルの作成</title>
  <info/>
  <para/>
  <sect1 xml:id="Autoinstallation.collectInfo">
   <title>情報の収集</title>

   <para>制御ファイルを作成するには、まずインストールしたいシステムに関して情報の収集を行なう必要があります。この情報収集にはハードウエアデータやネットワーク情報などが含まれます。まずはインストール予定のマシンに対して、下記のような情報を収集してください:</para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>ハードディスクの種類とサイズ</para>
    </listitem>
    <listitem>
     <para>グラフィカルなインターフェイスと接続されているモニタ (もしあれば)</para>
    </listitem>
    <listitem>
     <para>既知であればネットワークインターフェイスと MAC アドレスの情報 (特に DHCP を使用するような場合)</para>
    </listitem>
   </itemizedlist>
  </sect1>
  <sect1 xml:id="CreateProfile.CMS">
   <title>設定管理システム (Configuration Management System; CMS) の使用</title>

   <para>1 台もしくは複数台のコンピュータに対して制御ファイルを作成する目的で、 &yast; をベースにした設定インターフェイスが提供されています。このシステムは、 &productname; を通常の手順でインストールしたり設定したりする際に使用する、既存のモジュールをベースにして作られています。</para>

   <para>設定管理システムを使用することで、制御ファイルを簡単に作成することができるほか、複数のクライアントからアクセスすることができるようにするため、ネットワーク環境内で設定のリポジトリを管理したりすることもできます。</para>

   <figure os="sles;sled">
    <title>設定システム</title>
    <mediaobject>
     <imageobject role="html">
      <imagedata fileref="autoyast2-maindialog.png"/>
     </imageobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast2-maindialog.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>

   <figure os="osuse">
    <title>設定システム</title>
    <mediaobject>
     <imageobject role="html">
      <imagedata fileref="autoyast2-maindialog_kde.png"/>
     </imageobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast2-maindialog_kde.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>

   <sect2 xml:id="CreateProfile.CMS.new">
    <title>新しい制御ファイルの作成</title>
    <para>いくつかの例外を除いて、ほぼ全ての制御ファイルのリソースは、設定管理システムを利用することで設定することができます。システムは柔軟に作られていて、設定を作成する際の手順も、通常の &yast; コントロールセンターと同じユーザインターフェイスになっています。既存のものと同じユーザインターフェイスであるだけでなく、パーティション設定や汎用オプション、ソフトウエアなど、特殊で複雑な設定を作成するための新しいインターフェイスも提供されています。</para>
    <para>これに加えて、 CMS では生成された制御ファイルの正当性を確認する仕組みも備えていますので、生成された制御ファイルをそのまま自動インストールに使用することができます。</para>
    <para>まずは設定管理システム (<systemitem class="resource">autoyast2</systemitem> パッケージ) がインストールされていることを確認し、 &yast; コントロールセンターから起動を行なうか、もしくは root で下記のコマンドを実行します (なお、グラフィカルな表示を行ないたい場合は、 <envar>DISPLAY</envar> 環境変数を正しく設定していることを確認してから実行してください):</para>
<screen>/sbin/yast2 autoyast</screen>
   </sect2>
  </sect1>
  <sect1 xml:id="CreateProfile.Manual">
   <title>手作業による制御ファイルの作成および編集</title>

   <para>制御ファイルを手作業で編集する場合は、まず書式が正しいことを確認する必要があります。書式を確認するには、お使いのディストリビューションに既に用意されているツールをお使いください。たとえばファイルの書式が正しいこと (XML の構造に間違いがないこと) を確認したい場合は、 <systemitem>libxml2</systemitem> パッケージ内に含まれる <command>xmllint</command> ユーティリティを使用します:</para>

<screen>xmllint &lt;制御ファイル&gt;</screen>

   <para>制御ファイルの書式に問題が見つかると (たとえばタグが正しく閉じられていないなど) 、 <command>xmllint</command> はエラーを報告します。</para>


   <para>制御ファイルの内容を確認したい場合は、同じパッケージ内に含まれる <command>jing</command> ツールをお使いください。確認の際、タグの配置の誤りのほか、必須のタグや属性の確認や属性値の確認も行なわれます。 <phrase os="sles">なお、 <package>jing</package> パッケージは &sdk; 内に含まれています。</phrase></para>

<screen>jing /usr/share/YaST2/schema/autoyast/rng/profile.rng &lt;制御ファイル&gt;</screen>

   <para><literal>/usr/share/YaST2/schema/autoyast/rng/profile.rng</literal> ファイルは <literal>yast2-schema</literal> パッケージ内に含まれています。このファイルには、 &ay; プロファイルの書式とクラスに関する情報が書かれています。</para>


   <para>自動インストールを行なう前に、これらのチェックで表示されたエラーを全て修正してください。制御ファイルの書式や形式が正しくない場合、自動インストールの処理を開始することはできません。</para>

   <para>制御ファイルの編集にあたっては、任意の XML エディタのほか、 XML に対応した任意のテキストエディタ (例: Emacs, Vim) を使用することができます。ただし、多数のマシンに対して制御ファイルを作成する場合は最適な選択であるとは言えないため、自動インストールエンジンと設定管理システム (CMS) の中間で使用することをお勧めします。</para>

   <tip>
    <title>XML エディタとしての emacs の使用について</title>
    <para>Emacs に内蔵された nxml-mode を使用すると、タグの補完機能や検証機能も存在する、完全機能の XML エディタとして使用することができます。 nxml-mode の設定方法について、詳しくは Emacs のヘルプをお読みください。</para>
   </tip>
  </sect1>
  <sect1 xml:id="CreateProfile.XSLT">
   <title>XSLT を利用したスクリプト経由での制御ファイルの作成</title>

   <para>雛形となる制御ファイルが既に存在していて、その中の一部をスクリプトやコマンドラインで修正したい場合は、 <literal>xsltproc</literal> のような XSLT プロセッサを使用することをお勧めします。たとえば &ay; の制御ファイル内のホスト名を、スクリプトを介して修正したいような場合がそれにあたります (ホスト名を設定するような場合は、それをスクリプト化することをお勧めします) 。</para>

   <para>まずは XSL ファイルを作成します:</para>

   <example>
    <title>スクリプトでホスト名やドメイン名を置き換える場合の例</title>
<screen>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:y2="http://www.suse.com/1.0/yast2ns"
  xmlns:config="http://www.suse.com/1.0/configns"
  xmlns="http://www.suse.com/1.0/yast2ns"
  version="1.0"&gt;
  &lt;xsl:output method="xml" encoding="UTF-8" indent="yes" omit-xml-declaration="no" cdata-section-elements="source"/&gt;

  &lt;!-- パラメータ名 --&gt;
  &lt;xsl:param name="hostname"/&gt;
  &lt;xsl:param name="domain"/&gt;

  &lt;xsl:template match="/"&gt;
    &lt;xsl:apply-templates select="@*|node()"/&gt;
  &lt;/xsl:template&gt;

  &lt;xsl:template match="y2:dns"&gt;
    &lt;xsl:copy&gt;
      &lt;!-- where to copy the parameters --&gt;
      &lt;domain&gt;&lt;xsl:value-of select="string($domain)"/&gt;&lt;/domain&gt;
      &lt;hostname&gt;&lt;xsl:value-of select="string($hostname)"/&gt;&lt;/hostname&gt;
      &lt;xsl:apply-templates select="@*|node()"/&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;


  &lt;xsl:template match="@*|node()" &gt;
    &lt;xsl:copy&gt;
      &lt;xsl:apply-templates select="@*|node()"/&gt;
    &lt;/xsl:copy&gt;
  &lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;
</screen>
   </example>

   <para>このファイルでは、ホスト名とドメイン名をパラメータとして求めるようになっています。</para>

<screen>&lt;xsl:param name="hostname"/&gt;
&lt;xsl:param name="domain"/&gt;</screen>

   <para>これらの情報は、同じ制御ファイル内の DNS セクション内に書かれています。ただし、 DNS セクションには複数のドメイン要素を記述することがありますので、このまま使用してしまうと、最後の要素を取得してしまうことになり、期待通りの動作にならないことがあります。</para>

   <remark>mdejmek: why is this no good? please explain</remark>

<!-- FIXME: rewrite these sections using xsltproc
   <para>
    To create a new &ay; control file now from the template plus
    the XSL file, run the following command:
   </para>

<screen>sabcmd add_hostname.xsl \$hostname=myHost \$domain=my.domain  template.xml</screen>

   <para>
    You will then get a filled out &ay; control file on STDOUT.
   </para>

   <para>
    If you have multiple XSL files you want to apply to a template, do the
    following:
   </para>

<screen>sabcmd add_hd_vg.xsl \$device=/dev/sda \$partition=p2 \$vg=system \
        | sabcmd add_harddisk.xsl \$device=/dev/system \$lvm=true \
        | sabcmd ....
        | sabcmd add_hostname.xsl \$hostname=myHost \$domain=my.domain</screen>

   <para>
    Pipe the output of each sabcmd to the next sabcmd.
   </para>
-->

   <para>XSLT に関する詳細については、公式 Web ページ <link xlink:href="http://www.w3.org/TR/xslt">www.w3.org/TR/xslt</link> (英語) をお読みください。</para>
  </sect1>
 </chapter>
 <chapter xml:id="configuration">
<!--
    <section id="Configuration.Network.NISplus">
    <title>
    NIS+
  </title>
    <para>
    If you activate NIS+, the data of the
    NIS+ Server will be added to <filename>/etc/hosts</filename>. Keyserv and the NIS+ cache manager
    will be started and the NSS and PAM configuration will be modified to use
    NIS+ and set the Secret Key of a user.
  </para>
    &example.nisplus;
  </section>
    -->
<!-- {{{ Kdump -->
  <title>設定およびインストールのオプション</title>
  <info/>
  <para>本章では、一般的な用途で使用する制御ファイル内の主要なパーツについて説明しています。その他の利用可能なオプションについて知るには、設定管理システム (CMS) をお使いください。</para>
  <para>なお、オプションによっては追加のパッケージをインストールしなければならないものもあります。お使いのシステムをインストールする際、最小限のパッケージ選択を行なっていると、必要なパッケージがインストールされていない場合がありますので、この場合は個別にパッケージを選択してインストールしてください。</para>
  <para>&yast; では、 &ay; のインストール後フェーズの開始前に、インストールの第 2 フェーズで必要なパッケージをインストールします。しかしながら、システム側で必要な &yast; モジュールがインストールされていないと、主要な設定ステップが飛ばされてしまいます。たとえば <systemitem class="resource">yast2-security</systemitem> パッケージがインストールされていない場合、セキュリティ関連の設定は行なわれません。</para>
<sect1 xml:id="CreateProfile.General">
 <title>一般オプション</title>
  <para><literal>general</literal> セクションには、インストールの処理手順全体に影響する全ての設定が書かれています。このセクションの全体像は下記のとおりです:</para>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns"
 xmlns:config="http://www.suse.com/1.0/configns"&gt;
 &lt;general&gt;
  &lt;ask-list&gt;<co xml:id="co.ay.general.ask"/>
   ...
  &lt;/ask-list&gt;
  &lt;cio_ignore&gt;<co xml:id="co.ay.general.cio_ignore" arch="zseries"/>
   ...
  &lt;/cio_ignore&gt;
  &lt;mode&gt;<co xml:id="co.ay.general.mode"/>
   ...
  &lt;/mode&gt;
  &lt;proposals&gt;<co xml:id="co.ay.general.proposal"/>
   ...
  &lt;/proposals&gt;
  &lt;self_update&gt;<co xml:id="co.ay.general.self_update"/>
   ...
  &lt;/self_update&gt;
  &lt;self_update_url&gt;
   ...
  &lt;/self_update_url&gt;
  &lt;semi-automatic config:type="list"&gt;<co xml:id="co.ay.general.semi"/>
   ...
  &lt;/semi-automatic&gt;
  &lt;signature-handling&gt;<co xml:id="co.ay.general.signature"/>
   ...
  &lt;/signature-handling&gt;
  &lt;storage&gt;<co xml:id="co.ay.general.storage"/>
   ...
  &lt;/storage&gt;
  &lt;wait&gt;<co xml:id="co.ay.general.wait"/>
   ...
  &lt;/wait&gt;
 &lt;/general&gt;
&lt;profile&gt;</screen>
  <calloutlist>
   <callout arearefs="co.ay.general.ask">
    <para><!-- インストール時のユーザへの値の確認 --> <xref linkend="CreateProfile.Ask" xrefstyle="HeadingOnPage"/></para>
   </callout>
   <callout arearefs="co.ay.general.cio_ignore" arch="zseries">
    <para><!-- IBM z システムにおける未使用デバイスのブラックリスト設定 --> <xref linkend="CreateProfile.General.cio_ignore" xrefstyle="HeadingOnPage"/></para>
   </callout>
   <callout arearefs="co.ay.general.mode">
    <para><!-- モードセクション --> <xref linkend="CreateProfile.General.mode" xrefstyle="HeadingOnPage"/></para>
   </callout>
   <callout arearefs="co.ay.general.proposal">
    <para><!-- インストール設定画面の設定 --> <xref linkend="CreateProfile.General.proposal" xrefstyle="HeadingOnPage"/></para>
   </callout>
   <callout arearefs="co.ay.general.self_update">
    <para><!--自己更新セクション --> <xref linkend="CreateProfile.General.self_update" xrefstyle="HeadingOnPaqge"/></para>
   </callout>
   <callout arearefs="co.ay.general.semi">
    <para><!--半自動化セクション --> <xref linkend="CreateProfile.General.semi_automatic" xrefstyle="HeadingOnPaqge"/></para>
   </callout>
   <callout arearefs="co.ay.general.signature">
    <para><!-- 署名処理セクション --> <xref linkend="CreateProfile.General.signature" xrefstyle="HeadingOnPage"/></para>
   </callout>
   <callout arearefs="co.ay.general.storage">
    <para><!-- ストレージセクション --> <xref linkend="CreateProfile.General.storage" xrefstyle="HeadingOnPage"/></para>
   </callout>
   <callout arearefs="co.ay.general.wait">
    <para><!-- 待機セクション --> <xref linkend="CreateProfile.General.wait" xrefstyle="HeadingOnPage"/></para>
   </callout>
  </calloutlist>

  <sect2 xml:id="CreateProfile.General.mode">
   <title>モードセクション</title>

   <para>モードセクションでは、ユーザに対する問い合わせや再起動に関する &ay; の動作を設定します。 <tag class="element">mode</tag> セクション内では下記の要素を設定することができます:</para>

   <variablelist>
    <varlistentry>
     <term><tag class="element">activate_systemd_default_target</tag></term>
     <listitem>
      <para>この項目を <literal>false</literal> に設定すると、既定の <systemitem class="daemon">systemd</systemitem> のターゲットが <command>systemctl isolate</command> で有効化されなくなります。この値の指定は任意で、既定値は <literal>true</literal> です。</para>
<screen><![CDATA[<general>
 <mode>
  <activate_systemd_default_target config:type="boolean">
   true
  </activate_systemd_default_target>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">confirm</tag></term>
     <listitem>
      <para>既定では、インストール処理は <guimenu>インストール設定</guimenu> の画面で停止します。この時点では、まだシステムに対して何も変更が加えられておらず、必要であれば、この画面から各種の設定を変更することができます。ここから先に進むことで実際のインストールが始まることから、ここでユーザへの確認を行なっています。この値を <literal>false</literal> にすると、設定内容は自動的に受け入れられ、インストールが始まることになります。そのため、完全な無人インストールを行ないたい場合にのみ、 <literal>false</literal> を指定してください。この値の指定は任意で、既定値は <literal>true</literal> です。</para>
<screen><![CDATA[<general>
 <mode>
  <confirm config:type="boolean">true</confirm>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">confirm_base_product_license</tag></term>
     <listitem>
      <para>この値を <literal>true</literal> に設定すると、基本製品の EULA が表示されるようになります。ユーザ側では、表示されたライセンスを受け入れる必要があります。受け入れない場合、インストールはキャンセルされます。この値の設定は任意で、既定値は <literal>false</literal> です。この設定は基本製品のライセンスにのみ適用されます。追加のライセンスについては、 <literal>add-on</literal> セクション内の <literal>confirm_license</literal> フラグをお使いください (詳しくは <xref linkend="Software.Selections.additional"/> をお読みください) 。</para>
<screen><![CDATA[<general>
 <mode>
  <confirm_base_product_license config:type="boolean">
   false
  </confirm_base_product_license>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">final_halt</tag></term>
     <listitem>
      <para>この値を <literal>true</literal> に設定すると、インストールの最後の最後 (全てのパッケージをインストールし、第 2 ステージの末尾での設定が終わったあと) にマシンをシャットダウンするようになります。この値の設定は任意で、既定値は <literal>true</literal> です。この値と <literal>final_reboot</literal> の両方を <literal>true</literal> にしても、意味はありません。</para>
<screen><![CDATA[<general>
 <mode>
  <final_halt config:type="boolean">true</final_halt>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">final_reboot</tag></term>
     <listitem>
      <para>この値を <literal>true</literal> に設定すると、インストールの最後 (全てのパッケージをインストールし、第 2 ステージの末尾での設定が終わったあと) にマシンを再起動するようになります。この値の設定は任意で、既定値は <literal>true</literal> です。この値と <literal>final_halt</literal> の両方を <literal>true</literal> にしても、意味はありません。</para>
<screen><![CDATA[<general>
 <mode>
  <final_reboot config:type="boolean">true</final_reboot>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">final_restart_services</tag></term>
     <listitem>
      <para>この項目を <literal>false</literal> に設定すると、インストールの最後 (全てのパッケージをインストールし、第 2 ステージの末尾での設定が終わったあと) にサービス類が再起動 <emphasis>されなく</emphasis> なります。この値の設定は任意で、既定値は <literal>true</literal> です。</para>
<screen><![CDATA[<general>
 <mode>
  <final_restart_services config:type="boolean">
   true
  </final_restart_services>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry os="osuse">
     <term><tag class="element">forceboot</tag></term>
     <listitem>
      <para>&opensuse; のリリースによっては、第 1 ステージ終了後の再起動を避けるため、 &kexec; を利用して居るバージョンがあります。これにより、インストール済みのシステムを即時に起動できるようになっています。この場合、この値を <literal>true</literal> に設定することで、 &kexec; ではなく再起動を行なうようにすることができます。この値の設定は任意で、既定値は製品によって異なります。</para>
<screen><![CDATA[<general>
 <mode>
  <forceboot config:type="boolean">false</forceboot>
 </mode>
 ...
</general>]]></screen>
      <important>
       <title>ドライバによっては再起動が必要となる件について</title>
       <para><remark>2013-03-18 - fs: bnc #802387</remark> nVidia 社, ATI 社のグラフィックカード向けのプロプライエタリドライバなどを使用している場合、 &kexec; では正しく動作させることができず、必ず再起動が必要となります。そのため、 &productname; 製品の既定では、必ず再起動を行なうようになっています。</para>
      </important>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">halt</tag></term>
     <listitem>
      <para>第 1 ステージの終了後にマシンをシャットダウンします。この段階では、全てのパッケージとブートローダのインストールが完了し、 chroot スクリプトの指定があれば、実行後の状態になります。この場合、再起動を行なって第 2 ステージを開始する代わりに、マシンの電源が落とされます。その後マシンの電源を投入すると、マシンは第 2 ステージの自動インストールが始まるようになります。この値の設定は任意で、既定値は <literal>false</literal> です。</para>
<screen><![CDATA[<general>
 <mode>
  <halt config:type="boolean">false</halt>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">max_systemd_wait</tag></term>
     <listitem>
      <para><systemitem class="daemon">systemd</systemitem> が既定のターゲットの準備を整える際、 &ay; が最大で待機する時間を秒単位で指定します。この値の設定は任意で、通常は設定不要です。既定値は <literal>30</literal> (秒) です。</para>
<screen><![CDATA[<general>
 <mode>
  <max_systemd_wait config:type="integer">30</max_systemd_wait>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">ntp_sync_time_before_installation</tag></term>
     <listitem>
      <para>インストールを開始する前に時刻同期を行なうための、 NTP サーバを指定します。時刻同期は、このオプションを設定した場合にのみ行なわれます。なお、 NTP サーバとの通信にはネットワークの接続と、 NTP サーバへの経路情報の設定が必要となります。この値の設定は任意で、既定では時刻同期を行ないません。</para>
<screen><![CDATA[<general>
 <mode>
  <ntp_sync_time_before_installation>
   &ntpname;
  </max_systemd_wait>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">second_stage</tag></term>
     <listitem>
      <para>通常の &productname; のインストールは、単一のステージ内で行なわれますが、自動インストールの場合は、 2 つのステージに分割して実行されます。自動インストールでは基本的なシステムのインストールを行なったあと、システムの設定を行なうために第 2 ステージを起動します。このオプションを <literal>false</literal> に設定すると、第 2 ステージを無効化することができます。この値の設定は任意で、既定値は <literal>true</literal> です。</para>
<screen><![CDATA[<general>
 <mode>
  <second_stage config:type="boolean">true</second_stage>
 </mode>
 ...
</general>]]></screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="CreateProfile.General.proposal">
   <title>インストール設定画面の設定</title>

   <para>&ay; では、インストールに関する設定の概要を表示する <guimenu>インストール設定</guimenu> の画面をカスタマイズすることができます。この画面では、実際のインストールが始まる前に、さまざまな設定を変更することができます。 <tag class="element">proposal</tag> タグを使用することで、インストール設定の画面に表示される設定 (<quote>提案</quote>) を制御することができます。表示することのできる提案項目の一覧については、インストールメディア内の <filename>/control.xml</filename> ファイルをご覧ください。この設定は任意で、既定では全ての設定オプションを表示します。</para>

<screen><![CDATA[<proposals config:type="list">
 <proposal>partitions_proposal</proposal>
 <proposal>timezone_proposal</proposal>
 <proposal>software_proposal</proposal>
</proposals>]]></screen>
  </sect2>

  <sect2 xml:id="CreateProfile.General.self_update">
   <title>自己更新セクション</title>

   <para>インストールの際、 &yast; は自分自身を更新して、リリース後に発見されたインストーラ自身のバグを解決することができます。この機能に関する詳細について、詳しくは &deploy; をお読みください。 &yast; の自己更新機能では、下記のようなタグを使用することができます:</para>

   <variablelist>
    <varlistentry>
     <term><tag class="element">self_update</tag></term>
     <listitem>
      <para>このオプションを設定することで、 &yast; の自己更新機能を有効化 (<literal>true</literal>) もしくは無効化 (<literal>false</literal>) することができます。この値の設定は任意で、既定値は <literal>true</literal> です。</para>
<screen><![CDATA[<general>
 <self_update config:type="boolean">true</self_update>
 ...
</general>]]></screen>
      <para>カーネルのコマンドラインに対して、 <literal>self_update=1</literal> の起動パラメータを設定しても、同じ動作になります。</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">self_update_url</tag></term>
     <listitem>
      <para>&yast; の自己更新機能を提供する更新リポジトリの場所を指定します。詳しくは &deploy; をお読みください。</para>
      <important>
       <title>インストーラ自身の更新リポジトリのみを設定する必要がある件について</title>
       <para><option>self_update_url</option> パラメータでは、インストーラの自己更新を提供する URL のみを指定します。ソフトウエアの更新リポジトリなど、その他のリポジトリを指定してはなりません。</para>
      </important>
<screen><![CDATA[<general>
 <self_update_url>
  http://example.com/updates/$arch
 </self_update_url>
 ...
</general>]]></screen>
      <para>URL には <envar>$arch</envar> という変数を含めることができます。これはシステムのアーキテクチャに置き換えられる箇所を示すもので、たとえば <literal>x86_64</literal> , <literal>s390x</literal> などに置き換えられます。</para>
      <para>それ以外の方法としては、カーネルのコマンドラインに対して、 <literal>self_update=1</literal> と <literal>self_update=<replaceable>URL</replaceable></literal> の起動パラメータを設定しても、同じ動作になります。</para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>


  <sect2 xml:id="CreateProfile.General.semi_automatic">
   <title>半自動化セクション</title>

   <para>&ay; では、インストール時にいくつかの &yast; モジュールを起動する機能を提供しています。これは、いくつかの項目については手動で設定し、それ以外を全て自動的に実施したいような場合に有用です。この半自動化セクションでは、下記のような &yast; モジュールを起動することができます:</para>
   <itemizedlist>
    <listitem>
     <para>ネットワーク設定モジュール ( <literal>networking</literal> )</para>
    </listitem>
    <listitem>
     <para>パーティション設定モジュール ( <literal>partitioning</literal> )</para>
    </listitem>
    <listitem>
     <para>登録モジュール ( <literal>scc</literal> )</para>
    </listitem>
   </itemizedlist>
   <para>下記の例は、インストール時に対応する 3 種類全てのモジュールを起動する場合の例です:</para>
   <screen><![CDATA[<general>
 <semi-automatic config:type="list">
  <semi-automatic_entry>networking</semi-automatic_entry>
  <semi-automatic_entry>scc</semi-automatic_entry>
  <semi-automatic_entry>partitioning</semi-automatic_entry>
 </semi-automatic>
</general>]]></screen>
  </sect2>

  <sect2 xml:id="CreateProfile.General.signature">
   <title>署名処理セクション</title>

   <para>既定では、 &ay; は既知の GPG 鍵で署名されたソースからの署名付きパッケージのみをインストールします。本セクションでは、この既定値を変更することができます。</para>

   <warning>
    <title>署名処理設定の変更に伴う危険性について</title>
    <para>未署名のパッケージやチェックサムの確認が失敗したパッケージ、もしくは信頼していないソースからのパッケージを受け入れてしまうと、セキュリティ上のリスクとなります。このようなパッケージを受け入れてしまうと、パッケージが改ざんされていることを検出することができなくなるほか、お使いのマシンに悪意のあるソフトウエアをインストールする結果になってしまいます。ここで説明している既定値の上書きは、リポジトリとその中にあるパッケージの両方が信頼できるものである場合にのみ、設定してください。 &suse; では、これらの正当性チェックを無効化した状態でソフトウエアをインストールし使用した場合、一切の保証は行ないません。</para>
   </warning>

   <para>下記に示す全オプションの既定値は false です。オプションが false に設定されていた場合、それに対応するパッケージやリポジトリのチェックが失敗すると、特にメッセージを表示することなくインストールを行なわなくなります。</para>

   <variablelist>
    <varlistentry>
     <term><tag class="element">accept_unsigned_file</tag></term>
     <listitem>
      <para><literal>true</literal> に設定した場合、 &ay; はコンテンツファイルなどが未署名であっても、受け入れるようになります。</para>
<screen><![CDATA[<general>
 <signature-handling>
  <accept_unsigned_file config:type="boolean">
   false
  </accept_unsigned_file>
 </signature-handling>
 ...
<general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">accept_file_without_checksum</tag></term>
     <listitem>
      <para><literal>true</literal> に設定した場合、 &ay; はコンテンツファイルなどのチェックサムが存在しない場合であっても、受け入れるようになります。</para>
<screen><![CDATA[<general>
 <signature-handling>
  <accept_file_without_checksum config:type="boolean">
   false
  </accept_file_without_checksum>
 </signature-handling>
 ...
<general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">accept_verification_failed</tag></term>
     <listitem>
      <para><literal>true</literal> に設定すると、 &ay; は署名の検証が失敗した場合でも、署名付きのファイルであればそれらを受け付けるようになります。</para>
<screen><![CDATA[<general>
 <signature-handling>
  <accept_verification_failed config:type="boolean">
   false
  </accept_verification_failed>
 </signature-handling>
 ...
<general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">accept_unknown_gpg_key</tag></term>
     <listitem>
      <para><literal>true</literal> に設定した場合、 &ay; はインストール元に新しい GPG 鍵が存在し、その鍵でコンテンツファイルに署名されている場合、それを受け付けるようになります。</para>
<screen><![CDATA[<general>
 <signature-handling>
  <accept_unknown_gpg_key config:type="boolean">
   false
  </accept_unknown_gpg_key>
 </signature-handling>
 ...
<general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">accept_non_trusted_gpg_key</tag></term>
     <listitem>
      <para><literal>true</literal> に設定した場合、既知ではあるもののまだ信頼していない鍵を受け付けるようになります。</para>
<screen><![CDATA[<general>
 <signature-handling>
  <accept_non_trusted_gpg_key config:type="boolean">
   false
  </accept_non_trusted_gpg_key>
 </signature-handling>
 ...
<general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">import_gpg_key</tag></term>
     <listitem>
      <para><literal>true</literal> に設定した場合、 &ay; はインストール元にある新しい GPG 鍵を受け付け、データベース内に取り込むようになります。</para>
<screen><![CDATA[<general>
 <signature-handling>
  <import_gpg_key config:type="boolean">
   false
  </import_gpg_key>
 </signature-handling>
 ...
<general>]]></screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="CreateProfile.General.storage">
   <title>ストレージセクション</title>

   <para>本セクションでは、インストール時にマルチパスサポートを有効化することができます。ここではパーティションの割り当て方針についても設定することができます。</para>

   <variablelist>
    <varlistentry>
     <term><tag class="element">btrfs_set_default_subvolume_name</tag></term>
     <listitem>
      <para>詳しくは <xref linkend="ay.btrfs_subvolumes"/> をお読みください。</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">start_multipath</tag></term>
     <listitem>
      <para>複数のパスを介してアクセスすることのできるネットワークストレージ上にインストールを行なう場合、このパラメータを <literal>true</literal> に設定して、インストール時にマルチパス機能を使用できるようにします。この値の設定は任意で、既定値は <literal>false</literal> です。</para>
<screen><![CDATA[<general>
 <storage>
  <start_multipath config:type="boolean">false</start_multipath>
 </storage>
 ...
<general>]]></screen>
      <para>カーネルのコマンドラインに対して、 <literal>LIBSTORAGE_MULTIPATH_AUTOSTART=ON</literal> の起動パラメータを設定しても、同じ動作になります。</para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="CreateProfile.General.wait">
   <title>待機セクション</title>

   <para>インストールの第 2 ステージでは、ネットワークの設定などのさまざまなモジュールを動作させて、システムの設定を行ないます。 <tag class="element">wait</tag> セクションでは、特定のモジュールの動作前後で実行すべきスクリプトを指定することができます。また、各モジュールの前後でシステムを待機させる時間幅 ( <quote>スリープ</quote> ) を設定することもできます。</para>

   <variablelist>
    <varlistentry>
     <term><tag class="element">pre-modules</tag></term>
     <listitem>
      <para>設定モジュールが起動する前に実行すべきスクリプトと、その待機時間をそれぞれ設定することができます。下記のコードでは、ネットワーク設定モジュールを起動する前に、 10 秒間の待機と echo コマンドの実行を指定しています。</para>
<screen><![CDATA[<general>
 <wait>
  <pre-modules config:type="list">
   <module>
    <name>networking</name>
    <sleep>
     <time config:type="integer">10</time>
     <feedback config:type="boolean">true</feedback>
    </sleep>
    <script>
     <source>echo foo</source>
     <debug config:type="boolean">false</debug>
    </script>
   </module>
  </pre-modules>
  ...
 </wait>
<general>]]></screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><tag class="element">post-modules</tag></term>
     <listitem>
      <para>設定モジュールが起動した後に実行すべきスクリプトと、その待機時間をそれぞれ設定することができます。下記のコードでは、ネットワーク設定モジュールを起動した後に、 10 秒間の待機と echo コマンドの実行を指定しています。</para>
<screen><![CDATA[<general>
 <wait>
  <post-modules config:type="list">
   <module>
    <name>networking</name>
    <sleep>
     <time config:type="integer">10</time>
     <feedback config:type="boolean">true</feedback>
    </sleep>
    <script>
     <source>echo foo</source>
     <debug config:type="boolean">false</debug>
    </script>
   </module>
  </post-modules>
  ...
 </wait>
<general>]]></screen>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="CreateProfile.General.cio_ignore" arch="zseries">
   <title>&zseries; における未使用デバイスのブラックリスト設定</title>

   <para>&zseries; では、 <command>cio_ignore</command> を実行して、カーネルからの未使用ハードウエアデバイスの検索を防止し、ブラックリストとして設定することができます。これは &ay; で同名のパラメータを <literal>true</literal> に設定することで、実現することができます。この値の設定は任意で、 &zseries; ハードウエアに対してのみ適用されます。なお、既定値は <literal>false</literal> です。</para>

<screen><![CDATA[<general>
 <cio_ignore config:type="boolean">false</cio_ignore>
 ...
<general>]]></screen>
  </sect2>

  <sect2 xml:id="CreateProfile.General.example_common">
   <title><tag class="element">general</tag> セクションの例</title>

   <para>本章で説明してきた項目の設定例を示します。</para>

   <example xml:id="ex.general.common">
    <title>一般オプション</title>
    <para>下記は <literal>general</literal> セクションで最もよく使用されるオプションを示しています。 <literal>pre</literal> および <literal>post</literal> の各モジュールセクションにはダミーのスクリプトを埋め込んでいます。</para>
<screen><![CDATA[<?xml version="1.0"?>
<!DOCTYPE profile>
<profile xmlns="http://www.suse.com/1.0/yast2ns"
 xmlns:config="http://www.suse.com/1.0/configns">
 <general>
  <! -- cio_ignore は IBM &zseries; のみで使用することができます -->
  <cio_ignore config:type="boolean">false</cio_ignore>
  <mode>
   <halt config:type="boolean">false</halt>
   <forceboot config:type="boolean">false</forceboot>
   <final_reboot config:type="boolean">false</final_reboot>
   <final_halt config:type="boolean">false</final_halt>
   <confirm_base_product_license config:type="boolean">
    false
   </confirm_base_product_license>
   <confirm config:type="boolean">true</confirm>
   <second_stage config:type="boolean">true</second_stage>
  </mode>
  <proposals config:type="list">
   <proposal>partitions_proposal</proposal>
  </proposals>
  <self_update config:type="boolean">true</self_update>
  <self_update_url>http://example.com/updates/$arch</self_update_url>
  <signature-handling>
   <accept_unsigned_file config:type="boolean">
    true
   </accept_unsigned_file>
   <accept_file_without_checksum config:type="boolean">
    true
   </accept_file_without_checksum>
   <accept_verification_failed config:type="boolean">
    true
   </accept_verification_failed>
   <accept_unknown_gpg_key config:type="boolean">
    true
   </accept_unknown_gpg_key>
   <import_gpg_key config:type="boolean">true</import_gpg_key>
   <accept_non_trusted_gpg_key config:type="boolean">
   true
   </accept_non_trusted_gpg_key>
  </signature-handling>
  <storage>
   <partition_alignment config:type="symbol">
    align_cylinder
   </partition_alignment>
  </storage>
  <wait>
   <pre-modules config:type="list">
    <module>
     <name>networking</name>
     <sleep>
      <time config:type="integer">10</time>
      <feedback config:type="boolean">true</feedback>
     </sleep>
     <script>
     <source>&gt;![CDATA[
echo "Sleeping 10 seconds"
      ]]&gt;</source>
     <debug config:type="boolean">false</debug>
     </script>
    </module>
   </pre-modules>
   <post-modules config:type="list">
    <module>
     <name>networking</name>
     <sleep>
      <time config:type="integer">10</time>
      <feedback config:type="boolean">true</feedback>
     </sleep>
     <script>
      <source>&gt;![CDATA[
echo "Sleeping 10 seconds"
      ]]&gt;</source>
      <debug config:type="boolean">false</debug>
     </script>
    </module>
   </post-modules>
  </wait>
 </general>
</profile>]]></screen>
   </example>
  </sect2>
 </sect1>
  <sect1 xml:id="CreateProfile.Reporting">
   <title>レポート</title>

   <para><literal>report</literal> リソースでは、インストール時に表示される可能性のある、 3 種類のポップアップを管理します:</para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>メッセージポップアップ (通常は致命的なものではなく、情報提供のみを目的としたもの)</para>
    </listitem>
    <listitem>
     <para>警告ポップアップ (何らかの問題が発生していることを示すもの)</para>
    </listitem>
    <listitem>
     <para>エラーポップアップ (何らかのエラーが発生していることを示すもの)</para>
    </listitem>
   </itemizedlist>

   <example>
    <title>レポートの動作</title>
<screen>&lt;report&gt;
  &lt;errors&gt;
    &lt;show config:type="boolean"&gt;true&lt;/show&gt;
    &lt;timeout config:type="integer"&gt;0&lt;/timeout&gt;
    &lt;log config:type="boolean"&gt;true&lt;/log&gt;
  &lt;/errors&gt;
  &lt;warnings&gt;
    &lt;show config:type="boolean"&gt;true&lt;/show&gt;
    &lt;timeout config:type="integer"&gt;10&lt;/timeout&gt;
    &lt;log config:type="boolean"&gt;true&lt;/log&gt;
  &lt;/warnings&gt;
  &lt;messages&gt;
    &lt;show config:type="boolean"&gt;true&lt;/show&gt;
    &lt;timeout config:type="integer"&gt;10&lt;/timeout&gt;
    &lt;log config:type="boolean"&gt;true&lt;/log&gt;
  &lt;/messages&gt;
  &lt;yesno_messages&gt;
    &lt;show config:type="boolean"&gt;true&lt;/show&gt;
    &lt;timeout config:type="integer"&gt;10&lt;/timeout&gt;
    &lt;log config:type="boolean"&gt;true&lt;/log&gt;
  &lt;/yesno_messages&gt;
&lt;/report&gt;</screen>
   </example>

   <para>ご利用の方の知識レベルに応じて、これらのメッセージを非表示にしたり記録したり、もしくは (時間制限付きで) 表示したりすることができます。なお、全ての <literal>messages</literal> に対してタイムアウトを設定し、表示しておくことをお勧めします。警告は、その内容によっては読み飛ばすことができるものもありますが、通常は無視すべきものではありません。</para>

   <para>自動インストールモードでの既定値では、全てのエラーを時間制限無しで表示し、それ以外の警告やその他のメッセージは 10 秒の時間制限を設定して全て表示します。</para>

   <warning>
    <title>重要なシステムメッセージについて</title>
    <para><literal>report</literal> リソースでは、インストール時に表示される全てのメッセージを制御することはできません。パッケージのインストールやパーティション設定などで致命的な問題が発生した場合、 <literal>report</literal> セクションの設定に関わらずメッセージが表示されることがあります。通常、これらのメッセージは <guimenu>はい</guimenu> または <guimenu>いいえ</guimenu> で回答する必要があるものです。</para>
   </warning>
  </sect1>
  <sect1 xml:id="CreateProfile.Register" os="sles;sled">
   <title>システムの登録と拡張の選択</title>

   <para>登録サーバ経由でのシステムの登録は、 <literal>suse_register</literal> リソースで設定することができます。下記の例では、 &scc; に対してシステムの登録を行なっています。ご利用の組織内に独自の登録サーバが用意されている場合は、 <literal>reg_server*</literal> プロパティで必要なデータを指定する必要があり伸す。詳しくは表をご覧ください。</para>

<screen>&lt;suse_register&gt;
  &lt;do_registration config:type="boolean"&gt;true&lt;/do_registration&gt;
  &lt;email&gt;&exampleuser_plain;@&exampledomain;&lt;/email&gt;
  &lt;reg_code&gt;<replaceable>登録コード</replaceable>&lt;/reg_code&gt;
  &lt;install_updates config:type="boolean"&gt;true&lt;/install_updates&gt;
  &lt;slp_discovery config:type="boolean"&gt;false&lt;/slp_discovery&gt;
&lt;/suse_register&gt;
 </screen>

   <para>登録処理を完全に自動化する代わりに、インストール中に &yast; の登録モジュールを開始するよう設定することもできます。この仕組みにより、登録データを手作業で入力することができるようになります。この場合、下記のような XML コードを設定します:</para>

<screen>&lt;general&gt;
 &lt;semi-automatic config:type="list"&gt;
   &lt;semi-automatic_entry&gt;scc&lt;/semi-automatic_entry&gt;
 &lt;/semi-automatic&gt;
&lt;/general&gt;</screen>

   <tip>
    <title>インストール時のネットワーク設定の使用</title>
    <para>インストール時に使用するネットワーク設定と同じものを使用する必要がある場合、 &ay; は登録処理を行なう前の第 1 ステージで、ネットワーク設定を動作させる必要があることになります。</para>
<screen>&lt;networking&gt;
  &lt;setup_before_proposal config:type="boolean"&gt;true&lt;/setup_before_proposal&gt;
&lt;/networking&gt;</screen>
   </tip>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>要素</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
       <entry>
        <para>コメント</para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>do_registration</literal></para>
       </entry>
       <entry>
        <para>ブール値</para>
<screen>&lt;do_registration config:type="boolean"
&gt;true&lt;/do_registration&gt;</screen>
       </entry>
       <entry>
        <para>システムを登録すべきかどうかを指定します。 <literal>false</literal> を指定した場合、その他のオプションは全て無視され、システムは登録されなくなります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>e-mail</literal></para>
       </entry>
       <entry>
        <para>電子メールアドレス</para>
<screen>&lt;email&gt;&exampleuser_plain;@&exampledomain;&lt;/email&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。登録コードに合致する電子メールアドレスを指定します。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>reg_code</literal></para>
       </entry>
       <entry>
        <para>テキスト</para>
<screen>&lt;reg_code&gt;<replaceable>登録コード</replaceable>&lt;/reg_code&gt;</screen>
       </entry>
       <entry>
        <para>必須です。登録コードを指定します。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>install_updates</literal></para>
       </entry>
       <entry>
        <para>ブール値</para>
<screen>&lt;install_updates config:type="boolean"
&gt;true&lt;/install_updates&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。更新チャンネルからの更新をインストールすべきかどうかを指定します。既定ではそれらをインストールしません ( <literal>false</literal> ) 。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>slp_discovery</literal></para>
       </entry>
       <entry>
        <para>ブール値</para>
<screen>&lt;slp_discovery config:type="boolean"
&gt;true&lt;/slp_discovery&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。 SLP を介して登録サーバを検索するかどうかを指定します。既定値は <literal>false</literal> です。</para>
        <para>この指定では、登録サーバが 1 台だけ見つかる必要があります。複数の登録サーバが検出されると、インストールが失敗してしまいます。このような場合は、 <literal>reg_server</literal> でいずれか 1 つのサーバを指定してください。</para>
        <para><literal>slp_discovery</literal> も <literal>reg_server</literal> も指定しない場合、システムは &scc; に対して登録を行ないます。</para>
        <para>この設定は自己更新機能にも影響します。無効化した場合、 SLP での検索は行ないません。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>reg_server</literal></para>
       </entry>
       <entry>
        <para>URL</para>
<screen>&lt;reg_server&gt;
  https://smt.&exampledomain;
&lt;/reg_server&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。 &rmt; のサーバ URL を指定します。 <literal>slp_discovery</literal> も <literal>reg_server</literal> も指定しない場合、システムは &scc; に対して登録を行ないます。</para>
        <para>自己更新リポジトリの URL を問い合わせる際、 &rmt; サーバに対して問い合わせが行なわれます。そのため、 <literal>self_update_url</literal> が設定されていない場合、 &rmt; サーバには自己更新のダウンロード元を設定する必要があります。この機能に関する詳細については、 &deploy; をお読みください。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>reg_server_cert_fingerprint_type</literal></para>
       </entry>
       <entry>
        <para><literal>SHA1</literal> もしくは <literal>SHA256</literal></para>
<screen>&lt;reg_server_cert_fingerprint_type&gt;
  SHA1
&lt;/reg_server_cert_fingerprint_type&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。 <literal>reg_server_cert_fingerprint</literal> でチェックサム値を指定する場合には必須となります。なお、 SSL の証明書の正当性を確認するため、 <literal>reg_server_cert_fingerprint</literal> の値を設定しておくことをお勧めします。 SSL 通信が検証エラーで失敗した場合、該当する証明書が自動的に取り込まれるようになります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>reg_server_cert_fingerprint</literal></para>
       </entry>
       <entry>
        <para>16 進数表記 (大文字と小文字は区別しません) でのサーバ証明書の指紋 (フィンガープリント) の値を指定します。</para>
<screen>&lt;reg_server_cert_fingerprint&gt;
  <replaceable>01:AB...:EF</replaceable>
&lt;/reg_server_cert_fingerprint&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。 <literal>reg_server_cert_fingerprint_type</literal> とともに指定します。SSL の証明書の正当性を確認するため、 <literal>reg_server_cert_fingerprint</literal> の値は設定しておくことをお勧めします。 SSL 通信が検証エラーで失敗した場合、該当する証明書が自動的に取り込まれるようになります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>reg_server_cert</literal></para>
       </entry>
       <entry>
        <para>URL</para>
<screen>&lt;reg_server_cert&gt;
  http://smt.&exampledomain;/smt.crt
&lt;/reg_server_cert&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。サーバ内での SSL 証明書の URL を指定します。このオプションを設定してしまうと、ダウンロードした証明書の検証が行なわれなくなってしまうことから、非推奨となります。代わりに <literal>reg_server_cert_fingerprint</literal> をお使いください。</para>
       </entry>
      </row>
      <row os="sles;sled">
       <entry>
        <para><literal>addons</literal></para>
       </entry>
       <entry>
        <para>アドオンのリスト</para>
       </entry>
       <entry>
        <para>インストールリポジトリに追加すべき、登録サーバからの拡張を指定します。詳しくは <xref linkend="CreateProfile.Register.Extension"/> をお読みください。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>

   <tip>
    <title>サーバ証明書の指紋取得</title>
    <para><literal>reg_server_cert_fingerprint</literal> に入力すべきサーバ証明書の指紋情報を生成するには、下記のコマンドを実行します:</para>
    <screen>
echo | openssl s_client -showcerts -connect scc.suse.com:443 2&gt; /dev/null |
openssl x509 -noout -fingerprint -sha256
    </screen>
    <para>ここで、 <literal>scc.suse.com</literal> の箇所をご利用のサーバに置き換えてください。また、 <literal>-sha256</literal> の代わりに <literal>-sha1</literal> を指定してもかまいません (ただし既定値である SHA256 のほうがより適切です) 。</para>
    <para><emphasis>注意:</emphasis> この設定は、信頼のおけるネットワーク内でのみ使用することができます。インターネットなどの信頼できないネットワークを利用している場合、他の方法でサーバから証明書を取得して、指紋を取得してください。指紋は SSH 経由でサーバから取得することもできるほか、他の情報源から取得してもかまいません。このほか、ダウンロードした証明書とサーバの証明書を比較して、同一のものであることを確認してもかまいません。</para>
   </tip>

   <sect2 xml:id="CreateProfile.Register.Extension" os="sles;sled">
    <title>拡張</title>
    <para>&scc; では、インストール時に追加のソースとして含めることのできる、 <literal>sle-module-development-tools</literal> (開発ツールモジュール) などの拡張が提供されています。拡張は <literal>suse_register</literal> ブロック内の <literal>addons</literal> プロパティで追加することができます。 <!-- Below is a list of all extensions available for &productname; on x86_64: --></para>
    <note>
     <title>利用可能な拡張</title>
     <para>利用可能な拡張は製品とアーキテクチャによって異なります。全てのアーキテクチャで全ての拡張が利用できるというわけではありません。  <!-- All listed extensions are available for &sls; on the x86_64 architecture. --></para>
     <para>また、 <literal>sle-ha</literal> などの拡張を使用する場合は、登録コードが必要になります。ご契約の内容にもよりますが、拡張向けの専用登録コードを使用するか、もしくは基本製品に対するコードを変更して使用する必要があります。</para>
    </note>

    <para><command>SUSEConnect --list-extensions</command> を実行することで、登録済みのシステム内で利用可能な全ての拡張を表示することができます。出力結果には下記のような内容が現われるはずです:</para>
    <screen>Install with: SUSEConnect -p sle-module-development-tools/15/x86_64</screen>
    <para><option>-p</option> パラメータ以下には <replaceable>名前/バージョン/アーキテクチャ</replaceable> の形式で値が表示されますので、下記のように &ay; のプロファイルに変換することができます:</para>
    <screen><![CDATA[<addons config:type="list">
 <addon>
  <!-- Development Tools Module -->
  <name>sle-module-development-tools</name>
  <version>15</version>
  <arch>x86_64</arch>
 </addon>
</addons>]]></screen>

<note>
 <title>拡張同士の依存関係</title>
 <para>&slsa; 15 およびそれ以降のバージョンでは、 &ay; は登録時に依存関係を調査して、拡張の順序を自動的に調整することができます。これにより、 &ay; プロファイル内での拡張の順序は、特に重要ではないことになります。</para>
 <para>また、 &ay; ではプロファイル内に拡張が書かれていない場合であっても、依存関係にある拡張に対しては自動的に登録処理を実施します。これにより、拡張の依存関係に関しては、特に気にする必要がないことになります。</para>
 <para>しかしながら、依存関係にある拡張が登録キーを必要とするようなものであった場合、登録キーを含めてプロファイル内に指定を行なわなければなりません。プロファイル内に登録キーを設定しないと、登録処理が失敗することになります。</para>
</note>

    <para>背景となる情報、および &slsa; 向けのアドオンリストについて、詳しくは <link xlink:href="https://github.com/yast/yast-registration/wiki/Available-SCC-Extensions-for-Use-in-Autoyast"/> をお読みください。一覧は必要に応じて更新されます。</para>
   </sect2>
  </sect1>

  <sect1 xml:id="CreateProfile.Bootloader">
   <title>ブートローダ</title>

   <para>このドキュメンテーションは <command>yast2-bootloader</command> と &grub; 向けにのみ作成されています。従来バージョンの GRUB を含む古いバージョンについては、古いバージョンに含まれている <filename>/usr/share/doc/packages/autoyast2/</filename> 以下のドキュメンテーションをお読みください。</para>

   <para>&ay; でのブートローダの部分は、下記のような構成になっています:</para>

<screen>&lt;bootloader&gt;
  &lt;loader_type&gt;
    &lt;!-- ブートローダの種類 (grub2 もしくは grub2-efi) --&gt;
  &lt;/loader_type&gt;
  &lt;global&gt;
    &lt;!--
      &grub; のインストールと汎用ブートコードに関する設定
    --&gt;
  &lt;/global&gt;
  &lt;device_map config:type="list"&gt;
    &lt;!-- デバイスの順序を定義するための設定 --&gt;
  &lt;/device_map&gt;
 &lt;/bootloader&gt;</screen>

   <sect2 xml:id="CreateProfile.Bootloader.type">
    <title>ローダの種類</title>
    <para>ここでは、使用すべきブートローダの種類 (UEFI 向けもしくは BIOS 向け) を指定します。ただし、全てのアーキテクチャで両方のブートローダを使用できるわけではありません。最も安全な設定 ( <literal>default</literal> ) では、インストーラ側で自動的に判断します。</para>
    <screen>&lt;loader_type&gt;<replaceable>ローダの種類</replaceable>&lt;/loader_type&gt;</screen>
    <para><replaceable>ローダの種類</replaceable> で指定可能な値は下記のとおりです:</para>
    <itemizedlist>
     <listitem>
      <para><literal>default</literal> : インストーラ側で適切なブートローダを選択します。特に何もオプションが指定されていない場合、これが既定値となります。</para>
     </listitem>
     <listitem>
      <para><literal>grub2</literal>:  古い BIOS 向けのブートローダを使用します。</para>
     </listitem>
     <listitem>
      <para><literal>grub2-efi</literal> : EFI ブートローダを使用します。</para>
     </listitem>
     <listitem>
      <para><literal>none</literal> : インストーラ側では起動関連の処理および設定を行なわないようにします。</para>
     </listitem>
    </itemizedlist>
   </sect2>

   <sect2 xml:id="CreateProfile.Bootloader.globals">
    <title>グローバル</title>
    <para>この箇所は任意指定ではありますが重要な箇所です。ここでは &grub; のインストール先と起動処理の動作方法について設定を行ないます。なお、特に何も設定を行なわない場合、 <command>yast2-bootloader</command> が設定を作成します。通常は &ay; の制御ファイルにはこの部分のみを設定し、それ以外の箇所は <command>yast2-bootloader</command> が自動生成するようにします。特別な要件がある場合を除いて、 XML ファイル内ではブートローダの設定を行なわないでください。</para>
<screen>&lt;global&gt;
  &lt;activate config:type="boolean"&gt;true&lt;/activate&gt;
  &lt;timeout config:type="integer"&gt;10&lt;/timeout&gt;
  &lt;suse_btrfs config:type="boolean"&gt;true&lt;/suse_btrfs&gt;
  &lt;terminal&gt;gfxterm&lt;/terminal&gt;
  &lt;gfxmode&gt;1280x1024x24&lt;/gfxmode&gt;
&lt;/global&gt;</screen>
    <informaltable>
     <tgroup cols="2">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>activate</literal></para>
        </entry>
        <entry>
         <para>起動パーティションの起動フラグを設定するようにします。起動パーティションは、個別に /boot パーティションを設定していない場合、 <filename>/</filename> の存在するパーティションになります。起動パーティションが論理パーティション内に存在する場合は、拡張パーティションに対して起動フラグが設定されます。</para>
<screen>&lt;activate config:type="boolean"&gt;true&lt;/activate&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>append</literal></para>
        </entry>
        <entry>
         <para>通常モードと復元モードの両方に対して、起動項目の末尾に追加するカーネルパラメータを指定します。</para>
<screen>&lt;append&gt;nomodeset vga=0x317&lt;/append&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>boot_boot</literal></para>
        </entry>
        <entry>
         <para>個別の /boot パーティションに対して &grub; を書き込みます。個別の /boot パーティションが存在しない場合、 &grub; は <filename>/</filename> に書き込まれます。</para>
<screen>&lt;boot_boot&gt;false&lt;/boot_boot&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>boot_custom</literal></para>
        </entry>
        <entry>
         <para>指定したデバイスに &grub; を書き込みます。</para>
<screen>&lt;boot_custom&gt;/dev/sda3&lt;/boot_custom&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>boot_extended</literal></para>
        </entry>
        <entry>
         <para>&grub; を拡張パーティションに書き込みます (汎用のブートコードを使用する必要があり、 <filename>/boot</filename> が論理パーティションである場合に重要です) 。注意: 起動パーティションが論理パーティションである場合、 <literal>generic_mbr</literal> よりも <literal>boot_mbr</literal> (&grub; を MBR に書き込む) を使用すべきです。</para>
<screen>&lt;boot_extended&gt;false&lt;/boot_extended&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>boot_mbr</literal></para>
        </entry>
        <entry>
         <para>&grub; を順序の中で最初に現われるディスクの MBR に書き込みます (ディスクの順序は device.map で設定します) 。</para>
<screen>&lt;boot_mbr&gt;false&lt;/boot_mbr&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>boot_root</literal></para>
        </entry>
        <entry>
         <para>&grub; を <filename>/</filename> のパーティションに書き込みます。</para>
<screen>&lt;boot_root&gt;false&lt;/boot_root&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>generic_mbr</literal></para>
        </entry>
        <entry>
         <para>汎用のブートコードを MBR に書き込みます (<literal>boot_mbr</literal> が <literal>true</literal> に設定されている場合は無視されます) 。</para>
<screen>&lt;generic_mbr config:type="boolean"&gt;false&lt;/generic_mbr&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>gfxmode</literal></para>
        </entry>
        <entry>
         <para>&grub; の画面のグラフィカルな解像度を指定します (なお、 &lt;terminal&gt; の値を <literal>gfxterm</literal> に設定しなければなりません) 。この項目には <literal>auto</literal> (自動設定) のほか、 <literal><replaceable>水平解像度</replaceable>x<replaceable>垂直解像度</replaceable></literal> もしくは <literal><replaceable>水平解像度</replaceable>x<replaceable>垂直解像度</replaceable>x<replaceable>色深</replaceable></literal> の形式で設定します。お使いのシステムで指定できる &grub; の解像度について知りたい場合は、 &grub; のコマンドラインから <command>vbeinfo</command> コマンドを実行してください。</para>
<screen>&lt;gfxmode&gt;1280x1024x24&lt;/gfxmode&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>os_prober</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定すると、インストール時に既にインストールされているオペレーティングシステムを自動的に検索し、それらに対する起動項目を生成するようにします。</para>
<screen>&lt;os_prober config:type="boolean"&gt;false&lt;/os_prober&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>cpu_mitigations</literal></para>
        </entry>
        <entry>
         <para>CPU の脆弱性に対する緩和策に対するカーネルのコマンドラインパラメータを選択します (それと同時に、セキュリティ保護と性能のどちらを重視するのかを選択することにもなります) 。設定可能な値は下記のとおりです:</para>
         <formalpara>
          <title><literal>auto</literal></title>
           &kernel_cpu_mitigations_auto;
         </formalpara>
         <formalpara>
          <title><literal>nosmt</literal></title>
           &kernel_cpu_mitigations_nosmt;
         </formalpara>
         <formalpara>
          <title><literal>off</literal></title>
           &kernel_cpu_mitigations_off;
         </formalpara>
         <formalpara>
          <title><literal>manual</literal></title>
          &kernel_cpu_mitigations_manual;
         </formalpara>
<screen>&lt;cpu_mitigations&gt;auto&lt;/cpu_mitigations&gt;</screen>
         <para>&ay; 内で何も設定を行なわない場合、カーネルのコマンドラインを介して対応する設定を変更できるようになります。既定ではインストールメディア内の <filename>/control.xml</filename> に、何も指定しない場合の (製品固有の) 設定が書かれています。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>suse_btrfs</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定すると、 btrfs のスナップショットからの起動に対応するようになります。</para>
<screen>&lt;suse_btrfs config:type="boolean"&gt;false&lt;/suse_btrfs&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>serial</literal></para>
        </entry>
        <entry>
         <para>&grub; の端末モードが <literal>serial</literal> (シリアル) である場合に、実行すべきコマンドを設定します。</para>
<screen>&lt;serial&gt;
  serial --speed=115200 --unit=0 --word=8 --parity=no --stop=1
&lt;/serials&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>terminal</literal></para>
        </entry>
        <entry>
         <para>&grub; で使用したい端末モードを選択します。設定可能な値は <literal>console</literal> , <literal>gfxterm</literal> , <literal>serial</literal> のいずれかとなります。 <literal>serial</literal> を指定した場合は、 &lt;serial&gt; 内でシリアル用のコマンドを設定する必要があります。</para>
<screen>&lt;terminal&gt;serial&lt;/terminal&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>timeout</literal></para>
        </entry>
        <entry>
         <para>既定の起動項目を自動的に起動するまでの待機時間を、秒単位で指定します。</para>
<screen>&lt;timeout config:type="integer"&gt;10&lt;/timeout&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>vgamode</literal></para>
        </entry>
        <entry>
         <para>起動項目のカーネルパラメータに対して、 <literal>vga=<replaceable>値</replaceable></literal> の形式で追加を行ないます。</para>
<screen>&lt;vgamode&gt;0x317&lt;/vgamode&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>xen_append</literal></para>
        </entry>
        <entry>
         <para>&xen; ゲスト向けの起動項目の末尾に追加する、カーネルのパラメータを指定します。</para>
<screen>&lt;xen_append&gt;nomodeset vga=0x317&lt;/xen_append&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>xen_kernel_append</literal></para>
        </entry>
        <entry>
         <para>&vmhost; 内の &xen; カーネルに対して、起動項目の末尾に追加するパラメータを指定します。</para>
<screen>&lt;xen_kernel_append&gt;dom0_mem=768M&lt;/xen_kernel_append&gt;</screen>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

   <sect2 xml:id="CreateProfile.Bootloader.dev_map">
    <title>デバイスマップ</title>
    <para>&grub; では BIOS ドライブと Linux デバイスの間でのマッピングに関わる問題を回避するため、設定ファイルを生成する際にデバイス ID 文字列 (UUID) もしくはファイルシステムのラベルを使用するようになっています。 &grub; ユーティリティではその場で一時的なデバイスマップを作成しますが、これは特にディスクが 1 台しか搭載されていないシステムであれば十分な仕組みです。しかしながら、何らかの理由で自動デバイスマップの仕組みを上書きする必要がある場合は、このセクションを利用して独自のマッピングを指定してください。</para>
<screen>&lt;device_map config:type="list"&gt;
  &lt;device_map_entry&gt;
    &lt;firmware&gt;hd0&lt;/firmware&gt; &lt;!-- ターゲットマップ内でのデバイスの順序  --&gt;
    &lt;linux&gt;/dev/disk/by-id/ata-ST3500418AS_6VM23FX0&lt;/linux&gt; &lt;!-- デバイス (ディスク) 名  --&gt;
  &lt;/device_map_entry&gt;
&lt;/device_map&gt;</screen>
   </sect2>
  </sect1>
  <sect1 xml:id="CreateProfile.Partitioning">
   <title>パーティション設定</title>

   <para><remark role="fixme">Add a short description</remark></para>

   <sect2 xml:id="CreateProfile.Partitioning.config">
    <title>ドライブの設定</title>
    <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;profile&gt;
  &lt;partitioning config:type="list"&gt;
    &lt;drive&gt;
     ...
    &lt;/drive&gt;
  &lt;/partitioning&gt;
&lt;/profile&gt;</screen>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>device</literal></para>
        </entry>
        <entry>
         <para>このセクションで設定したいデバイスを指定します。 <filename>/dev/disk/by-id/ata-WDC_WD3200AAKS-75L9A0_WD-WMAV27368122</filename> のような ID 形式の名前を指定するか、 <filename>/dev/disk/by-path/pci-0001:00:03.0-scsi-0:0:0:0</filename> のように <emphasis>by-path</emphasis> 形式で指定を行なうことで、一貫性のある名前を使用することができるようになります。</para>
<screen>&lt;device&gt;/dev/sda&lt;/device&gt;</screen>
        <para>ボリュームグループやソフトウエア RAID 、 &bcache; デバイスの場合は、インストール後のシステムで使用するデバイス名は別のものになります (既存のデバイスとの衝突を避けるためのものです) 。</para>
        </entry>
        <entry>
         <para>任意指定です。何も指定しない場合、 &ay; は自動的にデバイスを判断します。判断を調整する方法については、 <xref linkend="ay.partitioning.skip_devices"/> をお読みください。</para>
         <para>値に <literal>ask</literal> を指定すると、 &ay; はインストール時に使用するデバイスをユーザに対して尋ねるようになります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>initialize</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定すると、 &ay; がパーティションの計算を行なう前に、パーティションテーブルを消去するようになります。</para>
<screen>&lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>partitions</literal></para>
        </entry>
        <entry>
         <para>&lt;partition&gt; 項目を入れる箇所です (詳しくは <xref linkend="ay.partition_configuration"/> をお読みください) 。</para>
<screen>&lt;partitions config:type="list"&gt;
  &lt;partition&gt;...&lt;/partition&gt;
  ...
&lt;/partitions&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。何もパーティションを指定しない場合、 &ay; は適切なパーティション設定を自動で作成します (詳しくは <xref linkend="ay.auto_partitioning"/> をお読みください) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>pesize</literal></para>
        </entry>
        <entry>
         <para>LVM の場合にのみ意味がある値です。</para>
<screen>&lt;pesize&gt;8M&lt;/pesize&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。 LVM ボリュームグループの場合、 4M が既定値となります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>use</literal></para>
        </entry>
        <entry>
         <para>&ay; がハードディスクのパーティション設定を行なう際の方針を指定します:</para>
         <para>下記の中からいずれかを指定します:</para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para><literal>all</literal>: 新しいパーティションを作成する際、ディスク全体を使用するようにします。</para>
          </listitem>
          <listitem>
           <para><literal>linux</literal>: 既存の Linux パーティションのみを使用します。</para>
          </listitem>
          <listitem>
           <para><literal>free</literal>: デバイス内の未使用領域のみを使用し、それ以外のパーティションについては何も変更しないようにします。</para>
          </listitem>
          <listitem>
           <para>1,2,3 (使用すべきパーティションの番号をカンマ区切りで指定します) 。</para>
          </listitem>
         </itemizedlist>
        </entry>
        <entry>
         <para>このパラメータは指定しておくべきものです。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>type</literal></para>
        </entry>
        <entry>
         <para><literal>drive</literal> の種類を指定します:</para>
         <para>下記の中からいずれかを指定します:</para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para><literal>CT_DISK</literal>: 物理的なハードディスク (既定値)</para>
          </listitem>
          <listitem>
           <para><literal>CT_LVM</literal>: LVM ボリュームグループ</para>
          </listitem>
          <listitem>
           <para><literal>CT_RAID</literal>: ソフトウエア RAID デバイス</para>
          </listitem>
          <listitem>
           <para><literal>CT_BCACHE</literal>: ソフトウエア &bcache; デバイス</para>
          </listitem>
         </itemizedlist>
<screen>&lt;type config:type="symbol"&gt;CT_LVM&lt;/type&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。通常の物理ハードディスクの場合、既定値は <literal>CT_DISK</literal> になります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>disklabel</literal></para>
        </entry>
        <entry>
         <para>パーティションテーブルの種類を選択します。</para>
         <para>下記の中からいずれかを指定します:</para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para><literal>msdos</literal></para>
          </listitem>
          <listitem>
           <para><literal>gpt</literal></para>
          </listitem>
          <listitem>
           <para><literal>none</literal> (無し)</para>
          </listitem>
         </itemizedlist>
<screen>&lt;disklabel&gt;gpt&lt;/disklabel&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定では &yast; 側で自動的に判断します。異なる種類のパーティションテーブルが既に存在している場合、そのままにしておくべきパーティションや再利用可能なパーティションが含まれている場合を除き、指定した種類のパーティションテーブルを再作成します。何もパーティションを作成せずにディスクを使用したい場合は、この要素を <literal>none</literal> にしてください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>keep_unknown_lv</literal></para>
        </entry>
        <entry>
         <para>type=CT_LVM のドライブでのみ意味のある項目です。論理ボリュームグループを再利用している場合、この値を <literal>true</literal> に設定すると、そのグループ内に存在する全ての既存論理ボリュームは、それらが &lt;partitioning&gt; で指定されている場合を除き、何も変更が加えられないようになります。そのため、そのままにしておくべき論理ボリュームについては、何も指定しなくて良いことになります。</para>
<screen>&lt;keep_unknown_lv config:type="boolean"
&gt;false&lt;/keep_unknown_lv&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>enable_snapshots</literal></para>
        </entry>
        <entry>
         <para>btrfs ファイルシステムに対してスナップショットを有効化します。その他のファイルシステムには適用されません。</para>
<screen>&lt;enable_snapshots config:type="boolean"
&gt;false&lt;/enable_snapshots&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>true</literal> です。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
    <tip xml:id="ay.partitioning.skip_devices">
     <title>ドライブを読み飛ばす設定について</title>
     <para>&ay; の制御ファイル内で &lt;device&gt; 項目を指定せず、 &ay; の自動デバイス判断に任せたい場合、その判断基準を設定することができます。通常は適切なデバイスのうち最初のデバイスを使用するようになっていますが、下記のように設定することで、条件に合致するデバイスを除外できるようになります:</para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;
    &lt;skip_list config:type="list"&gt;
      &lt;listentry&gt;
        &lt;!-- usb-storage ドライバを使用しているデバイスを読み飛ばす --&gt;
        &lt;skip_key&gt;driver&lt;/skip_key&gt;
        &lt;skip_value&gt;usb-storage&lt;/skip_value&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;!-- 1GB より小さいデバイスを読み飛ばす --&gt;
        &lt;skip_key&gt;size_k&lt;/skip_key&gt;
        &lt;skip_value&gt;1048576&lt;/skip_value&gt;
        &lt;skip_if_less_than config:type="boolean"&gt;true&lt;/skip_if_less_than&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;!-- 100GB より大きいデバイスを読み飛ばす --&gt;
        &lt;skip_key&gt;size_k&lt;/skip_key&gt;
        &lt;skip_value&gt;104857600&lt;/skip_value&gt;
        &lt;skip_if_more_than config:type="boolean"&gt;true&lt;/skip_if_more_than&gt;
      &lt;/listentry&gt;
    &lt;/skip_list&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     <para>&lt;skip_key&gt; で設定できる値の一覧について、詳しくはインストール済みのシステムで <command>yast2 ayast_probe</command> を実行してください。</para>
    </tip>
   </sect2>

   <sect2 xml:id="ay.partition_configuration">
    <title>パーティションの設定</title>
    <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;drive&gt;
  &lt;partitions config:type="list"&gt;
    &lt;partition&gt;
      ...
    &lt;/partition&gt;
  &lt;/partitions&gt;
&lt;/drive&gt;</screen>
    <informaltable>
     <tgroup cols="3">
      <colspec colwidth="1*"/>
      <colspec colwidth="3*"/>
      <colspec colwidth="2*"/>
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>create</literal></para>
        </entry>
        <entry>
         <para>このパーティションもしくは論理ボリュームを作成しなければならない場合や、既に存在しているような場合に指定します。</para>
<screen>&lt;create config:type="boolean" &gt;false&lt;/create&gt;</screen>
        </entry>
        <entry>
         <para><literal>false</literal> に設定した場合、 &ay; に対して使用すべきデバイスを指示するため、 <literal>partition_nr</literal> , <literal>lv_name</literal>, <literal>uuid</literal> のいずれかを指定する必要があります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>crypt_fs</literal></para>
        </entry>
        <entry>
         <para>パーティションを暗号化するかどうかを指定します。</para>
<screen>&lt;crypt_fs config:type="boolean"&gt;false&lt;/crypt_fs&gt;</screen>
        </entry>
        <entry>
         <para>既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>crypt_key</literal></para>
        </entry>
        <entry>
         <para>暗号鍵を指定します。</para>
<screen>&lt;crypt_key&gt;xxxxxxxx&lt;/crypt_key&gt;</screen>
        </entry>
        <entry>
         <para><literal>crypt_fs</literal> を <literal>true</literal> に設定した場合にのみ指定する必要があります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>mount</literal></para>
        </entry>
        <entry>
         <para>このパーティションのマウントポイントを指定します。</para>
<screen>&lt;mount&gt;/&lt;/mount&gt;
&lt;mount&gt;swap&lt;/mount&gt;</screen>
        </entry>
        <entry>
         <para>少なくとも 1 つのルートパーティション (/) とスワップパーティションを設定する必要があります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>fstopt</literal></para>
        </entry>
        <entry>
         <para>このパーティションのマウントオプションを指定します。</para>
<screen>&lt;fstopt&gt;
  ro,noatime,user,data=ordered,acl,user_xattr
&lt;/fstopt&gt;</screen>
        </entry>
        <entry>
         <para>指定可能なマウントオプションについて、詳しくは <command>man mount</command> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>label</literal></para>
        </entry>
        <entry>
         <para>パーティションのラベルを指定します (後述の <literal>mountby</literal> パラメータを使用する場合に有用です) 。</para>
<screen>&lt;label&gt;mydata&lt;/label&gt;</screen>
        </entry>
        <entry>
         <para>例については <command>man e2label</command> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>uuid</literal></para>
        </entry>
        <entry>
         <para>このパーティションの UUID を指定します (後述の <literal>mountby</literal> パラメータを使用する場合にのみ有用です) 。</para>
<screen>&lt;uuid
&gt;1b4e28ba-2fa1-11d2-883f-b9a761bde3fb&lt;/uuid&gt;</screen>
        </entry>
        <entry>
         <para>詳しくは <command>man uuidgen</command> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>size</literal></para>
        </entry>
        <entry>
         <para>4G, 4500M などのように、パーティションのサイズを指定します。 /boot パーティションとスワップパーティションに対しては、 <literal>auto</literal> を指定することもできます。この場合、 &ay; 側で適切なサイズを設定します。また、いずれか 1 つのパーティションに対して <literal>max</literal> を指定すると、残りの領域全てを使用することができるようになります。</para>
         <para>サイズは割合で設定することもできます。たとえば 10% と指定すると、ハードディスク全体もしくはボリュームグループの 10% 分を使用することができます。必要に応じて auto, max, サイズ指定, 割合を組み合わせて使用することもできます。</para>
<screen>&lt;size&gt;10G&lt;/size&gt;</screen>
        </entry>
        <entry>
         <para>&productname; 15 以降では、全ての値 (<literal>auto</literal> と <literal>max</literal> を含む) をパーティションのサイズ変更時にも使用できるようになっています。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>format</literal></para>
        </entry>
        <entry>
         <para>&ay; 側でパーティションをフォーマットするかどうかを指定します。</para>
<screen>&lt;format config:type="boolean"&gt;false&lt;/format&gt;</screen>
        </entry>
        <entry>
         <para><literal>create</literal> を <literal>true</literal> に設定した場合は、この値についても <literal>true</literal> を設定しておいたほうが良いでしょう。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>file system</literal></para>
        </entry>
        <entry>
         <para>このパーティションで使用するファイルシステムを指定します:</para>
         <itemizedlist mark="bullet" spacing="normal">
          <listitem>
           <para><literal>btrfs</literal></para>
          </listitem>
          <listitem>
           <para><literal>ext2</literal></para>
          </listitem>
          <listitem>
           <para><literal>ext3</literal></para>
          </listitem>
          <listitem>
           <para><literal>ext4</literal></para>
          </listitem>
          <listitem>
           <para><literal>fat</literal></para>
          </listitem>
          <listitem>
           <para><literal>xfs</literal></para>
          </listitem>
          <listitem>
           <para><literal>swap</literal></para>
          </listitem>
         </itemizedlist>
<screen>&lt;filesystem config:type="symbol"
&gt;ext3&lt;/filesystem&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ルートパーティションの場合、既定値は <literal>btrfs</literal> に、データパーティションの場合、既定値は <literal>xfs</literal> になります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>mkfs_options</literal></para>
        </entry>
        <entry>
         <para>mkfs コマンドを実行する際のオプション文字列を指定します。</para>
<screen>&lt;mkfs_options&gt;-I 128&lt;/mkfs_options&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。どうしても必要な場合にのみ設定してください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>partition_nr</literal></para>
        </entry>
        <entry>
         <para>このパーティションのパーティション番号を指定します。 <literal>create=false</literal> もしくは LVM を使用しようとしている場合、 <literal>partition_nr</literal> でパーティションの番号を指定することができます。なお、 &ay; に対してプライマリパーティションを強制的に作成させたい場合は、 5 未満の数値を指定してください。</para>
<screen>&lt;partition_nr config:type="integer"
&gt;2&lt;/partition_nr&gt;</screen>
        </entry>
        <entry>
         <para>通常は 1 から 4 までがプライマリパーティションに、 5 以上が論理パーティションになります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>partition_id</literal></para>
        </entry>
        <entry>
         <para><literal>partition_id</literal> ではパーティションの ID を設定します。 Linux パーティションでは 130 、スワップパーティションでは 131 が自動的に設定されますが、それ以外の ID を設定したい場合は、これで設定を行なってください。</para>
<screen>&lt;partition_id config:type="integer"
&gt;131&lt;/partition_id&gt;</screen>
         <para>設定可能な値は下記のとおりです:</para>
         <simplelist>
          <member>スワップ: <literal>130</literal></member>
          <member>Linux: <literal>131</literal></member>
          <member>LVM: <literal>142</literal></member>
          <member>MD RAID: <literal>253</literal></member>
          <member>EFI パーティション: <literal>259</literal></member>
         </simplelist>
        </entry>
        <entry>
         <para>既定では、 Linux パーティションに対しては <literal>131</literal> が、スワップパーティションに対しては <literal>130</literal> が設定されます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>partition_type</literal></para>
        </entry>
        <entry>
         <para>パーティションテーブルに <literal>msdos</literal> 形式を使用している場合、この要素でパーティションの種類を設定することができます。値には <literal>primary</literal> (プライマリパーティション) もしくは <literal>logical</literal> (論理パーティション) のいずれかを指定します。 <literal>gpt</literal> パーティションテーブルを使用している場合、このような区別はありませんので、値を設定しても無視されます。</para>
<screen>&lt;partition_type&gt;primary&lt;/partition_type&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。 <literal>primary</literal> (既定値) もしくは <literal>logical</literal> のいずれかを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>mountby</literal></para>
        </entry>
        <entry>
         <para>パーティション番号の代わりに、 <literal>device</literal> (デバイス), <literal>label</literal> (ラベル), <literal>uuid</literal> (UUID), <literal>path</literal> (udev パス), <literal>id</literal> (udev ID) などでパーティションをマウントするよう設定することができます。</para>
<screen>&lt;mountby config:type="symbol"
&gt;label&lt;/mountby&gt;</screen>
        </entry>
        <entry>
         <para>上述の <literal>label</literal> と <literal>uuid</literal> の説明をお読みください。既定値は &yast; 側で規定されていますが、通常は <literal>id</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>subvolumes</literal></para>
        </entry>
        <entry>
         <para>btrfs のファイルシステムで作成するサブボリュームの一覧を指定します。これは btrfs を使用する場合にのみ意味のある項目です。詳しくは <xref linkend="ay.btrfs_subvolumes"/> をお読みください。</para>
<screen>&lt;subvolumes config:type="list"&gt;
  &lt;path&gt;tmp&lt;/path&gt;
  &lt;path&gt;opt&lt;/path&gt;
  &lt;path&gt;srv&lt;/path&gt;
  &lt;path&gt;var/crash&lt;/path&gt;
  &lt;path&gt;var/lock&lt;/path&gt;
  &lt;path&gt;var/run&lt;/path&gt;
  &lt;path&gt;var/tmp&lt;/path&gt;
  &lt;path&gt;var/spool&lt;/path&gt;
  ...
&lt;/subvolumes&gt;</screen>
        </entry>
        <entry>
         <para>パーティションの設定内に <tag>subvolumes</tag> セクションが存在しない場合、 &ay; は指定したマウントポイント内に、既定のサブボリュームセットを作成します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>create_subvolumes</literal></para>
        </entry>
        <entry>
         <para>btrfs のサブボリュームを作成するかどうかを指定します。</para>
        </entry>
        <entry>
         <para>既定値は <literal>true</literal> です。 <literal>false</literal> に設定した場合、サブボリュームは作成されません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>subvolumes_prefix</literal></para>
        </entry>
        <entry>
         <para>btrfs のサブボリュームに設定するプレフィクス (前置) 名を指定します。何もプレフィクスを指定したくない場合は、空の値を設定してください:</para>
         <screen>&lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;</screen>
        </entry>
        <entry>
         <para>既定では <literal>@</literal> が設定されています。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>lv_name</literal></para>
        </entry>
        <entry>
         <para>このパーティションをボリュームグループ内の論理ボリュームに配置する場合、ここで論理ボリュームの名前を指定します (<literal>is_lvm_vg</literal> もお読みください) 。</para>
<screen>&lt;lv_name&gt;opt_lv&lt;/lv_name&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>stripes</literal></para>
        </entry>
        <entry>
         <para>LVM のストライピングを設定するための整数です。どれだけの数のデバイスにデータを分散させるのかを指定します。</para>
<screen>&lt;stripes config:type="integer"&gt;2&lt;/stripes&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>stripesize</literal></para>
        </entry>
        <entry>
         <para>各ブロックのサイズを KB 単位で指定します。</para>
<screen>&lt;stripesize config:type="integer"
&gt;4&lt;/stripesize&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>lvm_group</literal></para>
        </entry>
        <entry>
         <para>このパーティションが LVM のボリュームグループの一部として使用されている物理パーティションである場合は、ここでボリュームグループの名前を指定する必要があります。</para>
<screen>&lt;lvm_group&gt;system&lt;/lvm_group&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>pool</literal></para>
        </entry>
        <entry>
         <para>LVM 論理ボリュームが LVM の thin プール内に存在すべきである場合は、 <literal>pool</literal> の値を <literal>true</literal> にしなければなりません。</para>
<screen>&lt;pool config:type="boolean"&gt;false&lt;/pool&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>used_pool</literal></para>
        </entry>
        <entry>
         <para>この thin 論理ボリュームに対して、データストアとして使用する LVM thin プールの名前を指定します。ここに何らかの値を設定すると、このボリュームは thin 論理ボリュームとして使用されるようになります。</para>
<screen>&lt;used_pool&gt;my_thin_pool&lt;/used_pool&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>raid_name</literal></para>
        </entry>
        <entry>
         <para>この物理ボリュームが RAID の一部である場合は、ここで RAID の名前を指定します。</para>
<screen>&lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>raid_options</literal></para>
        </entry>
        <entry>
         <para>RAID オプションを指定します (説明欄もお読みください) 。</para>
<screen>&lt;raid_options&gt;...&lt;/raid_options&gt;</screen>
        </entry>
        <entry>
         <para><literal>partition</literal> 内に RAID のオプションを設定するのは非推奨になっています。詳しくは <xref linkend="ay.partition_sw_raid"/> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>bcache_backing_for</para>
        </entry>
        <entry>
         <para>このデバイスを <emphasis>&bcache; のバッキングデバイス</emphasis> として使用する場合は、ここで &bcache; のデバイス名を指定します。</para>
<screen>&lt;bcache_backing_for&gt;/dev/bcache0&lt;/bcache_backing_for&gt;</screen>
        </entry>
        <entry>
         <para>詳しくは <xref linkend="ay.partition_bcache"/> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>bcache_caching_for</para>
        </entry>
        <entry>
         <para>このデバイスを <emphasis>&bcache; のキャッシュデバイス</emphasis> として使用する場合は、ここで &bcache; のデバイス名を指定します。</para>
<screen>&lt;bcache_caching_for config:type="list"&gt;
  &lt;listentry&gt;/dev/bcache0&lt;/listentry&gt;
&lt;/bcache_caching_for&gt;</screen>
        </entry>
        <entry>
         <para>詳しくは <xref linkend="ay.partition_bcache"/> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>resize</literal></para>
        </entry>
        <entry>
         <para>既存のパーティションのサイズを変更すべきである場合、この値は <literal>true</literal> にします。この場合、 &ay; に対してデバイスの再利用 (<literal>create</literal>) を指定し、 <literal>size</literal> の値を設定する必要があります。</para>
<screen>&lt;resize config:type="boolean"&gt;false&lt;/resize&gt;</screen>
        </entry>
        <entry>
         <para>&productname; 15 およびそれ以降では、サイズ変更は物理ディスクパーティションと LVM ボリュームの両方に対して動作するようになっています。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <important>
     <title>自動的な起動パーティションの作成について</title>
     <para>&ay; がシステムの起動にあたって起動用のパーティションが必要であると判断すると、プロファイル内にそれが設定されていなくても、 &ay; が自動的にパーティションを追加します。</para>
     <para>ただし、何らかの理由で現在のパーティション配置に起動用のパーティションが設定できない場合、 &ay; は警告を表示したあと、そのままインストールを続行します。</para>
    </important>
   </sect2>

   <sect2 xml:id="ay.btrfs_subvolumes">
     <title>btrfs サブボリューム</title>
     <para><xref linkend="ay.partition_configuration"/> で説明しているとおり、それぞれの btrfs ファイルシステムに対して、必要なサブボリュームを定義することができます。最もシンプルな形態では、下記のようになります:</para>

<screen>&lt;subvolumes config:type="list"&gt;
  &lt;path&gt;tmp&lt;/path&gt;
  &lt;path&gt;opt&lt;/path&gt;
  &lt;path&gt;srv&lt;/path&gt;
  &lt;path&gt;var/crash&lt;/path&gt;
  &lt;path&gt;var/lock&lt;/path&gt;
  &lt;path&gt;var/run&lt;/path&gt;
  &lt;path&gt;var/tmp&lt;/path&gt;
  &lt;path&gt;var/spool&lt;/path&gt;
&lt;/subvolumes&gt;</screen>

     <para>&ay; では指定したサブボリュームに対して、 copy-on-write の無効化を設定することもできます。この場合、少し複雑な書式で設定する必要があります:</para>

<screen>&lt;subvolumes config:type="list"&gt;
&lt;listentry&gt;tmp&lt;/listentry&gt;
&lt;listentry&gt;opt&lt;/listentry&gt;
&lt;listentry&gt;srv&lt;/listentry&gt;
&lt;listentry&gt;
  &lt;path&gt;var/lib/pgsql&lt;/path&gt;
  &lt;copy_on_write config:type="boolean"&gt;false&lt;copy_on_write&gt;
&lt;/listentry&gt;
&lt;/subvolumes&gt;</screen>

     <para>ディストリビューション側で既定のサブボリュームが設定されている場合 (たとえば &productname; では <filename>@</filename>) 、この既定のサブボリュームの名前がこの一覧の中に自動的に追加されます。このような動作を無効化したい場合は、下記のようにして <literal>subvolumes_prefix</literal> を設定してください。</para>

<screen>&lt;subvolumes_prefix&gt;&lt;![CDATA[]]&gt;&lt;/subvolumes_prefix&gt;</screen>
   </sect2>

   <sect2 xml:id="ay.use_whole_disk">
    <title>ディスク全体の使用</title>

    <para>&ay; では、 <xref linkend="CreateProfile.Partitioning.config"/> で説明している <literal>disklabel</literal> の値を <literal>none</literal> に設定することで、パーティションを作成せずにディスク全体を使用することができます。このような場合、 <literal>drive</literal> 内の最初の <literal>partition</literal> 内の設定が、ディスク全体に対して適用されるようになります。</para>

    <para>下記の例では、 2 番目のディスク ( <literal>/dev/sdb</literal> ) 全体を <literal>/home</literal> のファイルシステムとして使用しています。</para>

    <example>
     <title>ディスク全体をファイルシステムとして使用する設定</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;</screen>
    </example>

    <para>これに加えて、ディスク全体を LVM 物理ボリュームやソフトウエア RAID のメンバーとして使用することもできます。 LVM やソフトウエア RAID に関する詳細は、 <xref linkend="ay.partition_lvm"/> および <xref linkend="ay.partition_sw_raid"/> をお読みください。</para>
   </sect2>

   <sect2 xml:id="ay.auto_partitioning">
    <title>自動的なパーティション設定</title>
    <para>パーティションを自動設定させる場合、パーティションのサイズとマウントポイントだけを設定すれば、それ以外のデータは (制御ファイル内に特に指示がない限り) 、インストール時に自動計算させることができます。</para>
    <para>指定したドライブにルートパーティションを作成する必要があるにもかかわらず、何もパーティションの定義を行なっていない場合、下記のようなパーティションを自動的に作成します:</para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para><filename>/boot</filename></para>
      <para><filename>/boot</filename> パーティションのサイズは、インストール先のシステムのアーキテクチャに従って決定されます。</para>
     </listitem>
     <listitem>
      <para><filename>swap</filename></para>
      <para>スワップパーティションのサイズは、インストール先のシステムに搭載されたメモリの量に従って決定されます。</para>
     </listitem>
     <listitem>
      <para><filename>/</filename> (ルートパーティション)</para>
      <para>ルートパーティションのサイズは、 <filename>swap</filename> と <filename>/boot</filename> の各パーティションを作成した後の残りの容量になります。</para>
     </listitem>
    </itemizedlist>
    <para>ドライブ内の当初のパーティション設定状態に従って、それぞれ下記のような方針で既定のパーティション設定が決定されます:</para>
    <variablelist>
     <varlistentry>
      <term>空き領域の使用</term>
      <listitem>
       <para>対象のドライブ内に既にパーティションが存在する場合、ドライブ内の空き領域に対して新しいパーティションを作成することができます。これはスワップ領域に加え、選択したパッケージをインストールするのに十分な容量が必要となります。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>利用可能な全領域の再利用</term>
      <listitem>
       <para>既存の全てのパーティション (Linux および非 Linux) を削除する場合に使用します。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>利用可能な全 Linux パーティションの再利用</term>
      <listitem>
       <para>このオプションを選択すると、既存の全ての Linux パーティションを削除します。その他のパーティション (例: Windows パーティション) は何も変更されません。ただし、このオプションは、 Linux パーティションがデバイスの末尾側に存在する場合にのみ動作します。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>指定したパーティションのみの再利用</term>
      <listitem>
       <para>このオプションを選択すると、削除するパーティションを指定することができます。この場合、後ろのパーティションから削除を行なってください。</para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para>パーティションの再設定は、選択したパーティションが隣同士に存在し、かつデバイスの後ろ側に存在する場合にのみ動作します。</para>
    <important>
     <title>データ損失への警告</title>
     <para><literal>use</literal> プロパティに設定した値に従って、既存のデータとパーティションの取り扱いが決まります。このプロパティに <literal>all</literal> を指定すると、ディスク全体が消去されます。いずれかのパーティション内に重要なデータが含まれる場合は、あらかじめバックアップを採取するものとし、 <literal>confirm</literal> を指定して確認を行なうようにしてください。確認を行なうように設定しないと、何もメッセージが表示されないままパーティションが削除されてしまいます。</para>
    </important>
    <para>インストール先のシステムに複数のドライブが存在する場合、ドライブはデバイス名で識別することができますので、それぞれに対してパーティション方式を設定してください。</para>
    <para>パーティションのサイズはギガバイト／メガバイト単位で指定することができるほか、 <literal>auto</literal> や <literal>max</literal> を指定して、サイズを自動設定することもできます。 <literal>max</literal> を指定すると、ドライブ内で利用可能な全ての領域を使用しますので、ドライブ内の最後のパーティションに対して設定すべき値になります。また <literal>swap</literal> (スワップ) や <literal>boot</literal> (起動) のパーティションに対して <literal>auto</literal> を設定すると、システムに搭載されたメモリ量やアーキテクチャの種類に従って、サイズが自動設定されます。</para>
    <para>サイズを固定値で指定する場合、下記のように指定します:</para>
    <para><literal>1GB</literal> , <literal>1G</literal> , <literal>1000MB</literal> , <literal>1000M</literal> はいずれも、 1 ギガバイトのパーティションサイズを意味します。</para>
    <example>
     <title>自動的なパーティション設定</title>
     <para>下記はドライブが 1 台だけ搭載されたシステムでの例で、事前には何もパーティションを作成していないため、指定されたパーティションプランに従って自動的にパーティションを作成するように指定しています。なお、何もドライブを指定しない場合、ドライブは自動的に検出されます。</para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
    <para>さらに詳しい例では、既存のパーティションが存在する場合や複数のドライブが存在する場合の処理方法について示しています。</para>
    <example>
     <title>詳細な自動パーティション設定</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;10G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;size&gt;1G&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;use&gt;free&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
        &lt;mount&gt;/data1&lt;/mount&gt;
        &lt;size&gt;15G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;mount&gt;/data2&lt;/mount&gt;
        &lt;size&gt;auto&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
   </sect2>

   <sect2 xml:id="ay.partition_advanced">
    <title>高度なパーティション設定</title>
    <para><remark role="fixme">Add a short description</remark></para>
    <sect3 xml:id="ay.partition_advanced.wipe">
     <title>パーティションテーブルの消去</title>
     <para>通常は &ay; が 1 つずつパーティションを削除していくことから、この設定を行なう必要はありません。ですが、 &ay; に対してパーティションを個別に削除するのではなく、敢えて新しいパーティションテーブルを作成させたい場合、下記のような設定が必要になります。</para>
     <para>具体的には、 <literal>drive</literal> セクション内に下記を追加してください:</para>
<screen>&lt;initialize config:type="boolean"&gt;true&lt;/initialize&gt;</screen>
     <para>このような設定を行なうことで、 &ay; は既存のパーティションの分析やパーティションプランの作成を行なう前に、パーティションテーブルの消去を行なうようになります。この設定を行なうと、ご存じのとおり既存のパーティション内にある全てのデータは消去され、保持できなくなります。</para>
    </sect3>
    <sect3 xml:id="ay.partition_advanced.mount">
     <title>マウントオプション</title>
     <para>既定では、マウントすべきファイルシステムは <filename>/etc/fstab</filename> 内にデバイス名で指定されます。この指定方法は UUID やボリュームラベルに変更することもできます。ただし、全てのファイルシステムが UUID やボリュームラベルでのマウントに対応しているわけではないことに注意してください。パーティションのマウント方法を指定するには、 <literal>symbol</literal> 型で指定する <literal>mountby</literal> プロパティを設定してください。設定可能な値は下記のとおりです:</para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para><literal>device</literal> (既定値)</para>
      </listitem>
      <listitem>
       <para><literal>label</literal></para>
      </listitem>
      <listitem>
       <para><literal>UUID</literal></para>
      </listitem>
     </itemizedlist>
     <para>ラベルを利用してパーティションをマウントする場合、 <literal>label</literal> プロパティで指定した名前をボリュームラベルとして使用します。</para>
     <para>また、 <filename>/etc/fstab</filename> の 4 番目の列に指定することのできる、マウントオプションを追加することもできます。複数のオプションはカンマで区切ります。指定可能な値は下記のとおりです:</para>
     <variablelist>
      <varlistentry>
       <term>読み込み専用でマウント ( <literal>ro</literal> )</term>
       <listitem>
        <para>ファイルシステムに対して書き込みを行なうことができなくなります。既定値は <literal>false</literal> です。</para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>アクセス日時を更新しない ( <literal>noatime</literal> )</term>
       <listitem>
        <para>ファイルが読み込まれた際、アクセス日時を更新しないようにします。既定値は <literal>false</literal> です。</para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>ユーザにマウントを許可 ( <literal>user</literal> )</term>
       <listitem>
        <para>一般ユーザからファイルシステムをマウントできるようにします。既定値は <literal>false</literal> です。</para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>データジャーナリングモード ( <literal>ordered</literal> , <literal>journal</literal> , <literal>writeback</literal> )</term>
       <listitem>
        <variablelist>
         <varlistentry>
          <term><literal>journal</literal></term>
          <listitem>
           <para>データを書き込む際、実際のファイルシステムに書き込む前にジャーナルに書き込むようにします。</para>
          </listitem>
         </varlistentry>
         <varlistentry>
          <term><literal>ordered</literal></term>
          <listitem>
           <para>メタデータをジャーナルに書き込む前に、全てのデータを直接実際のファイルシステムに書き込みます。</para>
          </listitem>
         </varlistentry>
         <varlistentry>
          <term><literal>writeback</literal></term>
          <listitem>
           <para>データの書き込み順序を維持しません。</para>
          </listitem>
         </varlistentry>
        </variablelist>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>アクセス制御リスト ( <literal>acl</literal> )</term>
       <listitem>
        <para>ファイルシステムに対してアクセス制御リストを有効化します。</para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>拡張ユーザ属性 ( <literal>user_xattr</literal> )</term>
       <listitem>
        <para>ファイルシステムに対して拡張ユーザ属性を使用できるようにします。</para>
       </listitem>
      </varlistentry>
     </variablelist>
     <example>
      <title>マウントオプション</title>
<screen>&lt;partitions config:type="list"&gt;
  &lt;partition&gt;
    &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
    &lt;format config:type="boolean"&gt;true&lt;/format&gt;
    &lt;fstopt&gt;ro,noatime,user,data=ordered,acl,user_xattr&lt;/fstopt&gt;
    &lt;mount&gt;/local&lt;/mount&gt;
    &lt;mountby config:type="symbol"&gt;uuid&lt;/mountby&gt;
    &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
    &lt;size&gt;10G&lt;/size&gt;
  &lt;/partition&gt;
&lt;/partitions&gt;
</screen>
     </example>

    <note>
     <title>ファイルシステムごとに対応するオプションが異なる件について</title>
     <para>ファイルシステムの種類が異なると、使用できるオプションもこことなります。オプションを設定する倍は、あらかじめ対応するドキュメンテーションをお読みください。</para>
    </note>
    </sect3>
    <sect3 xml:id="ay.partition_advanced.keep">
     <title>特定のパーティションの維持</title>
     <para>状況によっては、特定のパーティションのみをフォーマットして、それ以外のパーティションを何もせずにそのままにしておきたいような場合があります。たとえば異なる Linux インストールを共存させたいような場合や、他のオペレーティングシステムをインストールしたままにしておきたいような場合、これらのパーティションは消去せずに維持したままにすることができます。もちろんパーティション内のデータについても維持することができます。</para>
     <para>このような構成を作成する場合、インストール先のシステムとそのハードディスクに対して、さまざまな考慮を行なう必要があります。構成内容にもよりますが、インストール先のハードディスクのパーティションテーブルとパーティションの ID 、サイズと番号をそれぞれ知っておく必要があります。これらのデータをもとにして、 &ay; に対して特定のパーティションの維持を設定し、必要であれば新しいパーティションの作成を行なうことになります。</para>
     <para>下記の例では、パーティション 1,2,5 をそれぞれ維持し、パーティション 6 を削除して新しい 2 つのパーティションを作成しています。また、パーティション 2 以外を全てフォーマットして使用しています。 <remark>emap 2011-11-05: Not the best example for the scenarios two paras up with coexisting operating systems or data partitions. Who'd want to format those?</remark></para>
     <example>
      <title>パーティションの維持</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdc&lt;/device&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/&lt;/mount&gt;
          &lt;partition_nr config:type="integer"&gt;1&lt;/partition_nr&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;false&lt;/format&gt;
          &lt;partition_nr config:type="integer"&gt;2&lt;/partition_nr&gt;
          &lt;mount&gt;/space&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;create config:type="boolean"&gt;false&lt;/create&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
          &lt;partition_nr config:type="integer"&gt;5&lt;/partition_nr&gt;
          &lt;mount&gt;swap&lt;/mount&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/space2&lt;/mount&gt;
          &lt;size&gt;5G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;format config:type="boolean"&gt;true&lt;/format&gt;
          &lt;mount&gt;/space3&lt;/mount&gt;
          &lt;size&gt;max&lt;/size&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
    &lt;use&gt;6&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     </example>
     <para>上記の例では、既存のパーティションテーブルの内容のほか、維持すべきパーティションの番号についても明示的に指定しています。ただし、さまざまな種類のハードディスクや設定が混在しているような環境の場合、これらを明示的に指定することができない場合もあります。下記のシナリオでは、非 Linux OS のシステムと Linux インストール用の専用領域を確保する構成を示しています。</para>
     <figure xml:id="partitioning-keep1">
      <title>パーティションの維持</title>
      <mediaobject>
       <imageobject role="html">
        <imagedata fileref="partitioning-keep1.png"/>
       </imageobject>
       <imageobject role="fo">
        <imagedata fileref="partitioning-keep1.png" width="75%"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>このシナリオでは、 <xref linkend="partitioning-keep1"/> の図に示しているとおり、 &ay; では新しいパーティションを作成しないように設定します。その代わり、システム内に存在する特定の種類のパーティションを検出し、制御ファイルに書かれたパーティション設定プランに従ってそれらを使用するように構成しています。この場合、パーティションの番号は全く指定しておらず、マウントポイントとパーティションの種類のみを指定しています (たとえばファイルシステムのオプションや暗号化、ファイルシステムの種類などの追加データを設定することもできます) 。</para>
     <example>
      <title>維持すべきパーティションの自動検出</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;false&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;false&lt;/create&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;partition_id config:type="integer"&gt;130&lt;/partition_id&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
     </example>

     <note>
      <title>暗号化されたデバイスの維持について</title>
      <para>&ay; がストレージデバイスを検出する時点では、プロファイル内のパーティション設定セクションは解釈されていません。そのため、デバイスの暗号化を解除するために、どの鍵を使用すべきなのかを判別できません。たとえば、複数の暗号鍵を使用して暗号化を行なっている場合がそれに該当します。このような問題を解決するため、 &ay; では設定されている全ての鍵を利用して、デバイスの暗号化解除を試みるようになっています。</para>
     </note>
    </sect3>
   </sect2>

   <sect2 xml:id="ay.partition_lvm">
    <title>論理ボリュームマネージャ (Logical Volume Manager (LVM))</title>
    <para>LVM を設定するには、上述の通常のパーティション作成を設定して、物理ボリュームを作成しておく必要があります。</para>
    <example>
     <title>LVM 物理ボリュームの作成</title>
     <para>下記の例は、 <literal>partitioning</literal> リソースで LVM 向けのパーティションを準備する場合の例です。この例では <filename>/dev/sda1</filename> を作成したあとフォーマットを行なわず、 <literal>LVM</literal> の種類を設定し、ボリュームグループ <literal>system</literal> に追加を行ないます。なお、パーティションのサイズはドライブ内の全空き領域分になります。</para>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;lvm_group&gt;system&lt;/lvm_group&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;partition_id config:type="integer"&gt;142&lt;/partition_id&gt;
        &lt;partition_nr config:type="integer"&gt;1&lt;/partition_nr&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>
    <example>
     <title>LVM 論理ボリューム</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;lvm_group&gt;system&lt;/lvm_group&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/system&lt;/device&gt;
      &lt;is_lvm_vg config:type="boolean"&gt;true&lt;/is_lvm_vg&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;user_lv&lt;/lv_name&gt;
          &lt;mount&gt;/usr&lt;/mount&gt;
          &lt;size&gt;15G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;opt_lv&lt;/lv_name&gt;
          &lt;mount&gt;/opt&lt;/mount&gt;
          &lt;size&gt;10G&lt;/size&gt;
        &lt;/partition&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
          &lt;lv_name&gt;var_lv&lt;/lv_name&gt;
          &lt;mount&gt;/var&lt;/mount&gt;
          &lt;size&gt;1G&lt;/size&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
      &lt;pesize&gt;4M&lt;/pesize&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
    </example>
    <para>論理ボリュームに対しても <literal>size</literal> に <literal>max</literal> を指定することができます。もちろん、いずれか 1 つ (!) の論理ボリュームにしか指定できません。また、 1 つのボリュームグループ内で 2 つの論理ボリュームを <literal>max</literal> に設定することもできません。</para>
   </sect2>

   <sect2 xml:id="ay.partition_sw_raid">
    <title>ソフトウエア RAID</title>
    <para>ソフトウエア RAID デバイスに対するサポートは、 &productname; &product-ga; SP&product-sp; で大幅に改善されています。</para>
     <para>必要であれば、後方互換性維持の目的で残されているソフトウエア RAID の古い設定方法を利用することもできます。詳しくは <xref linkend="ay.partition_sw_raid_deprecated"/> をお読みください。</para>
     <para>&ay; を使用することで、ソフトウエア RAID デバイスを作成したり構成したりすることができます。対応する RAID レベルは下記のとおりです:</para>
    <variablelist>
     <varlistentry>
      <term>RAID 0</term>
      <listitem>
       <para>このレベルではディスク性能の強化が行なわれますが、冗長性は提供 <emphasis>されません</emphasis> 。いずれか 1 台のディスクがクラッシュすると、データの復元は不可能になります。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>RAID 1</term>
      <listitem>
       <para>このレベルでは最大限の冗長性を提供します。 2 台以上のディスクを使用することができます。このレベルでは、全てのディスクに対して同じデータが書き込まれます。いずれか 1 台のディスクが正しく動作している限り、データが失われることはありません。この RAID レベルを使用する場合、使用するパーティションはほぼ同じサイズである必要があります。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>RAID 5</term>
      <listitem>
       <para>このレベルでは多数のディスクの管理と冗長性の両方を提供します。このレベルを使用するには、 3 台以上のディスクが必要です。いずれか 1 台のディスクが壊れても、データが失われることはありませんが、 2 台のディスクが同時に壊れてしまうと、データの復元は不可能になります。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>マルチパス</term>
      <listitem>
       <para>このモードでは、複数のコントローラを介して同じ物理デバイスにアクセスを行ないます。これはコントローラカードの障害に対して冗長性を提供するものです。このモードを使用するには、少なくとも 2 枚のカードが必要になります。</para>
      </listitem>
     </varlistentry>
    </variablelist>
    <para>LVM と同様に、 &ay; プロファイル内でのソフトウエア RAID 定義は、 2 つの部品から構成されています:</para>

    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>どのディスクやパーティションを RAID のメンバーとして使用するのかの設定。 RAID メンバーとしての設定は、各デバイス要素内で <literal>raid_name</literal> を設定して行ないます。</para>
     </listitem>
     <listitem>
      <para><literal>drive</literal> セクションによる RAID そのものの定義。</para>
     </listitem>
    </itemizedlist>

    <para>下記の例は、 1 台目のディスクに存在するパーティションと、 2 台目のディスクに存在するパーティションを RAID のメンバーとして、 RAID1 を構成する場合の例です:</para>
    <example>
     <title>RAID1 設定</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;size&gt;20G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;none&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;raid_name&gt;/dev/md/0&lt;/raid_name&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/md/0&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/home&lt;/mount&gt;
        &lt;size&gt;40G&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;/srv&lt;/mount&gt;
        &lt;size&gt;10G&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;raid_options&gt;
      &lt;chunk_size&gt;4&lt;/chunk_size&gt;
      &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
      &lt;raid_type&gt;raid1&lt;/raid_type&gt;
    &lt;/raid_options&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>

    <para>ソフトウエア RAID 内にパーティションを作成したくない場合は、通常のディスクと同様に <literal>disklabel</literal> を <literal>none</literal> に設定してください。下記の例では、単純化のために RAID の <literal>drive</literal> セクションのみを示しています:</para>

    <example>
     <title>パーティションを使用しない RAID1</title>
<screen>&lt;drive&gt;
  &lt;device&gt;/dev/md/0&lt;/device&gt;
  &lt;disklabel&gt;none&lt;/disklabel&gt;
  &lt;partitions config:type="list"&gt;
    &lt;partition&gt;
      &lt;mount&gt;/home&lt;/mount&gt;
      &lt;size&gt;40G&lt;/size&gt;
    &lt;/partition&gt;
  &lt;/partitions&gt;
  &lt;raid_options&gt;
    &lt;chunk_size&gt;4&lt;/chunk_size&gt;
    &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
    &lt;raid_type&gt;raid1&lt;/raid_type&gt;
  &lt;/raid_options&gt;
  &lt;use&gt;all&lt;/use&gt;
&lt;/drive&gt;</screen>
    </example>

   <sect3 xml:id="ay.partition_sw_raid_deprecated">
    <title>古い書式の使用</title>
    <para>インストーラの自己更新機能が有効化されている場合、 &productname; 15 でソフトウエア RAID のパーティションを作成することができます。ただし、それ以前のバージョンではこのような仕組みには対応していないため、ソフトウエア RAID の定義が少し異なることになります。</para>

    <para>本章では、後方互換性のために提供されている古い形式の設定について説明しています。</para>

    <para>古い形式で RAID を設定する場合、下記の点に注意してください:</para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>RAID デバイスは必ず <filename>/dev/md</filename> になります。</para>
     </listitem>
     <listitem>
      <para><literal>partition_nr</literal> プロパティは、 MD デバイスの番号を判断するために使用します。たとえば <literal>partition_nr</literal> に 0 を設定すると、 <filename>/dev/md/0</filename> が設定されます。複数の <literal>partition</literal> セクションを設定すると、複数のソフトウエア RAID ( <filename>/dev/md/0</filename> , <filename>/dev/md/1</filename> ,...) を作成する意味になります。</para>
     </listitem>
     <listitem>
      <para>RAID 関連の全てのオプションは、 <literal>raid_options</literal> 内に含める必要があります。</para>
     </listitem>
    </itemizedlist>

    <example>
     <title>古い書式の RAID1 設定</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;partition_id config:type="integer"&gt;253&lt;/partition_id&gt;
        &lt;format config:type="boolean"&gt;false&lt;/format&gt;
        &lt;raid_name&gt;/dev/md0&lt;/raid_name&gt;
        &lt;raid_type&gt;raid1&lt;/raid_type&gt;
        &lt;size&gt;4G&lt;/size&gt;
      &lt;/partition&gt;

        &lt;!-- /dev/sda に配置する通常のパーティション設定 (例: /, swap)
                をここに記述します --&gt;

    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;false&lt;/format&gt;
        &lt;partition_id config:type="integer"&gt;253&lt;/partition_id&gt;
        &lt;raid_name&gt;/dev/md0&lt;/raid_name&gt;
        &lt;size&gt;4gb&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/md&lt;/device&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;ext4&lt;/filesystem&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;/space&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
        &lt;partition_nr config:type="integer"&gt;0&lt;/partition_nr&gt;
        &lt;raid_options&gt;
          &lt;chunk_size&gt;4&lt;/chunk_size&gt;
          &lt;parity_algorithm&gt;left_asymmetric&lt;/parity_algorithm&gt;
        &lt;/raid_options&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>
    </example>
   </sect3>

   <sect3 xml:id="ay.raid_configuration">
    <title>RAID オプション</title>
    <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
    <screen>&lt;partition&gt;
     &lt;raid_options&gt;
     ...
     &lt;/raid_options&gt;
     &lt;/partition&gt;</screen>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>chunk_size</literal></para>
        </entry>
        <entry>
         <para/>
         <screen>&lt;chunk_size&gt;4&lt;/chunk_size&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>parity_algorithm</literal></para>
        </entry>
        <entry>
         <para>設定可能な値は下記のとおりです:</para>
         <para><literal>left_asymmetric</literal> , <literal>left_symmetric</literal>, <literal>right_asymmetric</literal> , <literal>right_symmetric</literal> .</para>
         <para>RAID6 や RAID10 に対しては、下記の値を設定することができます:</para>
         <para><literal>parity_first</literal> , <literal>parity_last</literal> , <literal>left_asymmetric_6, left_symmetric_6</literal> , <literal>right_asymmetric_6</literal> , <literal>right_symmetric_6</literal> , <literal>parity_first_6</literal> , <literal>n2</literal> , <literal>o2</literal> , <literal>f2</literal> , <literal>n3</literal> , <literal>o3</literal> , <literal>f3</literal></para>
         <screen>&lt;parity_algorithm
          &gt;left_asymmetric&lt;/parity_algorithm&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>raid_type</literal></para>
        </entry>
        <entry>
         <para>値には <literal>raid0</literal> , <literal>raid1</literal> , <literal>raid5</literal> , <literal>raid6</literal> , <literal>raid10</literal> のいずれかを指定します。</para>
         <screen>&lt;raid_type&gt;raid1&lt;/raid_type&gt;</screen>
        </entry>
        <entry>
         <para>既定値は <literal>raid1</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>device_order</literal></para>
        </entry>
        <entry>
         <para>この一覧には、物理デバイスの設定順序を指定します:</para>
         <screen>&lt;device_order config:type="list"&gt;
          &lt;device&gt;/dev/sdb2&lt;/device&gt;
          &lt;device&gt;/dev/sda1&lt;/device&gt;
          ...
          &lt;/device_order&gt;</screen>
        </entry>
        <entry>
         <para>この設定は任意設定で、既定ではアルファベット順です。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect3>
  </sect2>

  <sect2 xml:id="ay.partition_bcache">
   <title>&bcache; の設定</title>
   <para>&bcache; は複数の高速なドライブを利用して、 1 つまたは複数の低速なドライブを高速化するための仕組みです。たとえば特定の高速なドライブをキャッシュとして使用し、巨大で遅いドライブの性能を改善したりすることができます。</para>

   <para>&productname; での bcache に関する詳細は、 <link xlink:href="https://www.suse.com/c/combine-the-performance-of-solid-state-drive-with-the-capacity-of-a-hard-drive-with-bcache-and-yast/"/> (英語) に書かれているブログの記事をお読みください。</para>

   <para>&bcache; のドライブを設定するには、 &ay; 側で下記のようなプロファイル設定が必要となります:</para>

   <itemizedlist>
    <listitem>
     <para>(遅いほうの) ブロックデバイスを <emphasis>バッキングデバイス</emphasis> として設定するには、 <literal>bcache_backing_for</literal> 要素を使用します。</para>
    </listitem>
    <listitem>
     <para>(早いほうの) ブロックデバイスを <emphasis>キャッシュデバイス</emphasis> して設定するには、 <literal>bcache_caching_for</literal> 要素を使用します。複数のドライブの速度を上げるために、 1 台のデバイスを使用するような設定も行なうことができます。</para>
    </listitem>
    <listitem>
     <para>&bcache; デバイスの配置方法を指定するには、 <literal>drive</literal> セクション内に <literal>type</literal> 要素が <literal>CT_BCACHE</literal> であるものを設定します。 &bcache; デバイス内には、パーティションを含めることもできます。</para>
    </listitem>
   </itemizedlist>

   <example>
    <title>&bcache; の定義</title>
<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;device&gt;/dev/sda&lt;/device&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;enable_snapshots config:type="boolean"&gt;true&lt;/enable_snapshots&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;btrfs&lt;/filesystem&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;create config:type="boolean"&gt;true&lt;/create&gt;
        &lt;size&gt;2GiB&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;

  &lt;drive&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;device&gt;/dev/sdb&lt;/device&gt;
    &lt;disklabel&gt;msdos&lt;/disklabel&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;!-- It can serve as caching device for several bcaches --&gt;
        &lt;bcache_caching_for config:type="list"&gt;
          &lt;listentry&gt;/dev/bcache0&lt;/listentry&gt;
        &lt;/bcache_caching_for&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;

  &lt;drive&gt;
    &lt;type config:type="symbol"&gt;CT_DISK&lt;/type&gt;
    &lt;device&gt;/dev/sdc&lt;/device&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;disklabel&gt;msdos&lt;/disklabel&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;!-- It can serve as backing device just for one bcache --&gt;
        &lt;bcache_backing_for&gt;/dev/bcache0&lt;/bcache_backing_for&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;

  &lt;drive&gt;
    &lt;type config:type="symbol"&gt;CT_BCACHE&lt;/type&gt;
    &lt;device&gt;/dev/bcache0&lt;/device&gt;
    &lt;bcache_options&gt;
      &lt;cache_mode&gt;writethrough&lt;/cache_mode&gt;
    &lt;/bcache_options&gt;
    &lt;use&gt;all&lt;/use&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;mount&gt;/data&lt;/mount&gt;
        &lt;size&gt;20GiB&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;size&gt;1GiB&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;
</screen>
</example>

   <para>現時点では、 <literal>bcache_options</literal> で使用することのできるオプションは <literal>cache_mode</literal> だけとなります。説明は下記に示しています。</para>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>cache_mode</literal></para>
       </entry>
       <entry>
        <para/>
        <screen>&lt;cache_mode&gt;writethrough&lt;/cache_mode&gt;</screen>
       </entry>
       <entry>
        <para>&bcache; のキャッシュモードを指定します。設定可能な値は <literal>writethrough</literal> (ライトスルー), <literal>writeback</literal> (ライトバック), <literal>writearound</literal> (ライトアラウンド), <literal>none</literal> (無し) のいずれかです。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect2>

  <sect2 xml:id="ay.partition_nfs">
   <title>NFS の設定</title>

   <para>&ay; では、 &productname; を <emphasis>Network File System</emphasis> (NFS) の共有内にインストールすることもできます。これを実現するには、まず <literal>CT_NFS</literal> の種類でドライブを作成し、デバイス名として NFS の共有名を ( <replaceable>サーバ:パス</replaceable> ) の形式で指定します。マウントポイントに関する情報は、最初のパーティションセクション内に記述します。なお、 NFS ドライブの場合、最初のパーティションしか使用されないことに注意してください。</para>
   <para>システムをインストールした後の NFS クライアントやサーバの設定方法については、 <xref linkend="ay.partition_nfs"/> をお読みください。</para>

   <example>
    <title>NFS 共有の定義</title>
      <screen>
        &lt;partitioning config:type="list"&gt;
          &lt;drive&gt;
            &lt;device&gt;192.168.1.1:/exports/root_fs&lt;/device&gt;
            &lt;type config:type="symbol"&gt;CT_NFS&lt;/type&gt;
            &lt;use&gt;all&lt;/use&gt;
            &lt;partitions config:type="list"&gt;
              &lt;partition&gt;
                &lt;mount&gt;/&lt;/mount&gt;
                &lt;fstopt&gt;nolock&lt;/fstopt&gt;
              &lt;/partition&gt;
            &lt;/partitions&gt;
          &lt;/drive&gt;
        &lt;/partitioning&gt;
      </screen>
    </example>
  </sect2>

   <sect2 xml:id="ay.partition_s390">
    <title>&zseries; 固有の設定</title>
    <para/>
    <sect3 xml:id="ay.partition_s390.dasd">
     <title>DASD ディスクの設定</title>
     <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;dasd&gt;
 &lt;devices config:type="list"&gt;
  &lt;listentry&gt;
   ...
  &lt;/listentry&gt;
 &lt;/devices&gt;
&lt;/dasd&gt;</screen>
     <para>上記のような内容を &lt;profile&gt; セクション内に記述します。それぞれのディスクは、それぞれ別々の &lt;listentry&gt; ... &lt;/listentry&gt; セクション内に記述する必要があります。</para>
     <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>device</literal></para>
         </entry>
         <entry>
          <para><literal>DASD</literal> だけを指定することができます</para>
<screen>&lt;device
&gt;DASD&lt;/dev_name&gt;</screen>
         </entry>
         <entry>
          <para/>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>dev_name</literal></para>
         </entry>
         <entry>
          <para>このセクションで設定したいデバイス ( <literal>dasd<replaceable>N</replaceable></literal> ) を指定します。</para>
<screen>&lt;dev_name
&gt;/dev/dasda&lt;/dev_name&gt;</screen>
         </entry>
         <entry>
          <para>任意指定ですが、できれば指定しておくことをお勧めします。何も指定しない場合、 &ay; がデバイスを自動的に判断します。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>channel</literal></para>
         </entry>
         <entry>
          <para>ディスクにアクセスする際のチャネルを指定します。</para>
<screen>&lt;channel&gt;0.0.0150&lt;/channel&gt;</screen>
         </entry>
         <entry>
          <para>必須です。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>diag</literal></para>
         </entry>
         <entry>
          <para><literal>DIAG</literal> を使用するかどうかを指定します。指定可能な値は <literal>true</literal> (有効化) もしくは <literal>false</literal> (無効化) のいずれかです。</para>
<screen>&lt;diag
config:type="boolean"&gt;true&lt;/diag&gt;</screen>
         </entry>
         <entry>
          <para>任意指定です。</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
     </informaltable>
    </sect3>
    <sect3 xml:id="ay.partition_s390.zfcp">
     <title>zFCP ディスクの設定</title>
     <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;profile&gt;
  &lt;zfcp&gt;
    &lt;devices config:type="list"&gt;
      &lt;listentry&gt;
        ...
      &lt;/listentry&gt;
    &lt;/devices&gt;
  &lt;/zfcp&gt;
&lt;profile&gt;</screen>
     <para>なお、各ディスクはそれぞれ別々の <literal>listentry</literal> セクション内に記述します。</para>
     <informaltable>
      <tgroup cols="2">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>controller_id</literal></para>
         </entry>
         <entry>
          <para>チャネル番号</para>
<screen>&lt;controller_id
&gt;0.0.fc00&lt;/controller_id&gt;</screen>
         </entry>
        </row>
       </tbody>
      </tgroup>
     </informaltable>
    </sect3>
   </sect2>
  </sect1>

  <sect1 xml:id="CreateProfile.Iscsi_client">
   <title>iSCSI イニシエータの概要</title>
   <para><literal>iscsi-client</literal> リソースを使用することで、インストール先のマシンを iSCSI クライアントとして設定することができます。</para>

   <example>
     <title>iSCSI クライアント</title>
     <screen>
  &lt;iscsi-client&gt;
    &lt;initiatorname&gt;iqn.2013-02.de.suse:01:e229358d2dea&lt;/initiatorname&gt;
    &lt;targets config:type="list"&gt;
      &lt;listentry&gt;
         &lt;authmethod&gt;None&lt;/authmethod&gt;
         &lt;portal&gt;192.168.1.1:3260&lt;/portal&gt;
         &lt;startup&gt;onboot&lt;/startup&gt;
         &lt;target&gt;iqn.2001-05.com.doe:test&lt;/target&gt;
         &lt;iface&gt;default&lt;/iface&gt;
      &lt;/listentry&gt;
    &lt;/targets&gt;
    &lt;version&gt;1.0&lt;/version&gt;
  &lt;/iscsi-client&gt;
     </screen>
   </example>

   <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>initiatorname</literal></para>
         </entry>
         <entry>
          <para><literal>InitiatorName</literal> は <filename>/etc/iscsi/initiatorname.iscsi</filename> からの値を指定します。 iBFT を使用している場合、この値は BIOS から設定されるため、 BIOS セットアップで変更する必要があります。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>version</literal></para>
         </entry>
         <entry>
          <para>&yast; モジュールのバージョンを指定します。既定値: 1.0</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>targets</literal></para>
         </entry>
         <entry>
          <para>ターゲットの一覧を指定します。各項目には下記の値を設定することができます:</para>
          <para><literal>authmethod</literal>: 認証方式 (None (無し)/CHAP)</para>
          <para><literal>portal</literal>: ポータルのアドレス</para>
          <para><literal>startup</literal>: manual (手動) もしくは onboot (起動時) のいずれか</para>
          <para><literal>target</literal>: ターゲット名</para>
          <para><literal>iface</literal>: インターフェイス名</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
   </informaltable>
  </sect1>

  <sect1 xml:id="CreateProfile.fcoe_client">
   <title>Fibre Channel over Ethernet (FCoE) の設定</title>
   <para><literal>fcoe_cfg</literal> リソースを使用することで、 Fibre Channel over Ethernet (FCoE) の設定を行なうことができます。</para>

   <example>
     <title>FCoE の設定</title>
     <screen>
  &lt;fcoe-client&gt;
    &lt;fcoe_cfg&gt;
      &lt;DEBUG&gt;no&lt;/DEBUG&gt;
      &lt;USE_SYSLOG&gt;yes&lt;/USE_SYSLOG&gt;
    &lt;/fcoe_cfg&gt;
    &lt;interfaces config:type="list"&gt;
      &lt;listentry&gt;
        &lt;dev_name&gt;eth3&lt;/dev_name&gt;
        &lt;mac_addr&gt;01:000:000:000:42:42&lt;/mac_addr&gt;
        &lt;device&gt;Gigabit 1313&lt;/device&gt;
        &lt;vlan_interface&gt;200&lt;/vlan_interface&gt;
        &lt;fcoe_vlan&gt;eth3.200&lt;/fcoe_vlan&gt;
        &lt;fcoe_enable&gt;yes&lt;/fcoe_enable&gt;
        &lt;dcb_required&gt;yes&lt;/dcb_required&gt;
        &lt;auto_vlan&gt;no&lt;/auto_vlan&gt;
        &lt;dcb_capable&gt;no&lt;/dcb_capable&gt;
        &lt;cfg_device&gt;eth3.200&lt;/cfg_device&gt;
      &lt;/listentry&gt;
    &lt;/interfaces&gt;
    &lt;service_start&gt;
      &lt;fcoe config:type="boolean"&gt;true&lt;/fcoe&gt;
      &lt;lldpad config:type="boolean"&gt;true&lt;/lldpad&gt;
    &lt;/service_start&gt;
  &lt;/fcoe-client&gt;
     </screen>
   </example>

   <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>fcoe_cfg</literal></para>
         </entry>
         <entry>
          <para><literal>DEBUG</literal> は、 fcoe サービススクリプトや fcoemon から出力することのできるデバッグメッセージを、有効化するかどうかを指定します。</para>
          <para><literal>USE_SYSLOG</literal> を yes に設定すると、メッセージを syslog に送信するようになります。</para>
         </entry>
         <entry>
          <para>yes/no</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>interfaces</literal></para>
         </entry>
         <entry>
          <para>VLAN や FCoE の設定状態を含む、ネットワークカードの一覧を指定します。</para>
         </entry>
         <entry>
          <para>
          </para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>service_start</literal></para>
         </entry>
         <entry>
          <para><systemitem class="service">fcoe</systemitem> と <systemitem class="service">lldpad</systemitem> の各サービスを、システムの起動時に開始するかどうかを指定します。</para>
          <para><systemitem class="service">fcoe</systemitem> サービスを開始すると、 FCoE インターフェイスを制御し、 <systemitem class="daemon">lldpad</systemitem> デーモンとの通信を確立する Fibre Channel over Ethernet サービスデーモン <systemitem class="daemon">fcoemon</systemitem> を起動します。</para>
          <para><systemitem class="service">lldpad</systemitem> サービスは Link Layer Discovery Protocol agent daemon (<systemitem class="daemon">lldpad</systemitem>) と呼ばれるサービスを提供するもので、このサービスは <systemitem class="daemon">fcoemon</systemitem> に対して DCB (Data Center Bridging) 機能とインターフェイスの設定を通知します。</para>
         </entry>
         <entry>
          <para>yes/no</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
   </informaltable>
  </sect1>

  <sect1 xml:id="CreateProfile.Country">
   <title>国ごとの設定</title>
   <para>言語やタイムゾーン、キーボードの設定などを行ないます。</para>

   <example>
     <title>言語</title>
     <screen>
       &lt;language&gt;
         &lt;language&gt;en_GB&lt;/language&gt;
         &lt;languages&gt;de_DE,en_US&lt;/languages&gt;
       &lt;/language&gt;
     </screen>
   </example>

   <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>language</literal></para>
         </entry>
         <entry>
          <para>第一言語</para>
         </entry>
         <entry>
          <para>利用可能な言語の一覧については、 <filename>/usr/share/YaST2/data/languages</filename> ファイルをご覧ください。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>languages</literal></para>
         </entry>
         <entry>
          <para>第二言語 (複数可、カンマ区切り)</para>
         </entry>
         <entry>
          <para>利用可能な言語の一覧については、 <filename>/usr/share/YaST2/data/languages</filename> ファイルをご覧ください。</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
   </informaltable>

   <para>第一言語に指定した値が正しくない場合、第一言語は既定値である <literal>en_US</literal> に設定されます。</para>

   <example>
     <title>タイムゾーン</title>
     <screen>
       &lt;timezone&gt;
         &lt;hwclock&gt;UTC&lt;/hwclock&gt;
         &lt;timezone&gt;Europe/Berlin&lt;/timezone&gt;
       &lt;/timezone&gt;
     </screen>
   </example>

   <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>hwclock</literal></para>
         </entry>
         <entry>
          <para>ハードウエアの時計がローカルの時刻 (localtime) を示しているのか、 UTC を示しているのかを指定します。</para>
         </entry>
         <entry>
          <para>localtime/UTC</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>timezone</literal></para>
         </entry>
         <entry>
          <para>タイムゾーン</para>
         </entry>
         <entry>
          <para>設定可能なタイムゾーンの一覧については、 <filename>/usr/share/YaST2/data/timezone_raw.ycp</filename> ファイルをご覧ください。</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
   </informaltable>

   <example>
     <title>キーボード</title>
     <screen>
       &lt;keyboard&gt;
         &lt;keymap&gt;german&lt;/keymap&gt;
       &lt;/keyboard&gt;
     </screen>
   </example>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>keymap</literal></para>
       </entry>
       <entry>
        <para>キーボードレイアウト</para>
       </entry>
       <entry>
        <para>設定可能なキーボードレイアウトの一覧については、 <literal>/usr/share/YaST2/data/keyboard_raw.ycp</literal> ファイルをご覧ください。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>

  </sect1>

  <sect1 xml:id="CreateProfile.Software">
   <title>ソフトウエア</title>

   <para><remark role="fixme">Add a short description</remark></para>

   <sect2 xml:id="Software.Selections.base_product" os="sles;sled">
    <title>製品の選択</title>
    <para>&productname; 15 およびそれ以降のバージョンでは、全ての製品は 1 枚のインストールメディアとして提供されるようになっています。そのため、 <tag class="element">product</tag> タグを指定してインストールしたい製品を選択する必要があることになります。</para>
    <para><tag class="element">product</tag> タグ内で設定可能な値は下記のとおりです:</para>
    <variablelist>
     <varlistentry>
      <term>SLES</term>
      <listitem>
       <para>&sls;</para>
      </listitem>
     </varlistentry>
    <varlistentry>
     <term>SLE_HPC</term>
     <listitem>
      <para>&slehpc;</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>SLES_SAP</term>
     <listitem>
      <para>&sles4sap;</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>SLED</term>
     <listitem>
      <para>&sled;</para>
     </listitem>
    </varlistentry>
    </variablelist>
    <example>
     <title>明示的な製品選択</title>
     <para>下記の例では、 &sled; を製品として選択しています:</para>
<screen>&lt;software&gt;
  &lt;products config:type="list"&gt;
    &lt;product&gt;SLED&lt;/product&gt;
  &lt;/products&gt;
&lt;/software&gt;
</screen>
    </example>
    <para>場合によっては、 1 枚のメディア内に 1 つの製品しか含まれていないものもあります。このような場合は、上述のようにして製品を明示的に指定する必要はありません。 &ay; 側で利用可能な製品を自動的に判断します。</para>
    <note>
     <title>古いバージョンの &ay; で使用していたファイルの使用</title>
     <para>古いバージョンの &productname; で使用していた &ay; 設定ファイルを使用していたり、移行しようとしていたりする場合は、特別な考慮を行なう必要があります。詳しくは <xref linkend="sec.ay_12vs15.product-selection"/> をお読みください。</para>
    </note>
   </sect2>

   <sect2 xml:id="Software.Selections.sles10">
    <title>パターンやパッケージの選択</title>
    <para>パターンやパッケージは下記のようにして設定します:</para>
    <example>
     <title>パターンやパッケージのセクションを利用した設定ファイル内でのパッケージ選択</title>
<screen>&lt;software&gt;
  &lt;patterns config:type="list"&gt;
    &lt;pattern&gt;directory_server&lt;/pattern&gt;
  &lt;/patterns&gt;
  &lt;packages config:type="list"&gt;
    &lt;package&gt;apache&lt;/package&gt;
    &lt;package&gt;postfix&lt;/package&gt;
  &lt;/packages&gt;
  &lt;do_online_update config:type="boolean"&gt;true&lt;/do_online_update&gt;
&lt;/software&gt;</screen>
    </example>
    <note>
     <title>パッケージとパターンの名前について</title>
     <para>値にはパッケージ名もしくはパターン名を指定します。バージョンが変わることによってパッケージ名が変更されることもありますが、その場合はプロファイル内に設定した名前を変更する必要があります。</para>
    </note>
   </sect2>

   <sect2 xml:id="Software.Selections.images" os="osuse">
    <title>イメージの配置</title>
    <para>インストールにかかる時間を削減するため、イメージを利用してインストールすることができます。</para>
    <example>
     <title>イメージの配置の有効化</title>
<screen>&lt;!-- 注意! software セクション内には記述しません! --&gt;
&lt;deploy_image&gt;
  &lt;image_installation config:type="boolean"&gt;false&lt;/image_installation&gt;
&lt;/deploy_image&gt;</screen>
    </example>
   </sect2>

   <sect2 xml:id="Software.Selections.additional">
    <title>追加のパッケージやカスタマイズしたパッケージ、もしくは独自の製品のインストール</title>
    <para>DVD-ROM 内に用意されているパッケージに加えて、必要であればカスタマイズしたカーネルなど、外部のパッケージをインストールすることもできます。なお、カスタマイズしたカーネルを使用する場合は、 &suse; パッケージとの互換性があるものでなければならないほか、同じ場所にインストールしなければならないことにも注意してください。</para>
    <para>従来のバージョンとは異なり、独自のパッケージや外部のパッケージをインストールするにあたって、特別なリソースを設定する必要はありません。その代わり、インストール元のリポジトリに必要なパッケージを追加したあと、パッケージデータベースを再作成する必要があります。</para>
    <para>このような作業に対応するため、リポジトリ内に存在するパッケージを調べてパッケージデータベースを作成するためのスクリプトが用意されています。これは <command>/usr/bin/create_package_descr</command> というコマンドになります。このコマンドは openSUSE Build Service 内の <literal>inst-source-utils</literal> パッケージ内に含まれています。なお、データベースを作成する際、全ての言語は英語にリセットされます。</para>
    <example>
     <title>inst-source-utils.rpm 追加パッケージを利用したパッケージデータベースの作成</title>
     <para>DVD 内のファイルを <literal>/usr/local/DVDs/LATEST</literal> に展開します。</para>
<screen>&prompt.user;cp /tmp/inst-source-utils-2016.7.26-1.2.noarch.rpm /usr/local/DVDs/LATEST/suse/noarch
&prompt.user;cd /usr/local/DVDs/LATEST/suse
&prompt.user;create_package_descr -d /usr/local/CDs/LATEST/suse</screen>
    </example>
    <para>上記の例では、 <filename>/usr/local/CDs/LATEST/suse</filename> 以下にアーキテクチャ (例: <literal>x86_64</literal>) に依存するパッケージと依存しないパッケージ (<literal>noarch</literal>) の両方が存在するものとします。他のアーキテクチャの場合は少し異なるかもしれません。</para>
    <para>この方式を使用することで、あらかじめ決められた最新のパッケージを提供する最新のリポジトリを提供できるようになります。また、この方式を使用することで、独自の CD-ROM を簡単に作成することもできます。</para>
    <para>たとえば SDK (&sdk;) のような独自モジュールを追加したい場合は、インストール元となるディレクトリのルートディレクトリに対して、 <filename>add_on_products.xml</filename> ファイルを追加します。</para>
    <para>下記の例では、基本製品のリポジトリ内に SDK モジュールを追加する方法を示しています。 SDK のリポジトリそのものは <filename>/sdk</filename> 内にあるものとします。</para>
    <example>
     <title><filename>add_on_products.xml</filename></title>
     <para>このファイルは、基本製品内に SDK モジュールを追加するためのファイルです。</para>
<screen>
&lt;?xml version="1.0"?&gt;
&lt;add_on_products xmlns="http://www.suse.com/1.0/yast2ns"
   xmlns:config="http://www.suse.com/1.0/configns"&gt;
   &lt;product_items config:type="list"&gt;
      &lt;product_item&gt;
         &lt;name&gt;SUSE Linux Enterprise Software Development Kit&lt;/name&gt;
         &lt;url&gt;relurl:////sdk?alias=SLE_SDK&lt;/url&gt;
         &lt;path&gt;/&lt;/path&gt;
         &lt;-- Users are asked whether to add such a product --&gt;
         &lt;ask_user config:type="boolean"&gt;false&lt;/ask_user&gt;
         &lt;-- Defines the default state of pre-selected state in case of ask_user used. --&gt;
         &lt;selected config:type="boolean"&gt;true&lt;/selected&gt;
      &lt;/product_item&gt;
   &lt;/product_items&gt;
&lt;/add_on_products&gt;
</screen>
    </example>
    <!-- fs 2018-05-09
         The following does not make sense, need to ask author what was intended
    <para>
     With a normal installation now the SDK module will be installed
     automatically. It will not be done via an &ay; installation. An
     additional entry would be needed for in the &ay; control file
     <literal>add-on</literal> section.
     </para>
     -->
    <para>上記のような特別な例のほかにも、その他のモジュールや拡張、アドオン製品などをそれぞれ別々のディレクトリに配置して、 &ay; のインストール時に追加するようなことも実現することができます。</para>
    <example>
     <title>SDK 拡張の追加</title>
<screen>&lt;add-on&gt;
  &lt;add_on_products config:type="list"&gt;
    &lt;listentry&gt;
      &lt;media_url&gt;cd:///sdk&lt;/media_url&gt;
      &lt;product&gt;sle-sdk&lt;/product&gt;
      &lt;alias&gt;SLES SDK&lt;/alias&gt;
      &lt;product_dir&gt;/&lt;/product_dir&gt;
      &lt;priority config:type="integer"&gt;20&lt;/priority&gt;
      &lt;ask_on_error config:type="boolean"&gt;false&lt;/ask_on_error&gt;
      &lt;confirm_license config:type="boolean"&gt;false&lt;/confirm_license&gt;
      &lt;name&gt;SUSE Linux Enterprise Software Development Kit&lt;/name&gt;
    &lt;/listentry&gt;
  &lt;/add_on_products&gt;
&lt;/add-on&gt;</screen>
    </example>
    <informaltable>
     <tgroup cols="2">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>media_url</literal></para>
        </entry>
        <entry>
         <para>製品の URL を指定します。 <literal>cd:///</literal> , <literal>http://</literal> , <literal>ftp://</literal> などのプレフィクスを使用することができます。この項目は必須です。</para>
         <para>&sle; のパッケージ DVD などのように複数の製品が含まれるメディアを使用する場合は、 URL パスが複数製品のメディアのルートディレクトリを指し示すように設定し、 <literal>product_dir</literal> でそれぞれの製品を指定する必要があります (詳しくは下記をお読みください) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>product</literal></para>
        </entry>
        <entry>
         <para>アドオンが製品である場合、内部向けの製品名を指定します。 <command>zypper products</command> を実行すると、インストール済みの製品名を表示することができます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>alias</literal></para>
        </entry>
        <entry>
         <para>リポジトリの別名を指定します。ユーザ側で任意の名前を設定することができます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>product_dir</literal></para>
        </entry>
        <entry>
         <para>製品のサブディレクトリを指定します。この属性は、 &sle; のパッケージ DVD など、複数の製品が含まれるメディアである場合にのみ使用します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>priority</literal></para>
        </entry>
        <entry>
         <para>リポジトリに対して設定する libzypp の優先順位を指定します。 1 が最も高い優先順位を表わし、数値が大きくなればなるほど、優先順位が低くなります。既定値は 99 です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>ask_on_error</literal></para>
        </entry>
        <entry>
         <para>&ay; に対して、指定した場所にアドオン製品やモジュール、拡張のリポジトリが存在しない場合、タイムアウトエラーを報告するのではなく、ユーザに対して尋ねるように設定するかどうかを指定します。ユーザに対して尋ねたい場合は、 ask_on_error を <literal>true</literal> に設定します (既定値は <literal>false</literal> です) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>confirm_license</literal></para>
        </entry>
        <entry>
         <para>ユーザに対してライセンスへの同意を求めるかどうかを指定します。既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>name</literal></para>
        </entry>
        <entry>
         <para>リポジトリ名を指定します。 <command>zypper lr</command> コマンドを実行することで、追加されたリポジトリの名前を表示することができます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <para>&ay; で未署名のインストールソースを使用するには、 &ay; の制御ファイル内で下記のような内容を設定し、チェックを無効化してください。</para>
    <note>
     <title>未署名のインストールソースの制限について</title>
     <para>ここでの署名チェックの無効化は、自動インストール処理内の第 1 ステージにのみ適用されます。第 2 ステージでのインストールは、 &ay; の設定ではなく、インストール済みのシステムでの設定に従って動作します。</para>
    </note>
    <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;general&gt;
  &lt;signature-handling&gt;
    ...
  &lt;/signature-handling&gt;
&lt;/general&gt;</screen>
    <para>下記に示す全てのオプションの既定値は <literal>false</literal> です。また、オプションが <literal>false</literal> に設定されていて、パッケージやリポジトリに対する対象のテストが失敗した場合、特に何もメッセージが表示されることなく無視され、パッケージがインストールされなくなります。なお、どの値を <literal>true</literal> に設定したとしても、そこには潜在的なセキュリティリスクが存在することに注意してください。また、サードパーティ製のインストール元を利用してインストールを行なう場合、これらの設定を行なってはなりません。</para>
    <informaltable>
     <tgroup cols="2">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>accept_unsigned_file</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; はコンテンツファイルなどが未署名であっても、受け入れるようになります。</para>
<screen>&lt;accept_unsigned_file config:type="boolean"
&gt;true&lt;/accept_unsigned_file&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_file_without_checksum</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; はコンテンツファイルなどのチェックサムが存在しない場合であっても、受け入れるようになります。</para>
<screen>&lt;accept_file_without_checksum config:type="boolean"
&gt;true&lt;/accept_file_without_checksum&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_verification_failed</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; は署名の検証が失敗した場合でもファイルを受け入れるようになります。</para>
<screen>&lt;accept_verification_failed config:type="boolean"
&gt;true&lt;/accept_verification_failed&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_unknown_gpg_key</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; はインストール元に新しい GPG 鍵が存在し、その鍵でコンテンツファイルに署名されている場合、それを受け付けるようになります。</para>
         <screen>&lt;accept_unknown_gpg_key config:type="boolean"
&gt;true&lt;/accept_unknown_gpg_key&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_non_trusted_gpg_key</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、既知ではあるもののまだ信頼していない鍵を受け付けるようになります。</para>
         <screen>&lt;accept_non_trusted_gpg_key config:type="boolean"
&gt;true&lt;/accept_non_trusted_gpg_key&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>import_gpg_key</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; はインストール元にある新しい GPG 鍵を受け付け、データベース内に取り込むようになります。</para>
         <screen>&lt;import_gpg_key config:type="boolean"
&gt;true&lt;/import_gpg_key&gt;</screen>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
    <para>それぞれのアドオン製品や拡張ごとに、署名の処理方法を設定することもできます。下記に示す要素は、個別のアドオン製品やモジュール、拡張などの中の <literal>signature-handling</literal> セクション内に設定しなければならないものです。いずれの設定も任意です。何も設定しない場合、 <literal>general</literal> セクション内のグローバルな署名処理設定が適用されます。</para>
    <informaltable>
     <tgroup cols="2">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>accept_unsigned_file</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; は対象のアドオン製品に対して、コンテンツファイルなどが未署名であっても、受け入れるようにします。</para>
         <screen>&lt;accept_unsigned_file config:type="boolean"
&gt;true&lt;/accept_unsigned_file&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_file_without_checksum</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; は対象のアドオン製品に対して、コンテンツファイルなどのチェックサムが存在しない場合であっても、受け入れるようにします。</para>
<screen>&lt;accept_file_without_checksum config:type="boolean"
&gt;true&lt;/accept_file_without_checksum&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_verification_failed</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、 &ay; は対象のアドオン製品に対して、署名の検証が失敗した場合でもファイルを受け入れるようにします。</para>
<screen>&lt;accept_verification_failed config:type="boolean"
&gt;true&lt;/accept_verification_failed&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_unknown_gpg_key</literal></para>
        </entry>
        <entry>
         <para><literal>all</literal> を <literal>true</literal> に設定した場合、 &ay; は対象のアドオン製品に対して、インストール元にある新しい GPG 鍵を受け付け、データベース内に取り込むようにします。</para>
<screen>&lt;accept_unknown_gpg_key&gt;
  &lt;all config:type="boolean"&gt;true&lt;/all&gt;
&lt;/accept_unknown_gpg_key&gt;</screen>
         <para>鍵を個別に指定することもできます。</para>
<screen>&lt;accept_unknown_gpg_key&gt;
  &lt;all config:type="boolean"&gt;false&lt;/all&gt;
  &lt;keys config:type="list"&gt;
    &lt;keyid&gt;3B3011B76B9D6523&lt;/keyid&gt;
  &lt;/keys&gt;
&lt;/accept_unknown_gpg_key&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>accept_non_trusted_gpg_key</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> に設定した場合、対象のアドオン製品に対して、既知ではあるもののまだ信頼していない鍵を受け付けるようにします。</para>
         <para>全ての鍵を信頼する場合は下記のように設定します:</para>
<screen>&lt;accept_non_trusted_gpg_key&gt;
  &lt;all config:type="boolean"&gt;true&lt;/all&gt;
&lt;/accept_non_trusted_gpg_key&gt;</screen>
         <para>特定の鍵のみを信頼する場合は下記のように設定します:</para>
<screen>&lt;accept_non_trusted_gpg_key&gt;
  &lt;all config:type="boolean"&gt;false&lt;/all&gt;
  &lt;keys config:type="list"&gt;
    &lt;keyid&gt;3B3011B76B9D6523&lt;/keyid&gt;
  &lt;/keys&gt;
&lt;/accept_non_trusted_gpg_key&gt;</screen>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>import_gpg_key</literal></para>
        </entry>
        <entry>
         <para><literal>all</literal> を <literal>true</literal> に設定した場合、 &ay; はインストール元にある全ての GPG 鍵を受け入れ、データベース内に取り込むようにします。</para>
<screen>&lt;import_gpg_key&gt;
  &lt;all config:type="boolean"&gt;true&lt;/all&gt;
&lt;/import_gpg_key&gt;</screen>
         <para>鍵を個別に指定することもできます:</para>
<screen>&lt;import_gpg_key&gt;
  &lt;all config:type="boolean"&gt;false&lt;/all&gt;
  &lt;keys config:type="list"&gt;
    &lt;keyid&gt;3B3011B76B9D6523&lt;/keyid&gt;
  &lt;/keys&gt;
&lt;/import_gpg_key&gt;</screen>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

   <sect2 xml:id="Software.Selections.kernel">
    <title>カーネルパッケージ</title>
    <para>カーネルパッケージはパッケージの選択の中に含めることができません。必要なカーネルはインストール時に自動判断されるためです。パッケージの選択内にカーネルパッケージを入れてしまうと、ほとんどの場合、矛盾が発生してインストールが失敗することになります。</para>
    <para>特定の種類のカーネルを強制したい場合は、 <literal>kernel</literal> プロパティで設定を行なってください。下記は既定のカーネル (kernel-default) を強制する場合の例です。下記のように設定することで、環境によらずに指定したカーネルをインストールするようになります。</para>
    <example>
     <title>制御ファイル内でのカーネルセクション</title>
<screen>&lt;software&gt;
  &lt;kernel&gt;kernel-default&lt;/kernel&gt;
  ...
&lt;/software&gt;</screen>
    </example>
   </sect2>

   <sect2 xml:id="Software.Selections.remove_packs">
    <title>自動選択したパッケージの削除</title>
    <para>依存関係にあるパッケージや推奨パッケージなど、いくつかのパッケージが自動的に選択されてインストールされることがあります。</para>
    <para>これらのパッケージを削除してしまうと、システムの一貫性を損なうことになるほか、同類のサービスを提供するような代替パッケージをインストールしない限り、基本的なパッケージについても、削除を行なわないことをお勧めします。最も分かりやすい例がメール転送エージェント (MTA) です。既定では <systemitem>postfix</systemitem> がインストールされますが、 <systemitem>sendmail</systemitem> のような他の MTA をインストールすれば、 postfix を一覧から削除することができます (ただし、 sendmail は &productname; では提供されていません) 。下記の例では、このように postfix を sendmail に置き換える場合の例を示しています:</para>
    <example>
     <title>制御ファイル内でのパッケージ選択</title>
<screen>&lt;software&gt;
  &lt;packages config:type="list"&gt;
    &lt;package&gt;sendmail&lt;/package&gt;
  &lt;/packages&gt;
  &lt;remove-packages config:type="list"&gt;
    &lt;package&gt;postfix&lt;/package&gt;
  &lt;/remove-packages&gt;
&lt;/software&gt;</screen>
    </example>

    <note>
     <title>パッケージ削除の失敗について</title>
     <para>パターン (詳しくは <xref linkend="Software.Selections.sles10"/> をお読みください) の一部として設定されているパッケージについては、削除を行なうことができません。このようなパッケージを削除しようとすると、下記のようなエラーメッセージを表示してインストールが失敗してしまいます:</para>
     <screen>パッケージ解決器の実行に失敗しました。
      &ay; プロファイルのソフトウエアのセクションを確認してください。</screen>
    </note>

   </sect2>

   <sect2 xml:id="Software.Selections.recommend_packs">
    <title>推奨されるパッケージやパターンのインストール</title>
    <para>既定では、推奨される全てのパッケージ／パターンがインストールされます。必要なパッケージのみをインストールしてパッケージ数を減らしたい場合は、 <literal>install_recommended</literal> フラグを設定して、この動作を切り替えることができます。ただし、このフラグは新規インストールの場合にのみ適用されるものであり、アップグレードの場合には無視されます。</para>
<screen>&lt;software&gt;
  &lt;install_recommended config:type="boolean"&gt;false
  &lt;/install_recommended&gt;
&lt;/software&gt;</screen>

    <para><emphasis>既定値</emphasis>: 設定ファイル内でフラグが設定されていない場合、推奨されるパッケージは <emphasis>全て</emphasis> インストールされますが、推奨されるパターンについては <emphasis>インストールされません</emphasis> 。</para>

   </sect2>

   <sect2 xml:id="Software.Selections.stage2_packs">
    <title>第 2 ステージでのパッケージのインストール</title>
    <para>再起動後の第 2 ステージでパッケージをインストールしたい場合は、下記のようにして <literal>post-packages</literal> 要素を設定します:</para>
<screen>&lt;software&gt;
  &lt;post-packages config:type="list"&gt;
    &lt;package&gt;yast2-cim&lt;/package&gt;
  &lt;/post-packages&gt;
&lt;/software&gt;</screen>
   </sect2>

   <sect2 xml:id="Software.Selections.stage2_patterns">
    <title>第 2 ステージでのパターンのインストール</title>
    <para>第 2 ステージでパターンをインストールすることもできます。下記のようにして <literal>post-patterns</literal> 要素を設定してください:</para>
<screen>&lt;software&gt;
  &lt;post-patterns config:type="list"&gt;
    &lt;pattern&gt;apparmor&lt;/pattern&gt;
  &lt;/post-patterns&gt;
&lt;/software&gt;</screen>
   </sect2>

   <sect2 xml:id="Software.Selections.stage2_update">
    <title>第 2 ステージでのオンライン更新</title>
    <para>インストールの末尾にオンライン更新を行なうこともできます。オンライン更新を行ないたい場合は、 <literal>do_online_update</literal> を <literal>true</literal> に設定してください。なおオンライン更新の処理は、たとえば suse-register/customer-center のセクションでオンライン更新用のリポジトリを設定していたり、 post-script 内でリポジトリを設定したりしている場合にのみ意味があります。第 1 ステージの add-on セクションで既にオンライン更新用のリポジトリを設定している場合は、 &ay; は当初の段階から最新のパッケージをインストールすることになります。なお、オンライン更新でカーネルを更新した場合、第 2 ステージの終了後に再起動処理が動作します。</para>
<screen>&lt;software&gt;
  &lt;do_online_update config:type="boolean"&gt;true&lt;/do_online_update&gt;
&lt;/software&gt;</screen>
   </sect2>
  </sect1>


  <sect1 xml:id="CreateProfile.upgrade">
   <title>アップグレード</title>

   <para>&ay; はシステムのアップグレードを行なう際にも使用することができます。パッケージのアップグレードだけでなく、下記のような機能のセクションも提供されています:</para>

   <itemizedlist>
    <listitem>
     <para><literal>scripts/pre-scripts</literal>: 全ての処理が行なわれるよりも前に動作するユーザスクリプトの指定。</para>
    </listitem>
    <listitem>
     <para><literal>add-on</literal>: 追加のアドオン製品の定義。</para>
    </listitem>
    <listitem>
     <para><literal>language</literal>: 言語の設定。</para>
    </listitem>
    <listitem>
     <para><literal>timezone</literal>: タイムゾーンの設定。</para>
    </listitem>
    <listitem>
     <para><literal>keyboard</literal>: キーボードの設定。</para>
    </listitem>
    <listitem>
     <para><literal>software</literal>: 追加のソフトウエアやパターンのインストール、インストール済みのパッケージの削除。</para>
    </listitem>
    <listitem>
     <para><literal>suse_register</literal>: 登録処理の実行。</para>
    </listitem>
   </itemizedlist>

   <para>アップグレード処理を制御する目的で、下記のようなセクションを定義することができます:</para>

   <example>
    <title>アップグレードとバックアップ</title>
<screen>&lt;upgrade&gt;
    &lt;stop_on_solver_conflict config:type="boolean"&gt;true&lt;/stop_on_solver_conflict&gt;
  &lt;/upgrade&gt;
  &lt;backup&gt;
    &lt;sysconfig config:type="boolean"&gt;true&lt;/sysconfig&gt;
    &lt;modified config:type="boolean"&gt;true&lt;/modified&gt;
    &lt;remove_old config:type="boolean"&gt;true&lt;/remove_old&gt;
  &lt;/backup&gt;</screen>
   </example>

   <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>stop_on_solver_conflict</literal></para>
        </entry>
        <entry>
         <para>パッケージの依存関係に問題が発生した場合、インストールを停止するようにします。</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>modified</literal></para>
        </entry>
        <entry>
         <para>変更されたファイルのバックアップを作成します。</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>sysconfig</literal></para>
        </entry>
        <entry>
         <para><filename>/etc/sysconfig</filename> ディレクトリのバックアップを作成します。</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>remove_old</literal></para>
        </entry>
        <entry>
         <para>以前の更新で作成されたバックアップを削除します。</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
      </tbody>
     </tgroup>
   </informaltable>

   <para>&ay; のアップグレードモードを開始するには、下記のようにして行ないます:</para>

   <procedure xml:id="pro.upgrade.upgrade-mode">
    <title>アップグレードモードでの &ay; の起動</title>
    <step>
     <para>作成した &ay; のプロファイルを、 ファイルシステム内の <filename>/root/autoupg.xml</filename> にコピーします。</para>
    </step>
    <step>
     <para>インストールメディアからシステムを起動します。</para>
    </step>
    <step>
     <para><literal>インストール</literal> を選択します。</para>
    </step>
    <step>
     <para>コマンドラインには <varname>autoupgrade=1</varname> を設定します。</para>
     <remark condition="clarity">
      2016-07-29 - fs: What about network setup with ifcfg= ?? Otherwise this
      command line won't work??
     </remark>
    </step>
    <step>
     <para><keycap function="enter"/> を押すとアップグレード処理が始まります。</para>
    </step>
   </procedure>
  </sect1>

  <sect1 xml:id="CreateProfile.Services">
   <title>サービスとターゲット</title>

   <para><literal>services-manager</literal> リソースを使用することで、既定の systemd ターゲットの指定のほか、個別のシステムサービスを開始したり停止したり、開始方法を指定したりすることができます。</para>

   <para>
    The <literal>default-target</literal> property specifies the default
    systemd target into which the system boots. Valid options are
    <literal>graphical</literal> for a graphical login, or
    <literal>multi-user</literal> for a console login.
   </para>

   <para>特定のサービスに対してシステムの起動時に開始するように設定したい場合は、 <literal>enable</literal> と <literal>disable</literal> のリストを設定します。特定のサービスを開始したい場合は、 <literal>enable</literal> のリスト内にその名前を設定します。逆にサービスをシステムの起動時に開始したくない場合は、 <literal>disable</literal> のリスト内に名前を設定します。</para>

   <para>サービスが <literal>enable</literal> と <literal>disable</literal> のどちらにも掲載されていない場合、既定の設定 (有効もしくは無効) が使用されます。</para>

   <para>このほか、 <literal>cups</literal> サポートなどのようにオンデマンドで有効化できる (ソケットで開始するサービス) ものもあります。このような機能を設定したい場合は、 <literal>enable</literal> ではなく <literal>on_demand</literal> のリスト内に名前を記載してください。</para>

   <example>
    <title>サービスとターゲットの設定</title>
<screen>&lt;services-manager&gt;
  &lt;default_target&gt;multi-user&lt;/default_target&gt;
  &lt;services&gt;
    &lt;disable config:type="list"&gt;
      &lt;service&gt;libvirtd&lt;/service&gt;
    &lt;/disable&gt;
    &lt;enable config:type="list"&gt;
      &lt;service&gt;sshd&lt;/service&gt;
    &lt;/enable&gt;
    &lt;on_demand config:type="list"&gt;
      &lt;service&gt;cups&lt;/service&gt;
    &lt;/on_demand&gt;
  &lt;/services&gt;
&lt;/services-manager&gt;</screen>
   </example>
  </sect1>

  <sect1 xml:id="CreateProfile.Network">
   <title>ネットワークの設定</title>

   <para>ネットワークの設定を行なうことで、ワークステーションをイーサネットベースの LAN に接続することができるほか、ダイヤルアップ接続を設定することもできます。より複雑な設定 (複数のネットワークカードやルーティングの設定など) も行なうことができます。</para>

   <para>下記の設定を <literal>true</literal> にすると、 &yast; はインストール時に作成したネットワーク設定 (<command>linuxrc</command> で設定したもの) と &ay; の制御ファイル内に書かれている設定 (もしあれば) を合成して使用するようになります。</para>
   <note>
    <title><command>linuxrc</command> プログラムについて</title>
    <para><command>linuxrc</command> の仕組みと設定キーワードについてより詳しく知りたい場合は、 <xref linkend="appendix.linuxrc"/> をお読みください。</para>
   </note>
   <para>&ay; での設定は、既に存在する設定ファイルよりも高い優先順位で適用されます。 &yast; は ifcfg-* ファイルに書き込みを行なう際、既存の内容を削除せずに行ないます。そのため、 DNS やルーティングのセクションを設定しない場合、 &yast; は既存の値をそのまま保持するようになります。そうでない場合、制御ファイル内の設定が適用されます。</para>

<screen>&lt;keep_install_network
config:type="boolean"&gt;true&lt;/keep_install_network&gt;</screen>

   <para>第 2 ステージでは、追加のパッケージのインストールが設定されていると、そのインストール処理はネットワークの設定が行なわれる前に動作してしまいます。このようなパッケージのインストールでネットワークを利用できるようにするため、 <literal>keep_install_network</literal> は既定で <literal>true</literal> に設定されています。第 1 ステージで必要なパッケージを全てインストールしていて、第 2 ステージの冒頭ではネットワークが不要である場合は、 <literal>keep_install_network</literal> を <literal>false</literal> に設定することで、設定のコピーを防ぐことができます。</para>

   <para>ネットワークの設定を適用してネットワークが正しく動作するようにするには、ネットワーク全体の設定を保存するためのグローバルリソースを 1 つだけ使用してください。</para>

   <example xml:id="ex.ay.network_config.general">
    <title>ネットワークの設定</title>
<screen>&lt;networking&gt;
  &lt;dns&gt;
    &lt;dhcp_hostname config:type="boolean"&gt;true&lt;/dhcp_hostname&gt;
    &lt;domain&gt;site&lt;/domain&gt;
    &lt;hostname&gt;linux-bqua&lt;/hostname&gt;
    &lt;nameservers config:type="list"&gt;
      &lt;nameserver&gt;&dnsip;&lt;/nameserver&gt;
      &lt;nameserver&gt;&dnsip117;&lt;/nameserver&gt;
      &lt;nameserver&gt;&dnsip118;&lt;/nameserver&gt;
    &lt;/nameservers&gt;
    &lt;resolv_conf_policy&gt;auto&lt;/resolv_conf_policy&gt;
    &lt;searchlist config:type="list"&gt;
      &lt;search&gt;&exampledomain;&lt;/search&gt;
      &lt;search&gt;&exampledomain1;&lt;/search&gt;
    &lt;/searchlist&gt;
    &lt;write_hostname config:type="boolean"&gt;false&lt;/write_hostname&gt;
  &lt;/dns&gt;
  &lt;interfaces config:type="list"&gt;
    &lt;interface&gt;
      &lt;bootproto&gt;dhcp&lt;/bootproto&gt;
      &lt;device&gt;eth0&lt;/device&gt;
      &lt;startmode&gt;auto&lt;/startmode&gt;
    &lt;/interface&gt;
    &lt;interface&gt;
      &lt;bootproto&gt;static&lt;/bootproto&gt;
      &lt;broadcast&gt;127.255.255.255&lt;/broadcast&gt;
      &lt;device&gt;lo&lt;/device&gt;
      &lt;firewall&gt;no&lt;/firewall&gt;
      &lt;ipaddr&gt;127.0.0.1&lt;/ipaddr&gt;
      &lt;netmask&gt;255.0.0.0&lt;/netmask&gt;
      &lt;network&gt;127.0.0.0&lt;/network&gt;
      &lt;prefixlen&gt;8&lt;/prefixlen&gt;
      &lt;startmode&gt;nfsroot&lt;/startmode&gt;
      &lt;usercontrol&gt;no&lt;/usercontrol&gt;
    &lt;/interface&gt;
  &lt;/interfaces&gt;
  &lt;ipv6 config:type="boolean"&gt;true&lt;/ipv6&gt;
  &lt;keep_install_network config:type="boolean"&gt;false&lt;/keep_install_network&gt;
  &lt;managed config:type="boolean"&gt;false&lt;/managed&gt;       ###### NetworkManager?
  &lt;net-udev config:type="list"&gt;
    &lt;rule&gt;
      &lt;name&gt;eth0&lt;/name&gt;
      &lt;rule&gt;ATTR{address}&lt;/rule&gt;
      &lt;value&gt;&wsImac;&lt;/value&gt;
    &lt;/rule&gt;
  &lt;/net-udev&gt;
  &lt;s390-devices config:type="list"&gt;
    &lt;listentry&gt;
      &lt;chanids&gt;0.0.0800 0.0.0801 0.0.0802&lt;/chanids&gt;
      &lt;type&gt;qeth&lt;/type&gt;
    &lt;/listentry&gt;
  &lt;/s390-devices&gt;
  &lt;routing&gt;
    &lt;ipv4_forward config:type="boolean"&gt;false&lt;/ipv4_forward&gt;
    &lt;ipv6_forward config:type="boolean"&gt;false&lt;/ipv6_forward&gt;
    &lt;routes config:type="list"&gt;
      &lt;route&gt;
        &lt;destination&gt;&routerintipII;&lt;/destination&gt;
        &lt;device&gt;eth0&lt;/device&gt;
        &lt;extrapara&gt;foo&lt;/extrapara&gt;
        &lt;gateway&gt;-&lt;/gateway&gt;
        &lt;netmask&gt;-&lt;/netmask&gt;
      &lt;/route&gt;
      &lt;route&gt;
        &lt;destination&gt;default&lt;/destination&gt;
        &lt;device&gt;eth0&lt;/device&gt;
        &lt;gateway&gt;&routerintipI;&lt;/gateway&gt;
        &lt;netmask&gt;-&lt;/netmask&gt;
      &lt;/route&gt;
      &lt;route&gt;
        &lt;destination&gt;default&lt;/destination&gt;
        &lt;device&gt;lo&lt;/device&gt;
        &lt;gateway&gt;&gateip;&lt;/gateway&gt;
        &lt;netmask&gt;-&lt;/netmask&gt;
      &lt;/route&gt;
    &lt;/routes&gt;
  &lt;/routing&gt;
&lt;/networking&gt;</screen>
   </example>

   <example xml:id="ex.ay.network_config.bridge">
     <title>ブリッジインターフェイスの設定</title>
<screen>
&lt;interfaces config:type="list"&gt;
  &lt;interface&gt;
    &lt;device&gt;br0&lt;/device&gt;
    &lt;bootproto&gt;static&lt;/bootproto&gt;
    &lt;bridge&gt;yes&lt;/bridge&gt;
    &lt;bridge_forwarddelay&gt;0&lt;/bridge_forwarddelay&gt;
    &lt;bridge_ports&gt;eth0 eth1&lt;/bridge_ports&gt;
    &lt;bridge_stp&gt;off&lt;/bridge_stp&gt;
    &lt;ipaddr&gt;192.168.122.100&lt;/ipaddr&gt;
    &lt;netmask&gt;255.255.255.0&lt;/netmask&gt;
    &lt;network&gt;192.168.122.0&lt;/network&gt;
    &lt;prefixlen&gt;24&lt;/prefixlen&gt;
    &lt;startmode&gt;auto&lt;/startmode&gt;
  &lt;/interface&gt;
  &lt;interface&gt;
    &lt;device&gt;eth0&lt;/device&gt;
    &lt;bootproto&gt;none&lt;/bootproto&gt;
    &lt;startmode&gt;hotplug&lt;/startmode&gt;
  &lt;/interface&gt;
  &lt;interface&gt;
    &lt;device&gt;eth1&lt;/device&gt;
    &lt;bootproto&gt;none&lt;/bootproto&gt;
    &lt;startmode&gt;hotplug&lt;/startmode&gt;
  &lt;/interface&gt;
&lt;/interfaces&gt;
</screen>
   </example>

   <tip>
    <title>IPv6 アドレスのサポートについて</title>
    <para>&ay; では IPv6 アドレスにも完全対応しています。 IPv6 アドレスのサポートを無効化したい場合は、 &lt;ipv6 config:type="boolean"&gt;false&lt;/ipv6&gt; を設定してください。</para>
   </tip>

   <sect2 xml:id="CreateProfile.Network.names">
    <title>ネットワークインターフェイス名の固定</title>
    <para>下記の要素は &lt;net-udev&gt;...&lt;/net-udev&gt; のタグ内に記述しなければなりません。</para>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>name</literal></para>
        </entry>
        <entry>
         <para>ネットワークインターフェイス名 (例: <literal>eth3</literal>) を設定します</para>
        </entry>
        <entry>
         <para>必須</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>rule</literal></para>
        </entry>
        <entry>
         <para>MAC ぁどれすベースのルールを作成するには <literal>ATTR{address}</literal> を、バス ID ベースのルールを作成するには <literal>KERNELS</literal> を指定します</para>
        </entry>
        <entry>
         <para>必須</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>value</literal></para>
        </entry>
        <entry>
         <para>MAC アドレスベースのルールの場合は <literal>f0:de:f1:6b:da:69</literal> のように、バス ID ベースのルールの場合は <literal>0000:00:1c.1 or 0.0.0700</literal> のように指定します</para>
        </entry>
        <entry>
         <para>必須</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <tip>
     <title>デバイス名の衝突時の処理について</title>
      <para>不完全な <emphasis>udev</emphasis> ルールセットを作成してしまった場合、既存のデバイス名と指定したルールのデバイス名が衝突する場合があります。たとえばネットワークインターフェイスの名前を <literal>eth0</literal> に変更する場合、カーネル側で自動生成されたデバイス名と衝突することがあります。 &ay; ではこのような場合でも、デバイス名をできる限り適切に処理しようとし、必要に応じて衝突したデバイスの名前を修正します。</para>
     </tip>
    </sect2>

   <sect2 xml:id="CreateProfile.Network.s390">
    <title>s390 オプション</title>
    <para>下記の要素は &lt;s390-devices&gt;...&lt;/s390-devices&gt; タグ内に記述しなければなりません。</para>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>type</para>
        </entry>
        <entry>
         <para>qeth, ctc, iucv のいずれか</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para>chanids</para>
        </entry>
        <entry>
         <para>スペース区切りでのチャンネル ID</para>
<screen>&lt;chanids&gt;0.0.0700 0.0.0701 0.0.0702&lt;/chanids&gt;</screen>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para>layer2</para>
        </entry>
        <entry>
         <para/>
<screen>&lt;layer2 config:type="boolean"&gt;true&lt;/layer2&gt;</screen>
        </entry>
        <entry>
         <para>ブール値。既定は false</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>portname</para>
        </entry>
        <entry>
         <para>QETH ポート名 (<phrase os="sles;sled">SLE 12 SP2</phrase> <phrase os="osuse">openSUSE 42.2</phrase> 以降では廃止予定となっています)</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para>protocol</para>
        </entry>
        <entry>
         <para>CTC / LCS プロトコル (文字列として、小さな値)</para>
<screen>&lt;protocol&gt;1&lt;/protocol&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>router</para>
        </entry>
        <entry>
         <para>IUCV ルータ／ユーザ</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <para>上述のオプションに加えて、 &ay; では設定ファイルの他のセクション内に &zseries; 固有のオプションを設定することもできます。特に論理リンクアドレス (LLADDR (イーサネットの場合 MAC アドレス)) を設定することもできます。設定を行なうには、デバイスの定義内に <literal>LLADDR</literal> オプションを設定してください。</para>
    <tip>
     <title>VLAN 向けの LLADDR について</title>
     <para>VLAN デバイスの場合、接続されている物理デバイスの LLADDR をそのまま継承します。 VLAN デバイスに対して別のアドレスを設定するには、物理デバイス側に LLADDR のオプションを設定してください。</para>
    </tip>
   </sect2>

   <sect2 xml:id="Configuration.Network.Proxy">
    <title>プロキシ</title>
    <para>インターネットプロキシ (キャッシュ) の設定を行なうことができます。</para>
    <para>HTTP, HTTPS, FTP に対応するプロキシサーバの設定は、それぞれ <literal>http_proxy</literal> , <literal>https_proxy</literal> , <literal>ftp_proxy</literal> で行ないます。プロキシを使用せず、直接アクセスすべきアドレスやホスト／ドメイン名がある場合は、それらを <literal>no_proxy</literal> (スペース区切り) に背呈します。また、プロキシサーバに対して認証が必要である場合は、 <literal>proxy_user</literal> と <literal>proxy_password</literal> をそれぞれ設定してください。</para>
    <example>
     <title>ネットワーク設定: プロキシ</title>
<screen>&lt;proxy&gt;
  &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
  &lt;ftp_proxy&gt;http://192.168.1.240:3128&lt;/ftp_proxy&gt;
  &lt;http_proxy&gt;http://192.168.1.240:3128&lt;/http_proxy&gt;
  &lt;no_proxy&gt;www.&exampledomain; .&exampledomain2; localhost&lt;/no_proxy&gt;
  &lt;proxy_password&gt;testpw&lt;/proxy_password&gt;
  &lt;proxy_user&gt;testuser&lt;/proxy_user&gt;
&lt;/proxy&gt;</screen>
    </example>
   </sect2>
   <!-- 2017-10-20 tbazant: xinetd is gone (https://fate.suse.com/323373)
   <sect2 xml:id="Configuration.Network.Inetd">
    <title>(X)Inetd</title>
    <para>
     The control file has elements to specify which superserver should be
     used (netd_service), whether it should be enabled (netd_status) and how
     the services should be configured (netd_conf).
    </para>
    <para>
     A service description element needs two parts: key and non-key. When
     writing the configuration, services are matched using the key fields;
     to the matching service, non-key fields are applied. If no service
     matches, it is created. If more services match, a warning is reported.
     The key fields are <emphasis>script, service, protocol and
     server.</emphasis>
    </para>
    <para>
     <emphasis>service</emphasis> and <emphasis>protocol</emphasis> are
     matched literally. <emphasis>script</emphasis> is the base name of the
     configuration file: usually a file in<filename>
     /etc/xinetd.d</filename>, for example "echo-udp", or "inetd.conf". For
     compatibility with 8.2, <emphasis>server</emphasis> is matched more
     loosely: if it is <filename>/usr/sbin/tcpd</filename>, the real server
     name is taken from <emphasis>server_args</emphasis>. After that, the
     basename of the first whitespace-separated word is taken and these
     values are compared.
    </para>

    <example>
     <title>Inetd Example</title>
<screen>&lt;profile&gt;
  &lt;inetd&gt;
    &lt;netd_service config:type="symbol"&gt;xinetd&lt;/netd_service&gt;
    &lt;netd_status config:type="integer"&gt;0&lt;/netd_status&gt;
    &lt;netd_conf config:type="list"&gt;
      &lt;conf&gt;
        &lt;script&gt;imap&lt;/script&gt;
        &lt;service&gt;pop3&lt;/service&gt;
        &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
      &lt;/conf&gt;
      &lt;conf&gt;
        &lt;server&gt;in.ftpd&lt;/server&gt;
        &lt;server_args&gt;-A&lt;/server_args&gt;
        &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
      &lt;/conf&gt;
      &lt;conf&gt;
        &lt;service&gt;daytime&lt;/service&gt;
        &lt;protocol&gt;tcp&lt;/protocol&gt;
      &lt;/conf&gt;
      &lt;conf&gt;...&lt;/conf&gt;
    &lt;/netd_conf&gt;
  &lt;/inetd&gt;
&lt;/profile&gt;</screen>
    </example>
   </sect2> -->
  </sect1>
  <sect1 xml:id="Configuration.Network.NIS">
   <title>NIS クライアント</title>

   <para><literal>nis</literal> リソースを使用することで、インストール先のマシンを NIS クライアントとして設定することができます。下記の例では、複数のドメインを利用した詳細な設定を行なっています。</para>

   <example>
    <title>ネットワーク設定: NIS</title>
<screen> &lt;nis&gt;
  &lt;nis_broadcast config:type="boolean"&gt;true&lt;/nis_broadcast&gt;
  &lt;nis_broken_server config:type="boolean"&gt;true&lt;/nis_broken_server&gt;
  &lt;nis_by_dhcp config:type="boolean"&gt;false&lt;/nis_by_dhcp&gt;
  &lt;nis_domain&gt;test.com&lt;/nis_domain&gt;
  &lt;nis_local_only config:type="boolean"&gt;true&lt;/nis_local_only&gt;
  &lt;nis_options&gt;&lt;/nis_options&gt;
  &lt;nis_other_domains config:type="list"&gt;
    &lt;nis_other_domain&gt;
      &lt;nis_broadcast config:type="boolean"&gt;false&lt;/nis_broadcast&gt;
      &lt;nis_domain&gt;domain.com&lt;/nis_domain&gt;
      &lt;nis_servers config:type="list"&gt;
        &lt;nis_server&gt;10.10.0.1&lt;/nis_server&gt;
      &lt;/nis_servers&gt;
    &lt;/nis_other_domain&gt;
  &lt;/nis_other_domains&gt;
  &lt;nis_servers config:type="list"&gt;
    &lt;nis_server&gt;192.168.1.1&lt;/nis_server&gt;
  &lt;/nis_servers&gt;
  &lt;start_autofs config:type="boolean"&gt;true&lt;/start_autofs&gt;
  &lt;start_nis config:type="boolean"&gt;true&lt;/start_nis&gt;
&lt;/nis&gt;</screen>
   </example>
  </sect1>

  <sect1 xml:id="Configuration.Network.NIS_Server">
   <title>NIS サーバ</title>

   <para>インストール先のマシンを NIS サーバとして構成することもできます。 NIS マスターサーバ、 NIS スレーブサーバ、 NIS マスター兼スレーブサーバをそれぞれ設定することができます。</para>

   <example>
    <title>NIS サーバの設定</title>
<screen>
  &lt;nis_server&gt;
    &lt;domain&gt;mydomain.de&lt;/domain&gt;
    &lt;maps_to_serve config:type="list"&gt;
      &lt;nis_map&gt;auto.master&lt;/nis_map&gt;
      &lt;nis_map&gt;ethers&lt;/nis_map&gt;
    &lt;/maps_to_serve&gt;
    &lt;merge_passwd config:type="boolean"&gt;false&lt;/merge_passwd&gt;
    &lt;mingid config:type="integer"&gt;0&lt;/mingid&gt;
    &lt;minuid config:type="integer"&gt;0&lt;/minuid&gt;
    &lt;nopush config:type="boolean"&gt;false&lt;/nopush&gt;
    &lt;pwd_chfn config:type="boolean"&gt;false&lt;/pwd_chfn&gt;
    &lt;pwd_chsh config:type="boolean"&gt;false&lt;/pwd_chsh&gt;
    &lt;pwd_srcdir&gt;/etc&lt;/pwd_srcdir&gt;
    &lt;securenets config:type="list"&gt;
      &lt;securenet&gt;
        &lt;netmask&gt;255.0.0.0&lt;/netmask&gt;
        &lt;network&gt;127.0.0.0&lt;/network&gt;
      &lt;/securenet&gt;
    &lt;/securenets&gt;
    &lt;server_type&gt;master&lt;/server_type&gt;
    &lt;slaves config:type="list"/&gt;
    &lt;start_ypbind config:type="boolean"&gt;false&lt;/start_ypbind&gt;
    &lt;start_yppasswdd config:type="boolean"&gt;false&lt;/start_yppasswdd&gt;
    &lt;start_ypxfrd config:type="boolean"&gt;false&lt;/start_ypxfrd&gt;
  &lt;/nis_server&gt;
</screen>
   </example>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>domain</literal></para>
       </entry>
       <entry>
        <para>NIS ドメイン名。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>maps_to_serve</literal></para>
       </entry>
       <entry>
        <para>サーバ側で利用できるようにするマップのリストを指定します。</para>
       </entry>
       <entry>
        <para>値: auto.master, ethers, group, hosts, netgrp, networks, passwd, protocols, rpc, services, shadow</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>merge_passwd</literal></para>
       </entry>
       <entry>
        <para>passwd ファイルと shadow ファイルの合成を行なうかどうかを指定します (shadow ファイルが存在する場合にのみ行なうことができます) 。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>mingid</literal></para>
       </entry>
       <entry>
        <para>ユーザマップ内での最小 GID を指定します。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>minuid</literal></para>
       </entry>
       <entry>
        <para>ユーザマップ内での最小 UID を指定します。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>nopush</literal></para>
       </entry>
       <entry>
        <para>変更点をスレーブサーバにプッシュしないようにします (スレーブサーバが存在しない場合に有用です) 。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>pwd_chfn</literal></para>
       </entry>
       <entry>
        <para>YPPWD_CHFN - フルネームの変更を許可します</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>pwd_chsh</literal></para>
       </entry>
       <entry>
        <para>YPPWD_CHSH - ログインシェルの変更を許可します</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>pwd_srcdir</literal></para>
       </entry>
       <entry>
        <para>YPPWD_SRCDIR - passwd データのソースディレクトリ</para>
       </entry>
       <entry>
        <para>既定値: <filename>/etc</filename></para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>securenets</literal></para>
       </entry>
       <entry>
        <para>NIS サーバに対して問い合わせることのできるホストの一覧</para>
       </entry>
       <entry>
        <para><remark>Dublin proofreader 2016-09-06: This does not make sense in the context of the sentence, however I am not sure of the intended meaning. Please revise.</remark> network のアドレスが、対向のアドレスと netmask の論理積のアドレスが一致した場合にのみ、アクセスが許可されます。</para>
        <para>network 127.0.0.0 および netmask 255.0.0.0 の設定は、ローカルからの接続を許可するために必ず存在していなければなりません。</para>
        <para>network 0.0.0.0, netmask 0.0.0.0 を指定すると、全てのホストからのアクセスを許可します。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>server_type</literal></para>
       </entry>
       <entry>
        <para>NIS サーバをマスターサーバ／スレーブサーバのどちらにするのか、もしくは NIS サーバを設定しないのかを選択します。</para>
       </entry>
       <entry>
        <para>値: master, slave, none</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>slaves</literal></para>
       </entry>
       <entry>
        <para>NIS サーバスレーブとして設定したいホスト名のリストを指定します。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>start_ypbind</literal></para>
       </entry>
       <entry>
        <para>このホストを NIS クライアントとしても設定します (ただしクライアント側の設定をローカルで行なう必要があります) 。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>start_yppasswdd</literal></para>
       </entry>
       <entry>
        <para>パスワードデーモンも起動するようにします。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>start_ypxfrd</literal></para>
       </entry>
       <entry>
        <para>マップ転送デーモンも起動するようにします。高速なマップ配布の仕組みにより、スレーブに対するマップの転送も高速化されます。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect1>

<!--
    <section id="Configuration.Network.NISplus">
    <title>
    NIS+
  </title>
    <para>
    If you activate NIS+, the data of the
    NIS+ Server will be added to <filename>/etc/hosts</filename>. Keyserv and the NIS+ cache manager
    will be started and the NSS and PAM configuration will be modified to use
    NIS+ and set the Secret Key of a user.
  </para>
    &example.nisplus;
  </section>
    -->

  <sect1 xml:id="Configuration.Network.Host">
   <title>ホスト名の定義</title>

   <para><literal>host</literal> リソースを使用することで、 <literal>/etc/hosts</literal> 内に 1 つもしくは複数の項目を追加することができます。既に存在する項目については、削除されることはありません。下記に詳細例を示します。</para>

   <example>
    <title>/etc/hosts</title>
    <screen>
    &lt;host&gt;
     &lt;hosts config:type="list"&gt;
      &lt;hosts_entry&gt;
       &lt;host_address&gt;133.3.0.1&lt;/host_address&gt;
       &lt;names config:type="list"&gt;
        &lt;name&gt;booking&lt;/name&gt;
       &lt;/names&gt;
      &lt;/hosts_entry&gt;
      &lt;hosts_entry&gt;
       &lt;host_address&gt;133.3.0.5&lt;/host_address&gt;
       &lt;names config:type="list"&gt;
        &lt;name&gt;test-machine&lt;/name&gt;
       &lt;/names&gt;
      &lt;/hosts_entry&gt;
     &lt;/hosts&gt;
    &lt;host&gt;
    </screen>
   </example>
  </sect1>

  <sect1 xml:id="Configuration.Network.Ldap">
   <title>LDAP サーバ (認証サーバ)</title>

   <para><literal>auth-server</literal> リソースを使用することで、インストール先のマシンを LDAP サーバとして構成することができます。下記に詳細例を示します。</para>

   <example>
    <title>LDAP の設定</title>
    <screen>
  &lt;auth-server&gt;
    &lt;daemon&gt;
      &lt;listeners config:type="list"&gt;
        &lt;listentry&gt;ldap&lt;/listentry&gt;
        &lt;listentry&gt;ldapi&lt;/listentry&gt;
      &lt;/listeners&gt;
      &lt;serviceEnabled&gt;1&lt;/serviceEnabled&gt;
      &lt;slp/&gt;
    &lt;/daemon&gt;
    &lt;databases config:type="list"&gt;
      &lt;listentry&gt;
        &lt;access config:type="list"&gt;
          &lt;listentry&gt;
            &lt;access config:type="list"&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;write&lt;/level&gt;
                &lt;type&gt;self&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;auth&lt;/level&gt;
                &lt;type&gt;*&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
            &lt;/access&gt;
            &lt;target&gt;
              &lt;attrs&gt;userPassword&lt;/attrs&gt;
            &lt;/target&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;access config:type="list"&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;write&lt;/level&gt;
                &lt;type&gt;self&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;read&lt;/level&gt;
                &lt;type&gt;*&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
            &lt;/access&gt;
            &lt;target&gt;
              &lt;attrs&gt;shadowLastChange&lt;/attrs&gt;
            &lt;/target&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;access config:type="list"&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;read&lt;/level&gt;
                &lt;type&gt;self&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;none&lt;/level&gt;
                &lt;type&gt;*&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
            &lt;/access&gt;
            &lt;target&gt;
              &lt;attrs&gt;userPKCS12&lt;/attrs&gt;
            &lt;/target&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;access config:type="list"&gt;
              &lt;listentry&gt;
                &lt;control/&gt;
                &lt;level&gt;read&lt;/level&gt;
                &lt;type&gt;*&lt;/type&gt;
                &lt;value/&gt;
              &lt;/listentry&gt;
            &lt;/access&gt;
            &lt;target/&gt;
          &lt;/listentry&gt;
        &lt;/access&gt;
        &lt;checkpoint config:type="list"&gt;
          &lt;listentry&gt;1024&lt;/listentry&gt;
          &lt;listentry&gt;5&lt;/listentry&gt;
        &lt;/checkpoint&gt;
        &lt;directory&gt;/var/lib/ldap&lt;/directory&gt;
        &lt;entrycache&gt;10000&lt;/entrycache&gt;
        &lt;idlcache&gt;30000&lt;/idlcache&gt;
        &lt;indexes&gt;
          &lt;cn&gt;
            &lt;eq&gt;1&lt;/eq&gt;
            &lt;sub&gt;1&lt;/sub&gt;
          &lt;/cn&gt;
          &lt;displayName&gt;
            &lt;eq&gt;1&lt;/eq&gt;
            &lt;sub&gt;1&lt;/sub&gt;
          &lt;/displayName&gt;
          &lt;gidNumber&gt;
            &lt;eq&gt;1&lt;/eq&gt;
          &lt;/gidNumber&gt;
          &lt;givenName&gt;
            &lt;eq&gt;1&lt;/eq&gt;
            &lt;sub&gt;1&lt;/sub&gt;
          &lt;/givenName&gt;
          &lt;mail&gt;
            &lt;eq&gt;1&lt;/eq&gt;
          &lt;/mail&gt;
          &lt;member&gt;
            &lt;eq&gt;1&lt;/eq&gt;
          &lt;/member&gt;
          &lt;memberUid&gt;
            &lt;eq&gt;1&lt;/eq&gt;
          &lt;/memberUid&gt;
          &lt;objectclass&gt;
            &lt;eq&gt;1&lt;/eq&gt;
          &lt;/objectclass&gt;
          &lt;sn&gt;
            &lt;eq&gt;1&lt;/eq&gt;
            &lt;sub&gt;1&lt;/sub&gt;
          &lt;/sn&gt;
          &lt;uid&gt;
            &lt;eq&gt;1&lt;/eq&gt;
            &lt;sub&gt;1&lt;/sub&gt;
          &lt;/uid&gt;
          &lt;uidNumber&gt;
            &lt;eq&gt;1&lt;/eq&gt;
          &lt;/uidNumber&gt;
        &lt;/indexes&gt;
        &lt;rootdn&gt;cn=Administrator,DC=corp,DC=Fabrikam,DC=COM,CN=Karen Berge&lt;/rootdn&gt;
        &lt;rootpw&gt;{SSHA}LCdgE3gNejqBogGI3ac1Xf4DOIVMSk9ZQg==&lt;/rootpw&gt;
        &lt;suffix&gt;DC=corp,DC=Fabrikam,DC=COM,CN=Karen Berge&lt;/suffix&gt;
        &lt;type&gt;hdb&lt;/type&gt;
      &lt;/listentry&gt;
    &lt;/databases&gt;
    &lt;globals&gt;
      &lt;allow config:type="list"/&gt;
      &lt;disallow config:type="list"/&gt;
      &lt;loglevel config:type="list"&gt;
        &lt;listentry&gt;none&lt;/listentry&gt;
      &lt;/loglevel&gt;
      &lt;tlsconfig&gt;
        &lt;caCertDir/&gt;
        &lt;caCertFile/&gt;
        &lt;certFile/&gt;
        &lt;certKeyFile/&gt;
        &lt;crlCheck&gt;0&lt;/crlCheck&gt;
        &lt;crlFile/&gt;
        &lt;verifyClient&gt;0&lt;/verifyClient&gt;
      &lt;/tlsconfig&gt;
    &lt;/globals&gt;
    &lt;schema config:type="list"&gt;
      &lt;listentry&gt;
        &lt;definition&gt;dn: cn=schema,cn=config
            objectClass: olcSchemaConfig
            ......
            .....
            ....
            ...
            ..
            .
        &lt;/definition&gt;
        &lt;name&gt;schema&lt;/name&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;includeldif&gt;/etc/openldap/schema/core.ldif&lt;/includeldif&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;includeldif&gt;/etc/openldap/schema/cosine.ldif&lt;/includeldif&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;includeldif&gt;/etc/openldap/schema/inetorgperson.ldif&lt;/includeldif&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;includeschema&gt;/etc/openldap/schema/rfc2307bis.schema&lt;/includeschema&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;includeschema&gt;/etc/openldap/schema/yast.schema&lt;/includeschema&gt;
      &lt;/listentry&gt;
    &lt;/schema&gt;
  &lt;/auth-server&gt;
    </screen>
   </example>
  </sect1>

  <sect1 xml:id="Configuration.Network.Samba_client">
   <title>Windows ドメインのメンバーシップ</title>

   <para><literal>samba-client</literal> リソースを使用することで、ワークグループや NT ドメイン、もしくは Active Directory ドメインのメンバーとして構成することができます。</para>

   <example>
    <title>Samba クライアント設定</title>
<screen>
  &lt;samba-client&gt;
    &lt;disable_dhcp_hostname config:type="boolean"&gt;true&lt;/disable_dhcp_hostname&gt;
    &lt;global&gt;
      &lt;security&gt;domain&lt;/security&gt;
      &lt;usershare_allow_guests&gt;No&lt;/usershare_allow_guests&gt;
      &lt;usershare_max_shares&gt;100&lt;/usershare_max_shares&gt;
      &lt;workgroup&gt;WORKGROUP&lt;/workgroup&gt;
    &lt;/global&gt;
    &lt;winbind config:type="boolean"&gt;false&lt;/winbind&gt;
  &lt;/samba-client&gt;
</screen>
   </example>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>disable_dhcp_hostname</literal></para>
       </entry>
       <entry>
        <para>DHCP に対してホスト名の変更を許可しないようにします。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>global/security</literal></para>
       </entry>
       <entry>
        <para>認証方式を設定します (NT ドメイン (domain) もしくは Active Directory サーバ (ADS)) 。</para>
       </entry>
       <entry>
        <para>値: ADS/domain</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>global/usershare_allow_guests</literal></para>
       </entry>
       <entry>
        <para>ゲストアクセスの共有を許可するかどうかを指定します。</para>
       </entry>
       <entry>
        <para>値: No (いいえ)/Yes (はい)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>global/usershare_max_shares</literal></para>
       </entry>
       <entry>
        <para><filename>smb.conf</filename> での最大共有数を指定します。</para>
       </entry>
       <entry>
        <para>0 を指定すると、共有を無効化する意味になります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>global/workgroup</literal></para>
       </entry>
       <entry>
        <para>ワークグループもしくはドメイン名を指定します。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>winbind</literal></para>
       </entry>
       <entry>
        <para>winbind を使用するかどうかを指定します。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect1>

  <sect1 xml:id="Configuration.Network.Samba_server">
   <title>Samba サーバ</title>

   <para>シンプルな Samba サーバの設定を行なうことができます。</para>

   <example>
    <title>Samba サーバ設定</title>
<screen>
  &lt;samba-server&gt;
    &lt;accounts config:type="list"/&gt;
    &lt;backend/&gt;
    &lt;config config:type="list"&gt;
      &lt;listentry&gt;
        &lt;name&gt;global&lt;/name&gt;
        &lt;parameters&gt;
          &lt;security&gt;domain&lt;/security&gt;
          &lt;usershare_allow_guests&gt;No&lt;/usershare_allow_guests&gt;
          &lt;usershare_max_shares&gt;100&lt;/usershare_max_shares&gt;
          &lt;workgroup&gt;WORKGROUP&lt;/workgroup&gt;
        &lt;/parameters&gt;
      &lt;/listentry&gt;
    &lt;/config&gt;
    &lt;service&gt;Disabled&lt;/service&gt;
    &lt;trustdom/&gt;
    &lt;version&gt;2.11&lt;/version&gt;
  &lt;/samba-server&gt;
</screen>
   </example>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>accounts</literal></para>
       </entry>
       <entry>
        <para>Samba アカウントのリスト。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>backend</literal></para>
       </entry>
       <entry>
        <para>利用可能なバックエンドのリスト。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>config</literal></para>
       </entry>
       <entry>
        <para><filename>/etc/samba/smb.conf</filename> 内に設定する追加のユーザ定義パラメータを指定します。</para>
       </entry>
       <entry>
        <para>詳しくは <filename>/etc/samba/smb.conf</filename> ファイル内の <literal>global</literal> パラメータをお読みください。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>service</literal></para>
       </entry>
       <entry>
        <para>Samba サービスを起動時に開始するかどうかを指定します。</para>
       </entry>
       <entry>
        <para>値: Enabled (有効)/Disabled (無効)</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>trustdom/</literal></para>
       </entry>
       <entry>
        <para>信頼するドメインを指定します。</para>
       </entry>
       <entry>
        <para>2 つのマップを指定します (キー: <literal>establish, revoke</literal>) 。各マップには <literal>key: domainname</literal> <literal>value: password</literal> の形式で項目を設定します。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>version</literal></para>
       </entry>
       <entry>
        <para>Samba のバージョンを指定します。</para>
       </entry>
       <entry>
        <para>既定値: 2.11</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect1>

  <sect1 xml:id="Configuration.Network.Auth">
   <title>認証クライアント</title>

   <para>下記は LDAP ユーザ認証を行なう場合のシンプルな例です。 NSS と PAM についても、必要に応じて自動設定されます。必要なデータは検索ベース (ベース DN 、例: <literal>dc=mydomain,dc=com</literal> ) と LDAP サーバの IP アドレスです。</para>

   <example>
    <title>ネットワーク設定: 認証クライアント</title>
<screen>&lt;auth-client&gt;
  &lt;sssd&gt;yes&lt;/sssd&gt;
  &lt;nssldap&gt;no&lt;/nssldap&gt;
  &lt;sssd_conf&gt;
    &lt;sssd&gt;
      &lt;config_file_version&gt;2&lt;/config_file_version&gt;
      &lt;services&gt;nss, pam, sudo&lt;/services&gt;
      &lt;domains&gt;EXAMPLE&lt;/domains&gt;
    &lt;/sssd&gt;
    &lt;auth_domains&gt;
      &lt;domain&gt;
        &lt;domain_name&gt;EXAMPLE&lt;/domain_name&gt;
        &lt;id_provider&gt;ldap&lt;/id_provider&gt;
        &lt;sudo_provider&gt;ldap&lt;/sudo_provider&gt;
        &lt;ldap_uri&gt;ldap://&exampledomain;&lt;/ldap_uri&gt;
        &lt;ldap_sudo_search_base&gt;ou=sudoers,dc=example,dc=com&lt;/ldap_sudo_search_base&gt;
      &lt;/domain&gt;
    &lt;/auth_domains&gt;
  &lt;/sssd_conf&gt;
&lt;/auth-client&gt;</screen>
   </example>

   <tip>
    <title>ldaps:// の使用について</title>
    <para>ネイティブ SSL (TLS ではなく) で LDAP を使用するには、 <literal>ldaps</literal> リソースを追加します:</para>
<screen>&lt;auth-client&gt;
  &lt;sssd_conf&gt;
    &lt;auth_domains&gt;
      &lt;domain&gt;
        &lt;ldaps config:type="boolean"&gt;true&lt;/ldaps&gt;
      &lt;/domain&gt;
    &lt;/auth_domains&gt;
  &lt;/sssd_conf&gt;
&lt;/auth-client&gt;</screen>
   </tip>
  </sect1>
  <sect1 xml:id="ay.nfs">
   <title>NFS クライアントおよびサーバ</title>

   <para>設定システムを使用することで、 NFS クライアントも NFS サーバも設定することができます。下記の例では、 NFS クライアントと NFS サーバの両方を設定する場合の例を示しています。</para>

   <para>&productname; &productnumber; およびそれ以降では、 NFS クライアントの設定構造が変更されています。それぞれ下記に示すグローバル設定オプションが追加されています:  <literal>enable_nfs4</literal> (NFS4 サポートの有効化／無効化), <literal>idmapd_domain</literal> (rpc.idmapd 向けのドメイン名設定 (NFS4 が有効化されている場合にのみ効果があります)) 。注意: 古い構造は新しい構造とは互換性が無く、古いリリースで作成された NFS セクションを含む制御ファイルは、新しい製品では動作しません。</para>

   <para>&productname; を NFS 共有にインストールする方法については、 <xref linkend="ay.partition_nfs"/> をお読みください。</para>

   <example>
    <title>ネットワーク設定: NFS クライアント</title>
<screen>&lt;nfs&gt;
  &lt;enable_nfs4 config:type="boolean"&gt;true&lt;/enable_nfs4&gt;
  &lt;idmapd_domain&gt;suse.cz&lt;/idmapd_domain&gt;
  &lt;nfs_entries config:type="list"&gt;
    &lt;nfs_entry&gt;
      &lt;mount_point&gt;/home&lt;/mount_point&gt;
      &lt;nfs_options&gt;sec=krb5i,intr,rw&lt;/nfs_options&gt;
      &lt;server_path&gt;saurus.suse.cz:/home&lt;/server_path&gt;
      &lt;vfstype&gt;nfs4&lt;/vfstype&gt;
    &lt;/nfs_entry&gt;
    &lt;nfs_entry&gt;
      &lt;mount_point&gt;/work&lt;/mount_point&gt;
      &lt;nfs_options&gt;defaults&lt;/nfs_options&gt;
      &lt;server_path&gt;bivoj.suse.cz:/work&lt;/server_path&gt;
      &lt;vfstype&gt;nfs&lt;/vfstype&gt;
    &lt;/nfs_entry&gt;
    &lt;nfs_entry&gt;
      &lt;mount_point&gt;/mnt&lt;/mount_point&gt;
      &lt;nfs_options&gt;defaults&lt;/nfs_options&gt;
      &lt;server_path&gt;fallback.suse.cz:/srv/dist&lt;/server_path&gt;
      &lt;vfstype&gt;nfs&lt;/vfstype&gt;
    &lt;/nfs_entry&gt;
  &lt;/nfs_entries&gt;
&lt;/nfs&gt;</screen>
   </example>

   <example>
    <title>ネットワーク設定: NFS サーバ</title>
<screen>&lt;nfs_server&gt;
  &lt;nfs_exports config:type="list"&gt;
    &lt;nfs_export&gt;
      &lt;allowed config:type="list"&gt;
        &lt;allowed_clients&gt;*(ro,root_squash,sync)&lt;/allowed_clients&gt;
      &lt;/allowed&gt;
      &lt;mountpoint&gt;/home&lt;/mountpoint&gt;
    &lt;/nfs_export&gt;
    &lt;nfs_export&gt;
      &lt;allowed config:type="list"&gt;
        &lt;allowed_clients&gt;*(ro,root_squash,sync)&lt;/allowed_clients&gt;
      &lt;/allowed&gt;
      &lt;mountpoint&gt;/work&lt;/mountpoint&gt;
    &lt;/nfs_export&gt;
  &lt;/nfs_exports&gt;
  &lt;start_nfsserver config:type="boolean"&gt;true&lt;/start_nfsserver&gt;
&lt;/nfs_server&gt;</screen>
   </example>
  </sect1>
  <sect1 xml:id="Configuration.Network.Ntp">
   <title>NTP クライアント</title>

   <important>
    <title>NTP クライアント設定の非互換性について</title>
    <para>&productname; 15 およびそれ以降のバージョンでは、 NTP クライアントの設定が新しい形式となり、以前のプロファイルとは互換性が <emphasis>なくなっています</emphasis> 。以前の &productname; バージョンで使用していたプロファイル内に NTP クライアントの設定が含まれている場合は、バージョン 15 もしくはそれ以降に対応するために更新を行なう必要があります。</para>
   </important>

   <para>下記に NTP クライアントの設定例を示します:</para>

   <example>
    <title>ネットワーク設定: NTP クライアント</title>
<screen>
&lt;ntp-client&gt;
&lt;ntp_policy&gt;auto&lt;/ntp_policy&gt;<co xml:id="co.ay.ntp.policy"/>
 &lt;ntp_servers config:type="list"&gt;
  &lt;ntp_server&gt;
   &lt;address&gt;cz.pool.ntp.org&lt;/address&gt;<co xml:id="co.ay.ntp.address"/>
   &lt;iburst config:type="boolean"&gt;false&lt;/iburst&gt;<co xml:id="co.ay.ntp.iburst"/>
   &lt;offline config:type="boolean"&gt;true&lt;/offline&gt;<co xml:id="co.ay.ntp.offline"/>
  &lt;/ntp_server&gt;
 &lt;/ntp_servers&gt;
 &lt;ntp_sync&gt;15&lt;/ntp_sync&gt;<co xml:id="co.ay.ntp.sync"/>
&lt;/ntp-client&gt;
</screen>
    <calloutlist>
     <callout arearefs="co.ay.ntp.policy">
      <para><literal>ntp_policy</literal> には <filename>/etc/sysconfig/network/config</filename> 内の <option>NETCONFIG_NTP_POLICY</option> と同じ値を設定することができます。最もよく使用する値は 'static' と 'auto' (既定値) です。詳しくは <command>man 8 netconfig</command> をお読みください。</para>
     </callout>
     <callout arearefs="co.ay.ntp.address">
      <para>タイムサーバもしくはタイムサーバのプールの URL を指定します。</para>
    </callout>
     <callout arearefs="co.ay.ntp.iburst">
      <para><option>iburst</option> を指定すると、 &chronyd; の起動直後の初期時刻同期を高速化することができます。</para>
     </callout>
     <callout arearefs="co.ay.ntp.offline">
      <para><option>offline</option> を指定すると、ネットワークインターフェイスが有効化されていない場合に、問い合わせを行なわないようになります。</para>
      </callout>
      <callout arearefs="co.ay.ntp.sync">
      <para><option>ntp_sync</option> に対しては、 NTP デーモンを起動する場合は 'systemd' (既定値) を、 cron を利用して定期的に同期する場合は <emphasis>整数値</emphasis> を、自動的な同期を行なわない場合は 'manual' をそれぞれ指定します。</para>
     </callout>
    </calloutlist>
   </example>

  </sect1>
  <sect1 xml:id="Configuration.Network.Sendmail">
   <title>メールの設定</title>

   <para>メールのクライアント側の設定を行なうには、このモジュールで詳細な設定を行ないます。このモジュールにはさまざまなオプションが含まれていますが、あくまでも初期設定として使用することをお勧めします。</para>

   <example>
    <title>メールの設定</title>
<screen>&lt;mail&gt;
  &lt;aliases config:type="list"&gt;
    &lt;alias&gt;
      &lt;alias&gt;root&lt;/alias&gt;
      &lt;comment&gt;&lt;/comment&gt;
      &lt;destinations&gt;foo&lt;/destinations&gt;
    &lt;/alias&gt;
    &lt;alias&gt;
      &lt;alias&gt;test&lt;/alias&gt;
      &lt;comment&gt;&lt;/comment&gt;
      &lt;destinations&gt;foo&lt;/destinations&gt;
    &lt;/alias&gt;
  &lt;/aliases&gt;
  &lt;connection_type config:type="symbol"&gt;permanent&lt;/connection_type&gt;
  &lt;fetchmail config:type="list"&gt;
    &lt;fetchmail_entry&gt;
      &lt;local_user&gt;foo&lt;/local_user&gt;
      &lt;password&gt;bar&lt;/password&gt;
      &lt;protocol&gt;POP3&lt;/protocol&gt;
      &lt;remote_user&gt;foo&lt;/remote_user&gt;
      &lt;server&gt;pop.foo.com&lt;/server&gt;
    &lt;/fetchmail_entry&gt;
    &lt;fetchmail_entry&gt;
      &lt;local_user&gt;test&lt;/local_user&gt;
      &lt;password&gt;bar&lt;/password&gt;
      &lt;protocol&gt;IMAP&lt;/protocol&gt;
      &lt;remote_user&gt;test&lt;/remote_user&gt;
      &lt;server&gt;blah.com&lt;/server&gt;
    &lt;/fetchmail_entry&gt;
  &lt;/fetchmail&gt;
  &lt;from_header&gt;test.com&lt;/from_header&gt;
  &lt;listen_remote config:type="boolean"&gt;true&lt;/listen_remote&gt;
  &lt;local_domains config:type="list"&gt;
    &lt;domains&gt;test1.com&lt;/domains&gt;
  &lt;/local_domains&gt;
  &lt;masquerade_other_domains config:type="list"&gt;
      &lt;domain&gt;blah.com&lt;/domain&gt;
  &lt;/masquerade_other_domains&gt;
  &lt;masquerade_users config:type="list"&gt;
    &lt;masquerade_user&gt;
      &lt;address&gt;joe@test.com&lt;/address&gt;
      &lt;comment&gt;&lt;/comment&gt;
      &lt;user&gt;joeuser&lt;/user&gt;
    &lt;/masquerade_user&gt;
    &lt;masquerade_user&gt;
      &lt;address&gt;bar@test.com&lt;/address&gt;
      &lt;comment&gt;&lt;/comment&gt;
      &lt;user&gt;foo&lt;/user&gt;
    &lt;/masquerade_user&gt;
  &lt;/masquerade_users&gt;
  &lt;mta config:type="symbol"&gt;postfix&lt;/mta&gt;
  &lt;outgoing_mail_server&gt;test.com&lt;/outgoing_mail_server&gt;
  &lt;postfix_mda config:type="symbol"&gt;local&lt;/postfix_mda&gt;
  &lt;smtp_auth config:type="list"&gt;
    &lt;listentry&gt;
      &lt;password&gt;bar&lt;/password&gt;
      &lt;server&gt;test.com&lt;/server&gt;
      &lt;user&gt;foo&lt;/user&gt;
    &lt;/listentry&gt;
  &lt;/smtp_auth&gt;
  &lt;use_amavis config:type="boolean"&gt;true&lt;/use_amavis&gt;
  &lt;virtual_users config:type="list"&gt;
    &lt;virtual_user&gt;
      &lt;alias&gt;test.com&lt;/alias&gt;
      &lt;comment&gt;&lt;/comment&gt;
      &lt;destinations&gt;foo.com&lt;/destinations&gt;
    &lt;/virtual_user&gt;
    &lt;virtual_user&gt;
      &lt;alias&gt;geek.com&lt;/alias&gt;
      &lt;comment&gt;&lt;/comment&gt;
      &lt;destinations&gt;bar.com&lt;/destinations&gt;
    &lt;/virtual_user&gt;
  &lt;/virtual_users&gt;
&lt;/mail&gt;</screen>
   </example>
  </sect1>

  <sect1 xml:id="Configuration.Network.apache">
   <title>HTTP サーバの設定</title>

   <para>このセクションは、 Apache HTTP サーバを設定するために使用します。</para>
   <para>知識のあるユーザである場合を除き、まずは &yast; の <literal>HTTP サーバ</literal>モジュールを利用して Apache サーバを設定しておくことをお勧めします。設定後、 <literal>&ay; 設定</literal> モジュールを呼び出して、 <literal>HTTP サーバ</literal> &yast; モジュールを選択し、 Apache の設定を複製するとよいでしょう。これらの設定は、 <literal>ファイル</literal> メニューを利用することでエクスポートすることができます。</para>

   <example>
    <title>HTTP サーバの設定</title>
<screen>
  &lt;http-server&gt;
    &lt;Listen config:type="list"&gt;
      &lt;listentry&gt;
        &lt;ADDRESS/&gt;
        &lt;PORT&gt;80&lt;/PORT&gt;
      &lt;/listentry&gt;
    &lt;/Listen&gt;
    &lt;hosts config:type="list"&gt;
      &lt;hosts_entry&gt;
        &lt;KEY&gt;main&lt;/KEY&gt;
        &lt;VALUE config:type="list"&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;DocumentRoot&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            #
            # Global configuration that will be applicable for all
            # virtual hosts, unless deleted here or overriden elsewhere.
            #
            &lt;/OVERHEAD&gt;
            &lt;VALUE&gt;"/srv/www/htdocs"&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;_SECTION&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            #
            # Configure the DocumentRoot
            #
            &lt;/OVERHEAD&gt;
            &lt;SECTIONNAME&gt;Directory&lt;/SECTIONNAME&gt;
            &lt;SECTIONPARAM&gt;"/srv/www/htdocs"&lt;/SECTIONPARAM&gt;
            &lt;VALUE config:type="list"&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;Options&lt;/KEY&gt;
                &lt;OVERHEAD&gt;
                # Possible values for the Options directive are "None", "All",
                # or any combination of:
                #   Indexes Includes FollowSymLinks SymLinksifOwnerMatch
                #   ExecCGI MultiViews
                #
                # Note that "MultiViews" must be named *explicitly*
                # --- "Options All"
                # does not give it to you.
                #
                # The Options directive is both complicated and important.
                #  Please see
                #  http://httpd.apache.org/docs/2.4/mod/core.html#options
                # for more information.
                &lt;/OVERHEAD&gt;
                &lt;VALUE&gt;None&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;AllowOverride&lt;/KEY&gt;
                &lt;OVERHEAD&gt;
                # AllowOverride controls what directives may be placed in
                # .htaccess files. It can be "All", "None", or any combination
                # of the keywords:
                #   Options FileInfo AuthConfig Limit
                &lt;/OVERHEAD&gt;
                &lt;VALUE&gt;None&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;_SECTION&lt;/KEY&gt;
                &lt;OVERHEAD&gt;
                # Controls who can get stuff from this server.
                &lt;/OVERHEAD&gt;
                &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
                &lt;SECTIONPARAM&gt;!mod_access_compat.c&lt;/SECTIONPARAM&gt;
                &lt;VALUE config:type="list"&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Require&lt;/KEY&gt;
                    &lt;VALUE&gt;all granted&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                &lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;_SECTION&lt;/KEY&gt;
                &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
                &lt;SECTIONPARAM&gt;mod_access_compat.c&lt;/SECTIONPARAM&gt;
                &lt;VALUE config:type="list"&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Order&lt;/KEY&gt;
                    &lt;VALUE&gt;allow,deny&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Allow&lt;/KEY&gt;
                    &lt;VALUE&gt;from all&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                &lt;/VALUE&gt;
              &lt;/listentry&gt;
            &lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;Alias&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            # Aliases: aliases can be added as needed (with no limit).
            # The format is Alias fakename realname
            #
            # Note that if you include a trailing / on fakename then the
            # server will require it to be present in the URL.  So "/icons"
            # is not aliased in this example, only "/icons/".  If the fakename
            # is slash-terminated, then the realname must also be slash
            # terminated, and if the fakename omits the trailing slash, the
            # realname must also omit it.
            # We include the /icons/ alias for FancyIndexed directory listings.
            # If you do not use FancyIndexing, you may comment this out.
            #
            &lt;/OVERHEAD&gt;
            &lt;VALUE&gt;/icons/ "/usr/share/apache2/icons/"&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;_SECTION&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            &lt;/OVERHEAD&gt;
            &lt;SECTIONNAME&gt;Directory&lt;/SECTIONNAME&gt;
            &lt;SECTIONPARAM&gt;"/usr/share/apache2/icons"&lt;/SECTIONPARAM&gt;
            &lt;VALUE config:type="list"&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;Options&lt;/KEY&gt;
                &lt;VALUE&gt;Indexes MultiViews&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;AllowOverride&lt;/KEY&gt;
                &lt;VALUE&gt;None&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;_SECTION&lt;/KEY&gt;
                &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
                &lt;SECTIONPARAM&gt;!mod_access_compat.c&lt;/SECTIONPARAM&gt;
                &lt;VALUE config:type="list"&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Require&lt;/KEY&gt;
                    &lt;VALUE&gt;all granted&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                &lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;_SECTION&lt;/KEY&gt;
                &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
                &lt;SECTIONPARAM&gt;mod_access_compat.c&lt;/SECTIONPARAM&gt;
                &lt;VALUE config:type="list"&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Order&lt;/KEY&gt;
                    &lt;VALUE&gt;allow,deny&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Allow&lt;/KEY&gt;
                    &lt;VALUE&gt;from all&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                &lt;/VALUE&gt;
              &lt;/listentry&gt;
            &lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;ScriptAlias&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            # ScriptAlias: This controls which directories contain server
            # scripts. ScriptAliases are essentially the same as Aliases,
            # except that documents in the realname directory are treated
            # as applications and run by the server when requested rather
            # than as documents sent to the client.
            # The same rules about trailing "/" apply to ScriptAlias
            # directives as to Alias.
            #
            &lt;/OVERHEAD&gt;
            &lt;VALUE&gt;/cgi-bin/ "/srv/www/cgi-bin/"&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;_SECTION&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            # "/srv/www/cgi-bin" should be changed to wherever your
            # ScriptAliased CGI directory exists, if you have that configured.
            #
            &lt;/OVERHEAD&gt;
            &lt;SECTIONNAME&gt;Directory&lt;/SECTIONNAME&gt;
            &lt;SECTIONPARAM&gt;"/srv/www/cgi-bin"&lt;/SECTIONPARAM&gt;
            &lt;VALUE config:type="list"&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;AllowOverride&lt;/KEY&gt;
                &lt;VALUE&gt;None&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;Options&lt;/KEY&gt;
                &lt;VALUE&gt;+ExecCGI -Includes&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;_SECTION&lt;/KEY&gt;
                &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
                &lt;SECTIONPARAM&gt;!mod_access_compat.c&lt;/SECTIONPARAM&gt;
                &lt;VALUE config:type="list"&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Require&lt;/KEY&gt;
                    &lt;VALUE&gt;all granted&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                &lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;_SECTION&lt;/KEY&gt;
                &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
                &lt;SECTIONPARAM&gt;mod_access_compat.c&lt;/SECTIONPARAM&gt;
                &lt;VALUE config:type="list"&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Order&lt;/KEY&gt;
                    &lt;VALUE&gt;allow,deny&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                  &lt;listentry&gt;
                    &lt;KEY&gt;Allow&lt;/KEY&gt;
                    &lt;VALUE&gt;from all&lt;/VALUE&gt;
                  &lt;/listentry&gt;
                &lt;/VALUE&gt;
              &lt;/listentry&gt;
            &lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;_SECTION&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            # UserDir: The name of the directory that is appended onto a
            # user's home directory if a ~user request is received.
            # To disable it, simply remove userdir from the list of modules
            # in APACHE_MODULES in /etc/sysconfig/apache2.
            #
            &lt;/OVERHEAD&gt;
            &lt;SECTIONNAME&gt;IfModule&lt;/SECTIONNAME&gt;
            &lt;SECTIONPARAM&gt;mod_userdir.c&lt;/SECTIONPARAM&gt;
            &lt;VALUE config:type="list"&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;UserDir&lt;/KEY&gt;
                &lt;OVERHEAD&gt;
                # Note that the name of the user directory ("public_html")
                # cannot simply be changed here, since it is a compile time
                # setting. The apache package would have to be rebuilt.
                # You could work around by deleting /usr/sbin/suexec, but
                # then all scripts from the directories would be executed
                # with the UID of the webserver.
                &lt;/OVERHEAD&gt;
                &lt;VALUE&gt;public_html&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;Include&lt;/KEY&gt;
                &lt;OVERHEAD&gt;
                # The actual configuration of the directory is in
                # /etc/apache2/mod_userdir.conf.
                &lt;/OVERHEAD&gt;
                &lt;VALUE&gt;/etc/apache2/mod_userdir.conf&lt;/VALUE&gt;
              &lt;/listentry&gt;
            &lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;IncludeOptional&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            # Include all *.conf files from /etc/apache2/conf.d/.
            #
            # This is mostly meant as a place for other RPM packages to drop
            # in their configuration snippet.
            #
            # <remark>The following wording is not grammatically correct, however I am not sure of the intended meaning. Please revise.</remark>
            # You can comment this out here if you want those bits include
            # only in a certain virtual host, but not here.
            &lt;/OVERHEAD&gt;
            &lt;VALUE&gt;/etc/apache2/conf.d/*.conf&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;IncludeOptional&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            # The manual... if it is installed ('?' means it will not complain)
            &lt;/OVERHEAD&gt;
            &lt;VALUE&gt;/etc/apache2/conf.d/apache2-manual?conf&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;ServerName&lt;/KEY&gt;
            &lt;VALUE&gt;linux-wtyj&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;ServerAdmin&lt;/KEY&gt;
            &lt;OVERHEAD&gt;
            &lt;/OVERHEAD&gt;
            &lt;VALUE&gt;root@linux-wtyj&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;NameVirtualHost&lt;/KEY&gt;
            &lt;VALUE&gt;192.168.43.2&lt;/VALUE&gt;
          &lt;/listentry&gt;
        &lt;/VALUE&gt;
      &lt;/hosts_entry&gt;
      &lt;hosts_entry&gt;
        &lt;KEY&gt;192.168.43.2/secondserver.suse.de&lt;/KEY&gt;
        &lt;VALUE config:type="list"&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;DocumentRoot&lt;/KEY&gt;
            &lt;VALUE&gt;/srv/www/htdocs&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;ServerName&lt;/KEY&gt;
            &lt;VALUE&gt;secondserver.suse.de&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;ServerAdmin&lt;/KEY&gt;
            &lt;VALUE&gt;second_server@suse.de&lt;/VALUE&gt;
          &lt;/listentry&gt;
          &lt;listentry&gt;
            &lt;KEY&gt;_SECTION&lt;/KEY&gt;
            &lt;SECTIONNAME&gt;Directory&lt;/SECTIONNAME&gt;
            &lt;SECTIONPARAM&gt;/srv/www/htdocs&lt;/SECTIONPARAM&gt;
            &lt;VALUE config:type="list"&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;AllowOverride&lt;/KEY&gt;
                &lt;VALUE&gt;None&lt;/VALUE&gt;
              &lt;/listentry&gt;
              &lt;listentry&gt;
                &lt;KEY&gt;Require&lt;/KEY&gt;
                &lt;VALUE&gt;all granted&lt;/VALUE&gt;
              &lt;/listentry&gt;
            &lt;/VALUE&gt;
          &lt;/listentry&gt;
        &lt;/VALUE&gt;
      &lt;/hosts_entry&gt;
    &lt;/hosts&gt;
    &lt;modules config:type="list"&gt;
      &lt;module_entry&gt;
        &lt;change&gt;enable&lt;/change&gt;
        &lt;name&gt;socache_shmcb&lt;/name&gt;
        &lt;userdefined config:type="boolean"&gt;true&lt;/userdefined&gt;
      &lt;/module_entry&gt;
      &lt;module_entry&gt;
        &lt;change&gt;enable&lt;/change&gt;
        &lt;name&gt;reqtimeout&lt;/name&gt;
        &lt;userdefined config:type="boolean"&gt;true&lt;/userdefined&gt;
      &lt;/module_entry&gt;
      &lt;module_entry&gt;
        &lt;change&gt;enable&lt;/change&gt;
        &lt;name&gt;authn_core&lt;/name&gt;
        &lt;userdefined config:type="boolean"&gt;true&lt;/userdefined&gt;
      &lt;/module_entry&gt;
      &lt;module_entry&gt;
        &lt;change&gt;enable&lt;/change&gt;
        &lt;name&gt;authz_core&lt;/name&gt;
        &lt;userdefined config:type="boolean"&gt;true&lt;/userdefined&gt;
      &lt;/module_entry&gt;
    &lt;/modules&gt;
    &lt;service config:type="boolean"&gt;true&lt;/service&gt;
    &lt;version&gt;2.9&lt;/version&gt;
  &lt;/http-server&gt;
</screen>
   </example>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>リスト名</para>
        </entry>
        <entry>
         <para>リスト要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>Listen</para>
        </entry>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>ホストの <literal>Listen</literal> 設定のリストを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>PORT</para>
        </entry>
        <entry>
         <para>ポート番号。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>ADDRESS</para>
        </entry>
        <entry>
         <para>ネットワークアドレス。何も指定しない場合、全てのアドレスを指定したものとみなされます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>hosts</para>
        </entry>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>仮想ホスト設定のリストを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>KEY</para>
        </entry>
        <entry>
         <para>ホスト名を指定します。 <literal>&lt;KEY&gt;main&lt;/KEY&gt;</literal> を指定すると、メインの仮想ホストの意味になります。例: <literal>&lt;KEY&gt;192.168.43.2/secondserver.suse.de&lt;/KEY&gt;</literal></para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>VALUE</para>
        </entry>
        <entry>
         <para>そのホストに設定するさまざまな値を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>modules</para>
        </entry>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>モジュールのリストです。ユーザ側で必要なモジュールのみを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>name</para>
        </entry>
        <entry>
         <para>モジュール名</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>userdefined</para>
        </entry>
        <entry>
         <para>過去のバージョンの経緯から、この値は常に <literal>true</literal> に設定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
         </para>
        </entry>
        <entry>
         <para>
          change
         </para>
        </entry>
        <entry>
         <para>過去のバージョンの経緯から、この値は常に <literal>enable</literal> に設定します。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>version</para>
        </entry>
        <entry>
         <para>使用する Apache サーバのバージョン</para>
        </entry>
        <entry>
          <para>情報提供の意味で設定するだけです。既定値: 2.9</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>service</para>
        </entry>
        <entry>
         <para>Apache サービスの有効化</para>
        </entry>
        <entry>
         <para>任意指定です。既定値: false</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <note>
      <title>ファイアウオールについて</title>
      <para>Apache サーバを正しく動作させるには、あわせてファイアウオールも設定する必要があります。</para>
    </note>

  </sect1>

  <sect1 xml:id="Configuration.Network.Squid">
   <title>squid サーバ</title>

   <para>squid はキャッシュ機能付きの Web プロキシサービスです。</para>

   <example>
    <title>squid サーバの設定</title>
<screen>
  &lt;squid&gt;
    &lt;acls config:type="list"&gt;
      &lt;listentry&gt;
        &lt;name&gt;QUERY&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;cgi-bin \?&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;urlpath_regex&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;apache&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;Server&lt;/option&gt;
          &lt;option&gt;^Apache&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;rep_header&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;all&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;0.0.0.0/0.0.0.0&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;src&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;manager&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;cache_object&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;proto&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;localhost&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;127.0.0.1/255.255.255.255&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;src&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;to_localhost&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;127.0.0.0/8&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;dst&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;SSL_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;443&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;80&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;21&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;443&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;70&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;210&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;1025-65535&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;280&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;488&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;591&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;Safe_ports&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;777&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;port&lt;/type&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;name&gt;CONNECT&lt;/name&gt;
        &lt;options config:type="list"&gt;
          &lt;option&gt;CONNECT&lt;/option&gt;
        &lt;/options&gt;
        &lt;type&gt;method&lt;/type&gt;
      &lt;/listentry&gt;
    &lt;/acls&gt;
    &lt;http_accesses config:type="list"&gt;
      &lt;listentry&gt;
        &lt;acl config:type="list"&gt;
          &lt;listentry&gt;manager&lt;/listentry&gt;
          &lt;listentry&gt;localhost&lt;/listentry&gt;
        &lt;/acl&gt;
        &lt;allow config:type="boolean"&gt;true&lt;/allow&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;acl config:type="list"&gt;
          &lt;listentry&gt;manager&lt;/listentry&gt;
        &lt;/acl&gt;
        &lt;allow config:type="boolean"&gt;false&lt;/allow&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;acl config:type="list"&gt;
          &lt;listentry&gt;!Safe_ports&lt;/listentry&gt;
        &lt;/acl&gt;
        &lt;allow config:type="boolean"&gt;false&lt;/allow&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;acl config:type="list"&gt;
          &lt;listentry&gt;CONNECT&lt;/listentry&gt;
          &lt;listentry&gt;!SSL_ports&lt;/listentry&gt;
        &lt;/acl&gt;
        &lt;allow config:type="boolean"&gt;false&lt;/allow&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;acl config:type="list"&gt;
          &lt;listentry&gt;localhost&lt;/listentry&gt;
        &lt;/acl&gt;
        &lt;allow config:type="boolean"&gt;true&lt;/allow&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;acl config:type="list"&gt;
          &lt;listentry&gt;all&lt;/listentry&gt;
        &lt;/acl&gt;
        &lt;allow config:type="boolean"&gt;false&lt;/allow&gt;
      &lt;/listentry&gt;
    &lt;/http_accesses&gt;
    &lt;http_ports config:type="list"&gt;
      &lt;listentry&gt;
        &lt;host/&gt;
        &lt;port&gt;3128&lt;/port&gt;
        &lt;transparent config:type="boolean"&gt;false&lt;/transparent&gt;
      &lt;/listentry&gt;
    &lt;/http_ports&gt;
    &lt;refresh_patterns config:type="list"&gt;
      &lt;listentry&gt;
        &lt;case_sensitive config:type="boolean"&gt;true&lt;/case_sensitive&gt;
        &lt;max&gt;10080&lt;/max&gt;
        &lt;min&gt;1440&lt;/min&gt;
        &lt;percent&gt;20&lt;/percent&gt;
        &lt;regexp&gt;^ftp:&lt;/regexp&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;case_sensitive config:type="boolean"&gt;true&lt;/case_sensitive&gt;
        &lt;max&gt;1440&lt;/max&gt;
        &lt;min&gt;1440&lt;/min&gt;
        &lt;percent&gt;0&lt;/percent&gt;
        &lt;regexp&gt;^gopher:&lt;/regexp&gt;
      &lt;/listentry&gt;
      &lt;listentry&gt;
        &lt;case_sensitive config:type="boolean"&gt;true&lt;/case_sensitive&gt;
        &lt;max&gt;4320&lt;/max&gt;
        &lt;min&gt;0&lt;/min&gt;
        &lt;percent&gt;20&lt;/percent&gt;
        &lt;regexp&gt;.&lt;/regexp&gt;
      &lt;/listentry&gt;
    &lt;/refresh_patterns&gt;
    &lt;service_enabled_on_startup config:type="boolean"&gt;true&lt;/service_enabled_on_startup&gt;
    &lt;settings&gt;
      &lt;access_log config:type="list"&gt;
        &lt;listentry&gt;/var/log/squid/access.log&lt;/listentry&gt;
      &lt;/access_log&gt;
      &lt;cache_dir config:type="list"&gt;
        &lt;listentry&gt;ufs&lt;/listentry&gt;
        &lt;listentry&gt;/var/cache/squid&lt;/listentry&gt;
        &lt;listentry&gt;100&lt;/listentry&gt;
        &lt;listentry&gt;16&lt;/listentry&gt;
        &lt;listentry&gt;256&lt;/listentry&gt;
      &lt;/cache_dir&gt;
      &lt;cache_log config:type="list"&gt;
        &lt;listentry&gt;/var/log/squid/cache.log&lt;/listentry&gt;
      &lt;/cache_log&gt;
      &lt;cache_mem config:type="list"&gt;
        &lt;listentry&gt;8&lt;/listentry&gt;
        &lt;listentry&gt;MB&lt;/listentry&gt;
      &lt;/cache_mem&gt;
      &lt;cache_mgr config:type="list"&gt;
        &lt;listentry&gt;webmaster&lt;/listentry&gt;
      &lt;/cache_mgr&gt;
      &lt;cache_replacement_policy config:type="list"&gt;
        &lt;listentry&gt;lru&lt;/listentry&gt;
      &lt;/cache_replacement_policy&gt;
      &lt;cache_store_log config:type="list"&gt;
        &lt;listentry&gt;/var/log/squid/store.log&lt;/listentry&gt;
      &lt;/cache_store_log&gt;
      &lt;cache_swap_high config:type="list"&gt;
        &lt;listentry&gt;95&lt;/listentry&gt;
      &lt;/cache_swap_high&gt;
      &lt;cache_swap_low config:type="list"&gt;
        &lt;listentry&gt;90&lt;/listentry&gt;
      &lt;/cache_swap_low&gt;
      &lt;client_lifetime config:type="list"&gt;
        &lt;listentry&gt;1&lt;/listentry&gt;
        &lt;listentry&gt;days&lt;/listentry&gt;
      &lt;/client_lifetime&gt;
      &lt;connect_timeout config:type="list"&gt;
        &lt;listentry&gt;2&lt;/listentry&gt;
        &lt;listentry&gt;minutes&lt;/listentry&gt;
      &lt;/connect_timeout&gt;
      &lt;emulate_httpd_log config:type="list"&gt;
        &lt;listentry&gt;off&lt;/listentry&gt;
      &lt;/emulate_httpd_log&gt;
      &lt;error_directory config:type="list"&gt;
        &lt;listentry/&gt;
      &lt;/error_directory&gt;
      &lt;ftp_passive config:type="list"&gt;
        &lt;listentry&gt;on&lt;/listentry&gt;
      &lt;/ftp_passive&gt;
      &lt;maximum_object_size config:type="list"&gt;
        &lt;listentry&gt;4096&lt;/listentry&gt;
        &lt;listentry&gt;KB&lt;/listentry&gt;
      &lt;/maximum_object_size&gt;
      &lt;memory_replacement_policy config:type="list"&gt;
        &lt;listentry&gt;lru&lt;/listentry&gt;
      &lt;/memory_replacement_policy&gt;
      &lt;minimum_object_size config:type="list"&gt;
        &lt;listentry&gt;0&lt;/listentry&gt;
        &lt;listentry&gt;KB&lt;/listentry&gt;
      &lt;/minimum_object_size&gt;
    &lt;/settings&gt;
  &lt;/squid&gt;
</screen>
   </example>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>acls</literal></para>
       </entry>
       <entry>
        <para>アクセス制御リスト (Access Control Settings (ACL)) のリストです。</para>
       </entry>
       <entry>
        <para>リストの項目には名前や種類のほか、追加のオプションを設定することができます。設定可能な値の概要を知るには、 &yast; squid 設定モジュールをお使いください。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>http_accesses</literal></para>
       </entry>
       <entry>
        <para>アクセス制御テーブル内で ACL グループに対してアクセスの許可または禁止を設定します。</para>
        <para>
        </para>
       </entry>
       <entry>
        <para>1 つの定義内に複数の ACL グループが存在する場合、それぞれの ACL グループに属するメンバー全てに対して、一括で許可または禁止を設定することができます。</para>
        <para>アクセス制御テーブルは、このリストの順序でチェックされ、最初に合致した項目のとおりにアクセスが許可もしくは禁止されます。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>http_ports</literal></para>
       </entry>
       <entry>
        <para>squid がクライアントからの HTTP リクエストを待ち受ける全てのポートを指定します。</para>
       </entry>
       <entry>
        <para><literal>Host</literal> にはホスト名や IP アドレスを指定することができますが、何も指定しなくてもかまいません。</para>
        <para><literal>transparent</literal> を指定すると、 PMTU discovery 機能が無効化されます。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>refresh_patterns</literal></para>
       </entry>
       <entry>
        <para>squid がキャッシュ内のオブジェクトを取り扱う際の更新パターンを定義します。</para>
       </entry>
       <entry>
        <para>更新パターンはこのリストの順序で解釈されます。最初に合致した項目のとおりに処理が行なわれます。</para>
        <para><literal>Min</literal> は明示的な有効期限が設定されていない場合に、オブジェクトが最新の状態であると判断する期間を分単位で指定します。 <literal>Max</literal> は逆に、明示的な有効期限が設定されていない場合に、オブジェクトが最新の状態であると判断する上限の期間を指定します。 <literal>Percent</literal> は直近の変更日時順に並べて、どこまでを保持するのかを指定します。明示的な有効期限が設定されていないオブジェクトについては、最新のものであると判断されます。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>settings</literal></para>
       </entry>
       <entry>
        <para>設定可能な汎用パラメータとその既定値を設定します。</para>
       </entry>
       <entry>
        <para>設定可能な項目について、詳しくは &yast; の squid 設定モジュールをお使いください。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>service_enabled_on_startup</literal></para>
       </entry>
       <entry>
        <para>システムの起動時に squid サービスを開始するかどうかを設定します。</para>
       </entry>
       <entry>
        <para>値: true (有効)/false (無効)</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect1>

  <sect1 xml:id="Configuration.Network.Ftp">
    <title>FTP サーバ</title>
    <para>FTP インターネットサーバの設定を行ないます。</para>
    <example>
     <title>FTP サーバの設定</title>
<screen>
  &lt;ftp-server&gt;
    &lt;AnonAuthen&gt;2&lt;/AnonAuthen&gt;
    &lt;AnonCreatDirs&gt;NO&lt;/AnonCreatDirs&gt;
    &lt;AnonMaxRate&gt;0&lt;/AnonMaxRate&gt;
    &lt;AnonReadOnly&gt;NO&lt;/AnonReadOnly&gt;
    &lt;AntiWarez&gt;YES&lt;/AntiWarez&gt;
    &lt;Banner&gt;Welcome message&lt;/Banner&gt;
    &lt;CertFile/&gt;
    &lt;ChrootEnable&gt;NO&lt;/ChrootEnable&gt;
    &lt;EnableUpload&gt;YES&lt;/EnableUpload&gt;
    &lt;FTPUser&gt;ftp&lt;/FTPUser&gt;
    &lt;FtpDirAnon&gt;/srv/ftp&lt;/FtpDirAnon&gt;
    &lt;FtpDirLocal/&gt;
    &lt;GuestUser/&gt;
    &lt;LocalMaxRate&gt;0&lt;/LocalMaxRate&gt;
    &lt;MaxClientsNumber&gt;10&lt;/MaxClientsNumber&gt;
    &lt;MaxClientsPerIP&gt;3&lt;/MaxClientsPerIP&gt;
    &lt;MaxIdleTime&gt;15&lt;/MaxIdleTime&gt;
    &lt;PasMaxPort&gt;40500&lt;/PasMaxPort&gt;
    &lt;PasMinPort&gt;40000&lt;/PasMinPort&gt;
    &lt;PassiveMode&gt;YES&lt;/PassiveMode&gt;
    &lt;SSL&gt;0&lt;/SSL&gt;
    &lt;SSLEnable&gt;NO&lt;/SSLEnable&gt;
    &lt;SSLv2&gt;NO&lt;/SSLv2&gt;
    &lt;SSLv3&gt;NO&lt;/SSLv3&gt;
    &lt;StartDaemon&gt;2&lt;/StartDaemon&gt;
    &lt;TLS&gt;YES&lt;/TLS&gt;
    &lt;Umask/&gt;
    &lt;UmaskAnon/&gt;
    &lt;UmaskLocal/&gt;
    &lt;VerboseLogging&gt;NO&lt;/VerboseLogging&gt;
    &lt;VirtualUser&gt;NO&lt;/VirtualUser&gt;
  &lt;/ftp-server&gt;
</screen>
    </example>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>AnonAuthen</literal></para>
        </entry>
        <entry>
         <para>匿名ユーザ、認証ユーザの有効／無効を切り替えます。</para>
        </entry>
        <entry>
         <para>認証ユーザのみ: 1, 匿名ユーザのみ: 0, 両方: 2</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>AnonCreatDirs</literal></para>
        </entry>
        <entry>
         <para>匿名ユーザに対してディレクトリの作成を許可するかどうかを指定します。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>AnonReadOnly</literal></para>
        </entry>
        <entry>
         <para>匿名ユーザに対してアップロードを許可するかどうかを指定します。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>AnonMaxRate</literal></para>
        </entry>
        <entry>
         <para>匿名ユーザに対して適用する最大のデータ転送レートを指定します。</para>
        </entry>
        <entry>
         <para>KB/s</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>AntiWarez</literal></para>
        </entry>
        <entry>
         <para>アップロードされているものの、ローカルの管理者が確認を行なっていないファイルのダウンロードを禁止するかどうかを指定します。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>Banner</literal></para>
        </entry>
        <entry>
         <para>サーバに接続した際に表示されるテキストを含むファイルの名前を指定します。</para>
        </entry>
        <entry>
         <para/>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>CertFile</literal></para>
        </entry>
        <entry>
         <para>SSL 暗号化接続で使用する DSA 証明書を指定します。</para>
        </entry>
        <entry>
         <para>SSL 暗号化接続で使用する DSA 証明書の場所を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>ChrootEnable</literal></para>
        </entry>
        <entry>
         <para>有効化すると、ローカルユーザがログインした際に既定でホームディレクトリ内に <literal>chroot</literal> されるようになります。</para>
        </entry>
        <entry>
         <para>警告: このオプションを設定すると、セキュリティへの影響があります。値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>EnableUpload</literal></para>
        </entry>
        <entry>
         <para>有効化すると、 FTP ユーザがアップロードできるようになります。</para>
        </entry>
        <entry>
         <para>匿名ユーザに対してアップロードを許可するには、 <literal>AnonReadOnly</literal> を設定してください。値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>FTPUser</literal></para>
        </entry>
        <entry>
         <para>匿名 FTP のユーザを指定します。</para>
        </entry>
        <entry>
         <para>
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>FtpDirAnon</literal></para>
        </entry>
        <entry>
         <para>匿名ユーザの場合の FTP ディレクトリを指定します。</para>
        </entry>
        <entry>
         <para>匿名 FTP ユーザがログインした時に表示するディレクトリを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>FtpDirLocal</literal></para>
        </entry>
        <entry>
         <para>認証ユーザの場合の FTP ディレクトリを指定します。</para>
        </entry>
        <entry>
         <para>認証ユーザがログインした時に表示するディレクトリを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>LocalMaxRate</literal></para>
        </entry>
        <entry>
         <para>ローカルで認証したユーザに対して適用する、最大のデータ転送レートを指定します。</para>
        </entry>
        <entry>
         <para>KB/s</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>MaxClientsNumber</literal></para>
        </entry>
        <entry>
         <para>クライアント側からの接続最大数を指定します。</para>
        </entry>
        <entry>
         <para>
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>MaxClientsPerIP</literal></para>
        </entry>
        <entry>
         <para>1 つの IP アドレスあたりの最大接続数を指定します。</para>
        </entry>
        <entry>
         <para>1 つの IP アドレスあたりに対して許可する、最大の同時接続数を制限することになります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>MaxIdleTime</literal></para>
        </entry>
        <entry>
         <para>クライアント側から送信される FTP コマンドの最大待機時間 (タイムアウト) を指定します。</para>
        </entry>
        <entry>
         <para>分</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>PasMaxPort</literal></para>
        </entry>
        <entry>
         <para>パッシブ接続応答の場合のポート範囲のうち、最大値を指定します。</para>
        </entry>
        <entry>
         <para><literal>PassiveMode</literal> を YES に設定する必要があります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>PasMinPort</literal></para>
        </entry>
        <entry>
         <para>パッシブ接続応答の場合のポート範囲のうち、最小値を指定します。</para>
        </entry>
        <entry>
         <para><literal>PassiveMode</literal> を YES に設定する必要があります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>PassiveMode</literal></para>
        </entry>
        <entry>
         <para>パッシブモードを有効化します</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>SSL</literal></para>
        </entry>
        <entry>
         <para>セキュリティ設定</para>
        </entry>
        <entry>
         <para>SSL/TLS を無効化する: 0, SSL/TLS を受け付ける: 1, SSL/TLS 無しでの接続を拒否する: 2</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>SSLEnable</literal></para>
        </entry>
        <entry>
         <para>有効化すると、 SSL での接続を受け付けるようになります。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>SSLv2</literal></para>
        </entry>
        <entry>
         <para>有効化すると、 SSL バージョン 2 での接続を許可するようになります。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>SSLv3</literal></para>
        </entry>
        <entry>
         <para>有効化すると、 SSL バージョン 3 での接続を許可するようになります。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>StartDaemon</literal></para>
        </entry>
        <entry>
         <para>FTP デーモンの起動方法を指定します。</para>
        </entry>
        <entry>
         <para>手動: 0, システムの起動時: 1, &systemd; ソケット経由: 2</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>TLS</literal></para>
        </entry>
        <entry>
         <para>有効化すると、 TLS での接続を受け付けるようになります。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>Umask</literal></para>
        </entry>
        <entry>
         <para>ファイル作成時のマスク値を指定します。 (ファイル向けの umask):(ディレクトリ向けの umask) の形式で指定します。</para>
        </entry>
        <entry>
         <para>最も制限を厳しくするには <literal>177:077</literal> のように設定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>UmaskAnon</literal></para>
        </entry>
        <entry>
         <para>匿名ユーザ向けのファイル作成時の umask 値を設定します。</para>
        </entry>
        <entry>
         <para>8 進数で指定したい場合は、頭に "0" を付けてください。それ以外の場合は、 10 進数として扱われます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>UmaskLocal</literal></para>
        </entry>
        <entry>
         <para>認証ユーザ向けの umask 値を設定します。</para>
        </entry>
        <entry>
         <para>8 進数で指定したい場合は、頭に "0" を付けてください。それ以外の場合は、 10 進数として扱われます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>VerboseLogging</literal></para>
        </entry>
        <entry>
         <para>有効化すると、全ての FTP 要求と応答がログに記録されます。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>VirtualUser</literal></para>
        </entry>
        <entry>
         <para>仮想ユーザを使用することで、システムのアカウントとは別に FTP アカウントを管理できるようになります。</para>
        </entry>
        <entry>
         <para>値: YES (はい)/NO (いいえ)</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

    <note>
      <title>ファイアウオールについて</title>
      <para>FTP サーバを正しく動作させるためには、ファイアウオール側も設定を行なう必要があります。</para>
    </note>

   </sect1>

   <sect1 xml:id="Configuration.Network.Tftp">
    <title>TFTP サーバ</title>
    <para>TFTP インターネットサーバの設定を行ないます。</para>
    <para>これを使用することで、 TFTP (Trivial File Transfer Protocol) のサーバ側を設定することができます。サーバは &systemd; のソケットを利用して開始されます。</para>
    <para>注意: TFTP と FTP は異なるものです。</para>
    <example>
     <title>TFTP サーバ設定:</title>
<screen>
  &lt;tftp-server&gt;
    &lt;start_tftpd config:type="boolean"&gt;true&lt;/start_tftpd&gt;
    &lt;tftp_directory&gt;/tftpboot&lt;/tftp_directory&gt;
  &lt;/tftp-server&gt;
</screen>
    </example>
    <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>要素</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>コメント</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para>start_tftpd</para>
         </entry>
         <entry>
          <para>TFTP サーバサービスを有効化するかどうかを指定します。</para>
         </entry>
         <entry>
          <para>値: true (有効)/false (無効)</para>
         </entry>
        </row>
        <row>
         <entry>
          <para>tftp_directory</para>
         </entry>
         <entry>
          <para>起動イメージのディレクトリ: 提供するファイルの存在するディレクトリを指定します。</para>
         </entry>
         <entry>
          <para>一般的には /tftpboot などのディレクトリを指定します。指定したディレクトリが存在しない場合、自動的に作成されます。 TFTP サーバは、このディレクトリをルートとして使用 (-s オプション) します。</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
    </informaltable>
   </sect1>

   <sect1 xml:id="CreateProfile.Firstboot">
   <title>firstboot の処理手順</title>

   <para>&yast; の firstboot ユーティリティ (&yast; 初期システム設定) はインストールの直後に動作する仕組みで、ここでは新規にインストールしたシステムに対して、必要な設定処理を行ないます。インストール後の初回起動では、ユーザはシステムを簡易に設定するための各種の手順を実施することになります。なお、 &yast; の firstboot は既定では動作しませんので、必要であれば設定を行なって有効化します。</para>

   <example>
    <title>firstboot の処理手順の有効化</title>
    <screen>
      &lt;firstboot&gt;
        &lt;firstboot_enabled config:type="boolean"&gt;true&lt;/firstboot_enabled&gt;
      &lt;/firstboot&gt;
    </screen>
   </example>
  </sect1>

  <sect1 xml:id="CreateProfile.Security">
   <title>セキュリティ設定</title>

   <para>このモジュールの機能を利用することで、インストール先のシステムに対するローカルセキュリティを設定することができます。ローカルセキュリティには起動時の設定のほか、ログイン関連の設定やパスワードの設定、ユーザ追加時の設定やファイルパーミッションなどが含まれます。</para>

   <para>セキュリティ関連の自動設定は、動作中のシステムで利用できるセキュリティモジュール内の設定に似た仕組みです。ここではさまざまな設定を行なうことができます。</para>

   <example>
    <title>セキュリティ設定</title>
    <para>下記の例で示されているキーの意味と値の選択肢について、詳しくはリファレンスをお読みください。</para>
<screen>&lt;security&gt;
  &lt;console_shutdown&gt;ignore&lt;/console_shutdown&gt;
  &lt;displaymanager_remote_access&gt;no&lt;/displaymanager_remote_access&gt;
  &lt;fail_delay&gt;3&lt;/fail_delay&gt;
  &lt;faillog_enab&gt;yes&lt;/faillog_enab&gt;
  &lt;gid_max&gt;60000&lt;/gid_max&gt;
  &lt;gid_min&gt;101&lt;/gid_min&gt;
  &lt;gdm_shutdown&gt;root&lt;/gdm_shutdown&gt;
  &lt;lastlog_enab&gt;yes&lt;/lastlog_enab&gt;
  &lt;encryption&gt;md5&lt;/encryption&gt;
  &lt;obscure_checks_enab&gt;no&lt;/obscure_checks_enab&gt;
  &lt;pass_max_days&gt;99999&lt;/pass_max_days&gt;
  &lt;pass_max_len&gt;8&lt;/pass_max_len&gt;
  &lt;pass_min_days&gt;1&lt;/pass_min_days&gt;
  &lt;pass_min_len&gt;6&lt;/pass_min_len&gt;
  &lt;pass_warn_age&gt;14&lt;/pass_warn_age&gt;
  &lt;passwd_use_cracklib&gt;yes&lt;/passwd_use_cracklib&gt;
  &lt;permission_security&gt;secure&lt;/permission_security&gt;
  &lt;run_updatedb_as&gt;nobody&lt;/run_updatedb_as&gt;
  &lt;uid_max&gt;60000&lt;/uid_max&gt;
  &lt;uid_min&gt;500&lt;/uid_min&gt;
&lt;/security&gt;</screen>
   </example>

   <sect2 xml:id="CreateProfile.Security.password">
    <title>パスワードの設定</title>
    <para>ここではさまざまなパスワード設定を行なうことができます。これらの設定は主に、 <filename>/etc/login.defs</filename> ファイル内に保存されます。</para>
    <para>このリソースを使用することで、現在対応しているさまざまな暗号化方式のうちのいずれかを使用することができます。何も指定しない場合、 <literal>DES</literal> を使用します。</para>
    <para><literal>DES</literal> は Linux の既定の暗号化方式で、全てのネットワーク環境で動作しますが、パスワードが 8 文字までに制限されます。 <literal>MD5</literal> ではより長いパスワードを設定することができますので、さらにセキュリティを高める結果になりますが、ネットワークプロトコルによっては対応していないものもあります。特に NIS を使用している場合は選択できません。 <literal>Blowfish</literal> にも対応しています。</para>
    <para>これらに加えて、パスワードの妥当性や長さをチェックするようシステムを設定することもできます。</para>
   </sect2>

   <sect2 xml:id="CreateProfile.Security.boot">
    <title>起動の設定</title>
    <para>security リソースでは、起動時の設定も変更することができます。</para>
    <variablelist>
     <varlistentry>
      <term><keycombo><keycap function="control"/><keycap function="alt"/><keycap function="delete"/></keycombo> の解釈方法</term>
      <listitem>
       <para>コンソールを使用しているユーザが <keycombo><keycap function="control"/> <keycap function="alt"/> <keycap function="delete"/></keycombo> を押した際、通常はシステムの再起動が始まります。ただし、対象のマシンをサーバとしても使用しているような場合、このような処理を無効化することもできます。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>GDM のシャットダウン時の動作</term>
      <listitem>
       <para>GDM 経由でマシンをシャットダウンすることのできるユーザの一覧を設定します。</para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect2>

   <sect2 xml:id="CreateProfile.Security.login">
    <title>ログインの設定</title>
    <para>さまざまなログイン関連の設定を行ないます。これらの設定は主に、 <filename>/etc/login.defs</filename> ファイル内に保存されます。</para>
   </sect2>

   <sect2 xml:id="CreateProfile.Security.users">
    <title>新規ユーザの設定 (<command>useradd</command> の設定)</title>
    <para>ユーザ ID およびグループ ID の最小値と最大値をそれぞれ設定します。</para>
   </sect2>
  </sect1>

  <sect1 xml:id="CreateProfile.Security.laf">
   <title>Linux 監査フレームワーク (Linux Audit Framework (LAF))</title>

   <para>このモジュールを使用することで、監査デーモンの設定や監査サブシステムに対するルールの追加などを行なうことができます。</para>

   <example>
    <title>LAF の設定</title>
<screen>
  &lt;audit-laf&gt;
    &lt;auditd&gt;
      &lt;flush&gt;INCREMENTAL&lt;/flush&gt;
      &lt;freq&gt;20&lt;/freq&gt;
      &lt;log_file&gt;/var/log/audit/audit.log&lt;/log_file&gt;
      &lt;log_format&gt;RAW&lt;/log_format&gt;
      &lt;max_log_file&gt;5&lt;/max_log_file&gt;
      &lt;max_log_file_action&gt;ROTATE&lt;/max_log_file_action&gt;
      &lt;name_format&gt;NONE&lt;/name_format&gt;
      &lt;num_logs&gt;4&lt;/num_logs&gt;
    &lt;/auditd&gt;
    &lt;rules/&gt;
  &lt;/audit-laf&gt;
</screen>
   </example>

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>属性</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>auditd/flush</literal></para>
       </entry>
       <entry>
        <para>ディスクへのデータの書き込み方法を設定します。</para>
       </entry>
       <entry>
        <para><literal>INCREMENTAL</literal> を指定すると、 <literal>auditd/freq</literal> パラメータで設定されたレコード数ごとに、ディスクへの明示的なフラッシュ処理が発行されます。 <literal>NONE</literal> を指定すると、データを書き込むにあたって特別な処理は行ないません。 <literal>DATA</literal> を指定するとデータ部分のみを同期し、 <literal>SYNC</literal> を指定するとデータとメタデータの両方を同期するようになります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/freq</literal></para>
       </entry>
       <entry>
        <para>このパラメータは、ディスクへの明示的な書き込み命令を発行するまでのレコード数を指定します。</para>
       </entry>
       <entry>
        <para>このパラメータを使用するには、 <literal>flush</literal> を <literal>INCREMENTAL</literal> にする必要があります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/log_file</literal></para>
       </entry>
       <entry>
        <para>ログファイルのフルパスを指定します。</para>
       </entry>
       <entry>
        <para>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/log_fomat</literal></para>
       </entry>
       <entry>
        <para>残しておくべき情報のサイズを指定します。</para>
       </entry>
       <entry>
        <para><literal>RAW</literal> を指定すると、 (カーネルが送信したものと全く同じ形式で) 全てのデータを保存します。 <literal>NOLOG</literal> を指定すると、ディスクに書き込むことなく全てのデータを破棄します (ただしディスパッチャから送信されたデータはそのまま受け取ります) 。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/max_log_file</literal></para>
       </entry>
       <entry>
        <para>残しておくべき情報のサイズを指定します。</para>
       </entry>
       <entry>
        <para>単位: メガバイト</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/num_logs</literal></para>
       </entry>
       <entry>
        <para>ログファイルの数を指定します。</para>
       </entry>
       <entry>
        <para><literal>max_log_file_action</literal> を <literal>ROTATE</literal> に設定する必要があります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/max_log_file_action</literal></para>
       </entry>
       <entry>
        <para>ログ記録サイズの上限に達した場合の処理を指定します。</para>
       </entry>
       <entry>
        <para><literal>ROTATE</literal> を指定すると、 <literal>auditd/num_logs</literal> で指定した数だけ過去のログファイルを保存するようになります。 <literal>SYSLOG</literal> を指定すると、監査デーモンはシステムログに対して警告を書き込むようになります。 <literal>SUSPEND</literal> を指定すると、デーモンからディスクへの書き込みが停止するようになります。 <literal>IGNORE</literal> は何も行なわず、 <literal>KEEP_LOGS</literal> は <literal>ROTATE</literal> と似たような動作ですが、ログファイルへの上書きは行なわなくなります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>auditd/name_format</literal></para>
       </entry>
       <entry>
        <para>ログファイルにコンピュータ名を書き込む際のコンピュータ名の書式を指定します。</para>
       </entry>
       <entry>
        <para><literal>USER</literal> を指定すると、ユーザ側で定義した名前を使用します。 <literal>NONE</literal> を指定すると、コンピュータ名を書き込みません。 <literal>HOSTNAME</literal> を指定すると、 'gethostname' システムコールで取得できるホスト名を書き込みます。 <literal>FQD</literal> を指定すると、完全修飾ドメイン名を使用します。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>rules</literal></para>
       </entry>
       <entry>
        <para>auditctl 向けのルール</para>
       </entry>
       <entry>
        <para>ルールを手作業で編集することもできますが、知識のあるユーザ向けの機能となります。全てのオプションに関する詳細は、 <command>man auditctl</command> をお読みください。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </sect1>


  <sect1 xml:id="Configuration.Security.users_and_groups">
   <title>ユーザとグループ</title>

   <para>&ay; ではローカルユーザやローカルグループ、特殊なログイン関連の設定や新規ユーザに対する既定値を設定することができます。これらの設定はそれぞれ下記のようなセクション内に記述します:</para>

   <variablelist>
    <varlistentry>
     <term>users</term>
     <listitem>
      <para>ユーザの一覧</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>user_defaults</term>
     <listitem>
      <para>新規ユーザに対する既定のオプション</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>groups</term>
     <listitem>
      <para>グループの一覧</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>login_settings</term>
     <listitem>
      <para>パスワード無しログインや自動ログインなどの特殊なログイン設定</para>
     </listitem>
    </varlistentry>
   </variablelist>

   <note>
    <title>第 1 ステージでのユーザとグループの設定</title>
    <para>ユーザとグループは第 1 ステージで設定されますので、第 2 ステージを動作させることなくシステムを構築することができます。</para>
   </note>

   <sect2 xml:id="Configuration.Security.users">
    <title>ユーザ</title>

    <para>ユーザの一覧は <literal>&lt;users&gt;</literal> セクション内に記述します。ログインができるようにするには &rootuser; に対する設定を記述するか、もしくは <command>linuxrc</command> のオプションで <option>rootpassword</option> を設定します。</para>

    <example>
     <title>最小限のユーザ設定</title>
     <screen>&lt;users config:type="list"&gt;
  &lt;user&gt;
    &lt;username&gt;root&lt;/username&gt;
    &lt;user_password&gt;password&lt;/user_password&gt;
    &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
  &lt;/user&gt;
    &lt;user&gt;
    &lt;username&gt;&exampleuser_plain;&lt;/username&gt;
    &lt;user_password&gt;password&lt;/user_password&gt;
    &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
  &lt;/user&gt;
&lt;/users&gt;</screen>
    </example>

    <para>下記の例では、さらに複雑なシナリオを構成しています。シェルやホームディレクトリの親となるディレクトリなど、 <filename>/etc/default/useradd</filename> が示す既定値を適用しています。</para>

    <example>
     <title>複雑なユーザ設定</title>
     <screen>&lt;users config:type="list"&gt;
  &lt;user&gt;
    &lt;username&gt;root&lt;/username&gt;
    &lt;user_password&gt;password&lt;/user_password&gt;
    &lt;uid&gt;1001&lt;/uid&gt;
    &lt;gid&gt;100&lt;/gid&gt;
    &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
    &lt;fullname&gt;Root User&lt;/fullname&gt;
    &lt;authorized_keys config:type="list"&gt;
      &lt;listentry&gt;command="/opt/login.sh" ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDKLt1vnW2vTJpBp3VK91rFsBvpY97NljsVLdgUrlPbZ/L51FerQQ+djQ/ivDASQjO+567nMGqfYGFA/De1EGMMEoeShza67qjNi14L1HBGgVojaNajMR/NI2d1kDyvsgRy7D7FT5UGGUNT0dlcSD3b85zwgHeYLidgcGIoKeRi7HpVDOOTyhwUv4sq3ubrPCWARgPeOLdVFa9clC8PTZdxSeKp4jpNjIHEyREPin2Un1luCIPWrOYyym7aRJEPopCEqBA9HvfwpbuwBI5F0uIWZgSQLfpwW86599fBo/PvMDa96DpxH1VlzJlAIHQsMkMHbsCazPNC0++Kp5ZVERiH root@example.net&lt;/listentry&gt;
    &lt;/authorized_keys&gt;
  &lt;/user&gt;
  &lt;user&gt;
    &lt;username&gt;&exampleuser_plain;&lt;/username&gt;
    &lt;user_password&gt;password&lt;/user_password&gt;
    &lt;uid&gt;1002&lt;/uid&gt;
    &lt;gid&gt;100&lt;/gid&gt;
    &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
    &lt;fullname&gt;Plain User&lt;/fullname&gt;
    &lt;home&gt;/Users/plain&lt;/home&gt;
    &lt;password_settings&gt;
      &lt;max&gt;120&lt;/max&gt;
      &lt;inact&gt;5&lt;/inact&gt;
    &lt;/password_settings&gt;
  &lt;/user&gt;
&lt;/users&gt;</screen>
    </example>

    <note>
     <title><literal>authorized_keys</literal> ファイルの上書きに関する注意</title>

     <para><literal>authorized_keys</literal> セクションでユーザに対する SSH の公開鍵を設定する場合、既存の <filename>$HOME/.ssh/authorized_keys</filename> ファイルの内容は上書きされます。存在しない場合は指定した内容がそのまま書かれます。 <filename>authorized_keys</filename> ファイルを上書きしたくない場合は、 &ay; の制御ファイル内に <literal>authorized_keys</literal> セクションを記述しないでください。</para>
    </note>

    <note>
     <title><literal>rootpassword</literal> と root ユーザオプションの組み合わせについて</title>

     <para><command>linuxrc</command> での <literal>rootpassword</literal> と &rootuser; に対する <literal>user</literal> セクションを同時に設定することもできます。<literal>user</literal> セクション内にパスワードの指定が書かれていない場合、パスワードは <command>linuxrc</command> 側に記述したものが使われますが、書かれている場合は <command>linuxrc</command> に書かれたものより優先されます。</para>
    </note>

    <note xml:id="ann.Configuration.Security.users.uid">
     <title>ユーザ ID ( <literal>uid</literal> ) の指定について</title>
     <para>Linux システム内のユーザには数値のユーザ ID が設定されます。 &ay; の制御ファイル内でこれを指定したい場合は、 <tag class="element">uid</tag> タグを利用して直接指定することができますが、指定しない場合はシステム側で自動的に設定されます。</para>
     <para>なお、ユーザ ID はシステム内で重複があってはなりません。重複が発生してしまうと、ログインマネージャ <systemitem class="resource">gdm</systemitem> のようなアプリケーションが、正しく動作しなくなってしまいます。</para>
     <para>&ay; の制御ファイルでユーザを追加する場合は、 ID を指定するユーザとしないユーザを混在させるのは避けておくことを強くお勧めします。混在させてしまうと、ユーザ ID の重複が発生する可能性があります。 &ay; の制御ファイル内では、全てのユーザに対してユーザ ID を設定するか、もしくは全てのユーザに対してユーザ ID を自動設定させるのか、いずれかにしてください。</para>
    </note>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>username</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;username&gt;lukesw&lt;/username&gt;</screen>
        </entry>
        <entry>
         <para>必須です。正しいユーザ名である必要があります。詳しくは <literal>man 8 useradd</literal> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>fullname</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;fullname&gt;Tux Torvalds&lt;/fullname&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ユーザのフルネームを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>forename</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;forname&gt;Tux&lt;/forename&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ユーザの名前 (ファーストネーム) を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>surname</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;surname&gt;Skywalker&lt;/surname&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ユーザの姓を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>uid</literal></para>
        </entry>
        <entry>
         <para>番号</para>
<screen>&lt;uid&gt;1001&lt;/uid&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ユーザ ID を指定します。システム内で重複していてはならず、かつ負の数であってはなりません。何も指定しない場合、 &ay; はユーザ ID を自動的に選択します。さらに詳しい情報については、 <xref linkend="ann.Configuration.Security.users.uid"/> もお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>gid</literal></para>
        </entry>
        <entry>
         <para>番号</para>
<screen>&lt;gid&gt;100&lt;/gid&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。初期グループ ID を指定します。重複していてはならず、かつ負の数であってはなりません。また、既存のグループ ID を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>home</literal></para>
        </entry>
        <entry>
         <para>パス</para>
<screen>&lt;home&gt;/home/luke&lt;/home&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ユーザのホームディレクトリの絶対パスを指定します。既定では <literal>/home/<replaceable>ユーザ名</replaceable></literal> が使用されます (例: ユーザ名が <literal>alice</literal> であれば <literal>/home/alice</literal> になります) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>home_btrfs_subvolume</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
<screen>&lt;home_btrfs_subvolume config:type="boolean"&gt;true&lt;/home_btrfs_subvolume&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。 btrfs サブボリューム内にホームディレクトリを生成します。既定では無効化されます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>shell</literal></para>
        </entry>
        <entry>
         <para>パス</para>
<screen>&lt;shell&gt;/usr/bin/zsh&lt;/shell&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定では <literal>/bin/bash</literal> が設定されます。それ以外のものを指定する場合は、対応するパッケージがインストールされていることを確認してください (<literal>software</literal> セクション内でパッケージをインストールする必要があります) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>user_password</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;user_password&gt;some-password&lt;/user_password&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。感嘆符 ( <literal>!</literal> ) を指定した場合、乱数を元にパスワードが生成されます。ユーザのパスワードはそのまま指定することも、暗号化して指定することもできます。暗号化して指定したい場合は、 <command>mkpasswd</command> コマンドをお使いください。パスワードは <filename>/etc/shadow</filename> 内 (2 列目) に書かれます。プロファイル内でのパスワードの暗号化を有効もしくは無効にするには、 <literal>encrypted</literal> パラメータを設定してください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>encrypted</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
<screen>&lt;encrypted config:type="boolean"&gt;true&lt;/encrypted&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。指定しない場合、 <literal>false</literal> が設定されたものとみなされます。ここでは、プロファイル内でのユーザのパスワードの暗号化可否を設定します。 &ay; では標準的な暗号化アルゴリズム (詳しくは <command>man 3 crypt</command> をお読みください) に対応しています。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>password_settings</literal></para>
        </entry>
        <entry>
         <para>パスワードの設定</para>
         <screen>&lt;password_settings&gt;
  &lt;expire/&gt;
  &lt;max&gt;60&lt;/max&gt;
  &lt;warn&gt;7&lt;/warn&gt;
&lt;/password_settings&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。いくつかのパスワード関連の設定をカスタマイズすることができます: <literal>expire</literal> (<literal>YYYY-MM-DD</literal> 形式でのアカウント有効期限), <literal>flag</literal> ( <literal>/etc/shadow</literal> のフラグ), <literal>inact</literal> (パスワードの有効期限が切れてから、アカウントを無効化するまでの日数), <literal>max</literal> (パスワードの有効期限日数), <literal>min</literal> (有効期限が切れたあと、ユーザがパスワードを変更できるようになるまでの日数), <literal>warn</literal> (パスワードの有効期限切れを予告警告する日数) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>authorized_keys</literal></para>
        </entry>
        <entry>
         <para>認可済みの鍵の一覧</para>
         <screen>&lt;authorized_keys config:type="list"&gt;
  &lt;listentry&gt;ssh-rsa ...&lt;/listentry&gt;
&lt;/authorized_keys&gt;</screen>
        </entry>
        <entry>
         <para><literal>$HOME/.ssh/authorized_keys</literal> に書き込むべき認可済みのキーのリストを指定します。下記の例をご覧ください。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>

   </sect2>

   <sect2 xml:id="Configuration.Security.user_defaults">
    <title>ユーザの既定値</title>

    <para>プロファイル内には、パスワードの有効期限や初期に所属するグループ、ホームディレクトリのプレフィクスなど、さまざまな新規ユーザ向けの既定値を設定することができます。なお、プロファイル内で個別に指定していれば、既定値ではなく指定した値を利用してユーザを作成することができます。 &ay; ではこれらの設定を <literal>useradd</literal> から読み込むことができるようにするため、 <filename>/etc/default/useradd</filename> ファイル内に保存します。</para>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>group</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;group&gt;100&lt;/group&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定の初期ログイングループを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>groups</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;groups&gt;users&lt;/groups&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。追加のグループの一覧を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>home</literal></para>
        </entry>
        <entry>
         <para>パス</para>
<screen>&lt;home&gt;/home&lt;/home&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。ユーザのホームディレクトリのプレフィクスを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>expire</literal></para>
        </entry>
        <entry>
         <para>日付</para>
<screen>&lt;expire&gt;2017-12-31&lt;/expire&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。 <literal>YYYY-MM-DD</literal> の形式で、既定のパスワード有効期限を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>inactive</literal></para>
        </entry>
        <entry>
         <para>番号</para>
<screen>&lt;inactive&gt;3&lt;/inactive&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。アカウントの期限が切れてから無効化するまでの日数を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>no_groups</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
<screen>&lt;no_groups config:type="boolean"&gt;true&lt;/no_groups&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。セカンダリグループを使用しないようにします。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>shell</literal></para>
        </entry>
        <entry>
         <para>パス</para>
<screen>&lt;shell&gt;/usr/bin/fish&lt;/shell&gt;</screen>
        </entry>
        <entry>
         <para>既定のログインシェルを指定します。既定値は <literal>/bin/bash</literal> です。それ以外のものを指定する場合は、対応するパッケージがインストールされていることを確認してください (<literal>software</literal> セクション内でパッケージをインストールする必要があります) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>skel</literal></para>
        </entry>
        <entry>
         <para>パス</para>
<screen>&lt;skel&gt;/etc/skel&lt;/skel&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。新規ユーザを追加する際に使用するファイルの場所を指定します。詳しくは <literal>man 8 useradd</literal> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>umask</literal></para>
        </entry>
        <entry>
         <para>ファイル作成時のモードマスク</para>
<screen>&lt;umask&gt;022&lt;/umask&gt;</screen>
        </entry>
        <entry>
         <para>ホームディレクトリに対するファイル作成時のモードマスクを設定します。既定では <literal>useradd</literal> は <literal>022</literal> を使用します。詳しくは <literal>man 8 useradd</literal> および <literal>man 1 umask</literal> をお読みください。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

   <sect2 xml:id="Configuration.Security.groups">
    <title>グループ</title>

    <para>グループの一覧は、例に示しているとおり <literal>&lt;groups&gt;</literal> 内に定義します。</para>

    <example>
     <title>グループの設定</title>
     <screen>&lt;groups config:type="list"&gt;
  &lt;group&gt;
    &lt;gid&gt;100&lt;gid&gt;
    &lt;groupname&gt;users&lt;/groupname&gt;
    &lt;userlist&gt;bob,alice&lt;/userlist&gt;
  &lt;/group&gt;
&lt;/groups&gt;</screen>
    </example>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>groupname</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;groupname&gt;users&lt;/groupname&gt;</screen>
        </entry>
        <entry>
         <para>必須です。正しいグループ名である必要があります。詳しくは <literal>man 8 groupadd</literal> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>gid</literal></para>
        </entry>
        <entry>
         <para>番号</para>
<screen>&lt;gid&gt;100&lt;/gid&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。グループ ID を指定します。重複していてはならず、かつ負の数であってはなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>group_password</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;group_password&gt;password&lt;/group_password&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。グループのパスワードはそのまま指定することも、暗号化して指定することもできます。プロファイル内でのパスワードの暗号化を有効もしくは無効にするには、 <literal>encrypted</literal> パラメータを設定してください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>encrypted</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
<screen>&lt;encrypted config:type="boolean"&gt;true&lt;/encrypted&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。プロファイル内でのグループのパスワードについて、暗号化を行なうかどうかを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>userlist</literal></para>
        </entry>
        <entry>
         <para>ユーザリスト</para>
<screen>&lt;userlist&gt;bob,alice&lt;/userlist&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。グループに所属すべきユーザの一覧を指定します。ユーザ名はカンマで区切ります。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

   <sect2 xml:id="Configuration.Security.login_settings">
    <title>ログインの設定</title>

    <para>&ay; のプロファイルでは、 2 種類の特殊なログイン設定 (自動ログイン、パスワード無しログイン) を有効化することができます。いずれも既定では無効化されています。</para>

    <example>
     <title>自動ログインおよびパスワード無しログインの有効化</title>
     <screen>&lt;login_settings&gt;
  &lt;autologin_user&gt;vagrant&lt;/autologin_user&gt;
  &lt;password_less_login config:type="boolean"&gt;true&lt;/password_less_login&gt;
&lt;/login_settings&gt;</screen>
    </example>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>password_less_login</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
<screen>&lt;password_less_login config:type="boolean"&gt;true&lt;/password_less_login&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。パスワード無しでのログインを許可します。ただし、グラフィカルなログインにしか効果がありません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autologin_user</literal></para>
        </entry>
        <entry>
         <para>テキスト</para>
<screen>&lt;autologin_user&gt;alice&lt;/autologin_user&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。指定したユーザに対する自動ログインを行ないます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

  </sect1>

  <sect1 xml:id="createprofile.scripts">
   <title>独自のユーザスクリプト</title>

   <para>自動インストールの処理内にスクリプトを追加することで、必要に応じた独自のカスタマイズを実現することができるほか、インストール時のさまざまな段階で制御を行なうことができるようになります。</para>

   <para>自動インストールの処理内では、全部で 5 箇所のスクリプトの実行タイミングが提供されています。</para>

   <para>全てのスクリプトは &lt;scripts&gt; セクション内に記述します。</para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para><literal>pre-scripts</literal>: いずれかの作業が発生するよりも前の、最も早い段階 (インストール前スクリプト)</para>
    </listitem>
    <listitem>
     <para><literal>postpartitioning-scripts</literal>: パーティションの設定と <filename>/mnt</filename> へのマウントが完了しているが、 RPM のインストールを行なうよりも前の段階 (パーティション設定後スクリプト)</para>
    </listitem>
    <listitem>
     <para><literal>chroot-scripts</literal>: パッケージのインストールが完了し、初回の起動が行なわれるよりも前の段階 (chroot 環境スクリプト)</para>
    </listitem>
    <listitem>
     <para><literal>post-scripts</literal>: インストール済みのシステムの初回起動時で、サービスが全く動作していない状態 (インストール後スクリプト)</para>
    </listitem>
    <listitem>
     <para><literal>init-scripts</literal>: インストール済みのシステムの初回起動時で、全てのサービスが起動し動作している状態 (準備スクリプト)</para>
    </listitem>
   </itemizedlist>

   <sect2 xml:id="pre-install.scripts">
    <title>インストール前スクリプト</title>
    <para>&yast; がシステムに対して何らかの変更を加えるよりも前の段階で動作します (ハードウエアの検出が完了しているものの、パーティション設定やパッケージのインストールよりも前の段階) 。</para>
    <para>インストール前スクリプトでは制御ファイルの修正を行ない、 &ay; に対して修正後のものを読み込み直すように指示することができます。制御ファイルは <filename>/tmp/profile/autoinst.xml</filename> に配置され、修正後の版は <filename>/tmp/profile/modified.xml</filename> に配置します。 &ay; では、インストール前スクリプトの動作完了後に修正後のファイルを読み込みなおします。</para>
    <para>インストール前スクリプトでは、パーティション設定の変更を行なうこともできます。</para>
    <note>
     <title>確認表示付きのインストール前スクリプトについて</title>
     <para>インストール前スクリプトはインストールの冒頭で動作します。インストール時に確認を求めるように設定した場合 (<literal>profile/install/general/mode/confirm</literal>) でも、インストール前スクリプトは確認画面を表示するよりも前の段階で動作してしまいます。</para>
    </note>
    <note>
     <title>インストール前スクリプトと zypper について</title>
     <para>インストール前スクリプトで <emphasis>zypper</emphasis> を実行したい場合は、動作中の &yast; プロセスと衝突しないようにするため、 <emphasis>ZYPP_LOCKFILE_ROOT="/var/run/autoyast"</emphasis> という環境変数を設定する必要があります。</para>
    </note>
    <para>インストール前スクリプトの要素は下記のように配置しなければなりません:</para>
<screen>&lt;scripts&gt;
  &lt;pre-scripts config:type="list"&gt;
    &lt;script&gt;
      ...
    &lt;/script&gt;
  &lt;/pre-scripts&gt;
&lt;/scripts&gt;</screen>
   </sect2>

   <sect2 xml:id="postpartitioning-install.scripts">
    <title>パーティション設定後スクリプト</title>
    <para>&yast; がパーティションの設定を行ない、 <filename>/etc/fstab</filename> 内に書き込みを行なった後に動作するスクリプトです。 <filename>/mnt</filename> 内には何もないシステムがマウントされているタイミングになります。</para>
    <para>パーティション設定後スクリプトの要素は下記のように配置しなければなりません:</para>
<screen>&lt;scripts&gt;
  &lt;postpartitioning-scripts config:type="list"&gt;
    &lt;script&gt;
      ...
    &lt;/script&gt;
  &lt;/postpartitioning-scripts&gt;
&lt;/scripts&gt;</screen>
   </sect2>

   <sect2 xml:id="chroot.scripts">
    <title>chroot 環境スクリプト</title>
    <para>chroot 環境スクリプトはインストールが完了したあと、マシンの再起動を行なう前に動作します。 chroot スクリプトはインストーラがインストール済みのシステムに chroot し、ブートローダの設定を行なう前に実行するか、もしくはインストール済みのシステムに chroot した後に動作させることができます (詳しくは <literal>chrooted</literal> パラメータをお読みください) 。</para>
    <para>chroot 環境スクリプトの要素は下記のように配置しなければなりません:</para>
<screen>&lt;scripts&gt;
  &lt;chroot-scripts config:type="list"&gt;
    &lt;script&gt;
      ...
    &lt;/script&gt;
  &lt;/chroot-scripts&gt;
&lt;/scripts&gt;</screen>
   </sect2>

   <sect2 xml:id="post-install.scripts">
    <title>インストール後スクリプト</title>
    <para>これらのスクリプトは、 &ay; がシステムの設定を完了し、システムの初回起動が完了したあとに実行されます。</para>
    <para>インストール後スクリプトの要素は下記のように配置しなければなりません:</para>
<screen>&lt;scripts&gt;
    &lt;post-scripts config:type="list"&gt;
      &lt;script&gt;
        ...
      &lt;/script&gt;
    &lt;/post-scripts&gt;
  &lt;/scripts&gt;</screen>
   </sect2>

   <sect2 xml:id="init.scripts">
    <title>準備スクリプト</title>
    <para>これらのスクリプトは &yast; の処理が完了し、ネットワークの準備が完了したあと、初回の起動処理内で実行されます。これらの最終スクリプトは <filename>/usr/lib/YaST2/bin/autoyast-initscripts.sh</filename> を利用して動作するものであり、一度のみ動作します。準備スクリプトは <emphasis>init-scripts</emphasis> タグで設定します。</para>
    <para>下記の要素は &lt;scripts&gt;&lt;init-scripts config:type="list"&gt;&lt;script&gt; ... &lt;/script&gt;&lt;/init-scripts&gt;...&lt;/scripts&gt; タグ内に記述します</para>
    <table>
     <title>準備スクリプトの XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>location</literal></para>
        </entry>
        <entry>
         <para>スクリプトの取得元の場所を指定します。場所にはプロファイルと同じプロトコル (http, ftp, nfs, など) を指定することができます。</para>
<screen>&lt;location
&gt;http://10.10.0.1/myInitScript.sh&lt;/location&gt;</screen>
        </entry>
        <entry>
         <para>&lt;location&gt; もしくは &lt;source&gt; を定義しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>source</literal>
         </para>
        </entry>
        <entry>
         <para>スクリプトそれ自身 (ソースコード) は CDATA タグ内にカプセル化して記述します。 XML プロファイル内にシェルスクリプト全体を配置したくない場合は、 location パラメータを指定してください。</para>
<screen>&lt;source&gt;
&lt;![CDATA[
echo "Testing the init script" &gt;
/tmp/init_out.txt
]]&gt;
&lt;/source&gt;</screen>
        </entry>
        <entry>
         <para>&lt;location&gt; もしくは &lt;source&gt; を定義しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>filename</literal></para>
        </entry>
        <entry>
         <para>スクリプトのファイル名を指定します。一時ディレクトリ <filename>/tmp</filename> 内にファイル名となります。</para>
<screen>&lt;filename&gt;mynitScript5.sh&lt;/filename&gt;</screen>
        </entry>
        <entry>
         <para>準備スクリプトが 1 つだけである場合は任意です。この場合は、既定の名前 ( <filename>init-scripts</filename> ) が使用されます。複数のスクリプトを使用している場合は、それぞれのスクリプトに対して重複しない名前を設定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>rerun</literal></para>
        </entry>
        <entry>
         <para><literal>ayast_setup</literal> を使用して XML ファイルを複数回実行するように設定しても、通常はスクリプトが一度だけ実行されます。この既定の動作を変更したい場合は、この値を <literal>true</literal> に設定します。</para>
<screen>&lt;rerun config:type="boolean"&gt;true&lt;/rerun&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> (スクリプトを一度だけ実行する) です。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
    <para>制御ファイルに対して手作業で追加を行なっている場合は、スクリプトには <emphasis>CDATA</emphasis> 要素を設定して、制御ファイル内でファイルの文法とその他のタグが混ざらないようにしてください。</para>
   </sect2>

   <sect2 xml:id="scripts.syntax">
    <title>スクリプトの XML パラメータ</title>
    <para>下記に示す XML 要素は、ここまでに説明してきた全ての種類のスクリプトに対して設定することができます。ただし <literal>chrooted</literal> については例外で、こちらは chroot 環境スクリプトにのみ設定することができます。</para>
    <table>
     <title>スクリプトの XML パラメータ</title>
     <tgroup cols="3">
      <colspec colwidth="1*"/>
      <colspec colwidth="3*"/>
      <colspec colwidth="2*"/>
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>location</literal></para>
        </entry>
        <entry>
         <para>スクリプトの取得元の場所を指定します。場所には制御ファイルと同じプロトコル (http, ftp, nfs, など) を指定することができます。</para>
<screen>&lt;location
&gt;http://10.10.0.1/myPreScript.sh&lt;/location&gt;</screen>
        </entry>
        <entry>
         <para><literal>location</literal> もしくは <literal>source</literal> を定義しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>source</literal>
         </para>
        </entry>
        <entry>
         <para>スクリプトそれ自身 (ソースコード) は CDATA タグ内にカプセル化して記述します。 XML プロファイル内にシェルスクリプト全体を配置したくない場合は、 location パラメータを指定してください。</para>
<screen>&lt;source&gt;
&lt;![CDATA[
echo "Testing the pre script" &gt; /tmp/pre-script_out.txt
]]&gt;
&lt;/source&gt;</screen>
        </entry>
        <entry>
         <para><literal>location</literal> もしくは <literal>source</literal> を定義しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>interpreter</literal></para>
        </entry>
        <entry>
         <para>スクリプトで使用するインタプリタを指定します。設定可能な値は <literal>shell</literal> (シェルスクリプト) もしくは <literal>perl</literal> (Perl スクリプト) のいずれかです。</para>
<screen>&lt;interpreter&gt;perl&lt;/interpreter&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>shell</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>file name</literal></para>
        </entry>
        <entry>
         <para>スクリプトのファイル名を指定します。一時ディレクトリ <filename>/tmp</filename> 内でのファイル名となります。</para>
<screen>&lt;filename&gt;myPreScript5.sh&lt;/filename&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値はスクリプトの種類ごとに異なります (この例の場合は <filename>pre-scripts</filename> になります) 。複数のスクリプトを使用している場合は、それぞれのスクリプトに対して重複しない名前を設定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>feedback</literal></para>
        </entry>
        <entry>
         <para>このブール値を <literal>true</literal> に設定すると、スクリプトの出力メッセージとエラーメッセージ (STDOUT および STDERR) がポップアップとして表示されるようになります。ユーザ側では OK ボタンを押して確認する必要が発生します。</para>
<screen>&lt;feedback config:type="boolean"&gt;true&lt;/feedback&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>feedback_type</literal></para>
        </entry>
        <entry>
         <para><literal>message</literal> , <literal>warning</literal> , <literal>error</literal> のいずれかの値を指定します。これらのポップアップに対するタイムアウトは、 &lt;report&gt; セクションで設定します。</para>
<screen>&lt;feedback_type&gt;warning&lt;/feedback_type&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。何も指定しない場合、常に動作を一時停止してポップアップを表示します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>debug</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> を指定すると、シェルスクリプト内の各行がログに記録されます。 Perl スクリプトの場合、 Warning が有効化されて実行されます。</para>
<screen>&lt;debug config:type="boolean"&gt;true&lt;/debug&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>true</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>notification</literal></para>
        </entry>
        <entry>
         <para>スクリプトを裏で実行している間、ここで設定したテキストをポップアップとして表示します。</para>
<screen>&lt;notification&gt;Please wait while script is running...&lt;/notification&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。指定しない場合、通知ポップアップを表示しません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>param-list</literal></para>
        </entry>
        <entry>
         <para>スクリプトを呼び出す際のパラメータを指定します。 <literal>param</literal> の項目は必要に応じて複数個設定することができます。複数個を指定した場合、それらはスペースで区切られてスクリプトのコマンドラインを構成します。パラメータそれ自身にスペースを含めたい場合は、シェルの引用符を指定してください。</para>
<screen>&lt;param-list&gt;
  &lt;param&gt;par1&lt;/param&gt;
  &lt;param&gt;par2 par3&lt;/param&gt;
  &lt;param&gt;"par4.1 par4.2"&lt;/param&gt;
&lt;/param-list&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。設定しない場合、スクリプトに対してパラメータを渡しません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>rerun</literal></para>
        </entry>
        <entry>
         <para>XML ファイル内に複数の <literal>ayast_setup</literal> を配置した場合であっても、スクリプトは通常、一度だけ実行します。この既定の動作を変更したい場合は、この値を <literal>true</literal> に設定してください。</para>
<screen>&lt;rerun config:type="boolean"&gt;true&lt;/rerun&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> で、スクリプトを一度だけ実行します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>chrooted</literal></para>
        </entry>
        <entry>
         <para>インストールの際、新しいシステムは <filename>/mnt</filename> 内にマウントされます。このパラメータを <literal>false</literal> に設定すると、 &ay; は <command>chroot</command> を行なわず、このステージではブートローダをインストールしなくなります。このパラメータを <literal>true</literal> に設定すると、 &ay; は <command>chroot</command> を実行して <filename>/mnt</filename> 内に入り、ブートローダのインストールを行なうようになります。つまり、新しくインストールしたシステムに対して何らかの変更を行ないたい場合、 <filename>/mnt</filename> のプレフィクスを指定せずに実行することができるようになります。</para>
<screen>&lt;chrooted config:type="boolean"
&gt;true&lt;/chrooted&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> です。このオプションは chroot 環境スクリプトでのみ設定することができます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 xml:id="script_examples">
    <title>スクリプト例</title>
    <example>
     <title>スクリプト設定</title>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
&lt;scripts&gt;
  &lt;chroot-scripts config:type="list"&gt;
    &lt;script&gt;
      &lt;chrooted config:type="boolean"&gt;true&lt;/chrooted&gt;
      &lt;filename&gt;chroot.sh&lt;/filename&gt;
      &lt;interpreter&gt;shell&lt;/interpreter&gt;
      &lt;source&gt;&lt;![CDATA[
#!/bin/sh
echo "Testing chroot (chrooted) scripts"
ls
]]&gt;
      &lt;/source&gt;
    &lt;/script&gt;
    &lt;script&gt;
      &lt;filename&gt;chroot.sh&lt;/filename&gt;
        &lt;interpreter&gt;shell&lt;/interpreter&gt;
        &lt;source&gt;&lt;![CDATA[
#!/bin/sh
echo "Testing chroot scripts"
df
cd /mnt
ls
]]&gt;
        &lt;/source&gt;
      &lt;/script&gt;
    &lt;/chroot-scripts&gt;
    &lt;post-scripts config:type="list"&gt;
      &lt;script&gt;
        &lt;filename&gt;post.sh&lt;/filename&gt;
        &lt;interpreter&gt;shell&lt;/interpreter&gt;
        &lt;source&gt;&lt;![CDATA[
#!/bin/sh

echo "Running Post-install script"
systemctl start portmap
mount -a 192.168.1.1:/local /mnt
cp /mnt/test.sh /tmp
umount /mnt
]]&gt;
        &lt;/source&gt;
      &lt;/script&gt;
      &lt;script&gt;
        &lt;filename&gt;post.pl&lt;/filename&gt;
        &lt;interpreter&gt;perl&lt;/interpreter&gt;
        &lt;source&gt;&lt;![CDATA[
#!/usr/bin/perl
print "Running Post-install script";

]]&gt;
        &lt;/source&gt;
      &lt;/script&gt;
    &lt;/post-scripts&gt;
    &lt;pre-scripts config:type="list"&gt;
      &lt;script&gt;
        &lt;interpreter&gt;shell&lt;/interpreter&gt;
        &lt;location&gt;http://192.168.1.1/profiles/scripts/prescripts.sh&lt;/location&gt;
      &lt;/script&gt;
      &lt;script&gt;
        &lt;filename&gt;pre.sh&lt;/filename&gt;
        &lt;interpreter&gt;shell&lt;/interpreter&gt;
        &lt;source&gt;&lt;![CDATA[
#!/bin/sh
echo "Running pre-install script"
]]&gt;
        &lt;/source&gt;
      &lt;/script&gt;
    &lt;/pre-scripts&gt;
    &lt;postpartitioning-scripts config:type="list"&gt;
      &lt;script&gt;
        &lt;filename&gt;postpart.sh&lt;/filename&gt;
        &lt;interpreter&gt;shell&lt;/interpreter&gt;
        &lt;debug config:type="boolean"&gt;false&lt;/debug&gt;
        &lt;feedback config:type="boolean"&gt;true&lt;/feedback&gt;
        &lt;source&gt;&lt;![CDATA[
touch /mnt/testfile
echo Hi
]]&gt;
        &lt;/source&gt;
      &lt;/script&gt;
    &lt;/postpartitioning-scripts&gt;
  &lt;/scripts&gt;
&lt;/profile&gt;</screen>
    </example>
    <para>インストール完了後は、スクリプトと出力されたログファイルが <filename>/var/adm/autoinstall</filename> 内に配置されます。スクリプトは <filename>scripts</filename> サブディレクトリ内、出力されたログは <filename>log</filename> サブディレクトリ内をそれぞれご覧ください。</para>
    <para>出力されたログは、シェルスクリプトを下記のようなコマンドラインで実行した場合と同じ内容になります:</para>
<screen>/bin/sh -x <replaceable>スクリプト名</replaceable> 2&amp;&gt;/var/adm/autoinstall/logs/<replaceable>スクリプト名</replaceable>.log</screen>
   </sect2>
  </sect1>
  <sect1 xml:id="createprofile.sysconfig">
   <title>システム変数 (sysconfig)</title>

   <para>sysconfig リソースを使用することで、 sysconfig リポジトリ ( <filename>/etc/sysconfig</filename> ) 内にある設定変数を直接定義することができます。 sysconfig 変数はさまざまなシステムコンポーネントや環境変数を設定することのできる仕組みで、要件に正確に適合させることができるようになります。</para>

   <para>下記に sysconfig リソースの設定例を示します。</para>

   <example>
    <title>sysconfig の設定</title>
<screen>&lt;sysconfig config:type="list" &gt;
  &lt;sysconfig_entry&gt;
    &lt;sysconfig_key&gt;XNTPD_INITIAL_NTPDATE&lt;/sysconfig_key&gt;
    &lt;sysconfig_path&gt;/etc/sysconfig/xntp&lt;/sysconfig_path&gt;
    &lt;sysconfig_value&gt;ntp.host.com&lt;/sysconfig_value&gt;
  &lt;/sysconfig_entry&gt;
  &lt;sysconfig_entry&gt;
    &lt;sysconfig_key&gt;HTTP_PROXY&lt;/sysconfig_key&gt;
    &lt;sysconfig_path&gt;/etc/sysconfig/proxy&lt;/sysconfig_path&gt;
    &lt;sysconfig_value&gt;proxy.host.com:3128&lt;/sysconfig_value&gt;
  &lt;/sysconfig_entry&gt;
  &lt;sysconfig_entry&gt;
    &lt;sysconfig_key&gt;FTP_PROXY&lt;/sysconfig_key&gt;
    &lt;sysconfig_path&gt;/etc/sysconfig/proxy&lt;/sysconfig_path&gt;
    &lt;sysconfig_value&gt;proxy.host.com:3128&lt;/sysconfig_value&gt;
  &lt;/sysconfig_entry&gt;
&lt;/sysconfig&gt;</screen>
    <para>絶対パスと相対パスのどちらでも指定することができます。相対パスを指定した場合は、 <filename>/etc/sysconfig</filename> ディレクトリからの相対パスとして扱われます。</para>
   </example>
  </sect1>
  <sect1 xml:id="createprofile.completeconf">
   <title>設定ファイルの直接追加</title>

   <para>さまざまなアプリケーションやサービスでは、インストール済みのシステム内に設定ファイルを配置することで、設定を行なうことができます。たとえば Web サーバをインストールしているような環境では、 ( <filename>httpd.conf</filename> ) のような設定ファイルが存在しています。</para>

   <para>このリソースを使用してインストール済みのシステムにおけるパスを指定することで、制御ファイル内に設定ファイルの内容そのものを含めることができるようになります。 &yast; では、指定された場所にファイルをコピーします。</para>

   <para>この機能を使用するには、インストール先のシステムに <package>autoyast2</package> パッケージをインストールする必要があります。このパッケージがインストールされていない場合、自動的にインストールを行ないます。</para>

   <para>また、 <literal>file_location</literal> を指定することで、ファイルの取得元を指定することもできます。取得元は HTTP サーバのようなネットワークリソースでもかまいません (例: <literal>&lt;file_location&gt;http://my.server.site/issue&lt;/file_location&gt;</literal>) 。</para>

   <para>なお、ディレクトリを作成したい場合は、スラッシュで終わる <literal>file_path</literal> を指定してください。</para>

   <example>
    <title>インストール済みのシステムに対するファイルの出力</title>
<screen>&lt;files config:type="list"&gt;
  &lt;file&gt;
    &lt;file_path&gt;/etc/apache2/httpd.conf&lt;/file_path&gt;
    &lt;file_contents&gt;

&lt;![CDATA[
some content
]]&gt;

    &lt;/file_contents&gt;
  &lt;/file&gt;
  &lt;file&gt;
    &lt;file_path&gt;/mydir/a/b/c/&lt;/file_path&gt; &lt;!-- create directory --&gt;
  &lt;/file&gt;
&lt;/files&gt;</screen>
   </example>

   <para>下記にはさらに複雑な例を示しています。この設定は <literal>file_contents</literal> 内で入れた内容をファイルに出力し、ファイルのパーミッションと所有権情報を設定してします。ファイルがシステムにコピーされたあと、スクリプトが実行されます。このような仕組みにより、ファイルをクライアントの環境に合わせて修正し、配置することができるようになります。</para>

   <example>
    <title>インストール済みのシステムに対するファイルの出力</title>
<screen>&lt;files config:type="list"&gt;
  &lt;file&gt;
    &lt;file_path&gt;/etc/someconf.conf&lt;/file_path&gt;
    &lt;file_contents&gt;

&lt;![CDATA[
some content
]]&gt;

    &lt;/file_contents&gt;
    &lt;file_owner&gt;&exampleuser_plain;.users&lt;/file_owner&gt;
    &lt;file_permissions&gt;444&lt;/file_permissions&gt;
    &lt;file_script&gt;
      &lt;interpreter&gt;shell&lt;/interpreter&gt;
      &lt;source&gt;

&lt;![CDATA[
#!/bin/sh

echo "Testing file scripts" &gt;&gt; /etc/someconf.conf
df
cd /mnt
ls
]]&gt;

      &lt;/source&gt;
    &lt;/file_script&gt;
  &lt;/file&gt;
&lt;/files&gt;</screen>
   </example>
  </sect1>
  <sect1 xml:id="CreateProfile.Ask">
   <title>インストール時のユーザへの値の確認</title>

   <para>インストールの際、ユーザに対して制御ファイルに設定すべき値を問い合わせるように設定することもできます。この機能を使用した場合、インストールの途中でポップアップが表示され、ユーザに対して値を問い合わせます。インストールを完全に自動化したいものの、ユーザに対してローカルのアカウントに対するパスワードを尋ねたりしたいような場合は、制御ファイル内に <literal>ask</literal> ディレクティブを設定してください。</para>

   <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>

<screen>&lt;general&gt;
  &lt;ask-list config:type="list"&gt;
    &lt;ask&gt;
      ...
    &lt;/ask&gt;
  &lt;/ask-list&gt;
&lt;/general&gt;</screen>

   <table>
    <title>ユーザへの値確認: XML 表記</title>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>要素</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
       <entry>
        <para>コメント</para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>question</literal></para>
       </entry>
       <entry>
        <para>ユーザに対して提示する質問文を指定します。</para>
<screen>&lt;question&gt;LDAP サーバのアドレスを入力してください&lt;/question&gt;</screen>
       </entry>
       <entry>
        <para>既定値は要素のパスそのものです (これではユーザに対する問い合わせになりませんので、 question については必ず設定しておくことをお勧めします) 。</para>
        <remark>emap 2011-11-04: not sure I understand this.</remark>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>default</literal></para>
       </entry>
       <entry>
        <para>ユーザに対して提示する既定値を指定します。テキスト入力の場合、表示されたタイミングでこの値が入力済みの状態になります。チェックボックスの場合は true もしくは false を指定することで、あらかじめ選択済みの状態か、そうでないかを指定することができます。</para>
<screen>&lt;default&gt;dc=suse,dc=de&lt;/default&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>help</literal></para>
       </entry>
       <entry>
        <para>質問の左側に表示する、任意指定のヘルプテキストを指定します。</para>
<screen>&lt;help&gt;LDAP サーバのアドレスを入力してください。&lt;/help&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>title</literal></para>
       </entry>
       <entry>
        <para>質問の上に表示する任意指定のタイトルを指定します。</para>
<screen>&lt;title&gt;LDAP サーバ&lt;/title&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>type</literal></para>
       </entry>
       <entry>
        <para>入力すべきデータの形式を指定します。指定可能な値は <literal>symbol</literal> (シンボル), <literal>boolean</literal> (ブール値), <literal>string</literal> (文字列), <literal>integer</literal> (整数) のいずれかです。たとえばパーティション内でのファイルシステムの選択であれば <literal>symbol</literal> を、ユーザ設定内でのホームディレクトリの暗号化可否設定であれば <literal>boolean</literal> になります。制御ファイル内の項目から形式を判断したい場合は、 <literal>config:type="...."</literal> の箇所をご確認ください。また、 <literal>static_text</literal> という形式を指定することもできます。この場合は、ユーザに対して入力を求めず、ヘルプテキストに含まれていない情報を表示するために使用することができます。</para>
<screen>&lt;type&gt;symbol&lt;/type&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。既定値は <literal>string</literal> です。 <literal>symbol</literal> を指定した場合は、 <literal>selection</literal> 要素も設定しなければなりません (下記参照) 。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>password</literal></para>
       </entry>
       <entry>
        <para>このブール値を <literal>true</literal> に設定すると、単純なテキスト入力ではなく、パスワードダイアログを表示するようになります。なお、 <literal>type</literal> の値が <literal>string</literal> の場合にのみ効果があります。</para>
<screen>&lt;password config:type="boolean"&gt;true&lt;/password&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。既定値は <literal>false</literal> です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>pathlist</literal></para>
       </entry>
       <entry>
        <para><literal>path</literal> (パス) 要素の一覧を指定します。パスはカンマ区切りのリストで、変更したい要素のパスを表わすものです。たとえば制御ファイル内での LDAP サーバの要素は <literal>&lt;ldap&gt;&lt;ldap_server&gt;</literal> という場所にありますが、この場合は <literal>ldap,ldap_server</literal> のように指定します。</para>
        <screen>&lt;pathlist config:type="list"&gt;
  &lt;path&gt;networking,dns,hostname&lt;/path&gt;
  &lt;path&gt;...&lt;/path&gt;
&lt;/pathlist&gt;
        </screen>
        <para>制御ファイル内に書かれている最初のユーザに対するパスワードを変更したい場合は、パスを <literal>users,0,user_password</literal> のように指定します。ここで <literal>0</literal> は、制御ファイルの &lt;users config:type="list"&gt; 内にある最初の要素を意味します。同様に <literal>1</literal> を指定すると、 2 番目の項目を意味することになります。</para>
        <screen>&lt;users config:type="list"&gt;
  &lt;user&gt;
    &lt;username&gt;root&lt;/username&gt;
    &lt;user_password&gt;password to change&lt;/user_password&gt;
    &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
  &lt;/user&gt;
  &lt;user&gt;
    &lt;username&gt;&exampleuser_plain;&lt;/username&gt;
    &lt;user_password&gt;password to change&lt;/user_password&gt;
    &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
  &lt;/user&gt;
&lt;/users&gt;
        </screen>

       </entry>
       <entry>
        <para>この情報の設定は任意ですが、 <literal>path</literal> もしくは <literal>file</literal> のいずれかを指定すべきです。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>file</literal></para>
       </entry>
       <entry>
        <para>質問に対してユーザが入力した内容をファイルに保存することもできます。このようにすることで、スクリプトから読み込んで使用できるようになります。なお、 <literal>stage=initial</literal> を設定した場合で、第 2 ステージで回答を使用したい場合は、 <literal>chrooted=false</literal> を指定した chroot 環境スクリプトで、回答が書かれたファイルをコピーする必要があります。たとえば <command>cp /tmp/my_answer /mnt/tmp/</command> のように実行します。これは、第 1 ステージでは <filename>/tmp</filename> が RAM ディスク内に存在するため、再起動を行なうと消えてしまうためです。このような仕組みから、 <filename>/mnt/</filename> 以下にマウントされたインストール先のシステムにコピーを行なうことで、この問題を解決することができます。</para>
<screen>&lt;file&gt;/tmp/answer_hostname&lt;/file&gt;</screen>
       </entry>
       <entry>
        <para>この情報の設定は任意ですが、 <literal>path</literal> もしくは <literal>file</literal> のいずれかを指定すべきです。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para>stage</para>
       </entry>
       <entry>
        <para>質問を表示するインストール時のステージを指定します。ここでは <literal>cont</literal> もしくは <literal>initial</literal> のいずれかを指定することができます。 <literal>initial</literal> はインストールの冒頭で表示する意味となり、インストール前スクリプトの直後に表示されます。対する <literal>cont</literal> はシステムを初めて再起動した後に表示されます。なお、ディスク内の制御ファイルに対して回答を書き込みたい場合は、 <literal>initial</literal> を指定してください。また、 <literal>initial</literal> でパスワードを入力した場合、パスワードは暗号化されずに保存されることにも注意してください。また、 <literal>cont</literal> を指定した場合、ファイルシステム関連の質問を表示しても意味がないことにも注意してください。これは、その時点では既にパーティションの設定が完了しているため、制御ファイルを書き換えても効果が無いためです。</para>
<screen>&lt;stage&gt;cont&lt;/stage&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。既定値は <literal>initial</literal> です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>selection</literal></para>
       </entry>
       <entry>
        <para><literal>selection</literal> 要素には <literal>entry</literal> 要素のリストを指定します。各 <literal>entry</literal> 要素は、ユーザ側に提示される選択肢を表わします。この場合、テキストボックスには直接値を指定することができません。一覧から値を選択するのみとなります。</para>
<screen>&lt;selection config:type="list"&gt;
  &lt;entry&gt;
    &lt;value&gt;
        btrfs
    &lt;/value&gt;
    &lt;label&gt;
        Btrfs File System
    &lt;/label&gt;
  &lt;/entry&gt;
  &lt;entry&gt;
    &lt;value&gt;
        ext3
    &lt;/value&gt;
    &lt;label&gt;
        Extended3 File System
    &lt;/label&gt;
  &lt;/entry&gt;
&lt;/selection&gt;</screen>
       </entry>
       <entry>
        <para><literal>type=string</literal> の場合は任意、 <literal>type=boolean</literal> の場合は設定不可、 <literal>type=symbol</literal> の場合は必須です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>dialog</literal></para>
       </entry>
       <entry>
        <para>1 つのダイアログ内で複数の質問を表示することもできます。これを行なうには、この要素で整数のダイアログ ID を指定してください。同じダイアログ ID の質問は、同じダイアログ内に表示されるようになります。また、ダイアログは ID 順に並べられます。</para>
<screen>&lt;dialog config:type="integer"&gt;3&lt;/dialog&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>element</literal></para>
       </entry>
       <entry>
        <para>1 つのダイアログ内で複数の質問を表示することもできます。この場合、 <literal>element</literal> で整数の ID を指定する必要があります。ダイアログ内での質問は、この ID 順に並べられます。</para>
<screen>&lt;element config:type="integer"&gt;1&lt;/element&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です (<literal>dialog</literal> もご覧ください) 。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>width</literal></para>
       </entry>
       <entry>
        <para>既定のダイアログ幅を広げることができます。ダイアログに対して複数の幅指定が存在する場合は、最も大きいものが使用されます。値は 1 文字分をおおよそ 1 とした幅で指定します。</para>
<screen>&lt;width config:type="integer"&gt;50&lt;/width&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>height</literal></para>
       </entry>
       <entry>
        <para>既定のダイアログの高さを広げることができます。ダイアログに対して複数の高さ指定が存在する場合は、最も大きいものが使用されます。値は 1 行分をおおよそ 1 とした高さで指定します。</para>
<screen>&lt;height config:type="integer"&gt;15&lt;/height&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>frametitle</literal></para>
       </entry>
       <entry>
        <para>1 つのダイアログ内で複数の質問を表示することもできます。この場合、ダイアログ内の各質問には枠が描かれ、枠タイトルと各質問に対するキャプションが表示されます。また 1 つの枠内に複数の要素を設定することもできます。この場合、同じ枠タイトルを設定する必要があります。</para>
<screen>&lt;frametitle&gt;User data&lt;/frametitle&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。既定では枠タイトルが設定されません。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>script</literal></para>
       </entry>
       <entry>
        <para>質問に対する回答を入力したあと、スクリプトを実行することができます。スクリプトに関する詳細は下記をお読みください。</para>
<screen>&lt;script&gt;...&lt;/script&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。既定ではスクリプトを動作させません。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>ok_label</literal></para>
       </entry>
       <entry>
        <para><guimenu>Ok</guimenu> ボタンのラベルを変更することもできます。 1 つのダイアログに対しては、最後に指定された要素が使用されます。</para>
<screen>&lt;ok_label&gt;Finish&lt;/ok_label&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>back_label</literal></para>
       </entry>
       <entry>
        <para><guimenu>Back</guimenu> (戻る) ボタンのラベルを変更することもできます。 1 つのダイアログに対しては、最後に指定された要素が使用されます。</para>
<screen>&lt;back_label&gt;change values&lt;/back_label&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>timeout</literal></para>
       </entry>
       <entry>
        <para>ここではタイムアウトを秒単位で指定することができます。ここで指定した時間内に何も回答を行なわなかった場合、既定値が回答されたものとして扱われます。なお、ダイアログ内のウイジェットに触れたり、何らかの変更を行なったりした場合は、タイムアウトの設定が解除され、 <guimenu>Ok</guimenu> を押すまで待機するようになります。</para>
<screen>&lt;timeout config:type="integer"&gt;30&lt;/timeout&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。値を指定しない場合は <literal>0</literal> として扱われ、タイムアウトの設定がないものとして処理されます。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>default_value_script</literal></para>
       </entry>
       <entry>
        <para>質問に対する既定値を設定するために、スクリプトを動作させることができます (詳しい手順については <xref linkend="CreateProfile.Ask.default_value"/> をお読みください) 。この機能は、何らかの理由で既定値を <emphasis>計算</emphasis> しなければならないような場合に有用で、 <literal>timeout</literal> オプションと併用して使用します。</para>
<screen>&lt;default_value_script&gt;...&lt;/default_value_script&gt;</screen>
       </entry>
       <entry>
        <para>任意指定です。既定ではスクリプトを動作させません。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>

   <sect2 xml:id="CreateProfile.Ask.default_value">
    <title>既定値スクリプト</title>
    <para>質問に対する既定値を設定するために、スクリプトを動作させることができます。この機能は、何らかの理由で既定値を <emphasis>計算</emphasis> しなければならないような場合に有用で、 <literal>timeout</literal> オプションと併用して使用します。</para>
    <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;general&gt;
  &lt;ask-list config:type="list"&gt;
    &lt;ask&gt;
      &lt;default_value_script&gt;
        ...
      &lt;/default_value_script&gt;
    &lt;/ask&gt;
  &lt;/ask-list&gt;
&lt;/general&gt;</screen>
    <table>
     <title>既定値スクリプト: XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>
          <literal>source</literal>
         </para>
        </entry>
        <entry>
         <para>スクリプトのソースコードを指定します。 <command>echo</command> コマンドで STDOUT (標準出力) に出力することで、ダイアログに対する既定値を設定することができます。なお、スクリプトの終了コードが 0 以外であった場合、通常の既定値が設定されます。なお、 <literal>\n</literal> を省略するために <command>echo -n</command> を使用する必要がある点と、出力する値が適切なものでなければならない点、そしてブール値の場合は <quote>okay</quote> 等を使用すべきではない点にそれぞれ注意してください。</para>
<screen>&lt;source&gt;...&lt;/source&gt;</screen>
        </entry>
        <entry>
         <para>この値は必須です。何も指定しない場合、何も実行されなくなります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>interpreter</literal></para>
        </entry>
        <entry>
         <para>使用するインタプリタを指定します。</para>
<screen>&lt;interpreter&gt;perl&lt;/interpreter&gt;</screen>
        </entry>
        <entry>
         <para>既定値は <literal>shell</literal> (シェルスクリプト) です。値に対して <filename>/bin/myinterpreter</filename> のように指定することもできます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 xml:id="CreateProfile.Ask.script">
    <title>スクリプト</title>
    <para>質問に対する回答が表示された後にスクリプトを実行することができます。</para>
    <para>下記のような XML 構造内に、必要な要素を追加していきます:</para>
<screen>&lt;general&gt;
  &lt;ask-list config:type="list"&gt;
    &lt;ask&gt;
      &lt;script&gt;
        ...
      &lt;/script&gt;
    &lt;/ask&gt;
  &lt;/ask-list&gt;
&lt;/general&gt;</screen>
    <table>
     <title>スクリプト: XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>file name</literal></para>
        </entry>
        <entry>
         <para>スクリプトのファイル名を指定します。</para>
<screen>&lt;filename&gt;my_ask_script.sh&lt;/filename&gt;</screen>
        </entry>
        <entry>
         <para>既定値は ask_script.sh です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>source</literal>
         </para>
        </entry>
        <entry>
         <para>スクリプトのソースコードを指定します。 <literal>rerun_on_error</literal> を有効化した場合、入力した値が適切かどうかをチェックする動作になります。この場合、 <filename>/tmp/next_dialog</filename> ファイルを作成してダイアログ ID を書き込むことで、 &ay; が次に表示するダイアログを指定することができます。値に -1 を書き込むと、問い合わせの流れを終了する意味になります。このファイルが作成されない場合、 &ay; はダイアログを通常通りに表示していきます (11.0 およびそれ以降のみ) 。</para>
<screen>&lt;source&gt;...&lt;/source&gt;</screen>
        </entry>
        <entry>
         <para>この値は必須です。何も指定しない場合、何も実行されなくなります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>environment</literal></para>
        </entry>
        <entry>
         <para>スクリプトに対して、環境変数の形で問い合わせの回答を設定するかをブール値で指定します。設定される環境変数は <envar>VAL</envar> になります。</para>
<screen>&lt;environment config:type="boolean"&gt;true&lt;/environment&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>feedback</literal></para>
        </entry>
        <entry>
         <para>スクリプトの実行時にフィードバックを表示するかどうかを指定します。 STDOUT に何らかの値を出力すると、スクリプトの実行終了後にポップアップメッセージが表示されるようになります。</para>
<screen>&lt;feedback config:type="boolean"&gt;true&lt;/feedback&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。既定値は <literal>false</literal> です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>debug</literal></para>
        </entry>
        <entry>
         <para>スクリプトの実行をデバッグするかどうかを指定します。</para>
<screen>&lt;debug config:type="boolean"&gt;true&lt;/debug&gt;</screen>
        </entry>
        <entry>
         <para>任意指定で、既定値は <literal>true</literal> です。この値を設定する場合は、 <literal>feedback</literal> についても有効化する必要があります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>rerun_on_error</literal></para>
        </entry>
        <entry>
         <para>スクリプトの実行結果が 0 (ゼロ) になるまでダイアログを繰り返し表示するかどうかを指定します。これにより、回答内容をチェックできるようになります。エラーメッセージを表示したい場合は、 <literal>feedback</literal> オプションを指定してください。</para>
<screen>&lt;rerun_on_error config:type="boolean"&gt;true&lt;/rerun_on_error&gt;</screen>
        </entry>
        <entry>
         <para>任意指定で、既定値は <literal>false</literal> です。このオプションを設定する場合は、 <literal>feedback</literal> オプションも設定すべきです。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
    <para>下記に <literal>ask</literal> 機能の使用例を示します。</para>
<screen>&lt;general&gt;
  &lt;ask-list config:type="list"&gt;
    &lt;ask&gt;
      &lt;pathlist config:type="list"&gt;
        &lt;path&gt;ldap,ldap_server&lt;/path&gt;
      &lt;/pathlist&gt;
      &lt;stage&gt;cont&lt;/stage&gt;
      &lt;help&gt;Choose your server depending on your department&lt;/help&gt;
      &lt;selection config:type="list"&gt;
        &lt;entry&gt;
          &lt;value&gt;ldap1.mydom.de&lt;/value&gt;
          &lt;label&gt;LDAP for development&lt;/label&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;value&gt;ldap2.mydom.de&lt;/value&gt;
          &lt;label&gt;LDAP for sales&lt;/label&gt;
        &lt;/entry&gt;
      &lt;/selection&gt;
      &lt;default&gt;ldap2.mydom.de&lt;/default&gt;
      &lt;default_value_script&gt;
        &lt;source&gt; &lt;![CDATA[
echo -n "ldap1.mydom.de"
]]&gt;
        &lt;/source&gt;
      &lt;/default_value_script&gt;
    &lt;/ask&gt;
    &lt;ask&gt;
      &lt;pathlist config:type="list"&gt;
        &lt;path&gt;networking,dns,hostname&lt;/path&gt;
      &lt;/pathlist&gt;
      &lt;question&gt;Enter Hostname&lt;/question&gt;
      &lt;stage&gt;initial&lt;/stage&gt;
      &lt;default&gt;enter your hostname here&lt;/default&gt;
    &lt;/ask&gt;
    &lt;ask&gt;
      &lt;pathlist config:type="list"&gt;
        &lt;path&gt;partitioning,0,partitions,0,filesystem&lt;/path&gt;
      &lt;/pathlist&gt;
      &lt;question&gt;File System&lt;/question&gt;
      &lt;type&gt;symbol&lt;/type&gt;
      &lt;selection config:type="list"&gt;
        &lt;entry&gt;
          &lt;value config:type="symbol"&gt;ext4&lt;/value&gt;
          &lt;label&gt;default File System (recommended)&lt;/label&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;value config:type="symbol"&gt;ext3&lt;/value&gt;
          &lt;label&gt;Fallback File System&lt;/label&gt;
        &lt;/entry&gt;
      &lt;/selection&gt;
    &lt;/ask&gt;
  &lt;/ask-list&gt;
&lt;/general&gt;</screen>
    <para>下記の例は &ay; の制御ファイルを選択させる場合の例です。 &ay; は問い合わせダイアログの動作完了後に <filename>modified.xml</filename> を読み込みなおしますので、これにより制御ファイルを全く新しくすることができます。</para>
<screen>&lt;general&gt;
  &lt;ask-list config:type="list"&gt;
    &lt;ask&gt;
      &lt;selection config:type="list"&gt;
        &lt;entry&gt;
          &lt;value&gt;part1.xml&lt;/value&gt;
          &lt;label&gt;Simple partitioning&lt;/label&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;value&gt;part2.xml&lt;/value&gt;
          &lt;label&gt;encrypted /tmp&lt;/label&gt;
        &lt;/entry&gt;
        &lt;entry&gt;
          &lt;value&gt;part3.xml&lt;/value&gt;
          &lt;label&gt;LVM&lt;/label&gt;
        &lt;/entry&gt;
      &lt;/selection&gt;
      &lt;title&gt;XML Profile&lt;/title&gt;
      &lt;question&gt;Choose a profile&lt;/question&gt;
      &lt;stage&gt;initial&lt;/stage&gt;
      &lt;default&gt;part1.xml&lt;/default&gt;
      &lt;script&gt;
        &lt;filename&gt;fetch.sh&lt;/filename&gt;
        &lt;environment config:type="boolean"&gt;true&lt;/environment&gt;
        &lt;source&gt;
&lt;![CDATA[
wget http://10.10.0.162/$VAL -O /tmp/profile/modified.xml 2&gt;/dev/null
]]&gt;
        &lt;/source&gt;
        &lt;debug config:type="boolean"&gt;false&lt;/debug&gt;
        &lt;feedback config:type="boolean"&gt;false&lt;/feedback&gt;
      &lt;/script&gt;
    &lt;/ask&gt;tion&gt;
  &lt;/ask-list&gt;
&lt;/general&gt;</screen>
    <para>下記のようなスクリプトを指定することで、質問に対する回答をチェックすることができます:</para>
<screen>&lt;general&gt;
  &lt;ask-list config:type="list"&gt;
    &lt;ask&gt;
      &lt;script&gt;
        &lt;filename&gt;my.sh&lt;/filename&gt;
        &lt;rerun_on_error config:type="boolean"&gt;true&lt;/rerun_on_error&gt;
        &lt;environment config:type="boolean"&gt;true&lt;/environment&gt;
        &lt;source&gt;&lt;![CDATA[
if [ "$VAL" = "myhost" ]; then
    echo "Illegal Hostname!";
    exit 1;
fi
exit 0
]]&gt;
        &lt;/source&gt;
        &lt;debug config:type="boolean"&gt;false&lt;/debug&gt;
        &lt;feedback config:type="boolean"&gt;true&lt;/feedback&gt;
      &lt;/script&gt;
      &lt;dialog config:type="integer"&gt;0&lt;/dialog&gt;
      &lt;element config:type="integer"&gt;0&lt;/element&gt;
      &lt;pathlist config:type="list"&gt;
        &lt;path&gt;networking,dns,hostname&lt;/path&gt;
      &lt;/pathlist&gt;
      &lt;question&gt;Enter Hostname&lt;/question&gt;
      &lt;default&gt;enter your hostname here&lt;/default&gt;
    &lt;/ask&gt;
  &lt;/ask-list&gt;
&lt;/general&gt;</screen>
   </sect2>
  </sect1>
<!-- {{{ Kdump -->
  <sect1 xml:id="CreateProfile.kdump">
   <title>カーネルダンプ</title>

   <note>
    <title>提供可否について</title>
    <para>この機能は &zseries; (s390x) アーキテクチャでは使用できません。</para>
   </note>

   <para>Kdump を使用することで、カーネル全体がクラッシュしてしまった際にクラッシュダンプファイルを作成することができるようになります。クラッシュダンプファイルには、システムがクラッシュした時点でのメモリ内容が含まれます。クラッシュダンプファイルはコアファイルとも呼ばれ、 (カーネルの) 開発者がクラッシュの原因を調査する際に使用します。 Kdump はクラッシュの再現が難しいものの、問題の修正が重要となるサーバ用途で特に有用です。</para>

   <para>なお、 Kdump にはマイナス面もあります。 Kdump を有効化すると、 64 MB から 128 MB 程度の追加のメモリが Kdump 向けに予約されます。この領域を利用してダンプファイルを動作させるためです。</para>

   <para>本章では、 &ay; で Kdump を設定する際の説明のみを行なっています。 Kdump の動作については、 kdump(7) のマニュアルページなどをお読みください。</para>

   <para>下記の例では、一般的な Kdump 設定を行なっています。</para>

   <example>
    <title>Kdump の設定</title>
<screen>&lt;kdump&gt;
  &lt;!-- メモリ予約 --&gt;
  &lt;add_crash_kernel config:type="boolean"&gt;true&lt;/add_crash_kernel&gt;
  &lt;crash_kernel&gt;256M-:64M&lt;/crash_kernel&gt;
  &lt;general&gt;

    &lt;!-- ダンプ先の設定 --&gt;
    &lt;KDUMP_SAVEDIR&gt;ftp://stravinsky.suse.de/incoming/dumps&lt;/KDUMP_SAVEDIR&gt;
    &lt;KDUMP_COPY_KERNEL&gt;true&lt;/KDUMP_COPY_KERNEL&gt;
    &lt;KDUMP_FREE_DISK_SIZE&gt;64&lt;/KDUMP_FREE_DISK_SIZE&gt;
    &lt;KDUMP_KEEP_OLD_DUMPS&gt;5&lt;/KDUMP_KEEP_OLD_DUMPS&gt;

    &lt;!-- フィルタと圧縮 --&gt;
    &lt;KDUMP_DUMPFORMAT&gt;compressed&lt;/KDUMP_DUMPFORMAT&gt;
    &lt;KDUMP_DUMPLEVEL&gt;1&lt;/KDUMP_DUMPLEVEL&gt;

    &lt;!-- 通知 --&gt;
    &lt;KDUMP_NOTIFICATION_TO&gt;&exampleuser_plain;@&exampledomain;&lt;/KDUMP_NOTIFICATION_TO&gt;
    &lt;KDUMP_NOTIFICATION_CC&gt;spam@&exampledomain; devnull@&exampledomain;&lt;/KDUMP_NOTIFICATION_CC&gt;
    &lt;KDUMP_SMTP_SERVER&gt;&mailname;&lt;/KDUMP_SMTP_SERVER&gt;
    &lt;KDUMP_SMTP_USER&gt;&lt;/KDUMP_SMTP_USER&gt;
    &lt;KDUMP_SMTP_PASSWORD&gt;&lt;/KDUMP_SMTP_PASSWORD&gt;

    &lt;!-- kdump カーネル --&gt;
    &lt;KDUMP_KERNELVER&gt;&lt;/KDUMP_KERNELVER&gt;
    &lt;KDUMP_COMMANDLINE&gt;&lt;/KDUMP_COMMANDLINE&gt;
    &lt;KDUMP_COMMANDLINE_APPEND&gt;&lt;/KDUMP_COMMANDLINE_APPEND&gt;

    &lt;!-- 熟練者向け設定 --&gt;
    &lt;KDUMP_IMMEDIATE_REBOOT&gt;yes&lt;/KDUMP_IMMEDIATE_REBOOT&gt;
    &lt;KDUMP_VERBOSE&gt;15&lt;/KDUMP_VERBOSE&gt;
    &lt;KEXEC_OPTIONS&gt;&lt;/KEXEC_OPTIONS&gt;
  &lt;/general&gt;
&lt;/kdump&gt; </screen>
   </example>

<!-- {{{ Memory Reservation -->

   <sect2 xml:id="CreateProfile.kdump.reservation">
    <title>メモリ予約</title>
    <para>Kdump ではまず、起動時にメモリを予約する処理を行ないます。このメモリは起動時のかなり早い段階で予約しなければならないものであることから、設定はカーネルのコマンドラインパラメータの <literal>crashkernel</literal> で行ないます。予約されたメモリは、通常使用しているカーネルがクラッシュした際に呼び出される <quote>第二のカーネル</quote> で使用されます。第二のカーネルには特殊な initrd が設定され、ここにはネットワークやディスクにダンプを保存する機能やメールを送信する機能、そして最後にシステムの再起動を行なう機能がそれぞれ用意されています。</para>
    <para>Kdump でメモリを予約するには、 <literal>メモリ量</literal> (<literal>64M</literal> のように指定すると、 64MB のメモリを予約する意味になります) と <literal>オフセット値</literal> を指定します。これらをあわせて <literal>crashkernel=<replaceable>メモリ量</replaceable>@<replaceable>オフセット値</replaceable></literal> のように指定します。カーネルは適切なオフセット値を検出することができます (ただし、 &xen; ハイパーバイザを使用している場合は例外で、オフセット値に <literal>16M</literal> を指定する必要があります) 。メモリ量はお使いのアーキテクチャとメインメモリの量によって異なります。詳しくは <xref linkend="cha.tuning.kdump.basic.manual"/> をお読みください。</para>
    <para>システムのメモリ量に応じて予約するメモリ量を変更するようにするため、複雑なコマンドライン文法を使用することもできます。これは &ay; の制御ファイル 1 つで複数の環境に対応するような場合に有用であるほか、マシンのメインメモリを増やしたり減らしたりするような環境で使用することができます。書式は下記のとおりです:</para>
<screen><replaceable>範囲開始_1</replaceable>-<replaceable>範囲終了_1</replaceable>:<replaceable>メモリ量_1</replaceable>,<replaceable>範囲開始_2</replaceable>-<replaceable>範囲終了_2</replaceable>:<replaceable>メモリ量_2</replaceable>@<replaceable>オフセット</replaceable></screen>
    <para><replaceable>範囲開始_1</replaceable> には 1 つ目のシステムのメモリ量範囲の開始 (例: <literal>0M</literal>) を、 <replaceable>範囲終了_1</replaceable> には 1 つ目のメモリ量範囲の終了をそれぞれ指定します。 2 つ目以降も同様です。なお、範囲終了の値を省略すると、 <literal>無限大</literal> の意味になります。たとえば <literal>256M-2G:64M,2G-:128M</literal> のように指定すると、システムのメモリ量が 256 MB から 2GB までの範囲であれば 64MB 分の予約が、それより大きければ 128MB 分の予約が行なわれる意味になります。</para>
    <para>それとは別に、 <literal>crashkernel</literal> パラメータに対して複数の値を設定することもできます。たとえば低メモリと高メモリで別々のセグメントを予約する必要がある場合は、 <literal>72M,low</literal> と <literal>256M,high</literal> のように指定します。</para>
    <example>
    <title>複数の値を設定した Kdump メモリ予約</title>
<screen>
&lt;kdump&gt;
  &lt;!-- メモリ予約 (高/低) --&gt;
  &lt;add_crash_kernel config:type="boolean"&gt;true&lt;/add_crash_kernel&gt;
  &lt;crash_kernel config:type="list"&gt;
    &lt;listentry&gt;72M,low&lt;/listentry&gt;
    &lt;listentry&gt;256M,high&lt;/listentry&gt;
  &lt;/crash_kernel&gt;
&lt;/kdump&gt; </screen>
   </example>
    <para>下記の表には、メモリ予約を行なう際に必要な設定を示しています:</para>
    <table>
     <title>Kdump メモリ予約設定: XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>add_crash_kernel</literal></para>
        </entry>
        <entry>
         <para>メモリを予約して Kdump を有効化する場合、 <literal>true</literal> を指定します。</para>
<screen>&lt;add_crash_kernel config:type="boolean"&gt;true&lt;/add_crash_kernel&gt;</screen>
        </entry>
        <entry>
         <para>必須</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>crash_kernel</literal></para>
        </entry>
        <entry>
         <para>上述の crashkernel コマンドラインの書式で設定を行ないます。</para>
<screen>&lt;crash_kernel&gt;256M:64M&lt;/crash_kernel&gt;</screen>
        <para>値のリストを指定することもできます。</para>
<screen>&lt;crash_kernel config:type="list"&gt;
  &lt;listentry&gt;72M,low&lt;/listentry&gt;
  &lt;listentry&gt;256M,high&lt;/listentry&gt;
&lt;/crash_kernel&gt;</screen>
        </entry>
        <entry>
         <para>必須</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 xml:id="CreateProfile.kdump.saving">
    <title>ダンプの保存</title>
    <para>本章では、クラッシュダンプの保存場所と保存方法を説明しています。</para>
    <sect3 xml:id="CreateProfile.kdump.saving.target">
     <title>ターゲット</title>
     <para><literal>KDUMP_SAVEDIR</literal> では、ダンプの保存先 URL を指定します。指定可能なプロトコルは下記のとおりです:</para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para><literal>file</literal>: ローカルディスクへの保存</para>
      </listitem>
      <listitem>
       <para><literal>ftp</literal>: FTP サーバへの保存 (暗号化無し)</para>
      </listitem>
      <listitem>
       <para><literal>sftp</literal>: SSH2 SFTP サーバへの保存</para>
      </listitem>
      <listitem>
       <para><literal>nfs</literal>: NFS 共有内への保存</para>
      </listitem>
      <listitem>
       <para><literal>cifs</literal>: Samba もしくは Microsoft Windows が提供する CIFS/SMB 共有への保存</para>
      </listitem>
     </itemizedlist>
     <para>詳細は kdump(5) のマニュアルページをお読みください。たとえば <literal>file:///var/crash</literal> のように指定すると、 FHS に準拠した既定の場所に保存することができますし、 <literal>ftp://user:password@host:port/incoming/dumps</literal> のように指定することもできます。なお、指定したディレクトリ以下に名前とタイムスタンプを含むサブディレクトリが作成され、そのサブディレクトリ内にダンプが保存されます。</para>
     <para>ダンプをローカルのディスクに保存する場合は、 <literal>KDUMP_KEEP_OLD_DUMPS</literal> を指定することで、古いダンプを自動削除することができます。ここで指定する値は、保存しておくべきダンプ数になります。また、 <literal>KDUMP_FREE_DISK_SIZE</literal> で指定した値よりも空き容量が少ない場合、ダンプを保存しないように設定することもできます。</para>
     <para>カーネル全体とデバッグ情報 (インストールされていれば) を同じディレクトリ内に保存したい場合は、 <literal>KDUMP_COPY_KERNEL</literal> を <literal>true</literal> に設定します。これにより、カーネルモジュールとそのデバッグ情報を除き、ダンプの解析に必要なデータを 1 箇所にまとめることができるようになります。</para>
    </sect3>
    <sect3 xml:id="CreateProfile.kdump.saving.compression">
     <title>フィルタリングと圧縮</title>
     <para>カーネルのダンプは通常圧縮されておらず、フィルタもされていません。そのため、搭載されているメモリの分だけ巨大なファイルになります。より小さいファイルにしたい場合は、ダンプファイルを圧縮するように設定してください。なお、ダンプファイルを開く際には、あらかじめ展開する必要が生じるようになります。</para>
     <para>crash(8) デバッグツールで使用できるように各ページを圧縮し、動的な展開を行なうようページ圧縮を設定したい場合は、 <literal>KDUMP_DUMPFORMAT</literal> に <literal>compressed</literal> (既定値) を指定します。</para>
     <para>ゼロで埋められているページなど、全てのメモリページを保存したくない場合もあります。このようにダンプをフィルタしたい場合は、 <literal>KDUMP_DUMPLEVEL</literal> を指定します。 0 を指定すると完全なダンプを、 31 を指定すると最も小さなダンプを生成することになります。それぞれの値の意味と保存されるページについて、詳しくは kdump(5) と makedumpfile(8) のマニュアルページをお読みください。</para>
    </sect3>
    <sect3 xml:id="CreateProfile.kdump.saving.summary">
     <title>概要</title>
     <table>
      <title>ダンプターゲットの設定: XML 表記</title>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>要素</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
         <entry>
          <para>コメント</para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>KDUMP_SAVEDIR</literal></para>
         </entry>
         <entry>
          <para>ダンプと関連ファイルを保存する先を URL で指定します。</para>
<screen>&lt;KDUMP_SAVEDIR&gt;file:///var/crash/&lt;/KDUMP_SAVEDIR&gt;</screen>
         </entry>
         <entry>
          <para>必須</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>KDUMP_COPY_KERNEL</literal></para>
         </entry>
         <entry>
          <para><literal>true</literal> を指定すると、 <literal>KDUMP_SAVEDIR</literal> にはダンプだけでなくカーネルとデバッグ情報 (インストールされていれば) も保存するようになります。</para>
<screen>&lt;KDUMP_COPY_KERNEL&gt;false&lt;/KDUMP_COPY_KERNEL&gt;</screen>
         </entry>
         <entry>
          <para>任意指定</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>KDUMP_FREE_DISK_SIZE</literal></para>
         </entry>
         <entry>
          <para>ダンプを保存した後に残しておかなければならない空き容量を、メガバイト単位で指定します。十分な空き容量が存在しない場合、ダンプは保存されなくなります。</para>
<screen>&lt;KDUMP_FREE_DISK_SIZE&gt;64&lt;/KDUMP_FREE_DISK_SIZE&gt;</screen>
         </entry>
         <entry>
          <para>任意指定</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>KDUMP_KEEP_OLD_DUMPS</literal></para>
         </entry>
         <entry>
          <para><literal>KDUMP_SAVEDIR</literal> がローカルのディレクトリを指し示している場合、削除せず残しておくべきダンプ数を指定します。 0 を指定するとダンプの削除を無効化します。 -1 を指定すると、最新のものを除いて全て削除するようになります。</para>
<screen>&lt;KDUMP_KEEP_OLD_DUMPS&gt;4&lt;/KDUMP_KEEP_OLD_DUMPS&gt;</screen>
         </entry>
         <entry>
          <para>任意指定</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
     </table>
    </sect3>
   </sect2>

   <sect2 xml:id="CreateProfile.kdump.notification">
    <title>電子メール通知</title>
    <para>マシンがクラッシュしてダンプが保存された際、電子メールによる通知を受け取りたい場合の設定です。</para>
    <para>Kdump は initrd 内で動作する仕組みであることから、ローカルのメールサーバはメールを送信することができません。 SMTP サーバを指定して送信する必要があります (下記参照) 。</para>
    <para>なお、 <literal>KDUMP_NOTIFICATION_TO</literal> には宛先のアドレスを 1 つだけ指定する必要があります。複数のアドレスを指定したい場合は、 <literal>KDUMP_NOTIFICATION_CC</literal> に設定してください。なお、いずれの設定でも、電子メールアドレスだけを指定するものとし、名前などは含めないでください。</para>
    <para><literal>KDUMP_SMTP_SERVER</literal> のほか、メールサーバ側で認証を行なう必要がある場合は、 <literal>KDUMP_SMTP_USER</literal> と <literal>KDUMP_SMTP_PASSWORD</literal> も指定してください。 TLS/SSL への対応は提供されていませんが、将来的に追加される予定です。</para>
<!-- {{{ Table: XML representation of the e-mail notification settings -->
    <table>
     <title>電子メール通知の設定: XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>KDUMP_NOTIFICATION_TO</literal></para>
        </entry>
        <entry>
         <para>電子メールの送信先となるメールアドレスを 1 つだけ指定します。追加の受信者を設定したい場合は、 <literal>KDUMP_NOTIFICATION_CC</literal> で設定してください。</para>
<screen>&lt;KDUMP_NOTIFICATION_TO
&gt;&exampleuser_plain;@&exampledomain;&lt;/KDUMP_NOTIFICATION_TO&gt;</screen>
        </entry>
        <entry>
         <para>任意指定 (何も指定しない場合、通知が無効化されます)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_NOTIFICATION_CC</literal></para>
        </entry>
        <entry>
         <para>通知メールのコピー送信先となるメールアドレスを任意の数 (0 個以上) だけ指定します。</para>
<screen>&lt;KDUMP_NOTIFICATION_CC
&gt;&exampleuserII_plain;@&exampledomain; &exampleuserIII_plain;@&exampledomain;&lt;/KDUMP_NOTIFICATION_CC&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_SMTP_SERVER</literal></para>
        </entry>
        <entry>
         <para>メールの配送に使用する SMTP サーバのホスト名を指定します。 SMTP 認証を設定する必要である場合は、 <literal>KDUMP_SMTP_USER</literal> と <literal>KDUMP_SMTP_PASSWORD</literal> を指定してください。 TLS/SSL には未対応です。</para>
<screen>&lt;KDUMP_SMTP_SERVER&gt;email.suse.de&lt;/KDUMP_SMTP_SERVER&gt;</screen>
        </entry>
        <entry>
         <para>任意指定 (何も指定しない場合、通知が無効化されます)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_SMTP_USER</literal></para>
        </entry>
        <entry>
         <para>SMTP 認証で使用するユーザ名を指定します。 <literal>KDUMP_SMTP_PASSWORD</literal> についても設定を行なってください。</para>
<screen>&lt;KDUMP_SMTP_USER&gt;bwalle&lt;/KDUMP_SMTP_USER&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_SMTP_PASSWORD</literal></para>
        </entry>
        <entry>
         <para>SMTP 認証で使用するパスワードを指定します。 <literal>KDUMP_SMTP_USER</literal> についても設定を行なってください。</para>
<screen>&lt;KDUMP_SMTP_PASSWORD&gt;geheim&lt;/KDUMP_SMTP_PASSWORD&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 xml:id="CreateProfile.kdump.kernel">
    <title>Kdump カーネル設定</title>
    <para>上述のとおり、ダンプを保存する際には特別なカーネルを起動します。どのカーネルを使用するのかを自動検出する仕組みを使用したくない場合 (詳しくは kdump(5) のマニュアルページをお読みください) は、 <literal>KDUMP_KERNELVER</literal> でカーネルのバージョンを指定することができます。たとえば、この値を <literal>foo</literal> に設定すると、 <filename>/boot/vmlinuz-foo</filename> もしくは <filename>/boot/vmlinux-foo</filename> (<filename>vmlinuz</filename> ファイルが存在するプラットフォームの場合の順序) を使用するようになります。</para>
    <para>また、 Kdump カーネルの起動する際のコマンドラインも設定することができます。通常は起動時のコマンドラインから、 Kdump には無関係な設定 (たとえば <literal>crashkernel</literal> パラメータなど) を取り除き、 Kdump で必要な設定 (詳しくは kdump(5) のマニュアルページをお読みください) を追加して設定することになります。追加のパラメータを指定したい場合は、 <literal>KDUMP_COMMANDLINE_APPEND</literal> を指定してください。コマンドライン全体を設定したい場合は、 <literal>KDUMP_COMMANDLINE</literal> を指定してください (この場合、必要なパラメータ全てを設定しなければならないことに注意してください) 。</para>
    <table>
     <title>カーネル設定: XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>KDUMP_KERNELVER</literal></para>
        </entry>
        <entry>
         <para>Kdump で使用するカーネルのバージョン文字列を指定します。自動検出の仕組みを使用する場合は、指定しないでください (自動検出のほうを強くお勧めします) 。</para>
<screen>&lt;KDUMP_KERNELVER
&gt;2.6.27-default&lt;/KDUMP_KERNELVER&gt;</screen>
        </entry>
        <entry>
         <para>任意指定 (何も指定しなければ自動検出)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_COMMANDLINE_APPEND</literal></para>
        </entry>
        <entry>
         <para>Kdump カーネルに渡す追加のコマンドラインパラメータ。</para>
<screen>&lt;KDUMP_COMMANDLINE_APPEND
&gt;console=ttyS0,57600&lt;/KDUMP_COMMANDLINE_APPEND&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_Command Line</literal></para>
        </entry>
        <entry>
         <para>Kdump のコマンドラインとして生成されたものを上書きするための設定です。注意してお使いください。通常は <literal>KDUMP_COMMANDLINE_APPEND</literal> のほうを指定します。</para>
<screen>&lt;KDUMP_COMMANDLINE_APPEND
&gt;root=/dev/sda5 maxcpus=1 irqpoll&lt;/KDUMP_COMMANDLINE&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 xml:id="CreateProfile.kdump.expert">
    <title>熟練者向け設定</title>
    <table>
     <title>熟練者向け設定: XML 表記</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>要素</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
        <entry>
         <para>コメント</para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>KDUMP_IMMEDIATE_REBOOT</literal></para>
        </entry>
        <entry>
         <para><literal>true</literal> を指定すると、ダンプの保存完了後に自動的に再起動を行なうようになります。 <literal>false</literal> を指定すると再起動を行なわなくなります。既定では自動的に再起動します。</para>
<screen>&lt;KDUMP_IMMEDIATE_REBOOT
&gt;true&lt;/KDUMP_IMMEDIATE_REBOOT&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KDUMP_VERBOSE</literal></para>
        </entry>
        <entry>
         <para>Kdump の冗長出力度をビットマスクで指定します。詳しくは kdump(5) をお読みください。</para>
<screen>&lt;KDUMP_VERBOSE&gt;3&lt;/KDUMP_VERBOSE&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>KEXEC_OPTIONS</literal></para>
        </entry>
        <entry>
         <para>Kdump カーネルを読み込む際に kexec に渡す追加のオプションを指定します。通常は何も指定しません。</para>
<screen>&lt;KEXEC_OPTIONS&gt;--noio&lt;/KEXEC_OPTIONS&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>
  </sect1>

  <sect1 xml:id="CreateProfile.dns-server">
   <title>DNS サーバ</title>

   <para><literal>dns-server</literal> リソースを指定することで、 bind DNS サーバを設定することができます。下記に示す 3 種類の直感的なプロパティでは、 1 が有効、 0 が無効を表わしています。</para>
   <!-- Dropped properties: allowed_interfaces -->

   <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>chroot</literal></para>
         </entry>
         <entry>
          <para>0 / 1</para>
         </entry>
         <entry>
          <para>DNS サーバを chroot 内に閉じこめておくかどうか。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>start_service</literal></para>
         </entry>
         <entry>
          <para>0 / 1</para>
         </entry>
         <entry>
          <para>bind を有効にするかどうか (システムの起動時に開始するかどうか) 。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>use_ldap</literal></para>
         </entry>
         <entry>
          <para>0 / 1</para>
         </entry>
         <entry>
          <para>直接的な設定ファイルではなく、 LDAP 内に設定を保存するかどうか。</para>
         </entry>
        </row>
      </tbody>
     </tgroup>
    </informaltable>

    <example>
    <title>基本的な DNS サーバの設定</title>
<screen>
&lt;dns-server&gt;
  &lt;chroot&gt;0&lt;/chroot&gt;
  &lt;start_service&gt;1&lt;/start_service&gt;
  &lt;use_ldap&gt;0&lt;/use_ldap&gt;
&lt;/dns-server&gt; </screen>
   </example>

   <para>これらの基本的な設定のほかにも、下記のリストに示す 3 種類の追加プロパティが提供されています。下記はいずれも、サービスの設定を細かく調整するためのものです。</para>

   <informaltable>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>
        <para>リスト</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>logging</literal></para>
       </entry>
       <entry>
        <para>DNS サーバのログ機能に関するオプションです。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>options</literal></para>
       </entry>
       <entry>
        <para>使用すべきファイルやディレクトリ、フォワーダの一覧やその他の設定に関するオプションです。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>zones</literal></para>
       </entry>
       <entry>
        <para>サーバ側に設定する DNS ゾーンとそれらの設定、およびレコード類のオプションです。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>

   <example>
    <title>DNS サーバのゾーン設定と高度な設定</title>
<screen>
&lt;dns-server&gt;
  &lt;logging config:type="list"&gt;
    &lt;listentry&gt;
      &lt;key&gt;channel&lt;/key&gt;
      &lt;value&gt;log_syslog { syslog; }&lt;/value&gt;
    &lt;/listentry&gt;
  &lt;/logging&gt;
  &lt;options config:type="list"&gt;
    &lt;option&gt;
      &lt;key&gt;forwarders&lt;/key&gt;
      &lt;value&gt;{ 10.10.0.1; }&lt;/value&gt;
    &lt;/option&gt;
  &lt;/options&gt;
  &lt;zones config:type="list"&gt;
    &lt;listentry&gt;
      &lt;is_new&gt;1&lt;/is_new&gt;
      &lt;modified&gt;1&lt;/modified&gt;
      &lt;options config:type="list"/&gt;
      &lt;records config:type="list"&gt;
        &lt;listentry&gt;
          &lt;key&gt;mydom.uwe.&lt;/key&gt;
          &lt;type&gt;MX&lt;/type&gt;
          &lt;value&gt;0 mail.mydom.uwe.&lt;/value&gt;
        &lt;/listentry&gt;
        &lt;listentry&gt;
          &lt;key&gt;mydom.uwe.&lt;/key&gt;
          &lt;type&gt;NS&lt;/type&gt;
          &lt;value&gt;ns.mydom.uwe.&lt;/value&gt;
        &lt;/listentry&gt;
      &lt;/records&gt;
      &lt;soa&gt;
        &lt;expiry&gt;1w&lt;/expiry&gt;
        &lt;mail&gt;root.aaa.aaa.cc.&lt;/mail&gt;
        &lt;minimum&gt;1d&lt;/minimum&gt;
        &lt;refresh&gt;3h&lt;/refresh&gt;
        &lt;retry&gt;1h&lt;/retry&gt;
        &lt;serial&gt;2005082300&lt;/serial&gt;
        &lt;server&gt;aaa.aaa.cc.&lt;/server&gt;
        &lt;zone&gt;@&lt;/zone&gt;
      &lt;/soa&gt;
      &lt;soa_modified&gt;1&lt;/soa_modified&gt;
      &lt;ttl&gt;2d&lt;/ttl&gt;
      &lt;type&gt;master&lt;/type&gt;
      &lt;update_actions config:type="list"&gt;
        &lt;listentry&gt;
          &lt;key&gt;mydom.uwe.&lt;/key&gt;
          &lt;operation&gt;add&lt;/operation&gt;
          &lt;type&gt;NS&lt;/type&gt;
          &lt;value&gt;ns.mydom.uwe.&lt;/value&gt;
        &lt;/listentry&gt;
      &lt;/update_actions&gt;
      &lt;zone&gt;mydom.uwe&lt;/zone&gt;
    &lt;/listentry&gt;
  &lt;/zones&gt;
&lt;/dns-server&gt; </screen>
   </example>
  </sect1>

  <sect1 xml:id="CreateProfile.dhcp-server">
   <title>DHCP サーバ</title>

   <para><literal>dhcp-server</literal> リソースを使用することで、 DHCP サーバの全ての設定を行なうことができます。下記の 6 種類のプロパティをお使いください。</para>
   <!-- Dropped properties: allowed_interfaces -->

   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>要素</para>
       </entry>
       <entry>
        <para>値</para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para><literal>chroot</literal></para>
       </entry>
       <entry>
        <para>0 / 1</para>
       </entry>
       <entry>
        <para>値に 1 を指定すると、 DHCP サーバを chroot 環境内に閉じこめて動作するようになります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>start_service</literal></para>
       </entry>
       <entry>
        <para>0 / 1</para>
       </entry>
       <entry>
        <para>値に 1 を指定すると、 DHCP サーバを有効化します (システムの起動時に開始するようにします) 。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>use_ldap</literal></para>
       </entry>
       <entry>
        <para>0 / 1</para>
       </entry>
       <entry>
        <para>値に 1 を指定すると、設定を設定ファイルではなく LDAP に保存するようになります。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>other_options</literal></para>
       </entry>
       <entry>
        <para>テキスト</para>
       </entry>
       <entry>
        <para>DHCP サーバの起動時に、実行ファイルに渡すコマンドラインパラメータを文字列で指定します。たとえば "-p 1234" のように指定すると、非標準の 1234 ポートでサービスを待ち受けるようになります。設定可能なオプションの一覧については、 dhcpd のマニュアルページをお読みください。何も指定しない場合、既定値が適用されます。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>allowed_interfaces</literal></para>
       </entry>
       <entry>
        <para>リスト</para>
       </entry>
       <entry>
        <para>DHCP サーバのサービスを提供するネットワークカードのリストを指定します。設定方法については下記の例をご覧ください。</para>
       </entry>
      </row>
      <row>
       <entry>
        <para><literal>settings</literal></para>
       </entry>
       <entry>
        <para>リスト</para>
       </entry>
       <entry>
        <para>DHCP サーバの動作を設定するための設定リストを指定します。設定はツリー構造で、ルート要素がグローバルオプションを表わし、そこからサブネットやホストを定義する形になっています。また、 <literal>children</literal> , <literal>parent_id</literal> , <literal>parent_type</literal> の各プロパティを指定することで、入れ子になった構造を表わします。正確な書式については下記の例をご覧ください。</para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>

   <example>
    <title>dhcp-server セクションの例</title>
<screen>
&lt;dhcp-server&gt;
  &lt;allowed_interfaces config:type="list"&gt;
    &lt;allowed_interface&gt;eth0&lt;/allowed_interface&gt;
  &lt;/allowed_interfaces&gt;
  &lt;chroot&gt;0&lt;/chroot&gt;
  &lt;other_options&gt;-p 9000&lt;/other_options&gt;
  &lt;start_service&gt;1&lt;/start_service&gt;
  &lt;use_ldap&gt;0&lt;/use_ldap&gt;

  &lt;settings config:type="list"&gt;
    &lt;settings_entry&gt;
      &lt;children config:type="list"/&gt;
      &lt;directives config:type="list"&gt;
        &lt;listentry&gt;
          &lt;key&gt;fixed-address&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;192.168.0.10&lt;/value&gt;
        &lt;/listentry&gt;
        &lt;listentry&gt;
          &lt;key&gt;hardware&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;ethernet d4:00:00:bf:00:00&lt;/value&gt;
        &lt;/listentry&gt;
      &lt;/directives&gt;
      &lt;id&gt;static10&lt;/id&gt;
      &lt;options config:type="list"/&gt;
      &lt;parent_id&gt;192.168.0.0 netmask 255.255.255.0&lt;/parent_id&gt;
      &lt;parent_type&gt;subnet&lt;/parent_type&gt;
      &lt;type&gt;host&lt;/type&gt;
    &lt;/settings_entry&gt;
    &lt;settings_entry&gt;
      &lt;children config:type="list"&gt;
        &lt;child&gt;
          &lt;id&gt;static10&lt;/id&gt;
          &lt;type&gt;host&lt;/type&gt;
        &lt;/child&gt;
      &lt;/children&gt;
      &lt;directives config:type="list"&gt;
        &lt;listentry&gt;
          &lt;key&gt;range&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;dynamic-bootp 192.168.0.100 192.168.0.150&lt;/value&gt;
        &lt;/listentry&gt;
        &lt;listentry&gt;
          &lt;key&gt;default-lease-time&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;14400&lt;/value&gt;
        &lt;/listentry&gt;
        &lt;listentry&gt;
          &lt;key&gt;max-lease-time&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;86400&lt;/value&gt;
        &lt;/listentry&gt;
      &lt;/directives&gt;
      &lt;id&gt;192.168.0.0 netmask 255.255.255.0&lt;/id&gt;
      &lt;options config:type="list"/&gt;
      &lt;parent_id/&gt;
      &lt;parent_type/&gt;
      &lt;type&gt;subnet&lt;/type&gt;
    &lt;/settings_entry&gt;
    &lt;settings_entry&gt;
      &lt;children config:type="list"&gt;
        &lt;child&gt;
          &lt;id&gt;192.168.0.0 netmask 255.255.255.0&lt;/id&gt;
          &lt;type&gt;subnet&lt;/type&gt;
        &lt;/child&gt;
      &lt;/children&gt;
      &lt;directives config:type="list"&gt;
        &lt;listentry&gt;
          &lt;key&gt;ddns-update-style&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;none&lt;/value&gt;
        &lt;/listentry&gt;
        &lt;listentry&gt;
          &lt;key&gt;default-lease-time&lt;/key&gt;
          &lt;type&gt;directive&lt;/type&gt;
          &lt;value&gt;14400&lt;/value&gt;
        &lt;/listentry&gt;
      &lt;/directives&gt;
      &lt;id/&gt;
      &lt;options config:type="list"/&gt;
      &lt;parent_id/&gt;
      &lt;parent_type/&gt;
      &lt;type/&gt;
    &lt;/settings_entry&gt;
  &lt;/settings&gt;
&lt;/dhcp-server&gt; </screen>
   </example>
  </sect1>

  <sect1 xml:id="CreateProfile.firewall">
   <title>ファイアウオール設定</title>

   <para>&slsa; 15 およびそれ以降のバージョンでは SuSEfirewall2 が &firewalld; に置き換えられています。 SuSEfirewall2 プロパティを使用していたプロファイルについては、 &firewalld; のプロファイル形式に変換されます。ただし、全てのプロファイル設定が変換されるわけではありません。 &firewalld; に関する詳細は、 <xref linkend="sec.security.firewall.firewalld"/> をお読みください。</para>

    <important>
     <title>SuSEFirewall2 を利用したプロファイルとの後方互換性の制限について</title>
     <para>SuSEFirewall2 ベースのプロファイルの使用は、多くのオプションが &firewalld; で使用できなくなっていることから、部分的なサポートにとどまっています。そのため、移行できなかった設定によって、ネットワークセキュリティに影響がある場合があります。</para>
    </important>

   <sect2 xml:id="CreateProfile.firewall.general">
    <title>一般的なファイアウオール設定</title>

    <para>&firewalld; では、一般的な設定は少数のプロパティでのみ提供されていて、ほとんどの設定はゾーン内で行なうようになっています。</para>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>start_firewall</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
        </entry>
        <entry>
         <para>設定を適用したあと、 &firewalld; をすぐに起動するかどうかを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>enable_firewall</literal></para>
        </entry>
        <entry>
         <para>ブール値</para>
        </entry>
        <entry>
         <para>&firewalld; をシステムの起動時に開始するかどうかを指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>default_zone</literal></para>
        </entry>
        <entry>
         <para>ゾーン名</para>
        </entry>
        <entry>
         <para>特にゾーンを割り当てない場合に使用する既定のゾーンを指定します。</para>
        </entry>
      </row>
      <row>
        <entry>
         <para><literal>log_denied_packets</literal></para>
        </entry>
        <entry>
         <para>ログに記録すべきパケットの種類</para>
        </entry>
        <entry>
         <para>ドロップしたパケットのうち、ログに記録すべきものを選択します。値: <literal>off</literal> (無し), <literal>unicast</literal> (ユニキャスト), <literal>multicast</literal> (マルチキャスト), <literal>broadcast</literal> (ブロードキャスト), <literal>all</literal> (全て)</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>name</literal></para>
        </entry>
        <entry>
         <para>ゾーンの識別子</para>
        </entry>
        <entry>
         <para>ゾーンを識別するために使用するものです。ゾーンが既知のものではない場合、新しいゾーンを作成します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>short</literal></para>
        </entry>
        <entry>
         <para>ゾーンに対する短い説明</para>
        </entry>
        <entry>
         <para>ゾーンの目的を大まかにまとめたものです。既に存在するゾーンの場合は無視されます。何も指定しない場合、名前をそのまま説明に適用します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>description</literal></para>
        </entry>
        <entry>
         <para>ゾーンの説明</para>
        </entry>
        <entry>
         <para>ゾーンの目的を詳しく説明したものです。既に存在するゾーンの場合は無視されます。何も指定しない場合、名前をそのまま説明に適用します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>target</literal></para>
        </entry>
        <entry>
         <para>既定のアクション</para>
        </entry>
        <entry>
         <para>どのルールにも該当しない場合に取るべきアクションを指定します。設定可能な値は <literal>ACCEPT</literal> , <literal>%%REJECT%%</literal> , <literal>DROP</literal> , <literal>default</literal> のいずれかです。何も指定しない場合は <literal>default</literal> が指定されたものとみなされます。値の意味についての詳細は、 <link xlink:href="https://firewalld.org/documentation/zone/options.html"/> をお読みください。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

   <sect2 xml:id="CreateProfile.firewall.zones">
    <title>ファイアウオールのゾーン設定</title>

    <para>&firewalld; の設定はゾーンの仕組みをベースにしています。ゾーンとは接続やインターフェイス、接続元アドレスに適用する信頼レベルを意味するもので、各ゾーンの動作はいくつかの方法で制御することができるものの、全てのプロパティを設定できるというわけではありません。</para>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>interfaces</literal></para>
        </entry>
        <entry>
         <para>インターフェイス名のリスト</para>
        </entry>
        <entry>
         <para>このゾーンに割り当てるインターフェイスの一覧を指定します。インターフェイスもしくはソースのみをゾーン内に設定することができます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>services</literal></para>
        </entry>
        <entry>
         <para>サービスの一覧</para>
        </entry>
        <entry>
         <para>このゾーンで許可するサービスの一覧を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>ports</literal></para>
        </entry>
        <entry>
         <para>ポートの一覧</para>
        </entry>
        <entry>
          <para>このゾーンで開くポート、もしくはポート範囲の一覧を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>protocols</literal></para>
        </entry>
        <entry>
         <para>プロトコルの一覧</para>
        </entry>
        <entry>
         <para>このゾーンで開く、もしくはアクセスできるようにするプロトコルの一覧を指定します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>masquerade</literal></para>
        </entry>
        <entry>
         <para>マスカレード処理の可否</para>
        </entry>
        <entry>
         <para>このゾーンに対してネットワークアドレス変換 (<emphasis>(NAT)</emphasis>) を有効化するかどうかを指定します。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
   </sect2>

   <sect2 xml:id="CreateProfile.firewall.example">
    <title>完全な例</title>

    <para><literal>firewall</literal> セクションの例です。ここには一般的なプロパティのほか、ゾーン固有のプロパティも書かれています。</para>

    <example>
     <title>firewall セクションの例</title>
     <screen>&lt;firewall&gt;
  &lt;enable_firewall&gt;true&lt;/enable_firewall&gt;
  &lt;log_denied_packets&gt;all&lt;/log_denied_packets&gt;
  &lt;default_zone&gt;external&lt;/default_zone&gt;
  &lt;zones config:type="list"&gt;
    &lt;zone&gt;
      &lt;name&gt;public&lt;/name&gt;
      &lt;interfaces config:type="list"&gt;
        &lt;interface&gt;eth0&lt;/interface&gt;
      &lt;/interfaces&gt;
      &lt;services config:type="list"&gt;
        &lt;service&gt;ssh&lt;/service&gt;
        &lt;service&gt;dhcp&lt;/service&gt;
        &lt;service&gt;dhcpv6&lt;/service&gt;
        &lt;service&gt;samba&lt;/service&gt;
        &lt;service&gt;vnc-server&lt;/service&gt;
      &lt;/services&gt;
      &lt;ports config:type="list"&gt;
        &lt;port&gt;21/udp&lt;/port&gt;
        &lt;port&gt;22/udp&lt;/port&gt;
        &lt;port&gt;80/tcp&lt;/port&gt;
        &lt;port&gt;443/tcp&lt;/port&gt;
        &lt;port&gt;8080/tcp&lt;/port&gt;
      &lt;/ports&gt;
    &lt;/zone&gt;
    &lt;zone&gt;
      &lt;name&gt;dmz&lt;/name&gt;
      &lt;interfaces config:type="list"&gt;
        &lt;interface&gt;eth1&lt;/interface&gt;
      &lt;/interfaces&gt;
    &lt;/zone&gt;
  &lt;/zones&gt;
&lt;/firewall&gt;</screen>
    </example>
  </sect2>

  </sect1>

  <sect1 xml:id="CreateProfile.Hardware">
   <title>その他のハードウエア／システムコンポーネント</title>

   <para>&ay; では、ネットワーク認証やセキュリティなどの中枢コンポーネントの設定に加えて、さまざまなハードウエアやシステムの設定オプションを提供しています。この仕組みは対話的な手段でシステムを手作業でインストールし、設定する場合と同じ機能となります。具体的には、 &yast; で提供されているプリンタやサウンドデバイス、 TV カードやその他のハードウエアコンポーネントなどを設定することができます。</para>

   <para>また、 &yast; 側に新しい設定オプションが追加されると、 &ay; 側でも利用できるようになります。</para>

   <sect2 xml:id="CreateProfile.Hardware.Printer">
    <title>プリンタ</title>
    <para>&ay; でのプリンタのサポートは、ネットワーク経由で印刷を行なう場合、それを CUPS でどのように取り扱うかといった、基本的な設定項目に限られます。</para>
    <para>なお、 &ay; ではローカルの印刷キューを設定する機能は用意されていません。新しいプリンタであれば通常は USB 経由で接続しますが、 CUPS からは <literal>usb://ACME/FunPrinter?serial=1a2b3c</literal> 等のように、型式ごとに異なる URI を使用することになります。この URI は CUPS のバックエンドである <literal>usb</literal> が検出の際に設定するものであることから、あらかじめ USB のデバイス URI を判断するのは難しいことになります。このような背景から、 &ay; ではローカルの印刷キューを設定する機能は提供されていません。</para>
    <para>ネットワーク経由で印刷を行なう CUPS のクライアント側は、下記のような構造になっています:</para>
    <para>クライアント側のワークステーションでは、アプリケーションプログラムが印刷キューを CUPS デーモンプロセス ( <systemitem>cupsd</systemitem> ) に送信します。 <systemitem>cupsd</systemitem> は印刷ジョブを、実際に処理を行なう CUPS 印刷サーバに転送します。 CUPS 印刷サーバは、プリンタ固有のデータをプリンタデバイスに送信します。</para>
    <para>ネットワーク内に CUPS 印刷サーバが 1 台だけ存在するような場合は、各クライアント側のワークステーションで CUPS デーモンを動作させる必要はありません。その代わりに、 CUPS サーバの場所を <filename>/etc/cups/client.conf</filename> ファイルで直接指定してアクセスするように設定します (この設定ファイルには CUPS サーバを 1 つしか設定できません) 。この場合、クライアント側のアプリケーションプログラムは、指定した CUPS 印刷サーバに対して、直接ジョブを送信することになります。</para>
    <para><xref linkend="printer.conf"/> には <literal>printer</literal> セクションの構造を示していますが、この中の <literal>cupsd_conf_content</literal> には、 <systemitem class="daemon">cupsd</systemitem> の設定ファイル <filename>/etc/cups/cupsd.conf</filename> の内容全体を記述します。また <literal>client_conf_content</literal> には同様に、 <filename>/etc/cups/client.conf</filename> の内容全体を記述します。なお、 <literal>printer</literal> セクションには <systemitem class="daemon">cupsd</systemitem> の設定を記述しますが、 cupsd を動作させるべきかどうかについては指定しません。</para>
    <example xml:id="printer.conf">
     <title>プリンタの設定</title>
<screen>  &lt;printer&gt;
    &lt;client_conf_content&gt;
      &lt;file_contents&gt;&lt;![CDATA[
... verbatim content of /etc/cups/client.conf ...
]]&gt;&lt;/file_contents&gt;
    &lt;/client_conf_content&gt;
    &lt;cupsd_conf_content&gt;
      &lt;file_contents&gt;&lt;![CDATA[
... verbatim content of /etc/cups/cupsd.conf ...
]]&gt;&lt;/file_contents&gt;
    &lt;/cupsd_conf_content&gt;
  &lt;/printer&gt;</screen>
    </example>
    <note>
     <title><filename>/etc/cups/cups-files.conf</filename> について</title>
     <para>CUPS バージョン 1.6 もしくはそれ以降のバージョンでは、 CUPS の設定ファイルが <filename>cupsd.conf</filename> と <filename>cups-files.conf</filename> の 2 つのファイルに分割されています。ただし、通常の印刷設定では <filename>cups-files.conf</filename> を既定値のままで使用すれば十分であることから、 &productname; &productnumber; では &ay; は <filename>cupsd.conf</filename> の修正のみに対応しています。</para>
    </note>
   </sect2>

   <sect2 xml:id="CreateProfile.Hardware.Sound">
    <title>サウンドデバイス</title>
    <para>設定システムを利用してサウンド関連の設定を行なった場合の例を書きに示します。</para>
    <example>
     <title>サウンド設定</title>
<screen>&lt;sound&gt;
  &lt;autoinstall config:type="boolean"&gt;true&lt;/autoinstall&gt;
  &lt;modules_conf config:type="list"&gt;
    &lt;module_conf&gt;
      &lt;alias&gt;snd-card-0&lt;/alias&gt;
      &lt;model&gt;M5451, ALI&lt;/model&gt;
      &lt;module&gt;snd-ali5451&lt;/module&gt;
      &lt;options&gt;
        &lt;snd_enable&gt;1&lt;/snd_enable&gt;
        &lt;snd_index&gt;0&lt;/snd_index&gt;
        &lt;snd_pcm_channels&gt;32&lt;/snd_pcm_channels&gt;
      &lt;/options&gt;
    &lt;/module_conf&gt;
  &lt;/modules_conf&gt;
  &lt;volume_settings config:type="list"&gt;
    &lt;listentry&gt;
      &lt;Master config:type="integer"&gt;75&lt;/Master&gt;
    &lt;/listentry&gt;
  &lt;/volume_settings&gt;
&lt;/sound&gt;</screen>
    </example>
   </sect2>
  </sect1>

  <sect1 xml:id="CreateProfile.SSHKeysAndConfig">
    <title>SSH 鍵と設定の取り込み</title>

    <para>&yast; では以前のインストールから SSH の鍵とサーバの設定を取り込むことができます。この機能は &ay; プロファイル側でも使用することができます。</para>

    <example xml:id="import_ssh">
     <title>/dev/sda2 からの SSH 鍵と設定の取り込み</title>
<screen>&lt;ssh_import&gt;
  &lt;import config:type="boolean"&gt;true&lt;/import&gt;
  &lt;copy_config config:type="boolean"&gt;true&lt;/copy_config&gt;
  &lt;device&gt;/dev/sda2&lt;/device&gt;
&lt;/ssh_import&gt;</screen>
    </example>

    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>import</literal></para>
        </entry>
        <entry>
         <para>true / false</para>
        </entry>
        <entry>
         <para>SSH 鍵を取り込みます。 <literal>false</literal> を指定すると、鍵を取り込まなくなります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>copy_config</literal></para>
        </entry>
        <entry>
         <para>true / false</para>
        </entry>
        <entry>
         <para>SSH のサーバ設定もあわせて取り込むようにします。なお、この設定は <literal>import</literal> が <literal>false</literal> である場合には効果がありません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>device</literal></para>
        </entry>
        <entry>
         <para>パーティション</para>
        </entry>
        <entry>
         <para>鍵や設定の取り込み元を指定します。何も指定しない場合、アクセス日時が最も新しいものを取り込みます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
  </sect1>

  <sect1 xml:id="CreateProfile.ConfigurationManagement">
    <title>設定管理</title>

    <para>&ay; では、 Salt のような <emphasis>設定管理ツール</emphasis> に対して、設定の一部を代行させることができます。この場合、 &ay; では基本的なシステムのインストール (パーティション設定やネットワーク設定など) を行ない、残りの設定作業を代行させる形になります。</para>

   <note>
    <title>Salt のみを公式サポートする件について</title>
    <para>本文書内では Puppet に関する説明も書かれていますが、公式には Salt のみをサポート対象としています。ただし、 Puppet をご利用の場合で何か問題があれば、報告をお願いいたします。</para>
   </note>

    <para>&ay; では 2 種類の異なるアプローチに対応しています:</para>

    <itemizedlist>
     <listitem>
      <para>設定管理サーバを使用する方法。この場合、 &ay; は設定管理ツールを構成します。ここからマスターサーバへの接続を行ない、システムの設定に関する情報を取得します。</para>
     </listitem>
     <listitem>
      <para>どこか別の場所 (たとえば HTTP サーバや USB メモリなど) から設定を取得する方法。この場合、設定管理ツールはスタンドアロン (単独) モードで動作することになります。</para>
     </listitem>
    </itemizedlist>

    <sect2 xml:id="CreateProfile.ConfigurationManagement.Server">
     <title>設定管理システム (Configuration Management System; CMS) への接続</title>

     <para>このアプローチは、設定管理サーバ (Salt や Puppet の用語では、 <emphasis>マスター</emphasis> と呼びます) が既に用意されている場合、特に有用となります。この場合、構築時に最も難しい箇所は、適切な認証方式の設定となります。</para>

     <para>Salt および Puppet では下記の認証方式に対応しています:</para>

     <itemizedlist>
      <listitem>
       <para>その場での手動認証。 &ay; がクライアントを起動すると、新しい認証要求が生成されます。管理者はその要求を、サーバ側で手作業で受け付けることになります。 &ay; では接続を再試行しますので、その間にキーを受け付けてもらうことができれば、 &ay; がインストールを続けることができるようになります。</para>
      </listitem>
      <listitem>
       <para>事前シード鍵の使用。事前シード鍵の生成方法について、詳しくはお使いの設定管理システムのドキュメンテーションをお読みください。 &ay; 内での事前シード鍵の参照先は、 <literal>keys_url</literal> オプションで指定します。</para>
      </listitem>
     </itemizedlist>

     <para>下記に設定例を示します。 &ay; はクライアントを起動して認証要求を生成します。最大で 3 回、 15 秒間隔で再試行します。</para>

     <example xml:id="configuration_management_manual_authentication">
      <title>手動認証によるクライアント／サーバ</title>
<screen>&lt;configuration_management&gt;
    &lt;type&gt;salt&lt;/type&gt;
    &lt;master&gt;my-salt-server.example.net&lt;/master&gt;
    &lt;auth_attempts config:type="integer"&gt;3&lt;/auth_attempts&gt;
    &lt;auth_time_out config:type="integer"&gt;15&lt;/auth_time_out&gt;
&lt;/configuration_management&gt;</screen>
     </example>

     <para>下記に示す設定例では、 &ay; はキーを USB メモリから取得し、それを利用してマスターサーバへの接続を行なっています。</para>

     <example xml:id="configuration_management_preseed_keys">
      <title>事前シード鍵によるクライアント／サーバ</title>
<screen>&lt;configuration_management&gt;
    &lt;type&gt;salt&lt;/type&gt;
    &lt;master&gt;my-salt-server.example.net&lt;/master&gt;
    &lt;keys_url&gt;usb:/&lt;/keys_url&gt;
&lt;/configuration_management&gt;</screen>
     </example>

     <para>下記の表には、これらのシナリオで使用しているオプションの意味について説明しています。</para>

     <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>type</literal></para>
         </entry>
         <entry>
          <para>文字列</para>
         </entry>
         <entry>
          <para>設定管理方式の名称です。現時点では <literal>salt</literal> にのみ公式対応しています。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>master</literal></para>
         </entry>
         <entry>
          <para>文字列</para>
         </entry>
         <entry>
          <para>設定管理サーバのホスト名もしくは IP アドレス。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>auth_attempts</literal></para>
         </entry>
         <entry>
          <para>整数</para>
         </entry>
         <entry>
          <para>サーバに対して接続を試す際の最大試行回数。既定値は 3 です。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>auth_time_out</literal></para>
         </entry>
         <entry>
          <para>整数</para>
         </entry>
         <entry>
          <para>サーバへの接続を待機する時間 (秒単位) 。既定値は 15 秒です。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>keys_url</literal></para>
         </entry>
         <entry>
          <para>使用する鍵の URL</para>
         </entry>
         <entry>
          <para>HTTP サーバやハードディスク、 USB メモリなどの URL を指定します。指定した URL から <literal>default.key</literal> および <literal>default.pub</literal> の各ファイルを取得します。この鍵は設定管理サーバ内で既知のものでなければなりません。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>enable_services</literal></para>
         </entry>
         <entry>
          <para>True/False</para>
         </entry>
         <entry>
          <para>インストール後にクライアント側で設定管理サービスを有効化するかどうかを指定します。既定値は <literal>true</literal> です。</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
     </informaltable>
    </sect2>

    <sect2 xml:id="CreateProfile.ConfigurationManagement.Masterless">
     <title>スタンドアロン (単独) モードでの実行</title>
     <para>シンプルな構成を目的とした場合、設定管理サーバの配置は不要となります。その代わり、 Salt や Puppet を <emphasis>スタンドアロン (単独)</emphasis> (もしくは <emphasis>マスターレス</emphasis>) モードで動作させます。</para>

     <para>サーバが存在しないことから、 &ay; 側には設定の取得元を設定する必要があります。設定ファイルを TAR 形式の書庫にまとめて、このファイルをどこか (USB メモリや HTTP/HTTPS サーバ、もしくは NFS/SMB 共有) に配置します。</para>

     <para>なお、 TAR 形式の書庫は Salt サーバ内での <literal>/srv</literal> と同じ構造になっていなければなりません。たとえば state, formula, pillar などは <filename>salt</filename> ディレクトリ内に配置する必要があります。また必要であれば、 <literal>pillar_url</literal> オプションを使用して、個別の TAR 書庫内に pillars のデータを配置することもできます。</para>

     <example xml:id="configuration_management_masterless">
      <title>スタンドアロンモード</title>
<screen>&lt;configuration_management&gt;
    &lt;type&gt;salt&lt;/type&gt;
    &lt;states_url&gt;my-salt-server.example.net&lt;/states_url&gt;
    &lt;pillar_url&gt;my-salt-server.example.net&lt;/pillar_url&gt;
&lt;/configuration_management&gt;</screen>
     </example>

     <informaltable>
      <tgroup cols="3">
       <thead>
        <row>
         <entry>
          <para>属性</para>
         </entry>
         <entry>
          <para>値</para>
         </entry>
         <entry>
          <para>
           Description
          </para>
         </entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry>
          <para><literal>type</literal></para>
         </entry>
         <entry>
          <para>文字列</para>
         </entry>
         <entry>
          <para>設定管理方式の名称です。現時点では <literal>salt</literal> にのみ公式対応しています。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>states_url</literal></para>
         </entry>
         <entry>
          <para>URL</para>
         </entry>
         <entry>
          <para>Salt states の TAR 書庫の場所を指定します。 formula や pillar を含んでいてもかまいません。ファイルは <filename>salt</filename> ディレクトリ内に配置しなければなりません。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>pillar_url</literal></para>
         </entry>
         <entry>
          <para>URL</para>
         </entry>
         <entry>
          <para>pillar を含む TAR 書庫の場所を指定します。</para>
         </entry>
        </row>
        <row>
         <entry>
          <para><literal>modules_url</literal></para>
         </entry>
         <entry>
          <para>URL</para>
         </entry>
         <entry>
          <para>Puppet モジュールの場所を指定します。</para>
         </entry>
        </row>
       </tbody>
      </tgroup>
     </informaltable>
    </sect2>

    <sect2 xml:id="CreateProfile.ConfigurationManagement.SUMAFormulasSupport">
     <title>&susemgr; Salt Formulas サポートについて</title>

     <para>&ay; ではスタンドアロン (単独) モードで &susemgr; Salt Formulas を動作させる環境をサポートしています。この場合、 formula は state 用の TAR 書庫内に存在する必要があります。 &ay; では、適用すべき formula を選択し、設定するための画面を表示します。</para>

     <para>ただし、この機能を利用してしまうと、 &ay; がユーザからの入力を待機してしまうことになりますので、 &ay; の目的である無人インストールの意味が薄くなってしまうことに注意してください。</para>
    </sect2>
  </sect1>

 </chapter>
<!-- fs 2014-09-24:
     Commenting since this short chapter does not provide new information
     This is already covered in greater detail in the Deployment Guide

 <chapter id="Bootmanagement">
  <title>Network-based Installation</title>
  <para>
   &ay; provides a method to automatically and identically install
   groups of systems. The first step when preparing an &ay; installation
   is to decide how you want to install the target systems. The following
   scenario is a good example for how to set up and perform automated
   installations:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     You need to install &productname; on 50 new systems.
    </para>
   </listitem>
   <listitem>
    <para>
     The development department owns 30 out of the 50 new dual processor and
     SCSI systems, and these systems must be installed as clients with
     development software.
    </para>
   </listitem>
   <listitem>
    <para>
     The sales department owns 20 out of the 50 new, uni-processor IDE based
     systems and its systems must be installed as clients with end user
     software and office tools.
    </para>
    <remark>emap 2011-11-07: What about the remaining new systems? Will they be
    needed in this example? If not better let R&amp;D buy 30 new machines and
    Sales 20 new ones with different hardware. Um, reading to the end of this
    file, I wonder if we need this example at all? It is not being used to
    explain anything. It rather gets in the way. We do not even explain how the
    different hardware is handled.</remark>
   </listitem>
  </itemizedlist>
  <para>
   Prerequisites:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     a boot server on the same Ethernet segment,
    </para>
   </listitem>
   <listitem>
    <para>
     an installation server with the SUSE Linux OS,
    </para>
    <remark>emap 2011-11-07: Rather with the installation sources? </remark>
   </listitem>
   <listitem>
    <para>
     an &ay; configuration server that defines rules and control files.
     <remark>emap 2011-11-07: This is the first mention of a configuration server. Is it really needed?</remark>
    </para>
   </listitem>
  </itemizedlist>

  <sect1>
   <title>Configuration Server</title>

   <para>
    A configuration repository holds the control files for multiple
    machines. The control files can have any file names, which need to be
    specified at the boot time of a target client. To avoid supplying the
    control file name for every client, you can define the directory of the
    control files. If a directory is specified, then the target client tries
    to load a file with a name matching its IP address in HEX mode. This has
    the advantage that you will be dealing with consistent file names rather
    than IPs as file names which might lead to some confusion.
    <remark>emap 2011-11-07: Sounds like no dedicated server is needed, only a repository.</remark>
   </para>

   <para>
    The configuration repository is the same directory you specify when
    using the configuration system for creating control files.
   </para>

   <sect2>
    <title>HTTP Repository</title>
    <para>
     To be able to use the HTTP protocol to
     retrieve control files while auto-installing, you need a working
     HTTP server on the server side. Install
     <emphasis>Apache</emphasis> or another Web server and enable it
     using &yast;. Normally the Web server root directory resides in
     <filename>/srv/www/htdocs</filename> so you need to create a
     subdirectory which will serve your configuration repository.
    </para>
   </sect2>

   <sect2>
    <title>NFS Repository</title>
    <para>
     Create a directory and export it via
     NFS to the target clients. This
     directory may the same location where you have copied the CDs (for example
     <filename>/usr/local/SUSE</filename>).
     <remark>emap 2011-11-07: Change CDs to installation source/repository?</remark>
    </para>
   </sect2>

   <sect2>
    <title>TFTP Repository</title>
    <para>
     By default the TFTP directory is
     available under <filename>/tftpboot</filename> which can also contain
     boot images if you are booting over network. Do not forget to enable
     TFTP in the Inetd configuration file
     (<filename>/etc/inetd.conf</filename>). <emphasis>Inetd</emphasis>
     configuration can be done via &yast;.
    </para>
   </sect2>
  </sect1>
 </chapter>
-->
 <chapter xml:id="rulesandclass">
  <title>ルールとクラス</title>
  <para>ルールとクラスを使用することで、様々な方法でマシンのインストールをカスタマイズすることができます:</para>
  <itemizedlist>
   <listitem>
    <para>ルールを使用することで、システムの属性に応じた設定を行なうことができます。</para>
   </listitem>
   <listitem>
    <para>クラスはインストール先のシステムの設定グループを構成するものです。クラスはシステムに対して割り当てることができます。</para>
   </listitem>
  </itemizedlist>
  <note>
    <title><literal>autoyast</literal> 起動オプションのみの使用について</title>
    <para>ルールとクラスを使用する場合、起動パラメータでは <literal>autoyast=<replaceable>URL</replaceable></literal> を指定してください。</para>
    <para>これは、 <literal>autoyast2=<replaceable>URL</replaceable></literal> を使用してしまうと、単一の &ay; 制御ファイルのみをダウンロードしてしまうことから、ルールとクラスに対応できなくなってしまうためです。</para>
  </note>
  <sect1 xml:id="rules">
   <title>ルールベースの自動インストール</title>

   <para>ルールを使用することで、インストール時に複数の制御ファイルを組み合わせて、システムの属性に応じた設定を行なうことができます。ルールベースのインストールは、ルールファイルを元に制御を行ないます。</para>
   <para>ルールベースのインストールはたとえば、 2 つの部署に対するシステムのインストールをまとめて行ないたいような場合に有用です。たとえば部署 A ではオフィスデスクトップをインストールする要件があり、部署 B では開発者向けのワークステーションを構築する必要がある場合、 2 つの異なるルールファイルを作成することになります。それぞれのルールではそれぞれ異なるシステムパラメータを設定しますし、そこからそれぞれの部署に対応するためのプロファイルへのリンクも作成することになります。</para>

   <para>ルールファイルは XML 形式のファイルで、自動インストールを行なうシステム内の各グループに対するルールを記述します。ここには 1 つもしくは複数のルールが書き込まれ、システムの属性を元にシステムのグループを判断します。全てのルールの処理が終わると、システム内のグループは特定の制御ファイルに辿り着きます。ルールファイルと制御ファイルは、いずれもあらかじめ指定されたアクセス可能な場所に配置します。</para>

   <para>ルールファイルは <literal>autoyast</literal> キーワードで制御ファイルを直接指定しない場合にのみ取得し伸す。たとえば下記のような指定を行なってしまうと、ルールファイルが評価されなくなってしまいます:</para>

<screen>autoyast=http://10.10.0.1/profile/myprofile.xml
autoyast=http://10.10.0.1/profile/rules/rules.xml</screen>

   <para>その代わりに、下記のように指定してください:</para>

<screen>autoyast=http://10.10.0.1/profile/</screen>

   <para>これにより、 <literal>http://10.10.0.1/profile/rules/rules.xml</literal> ファイルを読み込むようになります (ディレクトリ名の末尾のスラッシュが重要です) 。</para>

   <figure xml:id="rules_fig1">
    <title>ルール</title>
    <mediaobject>
     <imageobject role="html">
      <imagedata fileref="autoyast_rules.png"/>
     </imageobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast_rules.svg" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>

   <para>複数のルールを適用する場合、各グループの最後でスクリプトを介して制御ファイルが合成され生成されます。この合成処理はルールの順序をもとにして動作するもので、後ろのほうにあるルールが前のほうにあるルールを上書きします。なお、合成された XML ファイルの冒頭セクションの名前は、合成が成功するようアルファベット順である必要があります。</para>

   <para>ルールのファイルの使用は任意です。ルールファイルが何も見つからない場合、システムのインストールは指定された制御ファイルを元にした標準的な方法で行なわれるか、システムの MAC アドレスや IP アドレスを元にして制御ファイルを検索して実施されます。</para>

   <sect2 xml:id="rulesfile">
    <title>ルールファイルの詳細</title>
    <example>
     <title>シンプルなルールファイル</title>
     <para>下記のシンプルな例は、既知のハードウエアでクライアントが設定を取得する際、どのようなルールファイルを設定することができるのかを示すための例です。</para>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE autoinstall&gt;
&lt;autoinstall xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;rules config:type="list"&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/sdc 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_a.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/sda 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_b.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
  &lt;/rules&gt;
&lt;/autoinstall&gt;</screen>
    </example>
    <para>上記の例では 2 つのルールが設定され、それぞれに対して別々の制御ファイルが設定されています。この場合、ルールの判断基準になっているのは <literal>disksize</literal> (ディスクサイズ) です。ルールファイルを処理したあと、 &yast; は <filename>rules.xml</filename> ファイル内に書かれたルールを利用して、システムの判断を行ないます。インストール先のシステムが、ルール内に書かれた全ての属性条件に合致すると、対応するリソースが制御ファイルのスタックに追加され、最終的な制御ファイルを作成するために使用されるようになります。なお <literal>continue</literal> プロパティは、 &ay; に対してルールに合致した際、それ以外のルールも参照するかどうかを制御するものです。</para>
    <para>なお、最初のルールに合致しなかった場合、合致するルールが見つかるまで次のルールへの移動を繰り返します。</para>
    <para><literal>disksize</literal> 属性を使用することで、ハードディスクのサイズに応じて設定を変更することができるようになります。上記の例では、最初のルールは <filename>/dev/sdc</filename> に対するルールで、これが 1 GB よりも大きい (<literal>match</literal> プロパティ) かどうかを判断しています。</para>
    <para>ルールには少なくとも 1 つ以上の属性を指定しなければなりません。複数の属性 (たとえばメモリやアーキテクチャなど) を指定する場合は、 <literal>rule</literal> リソース内に複数の属性を指定することになります (次の例をご覧ください) 。</para>
    <example>
     <title>シンプルなルールファイル</title>
     <para>下記のシンプルな例は、既知のハードウエアでクライアントが設定を取得する際、どのようなルールファイルを設定することができるのかを示すための例です。</para>
<screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE autoinstall&gt;
&lt;autoinstall xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;rules config:type="list"&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/sdc 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;memsize&gt;
            &lt;match&gt;1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/memsize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_a.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/shda 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;memsize&gt;
            &lt;match&gt;256&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/memsize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_b.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
  &lt;/rules&gt;
&lt;/autoinstall&gt;</screen>
    </example>
    <para>ルールディレクトリは、起動時に <literal>autoyast</literal> キーワードで指定したものと同じディレクトリ内に配置しなければなりません。たとえばクライアントを <literal>autoyast=http://10.10.0.1/profiles/</literal> で起動する場合、 &ay; はルールファイルを検索する際、 http://10.10.0.1/profiles/rules/rules.xml を使用します。</para>
   </sect2>

   <sect2 xml:id="customrules">
    <title>独自のルール</title>
    <para>&ay; が提供する属性では目的を達成できないような場合、独自のルールを作成することもできます。独自のルールはシェルスクリプトで記述し、スクリプトの出力 (STDOUT のみ、 STDERR は無視されます) を判断結果として使用します。</para>
    <para>下記に独自のルールの設定例を示します:</para>
<screen>&lt;rule&gt;
  &lt;custom1&gt;
    &lt;script&gt;
if grep -i intel /proc/cpuinfo &gt; /dev/null; then
echo -n "intel"
else
echo -n "non_intel"
fi;
    &lt;/script&gt;
    &lt;match&gt;*&lt;/match&gt;
    &lt;match_type&gt;exact&lt;/match_type&gt;
  &lt;/custom1&gt;
  &lt;result&gt;
    &lt;profile&gt;@custom1@.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
  &lt;/result&gt;
&lt;/rule&gt;</screen>
    <para>このルール内のスクリプトは STDOUT に <literal>intel</literal> もしくは <literal>non_intel</literal> を出力します (grep コマンドの出力は /dev/null に送られています) 。このルールスクリプトの出力は 2 つの '@' 文字で挟まれた箇所に当てはめられ、取得すべき制御ファイルの名前が <filename>intel.xml</filename> もしくは <filename>non_intel.xml</filename> になるように設定されています。これらのファイルには、ソフトウエアの選択を行なうための &ay; のプロファイルの一部を含めることができます。この場合、 Intel ハードウエアかどうかによって、インストールするソフトウエアを変える動作になります。</para>
    <para>独自のルールは最大で 5 つまでに制限されています。そのため、 <literal>custom1</literal> から <literal>custom5</literal> までを設定することができます。</para>
   </sect2>

   <sect2 xml:id="matchtypes">
    <title>ルールで使用する比較の種類</title>
    <para>match_type には 5 種類の比較のうちの 1 つを選択することができます:</para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para><literal>exact</literal> (既定値; 厳密一致)</para>
     </listitem>
     <listitem>
      <para><literal>greater</literal> (より大きい)</para>
     </listitem>
     <listitem>
      <para><literal>lower</literal> (より小さい)</para>
     </listitem>
     <listitem>
      <para><literal>range</literal> (範囲指定)</para>
     </listitem>
     <listitem>
      <para><literal>regex</literal> (正規表現; bash の <literal>=~</literal> 演算子のようなシンプルな仕組みです)</para>
     </listitem>
    </itemizedlist>
    <para><literal>exact</literal> を指定した場合、文字列として厳密に一致した場合にのみ合致したとみなされます。 <literal>regex</literal> は単純な部分文字列としても使用することができますので、たとえば <literal>ntel</literal> のように指定すると、 Intel, intel, intelligent のいずれにも合致することになります。 <literal>greater</literal> と <literal>lower</literal> は <literal>memsize</literal> や <literal>totaldisk</literal> など、数値同士を比較する際に使用します。ただし、整数値のみを扱うことができます。 <literal>range</literal> も整数値の範囲を指定する場合にのみ使用することができるもので、たとえば <literal>512-1024</literal> のように、 <literal><replaceable>最小</replaceable>-<replaceable>最大</replaceable></literal> のような形式で値を指定します。</para>
   </sect2>

   <sect2 xml:id="rulescombination">
    <title>属性の組み合わせ</title>
    <para>論理演算子を使用することで、複数の属性を組み合わせて使用することもできます。たとえば <literal>disksize</literal> (ディスクサイズ) が 1GB 以上であるか、もしくは <literal>memsize</literal> (メモリサイズ) が 512MB ちょうどである場合にのみ合致するルールを作成することができます。</para>
    <para>論理演算子を指定するには、ルール内に <literal>operator</literal> 要素を指定します。この要素には <literal>and</literal> (いずれのルールにも合致した場合に全体で合致したものとみなす) もしくは <literal>or</literal> (いずれかのルールに合致した場合に全体で合致したものとみなす) を指定することができます。既定値は <literal>and</literal> です。下記に例を示します:</para>
<screen>&lt;rule&gt;
  &lt;disksize&gt;
    &lt;match&gt;/dev/sda 1000&lt;/match&gt;
    &lt;match_type&gt;greater&lt;/match_type&gt;
  &lt;/disksize&gt;
  &lt;memsize&gt;
    &lt;match&gt;256&lt;/match&gt;
    &lt;match_type&gt;greater&lt;/match_type&gt;
  &lt;/memsize&gt;
  &lt;result&gt;
    &lt;profile&gt;machine2.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
  &lt;/result&gt;
  &lt;operator&gt;or&lt;/operator&gt;
&lt;/rule&gt;</screen>
   </sect2>

   <sect2 xml:id="rulesstructure">
    <title>ルールファイルの構造</title>
    <para><filename>rules.xml</filename> は下記の条件全てに合致する必要があります:</para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>少なくとも 1 つ以上のルールが存在すること。</para>
     </listitem>
     <listitem>
      <para><filename>rules.xml</filename> というファイル名になっていること。</para>
     </listitem>
     <listitem>
      <para>プロファイルのリポジトリ内の <filename>rules</filename> ディレクトリ内に配置されていること。</para>
     </listitem>
     <listitem>
      <para>ルール内の合致について、少なくとも 1 つ以上の属性が存在すること。</para>
     </listitem>
    </itemizedlist>
   </sect2>

   <sect2 xml:id="ruleattributes">
    <title>定義済みのシステム属性</title>
    <para>下記の表には、ルールファイル内で合致に使用することのできる、定義済みのシステム属性の一覧を示しています。</para>
    <para>お使いのシステムでどのような値になるのかを知りたい場合は、 <command>/usr/lib/&yast;/bin/y2base ayast_probe ncurses</command> を実行してください。スクロール可能なテキストボックスが表示され、その中に検出された値が表示されます。ただし、このコマンドは排他ロックを取得する必要があるため、他の &yast; プロセスが動作している (例: インストーラ) 場合には動作しません。そのため、インストール時に実行することはできません。</para>
    <table>
     <title>システム属性</title>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>hostaddress</literal></para>
        </entry>
        <entry>
         <para>ホストの IP アドレス</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>host name</literal></para>
        </entry>
        <entry>
         <para>ホスト名</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>domain</literal></para>
        </entry>
        <entry>
         <para>ホストのドメイン名</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>installed_product</literal></para>
        </entry>
        <entry>
         <para>インストールする製品の名前</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>installed_product_version</literal></para>
        </entry>
        <entry>
         <para>インストールする製品のバージョン</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>network</literal></para>
        </entry>
        <entry>
         <para>ホストのネットワークアドレス</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>mac</literal></para>
        </entry>
        <entry>
         <para>ホストの MAC アドレス</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません (MAC アドレスは <literal>0080c8f6484c</literal> のような形式になります) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>linux</literal></para>
        </entry>
        <entry>
         <para>システムに設定されている Linux パーティションの数</para>
        </entry>
        <entry>
         <para>この属性は 0 以上の値になります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>others</literal></para>
        </entry>
        <entry>
         <para>システムに設定されている Linux 以外のパーティションの数</para>
        </entry>
        <entry>
         <para>この属性は 0 以上の値になります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>xserver</literal></para>
        </entry>
        <entry>
         <para>グラフィックアダプタが必要な X サーバ</para>
        </entry>
        <entry>
         <para>この属性には <literal>exact</literal> による厳密一致を指定しなければなりません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>memsize</literal></para>
        </entry>
        <entry>
         <para>メガバイト単位でのホスト内のシステムメモリ量</para>
        </entry>
        <entry>
         <para>全ての種類の比較を使用することができます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>totaldisk</literal></para>
        </entry>
        <entry>
         <para>メガバイト単位でのホスト内のディスク容量の合計</para>
        </entry>
        <entry>
         <para>全ての種類の比較を使用することができます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>hostid</literal></para>
        </entry>
        <entry>
         <para>IP アドレスの 16 進数表記</para>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>arch</literal></para>
        </entry>
        <entry>
         <para>ホストのアーキテクチャ</para>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>karch</literal></para>
        </entry>
        <entry>
         <para>ホストのカーネルアーキテクチャ (SMP カーネルや &xen; カーネルなど)</para>
         <remark>
          Do we actually still have a Xen-specific kernel? - sknorr, 2017-05-08
         </remark>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>disksize</literal></para>
        </entry>
        <entry>
         <para>ドライブデバイスとサイズ</para>
        </entry>
        <entry>
         <para>全ての種類の比較を使用することができます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>product</literal></para>
        </entry>
        <entry>
         <para>SMBIOS 内で設定されているハードウエアの製品名</para>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>product_vendor</literal></para>
        </entry>
        <entry>
         <para>SMBIOS 内で設定されているハードウエアの製造元名</para>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>board</literal></para>
        </entry>
        <entry>
         <para>SMBIOS 内で設定されているシステムボードの名前</para>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>board_vendor</literal></para>
        </entry>
        <entry>
         <para>SMBIOS 内で設定されているシステムボードの製造元名</para>
        </entry>
        <entry>
         <para><literal>exact</literal> による厳密一致が必要です</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>custom1-5</literal></para>
        </entry>
        <entry>
         <para>シェルスクリプトを利用した独自ルール</para>
        </entry>
        <entry>
         <para>全ての種類の比較を使用することができます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 xml:id="rules_dialogs">
    <title>ダイアログルール</title>
    <para>チェックボックス付きのポップアップを表示して、合致させたいルールを選択することもできます。</para>
    <para>下記に示す要素は <filename>rules.xml</filename> ファイル内の XML 構造内に配置すべきものです:</para>
<screen>&lt;rules config:type="list"&gt;
  &lt;rule&gt;
    &lt;dialog&gt;
      ...
    &lt;/dialog&gt;
  &lt;/rule&gt;
&lt;/rules&gt;</screen>
    <informaltable>
     <tgroup cols="3">
      <thead>
       <row>
        <entry>
         <para>属性</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para><literal>dialog_nr</literal></para>
        </entry>
        <entry>
         <para>同じ <literal>dialog_nr</literal> の値が設定されたルールは、同一のダイアログ内に表示されるようになります。そのため、 <literal>dialog_nr</literal> は複数のルール内に設定することができます。</para>
<screen>&lt;dialog_nr config:type="integer"&gt;3&lt;/dialog_nr&gt;</screen>
        </entry>
        <entry>
         <para>この要素は任意指定で、値を指定しない場合の既定値は <literal>0</literal> です。全てのルールで 1 つのポップアップだけを表示する場合は、 <literal>dialog_nr</literal> を指定しなくてもかまいません。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>element</literal></para>
        </entry>
        <entry>
         <para>重複しない ID を指定します。複数のダイアログを設定している場合は、同じ ID のものが現われてはなりません。ただしダイアログ 1 と 2 で同じ <literal>1</literal> を指定してもかまいません (この動作は <literal>ask</literal> とは逆で、ダイアログが異なる場合であれば同じ ID でもかまいません) 。</para>
<screen>&lt;element config:type="integer"&gt;3&lt;/element&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。何も指定しない場合、 &ay; 側で ID を自動設定します。自動設定した場合は、 <literal>conflicts</literal> を指定することはできません (下記参照) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>title</literal></para>
        </entry>
        <entry>
         <para>ポップアップダイアログのタイトルを指定します。</para>
<screen>&lt;title&gt;Desktop Selection&lt;/title&gt;</screen>
        </entry>
        <entry>
         <para>任意指定</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>question</literal></para>
        </entry>
        <entry>
         <para>チェックボックスの隣に表示する文章を指定します。</para>
<screen>&lt;question&gt;GNOME Desktop&lt;/question&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。何もテキストを指定しない場合、このルールを起動した XML ファイルの名前が表示されます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>timeout</literal></para>
        </entry>
        <entry>
         <para>ダイアログの制限時間を秒単位で指定します。制限時間を超過すると、 <guimenu>Ok</guimenu> ボタンが自動的に <quote>押された</quote> として扱われます。ルール内の問い合わせで止まったままにしたくない場合に使用します。</para>
<screen>&lt;timeout config:type="integer"&gt;30&lt;/timeout&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です。制限時間を指定しない場合、ユーザ側で操作を行なってダイアログを終了しない限り、インストールが停止したままになります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>conflicts</literal></para>
        </entry>
        <entry>
         <para>このルールと競合する要素 ID (ルール) のリストを指定します。このルールに合致した場合、もしくはこのルールをユーザ側で選択した場合、競合関係にあるルールの選択は外され、ポップアップ内で無効化されます。デッドロックを発生させることがないように注意してお使いください。</para>
<screen>&lt;conflicts config:type="list"&gt;
  &lt;element config:type="integer"&gt;1&lt;/element&gt;
  &lt;element config:type="integer"&gt;5&lt;/element&gt;
  ...
&lt;/conflicts&gt;</screen>
        </entry>
        <entry>
         <para>任意指定です</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </informaltable>
    <para>下記はルール内でダイアログを使用する場合の例です:</para>
<screen>&lt;rules config:type="list"&gt;
  &lt;rule&gt;
    &lt;custom1&gt;
      &lt;script&gt;
echo -n 100
      &lt;/script&gt;
      &lt;match&gt;100&lt;/match&gt;
      &lt;match_type&gt;exact&lt;/match_type&gt;
    &lt;/custom1&gt;
    &lt;result&gt;
      &lt;profile&gt;rules/gnome.xml&lt;/profile&gt;
      &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;/result&gt;
    &lt;dialog&gt;
      &lt;element config:type="integer"&gt;0&lt;/element&gt;
      &lt;question&gt;GNOME Desktop&lt;/question&gt;
      &lt;title&gt;Desktop Selection&lt;/title&gt;
      &lt;conflicts config:type="list"&gt;
        &lt;element config:type="integer"&gt;1&lt;/element&gt;
      &lt;/conflicts&gt;
      &lt;dialog_nr config:type="integer"&gt;0&lt;/dialog_nr&gt;
    &lt;/dialog&gt;
  &lt;/rule&gt;
  &lt;rule&gt;
    &lt;custom1&gt;
      &lt;script&gt;
echo -n 100
      &lt;/script&gt;
      &lt;match&gt;101&lt;/match&gt;
      &lt;match_type&gt;exact&lt;/match_type&gt;
    &lt;/custom1&gt;
    &lt;result&gt;
      &lt;profile&gt;rules/gnome.xml&lt;/profile&gt;
      &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;/result&gt;
    &lt;dialog&gt;
      &lt;element config:type="integer"&gt;1&lt;/element&gt;
      &lt;dialog_nr config:type="integer"&gt;0&lt;/dialog_nr&gt;
      &lt;question&gt;Gnome Desktop&lt;/question&gt;
      &lt;conflicts config:type="list"&gt;
        &lt;element config:type="integer"&gt;0&lt;/element&gt;
      &lt;/conflicts&gt;
    &lt;/dialog&gt;
  &lt;/rule&gt;
  &lt;rule&gt;
    &lt;custom1&gt;
      &lt;script&gt;
echo -n 100
      &lt;/script&gt;
      &lt;match&gt;100&lt;/match&gt;
      &lt;match_type&gt;exact&lt;/match_type&gt;
    &lt;/custom1&gt;
    &lt;result&gt;
      &lt;profile&gt;rules/all_the_rest.xml&lt;/profile&gt;
      &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
    &lt;/result&gt;
  &lt;/rule&gt;
&lt;/rules&gt;</screen>
   </sect2>
  </sect1>
  <sect1 xml:id="classes">
   <title>クラス</title>

   <para>クラスはインストール先のシステムのグループに対する設定を表わします。ルールとは異なり、クラスは制御ファイル内に設定する必要があります。クラスを設定した後、目的のシステムに割り当てを行ないます。</para>

   <para>下記にクラス定義の例を示します:</para>

<screen>&lt;classes config:type="list"&gt;
  &lt;class&gt;
    &lt;class_name&gt;TrainingRoom&lt;/class_name&gt;
    &lt;configuration&gt;Software.xml&lt;/configuration&gt;
  &lt;/class&gt;
&lt;/classes&gt;</screen>

   <para>上記の例では、 <filename>Software.xml</filename> は <filename>classes/TrainingRoom/</filename> サブディレクトリ内に配置しなければなりません。 &ay; の制御ファイルやルールと同じ場所から取得が行なわれます。</para>

   <para>複数の制御ファイルが存在していて、それらの内容のうち共通する部分がある場合は、共通する部分をクラスとして設定すると良いでしょう。 <!--You just need to change the class and all profiles using that class are fixed too.--> <remark>emap 2011-11-07: Sentence does not make sense.</remark> このほか、 XIncludes を使用することもできます。</para>

   <para>設定管理システムを使用することで、クラスのセットを作成することもできます。クラスの定義では下記のような変数を使用することができます:</para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>Name: クラス名</para>
    </listitem>
    <listitem>
     <para>Description:</para>
    </listitem>
    <listitem>
     <para>Order: クラスの順序 (優先順位) <remark>emap 2011-11-07: What migration?</remark></para>
    </listitem>
   </itemizedlist>

   <figure os="sles;sled">
    <title>クラスの定義</title>
    <mediaobject>
     <imageobject role="html">
      <imagedata fileref="cms-class-definitions.png"/>
     </imageobject>
     <imageobject role="fo">
      <imagedata fileref="cms-class-definitions.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>

   <figure os="osuse">
    <title>クラスの定義</title>
    <mediaobject>
     <imageobject role="html">
      <imagedata fileref="cms-class-definitions_kde.png"/>
     </imageobject>
     <imageobject role="fo">
      <imagedata fileref="cms-class-definitions_kde.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>

   <para>クラスは必要な数だけ作成することができますが、設定をできるかぎり簡潔にするため、できるだけ少ないクラス数にしておくことをお勧めします。たとえば下記のようなクラスのセットを使用することができます:</para>

   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>site: 物理的な配置をもとにしたクラス</para>
    </listitem>
    <listitem>
     <para>machine: マシンの種類をもとにしたクラス</para>
    </listitem>
    <listitem>
     <para>role: マシンの機能をもとにしたクラス</para>
    </listitem>
    <listitem>
     <para>group: 部署や場所をもとにしたクラス</para>
    </listitem>
   </itemizedlist>

   <para>class ディレクトリ内に保存したファイルは通常の制御ファイルと同じ書式ですが、設定の一部分のみを表わすように記述します。たとえば特定のネットワークインターフェイスを持つコンピュータに対して新しい制御ファイルを作成する場合、ネットワークの設定のみを設定した制御ファイルリソースを作成します。複数の種類のネットワークがある場合は、他のクラスファイルを利用してそれらの種類に対応させ、それらを組み合わせて新しい制御ファイルを作り上げる形になります。 <remark>emap 2011-11-07: Not very clear.</remark></para>
  </sect1>
  <sect1 xml:id="mixinfrulesclasses">
   <title>ルールとクラスの混合</title>

   <para>自動インストールのセッションでは、ルールとクラスを混在させることができます。たとえばクラス定義を含むルールを利用してシステムを識別したりすることができます。流れは <xref linkend="rulesflow"/> で示しています。</para>

   <para>ルールを取得してそれらを合成したら、生成された制御ファイルが処理され、クラスの定義が存在していないかどうかを確認します。クラスが定義されている場合、元のリポジトリからクラスファイルを取得し、さらに合成処理を行ないます。</para>
  </sect1>
  <sect1 xml:id="merging">
   <title>ルールとクラスの合成</title>

   <para>クラスとルールの両方を使用することで、複数の XML ファイルから 1 つの XML ファイルを合成することになります。この合成処理は、通常期待される処理とは異なる動作になっていることから、しばしば混乱の原因となります。まず注意しておくべきことは、合成処理を成功させるには、合成対象の XML ファイル内のトップセクションは、アルファベット順に並んでいなければならない、という点です。</para>

   <para>たとえば下記のような 2 種類の合成すべき XML ファイルがあるものとします:</para>

<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;130&lt;/partition_id&gt;
        &lt;size&gt;2000mb&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;4Gb&lt;/size&gt;
        &lt;mount&gt;/data&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>

<screen>&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;initialize config:type="boolean"&gt;false&lt;/initialize&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</screen>

   <para>これらを合成することによって、通常は 3 種類のパーティション設定になるかと思われますが、残念ながらそうではありません。これらを合成すると 2 種類のパーティション設定となり、最初のパーティションはスワップとルートパーティションを混在させたものになります。また、 <literal>mount</literal> や <literal>size</literal> など、両方のパーティション設定内に存在するものは、いずれも 2 つ目のファイルのものを使用することになります。いずれか片方にしか存在しない設定については、設定されているほうの値が適用されます。<remark>emap 2011-11-07: A little confusing, why not put the merged file here.</remark></para>

   <para>また上記の例では、 2 つ目の <literal>drive</literal> については不要となり、両方を 1 つにまとめる必要があります。このような場合、 3 つの個別のパーティション設定を行なう必要があります。また、 <literal>dont_merge</literal> メソッドを使用することで、合成時の問題を解決することができます:</para>

<screen>&lt;classes config:type="list"&gt;
  &lt;class&gt;
    &lt;class_name&gt;swap&lt;/class_name&gt;
    &lt;configuration&gt;largeswap.xml&lt;/configuration&gt;
    &lt;dont_merge config:type="list"&gt;
      &lt;element&gt;partition&lt;/element&gt;
    &lt;/dont_merge&gt;
  &lt;/class&gt;
&lt;/classes&gt;</screen>

<screen>&lt;rule&gt;
  &lt;board_vendor&gt;
    &lt;match&gt;ntel&lt;/match&gt;
    &lt;match_type&gt;regex&lt;/match_type&gt;
  &lt;/board_vendor&gt;
  &lt;result&gt;
    &lt;profile&gt;classes/largeswap.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;dont_merge config:type="list"&gt;
      &lt;element&gt;partition&lt;/element&gt;
    &lt;/dont_merge&gt;
  &lt;/result&gt;
  &lt;board_vendor&gt;
    &lt;match&gt;PowerEdge [12]850&lt;/match&gt;
    &lt;match_type&gt;regex&lt;/match_type&gt;
  &lt;/board_vendor&gt;
  &lt;result&gt;
    &lt;profile&gt;classes/smallswap.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;dont_merge config:type="list"&gt;
      &lt;element&gt;partition&lt;/element&gt;
    &lt;/dont_merge&gt;
  &lt;/result&gt;
&lt;/rule&gt;</screen>
  </sect1>
 </chapter>
 <chapter xml:id="Invoking">
  <title>自動インストール処理</title>
  <info/>
  <para/>
  <sect1 xml:id="Installation.process">
   <title>紹介</title>

   <para>システムが自動インストールを起動して制御ファイルを取得すると、 &yast; は制御ファイル内に書かれた情報をもとにして、システムの設定を始めます。全ての設定は既定で表示されるウインドウ内にまとめられますが、完全にインストールを自動化したい場合には無効化することもできます。</para>

   <para>&yast; が設定の概要を表示したタイミングでは、 &yast; はハードウエアの検出を行なって自動インストールのための準備を行なっただけの状態になります。この時点ではまだシステムに対して、何も変更を加えていない状態になります。ここまでで何らかのエラーが発生しても、処理を安全に中止することができます。</para>

   <para>システムを自動インストールする場合は、グラフィックアダプタやモニタを使用せずに行なうこともできます。ただし、クライアントマシンに自動インストールするような場合は、進捗状況やエラー時の対応を行なう必要があることから、モニタを接続しておくことをお勧めします。また、グラフィカルなインターフェイスだけでなく、テキストベースの ncurses インターフェイスを使用することもできます。このほか、キーボードやマウス、ディスプレイの存在しないクライアントであれば、シリアルポートをコンソールとして使用することもできます。</para>

   <sect2 xml:id="Installation.Interface.X11">
    <title>X11 インターフェイス (グラフィカル)</title>
    <para>自動インストールを行なう場合、これが既定のインターフェイスとなります。このインターフェイスを使用する場合には、特に何も設定を行なう必要はありません。</para>
   </sect2>

   <sect2 xml:id="Installation.Interface.SerialConsole">
    <title>シリアルコンソール</title>
    <para>シリアルコンソールを利用してインストールを行ないたい場合は、カーネルのコマンドラインに対して <literal>console</literal> キーワード (例: <literal>console=ttyS0</literal> ) を追加します。これにより <command>linuxrc</command> がコンソールモードで動作するようになり、 &yast; についてもシリアルコンソール経由で表示されるようになります。</para>
   </sect2>

   <sect2 xml:id="Installation.Interface.Ncurses">
    <title>テキストベースの &yast; インストール</title>
    <para>このオプションについても、コマンドラインから有効化することができます。 &yast; をテキストモードで起動したい場合は、コマンドラインに <literal>textmode=1</literal> を指定してください。</para>
    <para>&yast; のテキストモードによる起動は、 64 MB よりも少ないメモリしか搭載していないクライアントや、ディスプレイの接続がなく、 X11 を設定すべきではないクライアントを使用しているような場合にお勧めです。</para>
   </sect2>
  </sect1>
  <sect1 xml:id="bootmedium">
   <title>適切な起動メディアの選択</title>

   <para>クライアントの起動に際してはさまざまな方式を使用することができます。コンピュータにによっては搭載されているネットワークインターフェイスカード (NIC) を利用して、 DHCP 経由もしくは TFTP 経由で起動イメージを取得できるものもあります。このほか、 USB メモリからカーネルと initrd イメージを読み込んだり、起動可能な DVD-ROM から起動を行なったりすることもできます。</para>

   <para>&yast; はその起動時、起動メディアもしくは initrd 内のルートディレクトリに、 <filename>autoinst.xml</filename> ファイルが存在していないかどうかを確認します。存在していた場合には、自動インストール処理に移行します。制御ファイルが異なるファイル名であったり、どこか別の場所に配置しているような場合は、カーネルのコマンドラインパラメータに　<literal>&ay;=<replaceable>URL</replaceable></literal> を指定してください。</para>

   <sect2 xml:id="bootmedium.flash">
    <title>フラッシュメモリからの起動</title>
    <para>テストやシステムの救出を目的とする場合、もしくはお使いのネットワークインターフェイスカードに PROM や PXE が搭載されていないような場合でも、 &ay; を使用することができます。フラッシュメモリであれば制御ファイルを含めることもできます。</para>
    <tip>
     <title>起動可能なフラッシュメモリの作成</title>
     <para>起動可能な USB メモリを作成するには、 &productname; の DVD 1 の ISO イメージか、 Mini CD の ISO イメージを <command>dd</command> コマンドで USB メモリに書き込みます (このとき、 USB メモリをマウントしていてはなりません。また、 USB メモリの内容は全て消去されます):</para>
<screen>&prompt.sudo;dd if=<replaceable>ISO_イメージのパス</replaceable> of=<replaceable>USB_ストレージデバイス</replaceable> bs=4M</screen>
    </tip>
   </sect2>

   <sect2 xml:id="bootmedium.dvd">
    <title>DVD-ROM からの起動</title>
    <para>オリジナルの &productname; DVD-ROM と他のメディアを併用することもできます。たとえば制御ファイルを USB メモリやネットワーク内の場所に配置しておき、 DVD-ROM から起動して場所を指定することもできます。また、 DVD-ROM そのものを修正して、制御ファイルを入れておくこともできます。</para>
   </sect2>

   <sect2 xml:id="bootmedium.pxe">
    <title>ネットワーク経由での PXE 起動</title>
    <para>PXE 起動を行なうには、ネットワーク内に DHCP サーバと TFTP サーバを用意する必要があります。これにより、物理メディアを使用せずに起動を行なうことができます。 <phrase os="sles;sled">このようなインフラストラクチャを構築する方法について、詳しくは <xref linkend="cha.remote_installation"/> をお読みください。</phrase></para>
    <para>なお PXE 経由でインストールを行なう場合、インストールを繰り返し続けてしまうという問題が発生することがあります。これはインストール後の再起動で、通常は第 2 ステージのインストール処理が動作すべきはずのところ、 PXE 経由の起動が再度行なわれてしまい、第 1 ステージに戻ってきてしまうことによるものです。</para>
    <para>このような問題を解決する方法はいくつかあります。 1 つは HTTP サーバ内に &ay; の制御ファイルを配置する方法で、通常のファイルではなく CGI スクリプトとして &ay; の制御ファイルを提供するように構成し、 2 度目の起動では TFTP サーバの設定を変更して、ハードディスクから起動するように設定します。</para>
    <para>もう 1 つの方法としては、 &ay; の制御ファイル内で新しい PXE 起動の設定をアップロードするようにする方法があります:</para>
<screen>&lt;pxe&gt;
  &lt;pxe_localboot config:type="boolean"&gt;true&lt;/pxe_localboot&gt;
  &lt;pxelinux-config&gt;
    DEFAULT linux
    LABEL linux
    localboot 0
  &lt;/pxelinux-config&gt;
  &lt;tftp-server&gt;&tftpip;&lt;/tftp-server&gt;
  &lt;pxelinux-dir&gt;/pxelinux.cfg&lt;/pxelinux-dir&gt;
  &lt;filename&gt;__MAC__&lt;/filename&gt;
&lt;/pxe&gt;</screen>
    <para>上記のように設定すると、初回の再起動が行なわれる直前に、インストール先のホストから TFTP サーバに対して新しい設定ファイルがアップロードされるようになります。ほとんどのインストール環境では TFTP デーモンが <systemitem class="username">nobody</systemitem> で動作していますので、このユーザから <filename>pxelinux.cfg</filename> ディレクトリに書き込むことができるように設定します。また、アップロードするファイルのファイル名を指定することもできます。上記の例では <literal>__MAC__</literal> と指定していますが、これは <literal>01-08-00-27-79-49-ee</literal> のような実際の MAC アドレスに置き換えられます。なお、ファイル名の設定が無い場合は、ファイル名に IP アドレスが設定されます。</para>
    <para>同じマシンに対して自動インストールを再度行なわせたい場合は、 TFTP サーバ内で該当のファイルを削除してください。</para>
   </sect2>
  </sect1>
  <sect1 xml:id="invoking_autoinst">
   <title>自動インストール処理の開始</title>

   <para><remark role="fixme">Add a short description</remark></para>

   <sect2 xml:id="invoking_autoinst.options">
    <title>コマンドラインオプション</title>
    <para>コマンドライン変数 <literal>autoyast</literal> を設定することで、 <command>linuxrc</command> を自動モードにすることができます。その場合、 <command>linuxrc</command> プログラムは設定ファイル (制御ファイルとは別のものです) を検索します。そのときの場所は下記のとおりです:</para>
    <itemizedlist>
     <listitem>
      <para>システムを起動する際に使用していた初期 RAM ディスクのルートディレクトリ</para>
     </listitem>
     <listitem>
      <para>起動メディアのルートディレクトリ</para>
     </listitem>
    </itemizedlist>
    <para><command>linuxrc</command> の設定ファイルには、複数のキーワードが用意されています。 <command>linuxrc</command> の詳しい説明とキーワードの一覧については、 <xref linkend="appendix.linuxrc"/> をお読みください。主なものは下記のとおりです:</para>
    <table>
     <title><command>linuxrc</command> のキーワード</title>
     <tgroup cols="2">
      <thead>
       <row>
        <entry>
         <para>キーワード</para>
        </entry>
        <entry>
         <para>値</para>
        </entry>
       </row>
      </thead>
      <tbody>
        <row>
        <entry>
         <para><literal>autoupgrade</literal></para>
        </entry>
        <entry>
         <para>&ay; を利用して自動アップグレードの処理を開始します。詳しくは <xref linkend="CreateProfile.upgrade"/> をお読みください。なお、用途によっては <literal>autoyast</literal> パラメータを指定する必要もあります (詳しくは <xref linkend="Commandline.ay"/> をお読みください) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast</literal></para>
        </entry>
        <entry>
         <para>自動インストールの際に使用する制御ファイルの場所を指定します。詳しくは <xref linkend="Commandline.ay"/> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast2</literal></para>
        </entry>
        <entry>
         <para>自動インストールの際に使用する制御ファイルの場所を指定します。 <literal>autoyast</literal> とは異なり、 <command>linuxrc</command> 側で指定された値を解釈し、たとえば必要に応じてネットワークの設定などを行なうようになります。 &ay; と <command>linuxrc</command> の URI 書式の違いについて、詳しくは <command>linuxrc</command> の付録 <xref linkend="appendix.linuxrc"/> をお読みください。 &ay; のルールとクラスには対応して <emphasis>いません</emphasis> 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>ifcfg</literal></para>
        </entry>
        <entry>
         <para>ネットワークを設定し、起動するようになります。 &ay; に対して、ネットワーク上離れた場所から取得を行なう必要がある場合に必要となります。詳しくは <xref linkend="ay.adv_network"/> をお読みください。</para>
        </entry>
       </row>
       <!-- fs 2016-07-29: better use ifcfg
       <row>
        <entry>
         <para>
          <literal>gateway</literal>
         </para>
        </entry>
        <entry>
         <para>
          Gateway
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>hostip</literal>
         </para>
        </entry>
        <entry>
         <para>
          When empty, client sends BOOTP request, otherwise client is
          configured with entered IP configuration.
         </para>
        </entry>
        </row>
        -->
       <row>
        <entry>
         <para><literal>insmod</literal></para>
        </entry>
        <entry>
         <para>読み込むべきカーネルモジュール</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>install</literal></para>
        </entry>
        <entry>
         <para>インストールに使用するディレクトリの指定。例: <literal>install=nfs://192.168.2.1/CDs/</literal></para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>instmode</literal></para>
        </entry>
        <entry>
         <para>インストールモードを指定します。たとえば <literal>nfs</literal> , <literal>http</literal> などを指定します (<literal>install</literal> が指定されていれば不要です) 。</para>
        </entry>
       </row>
       <!-- fs 2016-07-29: better use ifcfg
       <row>
        <entry>
         <para>
          <literal>nameserver</literal>
         </para>
        </entry>
        <entry>
         <para>
          Name Server
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>netdevice</literal>
         </para>
        </entry>
        <entry>
         <para>
          Network device to use for network setup (for BOOTP and DHCP
          requests)
         </para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>netmask</literal>
         </para>
        </entry>
        <entry>
         <para>
          Netmask
         </para>
        </entry>
        </row>
        -->
      <row>
        <entry>
         <para><literal>rootpassword</literal></para>
        </entry>
        <entry>
         <para>&ay; プロファイル内で指定されていない場合、ここで root のパスワードを設定することができます</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>server</literal></para>
        </entry>
        <entry>
         <para>ソースディレクトリとして使用するサーバ (NFS) を指定します</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>serverdir</literal></para>
        </entry>
        <entry>
         <para>NFS サーバ内のディレクトリを指定します</para>
        </entry>
       </row>
       <row>
        <entry>
         <para>
          <literal>y2confirm</literal>
         </para>
        </entry>
        <entry>
         <para>制御ファイル内に &lt;confirm&gt;no&lt;/confirm&gt; が設定されていても、確認メッセージを表示するようにします。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
    <para>これらの値やキーワードはシステムを起動する際に使用され、 &yast; がメインの制御ファイルを得るまでの間使用されます。現時点ではソースメディアは自動検出されるようになっていますので、場合によっては <command>linuxrc</command> に特段の設定を行なわなくても、自動インストールの処理を開始することができるようになっています。</para>
    <para>従来の <command>linuxrc</command> の設定ファイル ( <filename>info</filename> ) には、インストールサーバやソースの場所など、クライアントに対して十分な情報を提供する機能が用意されてきました。通常はこのファイルを用意する必要はありませんが、 DHCP も BOOTP も使用していないような環境であったり、特殊なカーネルモジュールを読み込む必要があるような環境では、必要となる場合もあります。</para>
    <para><command>linuxrc</command> にキーワードを渡したい場合は、カーネルのコマンドラインを使用することができます。これはいくつかの方法で設定することができます。通常のメディアからの起動時に、その他のカーネルパラメータとともに <command>linurc</command> キーワードを指定することができるほか、ネットワーク経由で起動するディスクイメージを作成して、そこにカーネルパラメータを設定する方法もあります。また、 Etherboot や PXE との組み合わせで、 DHCP サーバ側でカーネルのパラメータを設定することもできます。</para>
    <para>コマンドライン変数 <literal>autoyast</literal> には、 <xref linkend="Commandline.ay"/> の表に示すような書式を使用することができます。</para>
    <table xml:id="Commandline.ay">
     <title>&ay; の書式</title>
     <tgroup cols="2">
      <thead>
       <row>
        <entry>
         <para>コマンドライン変数</para>
        </entry>
        <entry>
         <para>
          Description
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row>
        <entry>
         <para>(無し)</para>
        </entry>
        <entry>
         <para>自動アップグレードの場合は、 <literal>autoyast</literal> 変数を指定する必要はありません。詳しくは <xref linkend="pro.upgrade.upgrade-mode"/> をお読みください。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=default</literal></para>
        </entry>
        <entry>
         <para>既定の自動インストールオプションを使用します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=file:///<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>指定したパス内の制御ファイルを読み込みます。ソースメディアのルートディレクトリからの相対パスを指定します。たとえば CD/DVD から起動している場合、 <literal>file:///autoinst.xml</literal> のように指定すると、 CD/DVD-ROM のルートディレクトリ内のファイルを読み込むようになります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=device://<replaceable>デバイス</replaceable>/<replaceable>ファイル名</replaceable></literal></para>
        </entry>
        <entry>
         <para>指定したストレージデバイス内の制御ファイルを読み込みます。この場合、デバイスに対するフルパスではなく、デバイス名のみを指定してください。また、デバイス名を省略する (例: <literal>autoyast=device:///<replaceable>ファイル名</replaceable></literal> ) と、 &ay; は全てのデバイスを検索するようになります。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=nfs://<replaceable>サーバ</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>NFS サーバ内の制御ファイルを読み込みます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=http://[<replaceable>ユーザ名</replaceable>:<replaceable>パスワード</replaceable>@]<replaceable>サーバ</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>HTTP プロトコルを利用して、 Web サーバから制御ファイルを取得します。ユーザ名とパスワードの指定は任意です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=https://[<replaceable>ユーザ名</replaceable>:<replaceable>パスワード</replaceable>@]<replaceable>サーバ</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>HTTPS プロトコルを利用して、 Web サーバから制御ファイルを取得します。ユーザ名とパスワードの指定は任意です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=tftp://<replaceable>サーバ</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>TFTP 経由で制御ファイルを取得します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=ftp://[<replaceable>ユーザ名</replaceable>:<replaceable>パスワード</replaceable>@]<replaceable>サーバ</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>FTP プロトコルを利用して制御ファイルを取得します。ユーザ名とパスワードの指定は任意です。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=usb://<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>USB デバイスから制御ファイルを取得します (&ay; は接続されている全ての USB デバイスを検索します) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=relurl://<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>インストール元 (install=....) から制御ファイルを取得します。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=slp</literal></para>
        </entry>
        <entry>
         <para>SLP サーバに対して制御ファイルの場所を尋ねます (service:autoyast:...) 。必要であれば、 <literal>description=</literal> 属性を追加して、 URL をより分かりやすく <quote>翻訳</quote> することもできます ( <literal>autoyast=slp:/?descr=*SLES*</literal> ) 。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=cifs://<replaceable>サーバ</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>CIFS サーバ内にある制御ファイルを読み込みます。</para>
        </entry>
       </row>
       <row>
        <entry>
         <para><literal>autoyast=label://<replaceable>ラベル</replaceable>/<replaceable>パス</replaceable></literal></para>
        </entry>
        <entry>
         <para>指定したラベルのデバイス内にある制御ファイルを読み込みます。</para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
    <para>自動インストールでは、異なる種類のインフラストラクチャとソースメディアを使用するさまざまなシナリオが考えられます。最もシンプルな方法は &productname; のソースメディア (DVD メディア) を使用する方法ですが、この場合は自動インストールを開始するのにコマンドライン変数を入力する必要があるほか、 &yast; からアクセス可能な場所に制御ファイルを配置する必要もあります。</para>
     <para>スクリプトという観点では、マシンに対してシリアルコンソールを使用することで、テキストモードによるインストールを行なう方法もあります。この場合、必要なパラメータを expect スクリプトなどで問い合わせることができます。</para>
     <para>それぞれの起動方法ごとに利用可能な、制御ファイルの提供方法を示します:</para>
    <variablelist>
     <varlistentry>
      <term>&productname; インストール DVD-ROM を使用する場合</term>
      <listitem>
       <para>&productname; の DVD-ROM を使用する場合、制御ファイルは USB メモリやネットワーク内に存在している必要があります:</para>
       <formalpara>
        <title>USB メモリ</title>
        <para><literal>autoyast=usb://<replaceable>パス</replaceable></literal> オプションを指定して制御ファイルにアクセスを行なうことができます。</para>
       </formalpara>
       <formalpara>
        <title>ネットワーク</title>
        <para>下記のいずれかのコマンドで制御ファイルにアクセスすることができます: <literal>autoyast=nfs://..</literal> , <literal>autoyast=ftp://..</literal> , <literal>autoyast=http://..</literal> , <literal>autoyast=https://..</literal> , <literal>autoyast=tftp://..</literal> , <literal>autoyast=cifs://..</literal></para>
       </formalpara>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>独自の DVD-ROM を使用する場合</term>
      <listitem>
       <para>この場合、制御ファイルを DVD-ROM 内に直接含めることができます。制御ファイルはルートディレクトリ内に配置し、 <filename>autoinst.xml</filename> というファイル名にしておいてください。これにより、インストール時に自動検出され、使用されるようになります。もちろん <literal>autoyast=file:///<replaceable>パス</replaceable></literal> のように指定すれば、他のパスにある制御ファイルを指定して使用することもできます。</para>
       <para>自動インストールで DVD-ROM を使用する場合は、インストーラに対してネットワークにアクセスして必要なファイルを取得するのではなく、 DVD-ROM 内にあるファイルを使用するように指定する必要があります。これはカーネルのコマンドライン内に <literal>instmode=cd</literal> を指定することで設定することができます (なお、 DVD 内の <filename>isolinux.cfg</filename> 内にオプションを追加すれば、これも自動化することができます) 。</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>ネットワーク経由でインストールする場合</term>
      <listitem>
       <para>自動インストールではこのインストール方法が最も多いでしょう。複数のマシンにインストールを行なう場合、 SLP や NFS のサーバのほか、 BOOTP や DHCP などのネットワークサービスを併用することが多いためです。この場合、制御ファイルの配置にあたって最も簡単な方法は、インストールソースとして使用するディレクトリのルートに、制御ファイルを配置する方法です。ファイル名は <filename>autoinst.xml</filename> というファイル名にしてください。この場合、インストール時に自動検出され、自動インストールが行なわれるようになります。制御ファイルは下記のような場所に配置することもできます:</para>
       <formalpara>
        <title>USB メモリ</title>
        <para><literal>autoyast=usb://<replaceable>パス</replaceable></literal> オプションを指定して制御ファイルにアクセスを行なうことができます。</para>
       </formalpara>
       <formalpara>
        <title>ネットワーク</title>
        <para>下記のいずれかのコマンドで制御ファイルにアクセスすることができます: <literal>autoyast=nfs://..</literal> , <literal>autoyast=ftp://..</literal> , <literal>autoyast=http://..</literal> , <literal>autoyast=https://..</literal> , <literal>autoyast=tftp://..</literal> , <literal>autoyast=cifs://..</literal></para>
       </formalpara>
      </listitem>
     </varlistentry>
    </variablelist>
    <note>
     <title>ネットワークと DHCP の無効化について</title>
     <para>インストール時にネットワークが不要である場合や利用できない場合、たとえば DVD-ROM から自動インストールを行なうような場合、ネットワークを無効化するには、 <command>linuxrc</command> オプションに <literal>netsetup=0</literal> を指定することで、ネットワークの設定を無効化することができます。</para>
    </note>
    <note>
     <title><literal>autoyast</literal> と <literal>autoyast2</literal> のオプションの違いについて</title>
     <para><literal>autoyast</literal> と <literal>autoyast2</literal> のオプションは非常に似通っていますが、下記のような大きな違いが存在します:</para>
     <itemizedlist>
      <listitem>
       <para><literal>autoyast=http://...</literal> を使用した場合は、 <command>linuxrc</command> でネットワーク設定を行なう必要があります。</para>
      </listitem>
      <listitem>
       <para><literal>autoyast2=http://...</literal> を使用した場合は、 <command>linuxrc</command> が自動的にネットワークの設定を行ないます。</para>
      </listitem>
     </itemizedlist>
    </note>
    <para><literal>autoyast=default</literal> を指定した場合、 &yast; は下記の場所のいずれかに存在する <filename>autoinst.xml</filename> を読み込もうとします:</para>
    <orderedlist>
     <listitem>
      <para>USB メモリのルートディレクトリ</para>
     </listitem>
     <listitem>
      <para>インストールメディアのルートディレクトリ</para>
     </listitem>
     <listitem>
      <para>システムを起動する際に使用した初期 RAM ディスクのルートディレクトリ</para>
     </listitem>
    </orderedlist>
    <para><literal>default</literal> を除く全ての &ay; オプションでは、下記のような方式で制御ファイルの場所を指定することができます:</para>
<!-- numeration="arabic" -->
    <orderedlist>
     <listitem>
      <para>制御ファイルの正確な場所を指定する方法:</para>
<screen>autoyast=http://192.168.1.1/control-files/client01.xml</screen>
     </listitem>
     <listitem>
      <para>複数の制御ファイルが配置されているディレクトリを指定する方法:</para>
<screen>autoyast=http://192.168.1.1/control-files/</screen>
      <para>この場合、対応する制御ファイルは IP アドレスの 16 進数表記によるファイル名で取得することになります (後述) 。</para>
     </listitem>
    </orderedlist>
    <para>パスのプレフィクスのみを指定した場合、 &yast; は下記の流れで制御ファイルへのアクセスを試みます:</para>
<!-- numeration="arabic" -->
    <orderedlist>
     <listitem>
      <para>まずは自分自身の IP アドレスを 16 進数に変換したファイル名の制御ファイルを検索します。たとえば <literal>192.0.2.91 -&gt; C000025B</literal> のようになります。</para>
     </listitem>
     <listitem>
      <para>このファイルが見つからない場合、 &yast; は 16 進数表記から 1 桁を削って再試行します。この処理は、ファイルが見つかるまで繰り返されます。それでも見つからない場合は、クライアント側の MAC アドレスからファイル名を生成してアクセスしようとします (MAC アドレスは <literal>0080C8F6484C</literal> のような書式になります) 。それでも見つからない場合は、 <filename>default</filename> というファイル名 (全て小文字) でアクセスを試みます。</para>
     </listitem>
    </orderedlist>
    <para>たとえば 192.0.2.91 であれば、 HTTP クライアントは下記の順序でアクセスしようとします:</para>
<!-- role="literallayout" -->
<screen>C000025B
C000025
C00002
C0000
C000
C00
C0
C
0080C8F6484C
default</screen>
    <para><!-- NOTE: nothing needed for translation --></para>
    <para>クライアントの IP アドレスを 16 進数に変換するには、 <systemitem class="resource">syslinux</systemitem> パッケージに含まれる <command>/usr/bin/gethostip</command> ユーティリティをお使いください。</para>
    <example>
     <title>IP アドレスの 16 進数表記への変換</title>
<screen>&prompt.user;/usr/bin/gethostip 10.10.0.1
10.10.0.1 10.10.0.1 0A0A0001</screen>
    </example>
   </sect2>

   <sect2 xml:id="autoinstall.singlesystem">
    <title>単一システムの自動インストール</title>
    <para>ネットワーク接続がない場合、自動インストールを行なうのに最も簡単な方法は、 &productname; の DVD-ROM と USB メモリを使用する方法です。この場合、インストールサーバもネットワーク環境も用意する必要がありません。</para>
    <para>制御ファイルを作成して <filename>autoinst.xml</filename> というファイル名で保存します。あとは USB メモリに <filename>autoinst.xml</filename> ファイルをコピーします。</para>
   </sect2>

   <sect2 xml:id="invoking_autoinst.linuxrc">
    <title>&ay; 制御ファイルと <command>linuxrc</command> <filename>info</filename> ファイルの組み合わせ</title>
    <para><filename>info</filename> ファイルを利用して <command>linuxrc</command> に情報を渡す場合、 XML の制御ファイル内にキーワードを統合することもできます。この場合、ファイルは <command>linuxrc</command> からアクセスできて、かつ <filename>info</filename> という名前でなければなりません。</para>
    <para><command>linuxrc</command> プログラムは &ay; 制御ファイル内にある <literal>start_linuxrc_conf</literal> という文字列を検索します。これは <command>linuxrc</command> に指定すべき内容を制御ファイル内に組み込む場合のキーワード文字列です。この文字列が見つかると、 <command>linuxrc</command> はそれ以降の文字列を読み込んでいきます。この処理は <literal>end_linuxrc_conf</literal> が現われるまで続きます。たとえば下記のようになります:</para>
    <example>
     <title>&ay; 制御ファイル内での <command>linuxrc</command> オプション</title>
<screen>....
  &lt;install&gt;
....
    &lt;init&gt;
      &lt;info_file&gt;
&lt;![CDATA[
#
# 下記の行を削除してはなりません:
# start_linuxrc_conf
#
install: nfs://192.168.1.1/CDs/full-i386
textmode: 1
autoyast: file:///info

# end_linuxrc_conf
# 上記のコメントを削除してはなりません
#
]]&gt;

      &lt;/info_file&gt;
    &lt;/init&gt;
......
  &lt;/install&gt;
....
</screen>
    </example>
    <para>ただし、 <literal>autoyast</literal> キーワードは同じファイルを参照するようにしなければならないことに注意してください。たとえば USB メモリであれば <literal>usb:///</literal> を指定する必要があります。また、 <filename>info</filename> ファイルが初期 RAM ディスク内に配置されている場合は、 <literal>file://</literal> を指定する必要があります。</para>
   </sect2>
  </sect1>
  <sect1 xml:id="System_Configuration">
   <title>システム設定</title>

   <para>自動インストール時のシステム設定は、処理全体の中で最も重要な部分となります。これまでの章で説明してきたとおり、インストール先のシステムはほぼ全て自動設定することができます。また、あらかじめ定義されているディレクティブに加えて、さまざまな事後スクリプトを使用することで、さまざまなシステム設定を調整することができます。必要であればシステムの変数を変更したり、インストール先のシステムに設定ファイル全体をコピーしたりするようなことも実現できます。</para>

   <sect2 xml:id="System_Configuration.post">
    <title>インストール後およびシステムの設定</title>
    <para>インストール後の処理やシステムの設定処理は、インストール先のシステムへのパッケージインストールが完了すると即時に実行され、初回の再起動後にも続けて行なわれます。</para>
    <para>システムの初回起動よりも前に、 &ay; はインストール時に収集した全てのデータと、ブートローダの設定を指定された場所に保存します。これらの通常の処理に加え、 &ay; では制御ファイル内に指定された chroot 環境スクリプトも実行されます。ただし、これらのスクリプトはシステムがまだマウントされていない状態で実行されます。</para>
    <para>既定とは異なるカーネルをインストールしている場合は、ハードウエアレベルでの再起動が必要となります。ハードウエアレベルでの再起動は、インストールされているカーネルとは無関係に強制することもできます。ハードウエアレベルでの再起動を強制したい場合は、 <literal>general</literal> リソース内の <literal>reboot</literal> を設定してください (詳しくは <xref linkend="CreateProfile.General"/> をお読みください) 。</para>
   </sect2>

   <sect2 xml:id="System_Configuration.custom">
    <title>システムのカスタマイズ</title>
    <para>インストールの第 2 ステージでは、ほとんどのシステムのカスタマイズを完了させます。 &ay; リソースでは実現できないようなカスタマイズが必要となる場合は、インストール後スクリプトを設定して、その中でカスタマイズを実施してください。</para>
    <para>制御ファイル内には独自のスクリプトを必要な数だけ定義することができます。また、この設定を行なうにあたっては、制御ファイルの編集のほか、設定システムを使用して行なうこともできます。</para>
   </sect2>
  </sect1>
 </chapter>
 <chapter xml:id="InstalledSystem">
  <title>インストール済みのシステム内での &ay; の実行</title>
   <para>場合によっては、 &ay; をインストール済みのシステムで動作させたほうが都合の良いこともあります。</para>
   <para>たとえば下記の例では、追加のソフトウエアパッケージ ( <literal>foo</literal> ) をインストールします。このソフトウエアを動作させるには、 NTP クライアントをインストールして設定する必要もあります。</para>
   <para>下記の &ay; プロファイルでは、パッケージのインストール ( <xref linkend="Software.Selections.stage2_packs"/> ) のほか、ユーザの追加 ( <xref linkend="Configuration.Security.users"/> ) や NTP クライアントの設定 ( <xref linkend="Configuration.Network.Ntp"/> ) をそれぞれ行なうセクションが記述されています:</para>
   <screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;ntp-client&gt;
    &lt;peers config:type="list"&gt;
      &lt;peer&gt;
        &lt;address&gt;us.pool.ntp.org&lt;/address&gt;
        &lt;comment/&gt;
        &lt;options&gt; iburst&lt;/options&gt;
        &lt;type&gt;server&lt;/type&gt;
      &lt;/peer&gt;
    &lt;/peers&gt;
    &lt;start_at_boot config:type="boolean"&gt;true&lt;/start_at_boot&gt;
    &lt;start_in_chroot config:type="boolean"&gt;false&lt;/start_in_chroot&gt;
    &lt;sync_interval config:type="integer"&gt;5&lt;/sync_interval&gt;
    &lt;synchronize_time config:type="boolean"&gt;false&lt;/synchronize_time&gt;
  &lt;/ntp-client&gt;
  &lt;software&gt;
    &lt;post-packages config:type="list"&gt;
      &lt;package&gt;ntp&lt;/package&gt;
      &lt;package&gt;yast2-ntp-client&lt;/package&gt;
      &lt;package&gt;foo&lt;/package&gt;
    &lt;/post-packages&gt;
  &lt;/software&gt;
  &lt;users config:type="list"&gt;
    &lt;user&gt;
      &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
      &lt;fullname&gt;Foo user&lt;/fullname&gt;
      &lt;gid&gt;100&lt;/gid&gt;
      &lt;home&gt;/home/foo&lt;/home&gt;
      &lt;password_settings&gt;
        &lt;expire/&gt;
        &lt;flag/&gt;
        &lt;inact/&gt;
        &lt;max&gt;99999&lt;/max&gt;
        &lt;min&gt;0&lt;/min&gt;
        &lt;warn&gt;7&lt;/warn&gt;
      &lt;/password_settings&gt;
      &lt;shell&gt;/bin/bash&lt;/shell&gt;
      &lt;uid&gt;1001&lt;/uid&gt;
      &lt;user_password&gt;linux&lt;/user_password&gt;
      &lt;username&gt;foo&lt;/username&gt;
    &lt;/user&gt;
  &lt;/users&gt;
&lt;/profile&gt;</screen>
   <para>上記のファイルを <filename>/tmp/install_foo.xml</filename> というパスに保存した場合、下記のようなコマンドを実行することで &ay; の処理を開始することができます:</para>
   <screen>&prompt.sudo;yast2 ayast_setup setup filename=/tmp/install_foo.xml dopackages="yes"</screen>

   <para>詳しくは <command>yast2 ayast_setup longhelp</command> を実行して表示される内容をお読みください</para>
 </chapter>
 <appendix xml:id="handlingrules">
  <title>ルールの処理</title>
  <info/>
  <para>下記の図には、ルールの処理と取得、そして合成に至るまでの流れが書かれています。</para>
  <figure xml:id="rulesflow">
   <title>ルールの取得処理</title>
   <mediaobject>
    <imageobject role="html">
     <imagedata fileref="rules_flow.png"/>
    </imageobject>
    <imageobject role="fo">
     <imagedata fileref="rules_flow.png" width="75%"/>
    </imageobject>
   </mediaobject>
  </figure>
 </appendix>
 <appendix xml:id="app.ay.faq">
  <title>&ay; FAQ - よくある質問とその回答</title>
  <qandaset>
   <qandaentry xml:id="qa.ay.invoke">
    <question>
     <para>&ay; のインストールを開始するには？</para>
    </question>
    <answer>
     <para>&productname; では、どのバージョンであっても、カーネルのコマンドラインに <literal>autoyast=&lt;プロファイルの_URI&gt;</literal> を指定することで、自動インストールを開始することができます。たとえば <literal>autoyast=<replaceable>http://MYSERVER/MYCONFIG.xml</replaceable></literal> のように指定すると、 <literal>myserver</literal> という Web サーバから &ay; の制御ファイルを取得して、自動インストールを開始する意味になります。詳しくは <xref linkend="invoking_autoinst"/> をお読みください。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.profile">
    <question>
     <para>&ay; プロファイルとは？</para>
    </question>
    <answer>
     <para>プロファイルとは &ay; 設定ファイルや制御ファイルとも呼ばれ、このファイルの中にはシステムの設定に関する詳細や、インストールすべきパッケージの一覧などが書かれています。それ以外にも、パーティションの設定やネットワークの設定、ソフトウエアのインストール元などが含まれています。ほとんど全ての設定は、動作中のシステムで &yast; を利用することで作成することができます。プロファイルは ASCII XML 形式で書かれています。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.create_profile">
    <question>
     <para>&ay; プロファイルを作成するには？</para>
    </question>
    <answer>
     <para>最も簡単な方法は、既にインストール済みの &productname; のシステムを雛形として使用する方法です。既にインストールの完了しているシステムで <menuchoice> <guimenu>&yast;</guimenu> <guimenu>その他</guimenu> <guimenu>自動インストールの設定</guimenu></menuchoice> を選択し、メニューから <menuchoice> <guimenu>ツール</guimenu> <guimenu>参照プロファイルの作成</guimenu> </menuchoice> を選びます。あとはプロファイル内に含めたいシステムコンポーネントを選択します。このほか、コマンドラインから <command>sudo yast clone_system</command> を実行することでも、完全なシステム設定を含むプロファイルを作成することができます。</para>
     <para>いずれの方法であっても、ファイルは <filename>/root/autoinst.xml</filename> 内に保存されます。コマンドラインから作成した場合は、プロファイルを作成したシステムと全く同一の環境になるようにプロファイルが作られます。しかしながら、通常はいくつかの箇所に対して調整を行なう必要があるはずです。調整作業はテキストエディタや XML エディタで実施してください。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.check_profile">
    <question>
     <para>作成した &ay; プロファイルの文法をチェックするには？</para>
    </question>
    <answer>
     <para>作成した &ay; プロファイルをチェックするための最も効率的な方法は、 <command>jing</command> もしくは <command>xmllint</command> を使用する方法です。</para>
     <para>詳しくは <xref linkend="CreateProfile.Manual"/> をお読みください。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.small_profile">
    <question>
     <para>使用できる最小限の &ay; プロファイルが知りたい。</para>
    </question>
    <answer>
     <para>&ay; プロファイル内に何もセクションを定義していない場合、一般的な &yast; の提案内容がそのまま適用されますが、少なくともインストール後にログインができなければならないはずですので、 &rootuser; のパスワードのみ指定した下記のプロファイルが最小となります。</para>
     <screen>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;users config:type="list"&gt;
    &lt;user&gt;
      &lt;encrypted config:type="boolean"&gt;false&lt;/encrypted&gt;
      &lt;user_password&gt;linux&lt;/user_password&gt;
      &lt;username&gt;root&lt;/username&gt;
    &lt;/user&gt;
  &lt;/users&gt;
&lt;/profile&gt;</screen>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.auto_sound">
    <question>
     <para>サウンドカードを自動検出して自動インストールするには？</para>
    </question>
    <answer>
     <para>プロファイル内に下記の <literal>sound</literal> セクションを設定してください:</para>
     <screen>&lt;sound&gt;
  &lt;autoinstall config:type="boolean"&gt;true&lt;/autoinstall&gt;
  &lt;configure_detected config:type="boolean"&gt;true&lt;/configure_detected&gt;
&lt;/sound&gt;</screen>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.cd">
    <question>
     <para>DVD のみを使用してインストールを行ないたい。 &ay; プロファイルにはどのように設定すればいいのか？</para>
    </question>
    <answer>
     <para>DVD のルートディレクトリにプロファイルを配置し、 <literal>file:///<replaceable>プロファイル名</replaceable>.xml</literal> としてアクセスしてください。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.test_merge">
    <question>
     <para>コマンドラインで合成処理をテストするには？</para>
    </question>
    <answer>
     <para>たとえば <filename>a.xml</filename> と <filename>base.xml</filename> という、 2 つのプロファイルを合成する場合は、下記のようなコマンドを実行します:</para>
     <screen>&prompt.user;/usr/bin/xsltproc --novalid --param replace "'false'" \
--param dontmerge1 "'package'" --param with "'a.xml'" --output out.xml \
/usr/share/autoinstall/xslt/merge.xslt base.xml</screen>
     <para>上記を実行するには、両方のプロファイルがアルファベット順に並んでいる必要があります (たとえば &lt;software&gt; セクションが &lt;add-on&gt; セクションの後ろに存在していなければなりません) 。 &yast; でプロファイルを作成していれば、プロファイルはアルファベット順に並べられます。</para>
     <para>なお、 <literal>dontmerge1</literal> パラメータは任意で指定するもので、プロファイル内に <literal>dont_merge</literal> を使用している場合にどのようにすべきなのかを例示しているものです。詳しくは <xref linkend="merging"/> をお読みください。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.zypper">
    <question>
     <para>スクリプトから zypper コマンドを呼び出して問題ないか？</para>
    </question>
    <answer>
     <para>zypper は &ay; の準備スクリプト (init-script) からのみ呼び出すことができます。これは、インストール後スクリプトの段階では、 &yast; がまだ RPM データベースに対する排他ロックを取得したままの状態であるためです。</para>
     <para>準備スクリプト以外 (たとえばインストール後スクリプト) でどうしても使用したい場合は、下記のようにして自己責任でロックを外してください:</para>
     <screen>&lt;post-scripts config:type="list"&gt;
  &lt;script&gt;
    &lt;filename&gt;yast_clone.sh&lt;/filename&gt;
    &lt;interpreter&gt;shell&lt;/interpreter&gt;
    &lt;location/&gt;
    &lt;feedback config:type="boolean"&gt;false&lt;/feedback&gt;
    &lt;source&gt;&lt;![CDATA[#!/bin/sh
mv /var/run/zypp.pid /var/run/zypp.sav
zypper in foo
mv /var/run/zypp.sav /var/run/zypp.pid
]]&gt;&lt;/source&gt;
  &lt;/script&gt;
&lt;/post-scripts&gt;</screen>
    </answer>
   </qandaentry>
   <qandaentry>
    <question>
     <para>&ay; プロファイル内では、セクションの順序に注意する必要があるか？</para>
    </question>
    <answer>
     <para>実際のところ、順序は重要ではありません。プロファイル内におけるセクションの順序は、 &ay; の処理手順には何も影響しません。しかしながら、異なるプロファイル同士を <emphasis>合成</emphasis> したい場合は、セクションはアルファベット順に並べる必要があります。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.insecure">
    <question>
     <para><command>linuxrc</command> で <literal>File not signed</literal> と表示されてしまいインストールが進まない。どのように対応すれば自動化できるか？</para>
    </question>
    <answer>
     <para><command>linuxrc</command> はドライバ更新などのファイルに対して、署名されているかどうかのチェックを行ないます。未署名のファイルを受け付けるには、 <command>linuxrc</command> のパラメータリスト内に <literal>insecure=1</literal> を設定してください (自動インストールなので <literal>autoyast=...</literal> パラメータも必要です) 。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.net">
    <question>
     <para>DVD/USB/HD のみを使用してインストールを行ないたいが、 XML ファイルだけはネットワークから取得したい。どのように設定すればよいのか？</para>
    </question>
    <answer>
     <para><command>linuxrc</command> に対して <literal>ifcfg</literal> のパラメータを設定する必要があります。これはネットワークの設定を行なう際には必須のパラメータで、指定を行なわないと、プロファイルをリモートからダウンロードできなくなってしまいます。詳しくは <xref linkend="ay.adv_network"/> をお読みください。</para>
    </answer>
   </qandaentry>
   <qandaentry xml:id="qa.ay.nfsroot">
    <question>
     <para>NFS をルートディレクトリとして使用する環境の自動インストールには対応しているのか？</para>
    </question>
    <answer>
     <para>対応していますが、他の方式よりは複雑な構成になります。環境 (DHCP, TFTP など) は注意して構築しなければなりません。また、 &ay; のプロファイルは下記のようになります:</para>
     <screen>&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE profile&gt;
&lt;profile xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;partitioning config:type="list"&gt;
    &lt;drive&gt;
      &lt;device&gt;/dev/nfs&lt;/device&gt;
      &lt;initialize config:type="boolean"&gt;false&lt;/initialize&gt;
      &lt;type config:type="symbol"&gt;CT_NFS&lt;/type&gt;
      &lt;partitions config:type="list"&gt;
        &lt;partition&gt;
          &lt;filesystem config:type="symbol"&gt;nfs&lt;/filesystem&gt;
          &lt;fstopt&gt;nolock&lt;/fstopt&gt;
          &lt;device&gt;10.10.1.53:/tmp/m4&lt;/device&gt;
          &lt;mount&gt;/&lt;/mount&gt;
        &lt;/partition&gt;
      &lt;/partitions&gt;
      &lt;use&gt;all&lt;/use&gt;
    &lt;/drive&gt;
  &lt;/partitioning&gt;
&lt;/profile&gt;</screen>
    </answer>
   </qandaentry>
   <qandaentry>
    <question>
     <para>ここに掲載されていない質問に対する回答を得るには？</para>
    </question>
    <answer>
     <para>&ay; のメーリングリスト (英語のみ) で質問を受け付けております。詳しくは <link xlink:href="http://lists.opensuse.org/opensuse-autoinstall/"/> をお読みください。</para>
    </answer>
   </qandaentry>
  </qandaset>
 </appendix>

 <appendix xml:id="appendix.linuxrc">
  <title>高度な <command>linuxrc</command> オプション</title>
  <info/>
  <para>
   <command>linuxrc</command> is a small program that runs after the kernel has
   loaded, but before &ay; or other stages. It prepares the system for
   installation. It allows the user to load modules, start an installed system
   or a rescue system, and to guide the operation of &yast;.
  </para>
  <note>
   <title>&ay; と <command>linuxrc</command> の設定が等価ではない件について</title>
   <para>
    Some <command>linuxrc</command> settings coincidentally have the same names
    as settings used by &ay; in its <filename>autoyast.xml</filename> file. This
    does <emphasis>not</emphasis> mean that they take the same parameters or
    function in the same way. For example, &ay; takes a <command>self_update</command>
    setting. If this value is set to <literal>1</literal>, another setting,
    <command>self_update_url</command> will be read and followed. Although <command>linuxrc</command>
    also has a <command>self_update</command> setting, <command>linuxrc</command>'s
    setting takes values of either <literal>0</literal> or a URL.
   </para>
   <para>
    Do not pass &ay; parameters to <command>linuxrc</command>, as this will
    almost certainly not give the desired results.
   </para>
  </note>
  <para>
   If <command>linuxrc</command> is installed on a machine, information about it
   can be found in the folder <filename>/usr/share/doc/packages/linuxrc/</filename>.
   Alternatively, its documentation can be found online at:
   <link xlink:href="https://en.opensuse.org/SDB:Linuxrc"/>
  </para>
  <note>
   <title>インストール済みのシステムでの <command>linuxrc</command> の実行について</title>
   <para>
    If you run <command>linuxrc</command> on an installed system, it will work
    slightly differently so as not to destroy your installation. As a
    consequence, you cannot test all features this way.
   </para>
  </note>
  <para>
   To keep the <command>linuxrc</command> binary file as small as possible, all
   its libraries and other supplemental files are linked directly into the main
   program binary file. This means that there is no need for any shared
   libraries in the initial RAM disk, <filename>initrd</filename>.
  </para>
  <sect1 xml:id="ay.cmd_parameters">
   <title><command>linuxrc</command> へパラメータを渡す方法</title>

   <para>
    Unless <command>linuxrc</command> is in manual mode, it will look for an
    <filename>info</filename> file in these locations: first
    <filename>/info</filename> on the flash disk and if that does not exist,
    for <filename>/info</filename> in the <filename>initrd</filename>. After
    that, it parses the kernel command line for parameters. You may change the
    <filename>info</filename> file <command>linuxrc</command> reads by setting the
    <filename>info</filename> command line parameter. If you do not want
    <command>linuxrc</command> to read the kernel command line (for example,
    because you need to specify a kernel parameter that <command>linuxrc</command>
    recognizes as well), use <literal>linuxrc=nocmdline</literal>.
   </para>

   <para>
    <command>linuxrc</command> will always look for and parse a file called
    <filename>/linuxrc.config</filename>. Use this file to change default values
    if you need to. In general, it is better to use the <filename>info</filename>
    file instead. Note that <filename>/linuxrc.config</filename> is read before
    any <filename>info</filename> file, even in manual mode.
   </para>
  </sect1>
  <sect1 xml:id="info_file_format">
   <title><filename>info</filename> ファイルの書式</title>

   <para>
    Lines starting with <literal>#</literal> are comments. Valid entries are
    of the form:
   </para>

<screen>key: value</screen>

   <para>
    Note that <literal>value</literal> extends to the end of the line and
    therefore may contain spaces. The matching of <literal>key</literal> is on a
    case-insensitive basis.
   </para>

   <para>
    You can use the same key-value pairs on the kernel command line using
    the syntax <literal>key=value</literal>. Lines that do not have the form
    described above will be ignored.
   </para>

   <para>
    The table below lists important keys and example values. For a complete
    list of <command>linuxrc</command> parameters, refer to <link xlink:href="https://en.opensuse.org/SDB:Linuxrc"/>.
   </para>

   <table>
    <title>高度な <command>linuxrc</command> のキーワード</title>
    <tgroup cols="2">
     <colspec colnum="1" colname="1" colwidth="30*"/>
     <colspec colnum="2" colname="2" colwidth="70*"/>
     <thead>
      <row>
       <entry>
        <para>
         Keyword: Example Value
        </para>
       </entry>
       <entry>
        <para>
         Description
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         <literal>addswap: 0|3|/dev/sda5</literal>
        </para>
       </entry>
       <entry>
        <para>
         If 0, never ask for swap; if the argument is a positive number
         <literal>n</literal>, activate the <literal>n</literal>th swap
         partition; if the argument is a partition name, activate this swap
         partition.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>autoyast:
         <replaceable>ftp://AUTOYASTFILE</replaceable></literal>
        </para>
       </entry>
       <entry>
        <para>
         Location of the auto installation file; activates auto installation
         mode. See <xref linkend="Commandline.ay"/> for details.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>bootptimeout: 10</literal>
        </para>
       </entry>
       <entry>
        <para>
         10 seconds timeout for BOOTP requests.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>bootpwait: 5</literal>
        </para>
       </entry>
       <entry>
        <para>
         Sleep 5 seconds between network activation and starting bootp.
        </para>
       </entry>
      </row>
      <!-- fs 2016-07-29: better use ifcfg
      <row>
       <entry>
        <para>
         <literal>dhcptimeout: 60</literal>
        </para>
       </entry>
       <entry>
        <para>
         60 seconds timeout for DHCP requests.
        </para>
       </entry>
       </row>
       -->
      <row>
       <entry>
        <para>
         <literal>display: color|mono|alt</literal>
        </para>
       </entry>
       <entry>
        <para>
         Set the menu color scheme.
        </para>
       </entry>
      </row>
      <!-- fs 2016-07-29: better use ifcfg
      <row>
       <entry>
        <para>
         <literal>dhcp: 0|1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Start the DHCP daemon now&gt;, but see <literal>UseDHCP</literal>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>domain: &exampledomain;</literal>
        </para>
       </entry>
       <entry>
        <para>
         Set domain name (used for name server lookups)
        </para>
       </entry>
       </row>
       -->
      <row>
       <entry>
        <para>
         <literal>exec: <replaceable>COMMAND</replaceable></literal>
        </para>
       </entry>
       <entry>
        <para>
         Run <emphasis>command</emphasis>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>forceinsmod: 0|1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Use the <option>-f</option> option (force) when running
         <command>insmod</command> commands.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>forcerootimage: 0|1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Load the installation system into RAM disk.
        </para>
       </entry>
      </row>
      <!-- fs 2016-07-29: better use ifcfg
      <row>
       <entry>
        <para>
         <literal>gateway: 10.10.0.1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Gateway
        </para>
       </entry>
      </row>
       <row>
       <entry>
        <para>
         <literal>hostip: 10.10.0.2</literal>
        </para>
       </entry>
       <entry>
        <para>
         The client ip address
        </para>
       </entry>
       </row>
      -->
      <row>
       <entry>
        <para>
         <literal>ifcfg:
         <replaceable>NETWORK_CONFIGURATION</replaceable></literal>
        </para>
       </entry>
       <entry>
        <para>
         Set up and start the network. See <xref linkend="ay.adv_network"/> for
         more information.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>insmod: <replaceable>MODULE</replaceable></literal>
        </para>
       </entry>
       <entry>
        <para>
         Load <replaceable>MODULE</replaceable>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>install: <replaceable>URL</replaceable></literal>
        </para>
       </entry>
       <entry>
        <para>
         Install from the repository specified with
         <replaceable>URL</replaceable>. For the syntax of
         <replaceable>URL</replaceable> refer to <link xlink:href="https://en.opensuse.org/SDB:Linuxrc#url_descr"/>.
        </para>
       </entry>
      </row>
      <!-- fs 2016-07-29: Either not a linuxrc parameter or deprecated,
           commenting

      <row>
       <entry>
        <para>
         <literal>installdir: /suse/inst-sys</literal>
        </para>
       </entry>
       <entry>
        <para>
         Path to the installation system
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         InstMode: cd|hd|nfs|smb|ftp|http|tftp
        </para>
       </entry>
       <entry>
        <para>
         Set installation mode
        </para>
       </entry>
       </row>
       -->
      <row>
       <entry>
        <para>
         <literal>keytable: de-lat1-nd</literal>
        </para>
       </entry>
       <entry>
        <para>
         Virtual console keyboard map to load.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>language: de_DE</literal>
        </para>
       </entry>
       <entry>
        <para>
         Language preselected for the installation.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>loghost: 10.10.0.22</literal>
        </para>
       </entry>
       <entry>
        <para>
         Enable remote logging via syslog.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>memloadimage: 50000</literal>
        </para>
       </entry>
       <entry>
        <para>
         Load installation system into RAM disk if free memory is above
         50000 KB.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>memlimit: 10000</literal>
        </para>
       </entry>
       <entry>
        <para>
         Ask for swap if free memory drops below 10000 KB.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>mem&yast;: 20000</literal>
        </para>
       </entry>
       <entry>
        <para>
         Run &yast; in text mode if free memory is below 20000 KB.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>mem&yast;Text: 10000</literal>
        </para>
       </entry>
       <entry>
        <para>
         Ask for swap before starting &yast; if free memory is below
         10000 KB.
        </para>
       </entry>
      </row>
      <!-- fs 2016-07-29: better use ifcfg
      <row>
       <entry>
        <para>
         <literal>nameserver: 10.10.0.1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Name Server
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>netdevice: eth0</literal>
        </para>
       </entry>
       <entry>
        <para>
         Network interface to use
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>netmask: 255.255.0.0</literal>
        </para>
       </entry>
       <entry>
        <para>
         Network mask
        </para>
       </entry>
       </row>
       -->
      <row>
       <entry>
        <para>
         <literal>proxy: 10.10.0.1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Proxy (either FTP or HTTP).
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>rescue: 1|nfs://server/dir</literal>
        </para>
       </entry>
       <entry>
        <para>
         Load the rescue system; the URL variant specifies the location of the
         rescue image explicitly.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>rescueimage: /suse/images/rescue</literal>
        </para>
       </entry>
       <entry>
        <para>
         Location of the rescue system image.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>rootimage: /suse/images/root</literal>
        </para>
       </entry>
       <entry>
        <para>
         Location of the installation system image.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>textmode: 1</literal>
        </para>
       </entry>
       <entry>
        <para>
         Start &yast; in text mode.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>usbwait: 4</literal>
        </para>
       </entry>
       <entry>
        <para>
         Wait four seconds after loading the USB modules.
        </para>
       </entry>
      </row>
      <!-- fs 2016-07-29: better use ifcfg
      <row>
       <entry>
        <para>
         vlan: <replaceable>VLANID</replaceable>
        </para>
       </entry>
       <entry>
        <para>
         Set a <replaceable>VLANID</replaceable> to enable 802.1q tagged
         VLAN support
        </para>
       </entry>
       </row>
       -->
      <row>
       <entry>
        <para>
         <literal>y2confirm</literal>
        </para>
       </entry>
       <entry>
        <para>
         Overrides the confirm parameter in a control file and requests
         confirmation of installation proposal.
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </sect1>
  <sect1 xml:id="ay.adv_network">
   <title>高度なネットワーク設定</title>

   <para>
    Even if parameters like <literal>hostip</literal>, <literal>nameserver</literal>,
    and <literal>gateway</literal> are passed to <command>linuxrc</command>, the
    network is only started when it is needed (for example, when installing via
    SSH or VNC). Because <literal>autoyast</literal> is not a <command>linuxrc</command>
    parameter (this parameter is ignored by <command>linuxrc</command> and is
    only passed to &yast;), the network will <emphasis>not</emphasis> be started
    automatically when specifying a remote location for the &ay; profile.
   </para>
   <para>
    Therefore, the network needs to be started explicitly. This used to be done
    with the <command>linuxrc</command> parameter <literal>netsetup</literal>.
    Starting with &productname; <phrase os="osuse">13.2</phrase><phrase os="sles;sled">12</phrase>, the parameter <literal>ifcfg</literal> is
    available. It offers more configuration options, for example configuring
    more than one interface. <literal>ifcfg</literal> directly controls the
    content of the <filename>/etc/sysconfig/network/ifcfg-*</filename> files.
   </para>
   <variablelist>
    <varlistentry>
     <term>DHCP Network Configuration</term>
     <listitem>
      <para>
       The general syntax to configure DHCP is
      </para>
      <screen> ifcfg=<replaceable>INTERFACE</replaceable>=<replaceable>DHCP*</replaceable>,<replaceable>OPTION1</replaceable>=<replaceable>VALUE1</replaceable>,<replaceable>OPTION2</replaceable>=<replaceable>VALUE2</replaceable></screen>
      <para>
       where <replaceable>INTERFACE</replaceable> is the interface name, for
       example <literal>eth0</literal>, or <literal>eth*</literal> for all
       interfaces. <replaceable>DHCP*</replaceable> can either be
       <literal>dhcp</literal> (IPv4 and IPv6), <literal>dhcp4</literal>, or
       <literal>dhcp6</literal>.
      </para>
      <para>
       To set up DHCP for <literal>eth0</literal> use:
      </para>
      <screen>ifcfg=eth0=dhcp</screen>
      <para>
       To set up DHCP on all interfaces use:
      </para>
      <screen>ifcfg=eth*=dhcp</screen>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Static Network Configuration</term>
     <listitem>
      <para>
       The general syntax to configure a static network is
      </para> <screen>ifcfg=<replaceable>INTERFACE</replaceable>=<replaceable>IP_LIST</replaceable>,<replaceable>GATEWAY_LIST</replaceable>,<replaceable>NAMESERVER_LIST</replaceable>,<replaceable>DOMAINSEARCH_LIST</replaceable>,\
<replaceable>OPTION1=value1</replaceable>,...</screen>
      <para>
       where <replaceable>INTERFACE</replaceable> is the interface name, for
       example <literal>eth0</literal>. If using <literal>eth*</literal>, the
       first device available will be used. The other parameters need to be
       replaced with the respective values in the given order. Example:
      </para>
      <screen>ifcfg=eth0=&wsIip;/24,&gateip;,&dnsip;,&exampledomain;</screen>
      <para>
       When specifying multiple addresses for a parameter, use spaces to separate
       them and quote the complete string. The following example uses two
       name servers and a search list containing two domains.
      </para>
      <screen>ifcfg="eth0=&wsIip;/24,&gateip;,&dnsip; &dnsip117;,&exampledomain; &exampledomain1;"</screen>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    For more information refer to <link xlink:href="https://en.opensuse.org/SDB:Linuxrc#Network_Configuration"/>.
   </para>
  </sect1>
 </appendix>
 <xi:include href="ay_12_migrate_15.xml"/>

 <!--taroth 2019-01-18: commenting docupdates for now
     as discussed in doc team meeting-->
 <!--<xi:include os="sles;sled" href="ay_docupdates.xml"/>-->

 <xi:include href="common_legal.xml"/>
</book>
