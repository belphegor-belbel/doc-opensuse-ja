<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter [
<!ENTITY % entities SYSTEM "generic-entities.ent">
%entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="cha-virtualization-scenarios">
  <!-- I/O virtualization -->
  <title>仮想化シナリオ</title>
  <info>
    <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
      <dm:bugtracker/>
      <dm:translation>yes</dm:translation>
    </dm:docmanager>
    <abstract>
      <para>仮想化の仕組みは、たとえば下記のようなメリットをもたらします:</para>
      <itemizedlist>
        <listitem>
          <para>より効率的なハードウエアの使用</para>
        </listitem>
        <listitem>
          <para>古いソフトウエアのサポート</para>
        </listitem>
        <listitem>
          <para>オペレーティングシステムの分離</para>
        </listitem>
        <listitem>
          <para>ライブマイグレーション</para>
        </listitem>
        <listitem>
          <para>災害対策</para>
        </listitem>
        <listitem>
          <para>負荷分散</para>
        </listitem>
      </itemizedlist>
    </abstract>
  </info>
  <sect1 xml:id="sec-virtualization-scenarios-capabilities">
    <title>サーバの集約</title>

    <para>多数のサーバを 1 台の巨大な物理サーバに統合することができます。多数のサーバを仮想マシンに変換することで、ハードウエアを集約してまとめることができます。古いソフトウエアを新しいハードウエア上で動作させることもできます。 <!-- reduce cost --></para>

    <itemizedlist>
      <listitem>
        <para>リソースを効率的に使用することができます (一般的には各サーバが全てのリソースを使用しているわけではないため)</para>
      </listitem>
      <listitem>
        <para>サーバの物理スペースを削減することができます</para>
      </listitem>
      <listitem>
        <para>複数の処理を同じサーバ内で処理することにより、効率の向上を図ることができます</para>
      </listitem>
      <listitem>
        <para>データセンターのインフラストラクチャを単純化することができます</para>
      </listitem>
      <listitem>
        <para>他のホストへの負荷移行を簡単に行うことができます (サービスのダウンタイム防止)</para>
      </listitem>
      <listitem>
        <para>手っ取り早くマシンを調達するための手段としても使用することができます</para>
      </listitem>
      <listitem>
        <para>単一のホスト内で複数のゲストオペレーティングシステムを動作させることができます</para>
      </listitem>
    </itemizedlist>

    <important>
      <para>サーバの統合にあたっては、下記の点について特別な注意を払う必要があります:</para>
      <itemizedlist>
        <listitem>
          <para>メンテナンス時間を注意深く計画する必要があります</para>
        </listitem>
        <listitem>
          <para>ストレージが統合の鍵となります。移行に対応する必要があるほか、ディスク領域の拡張にも対応する必要があります</para>
        </listitem>
        <listitem>
          <para>さらなる負荷をまかなえるかどうかをよく確認しておく必要があります</para>
        </listitem>
      </itemizedlist>
    </important>
  </sect1>
  <sect1>
    <title>分離</title>

    <para>ゲスト側のオペレーティングシステムはホスト側のオペレーティングシステムとの間で完全に分離されています。そのため、仮想マシン内で何らかの問題が発生した場合でも、ホスト側はその影響を受けません。また、一方の仮想マシンで問題が発生しても、他方の仮想マシンに影響を与えることもありません。仮想マシン間でのデータの共有も行われません。</para>

    <itemizedlist>
      <listitem>
        <para>仮想マシンに対して &uefisecboot; を使用することができます。</para>
      </listitem>
      <listitem>
        <para>KSM は使用すべきではありません。 KSM に関する詳細は <xref linkend="gloss-vt-acronym-ksm"/> をお読みください。</para>
      </listitem>
      <listitem>
        <para>CPU の各コアはそれぞれの仮想マシン専用にすることもできます。</para>
      </listitem>
      <listitem>
        <para>潜在的なセキュリティ問題を避けるため、 Hyper-threading (HT) 機能は無効化しておくことをお勧めします。</para>
      </listitem>
      <listitem>
        <para>仮想マシンはネットワーク／ストレージ／ハードウエアを共有すべきではありません。</para>
      </listitem>
      <listitem>
        <para>PCI パススルー機能や NUMA などの高度なハイパーバイザ機能を使用する場合は、仮想マシンの移行時に問題が生じうることに注意しておいてください</para>
      </listitem>
      <listitem>
        <para>一般的に、準仮想化ドライバ <literal>virtio</literal> を使用することで、仮想マシンの性能と効率の両方を向上させることができます</para>
      </listitem>
    </itemizedlist>

    <para>AMD 社は仮想化のセキュリティに関する特別な機能を提供しています。 <!-- link to the SEV doc? --></para>

    <!-- REMOVE IT FROM NOW. PM WOULD LIKE TO DISCUSS ABOUT THIS
      <itemizedlist>
      <listitem>
      <para>
      AMD Secure Memory Encryption (SME):
      Uses a single key to encrypt system memory. The key is generated by the AMD Secure Processor at boot. SME requires enablement in the system BIOS or operating system. When enabled in the BIOS, memory encryption is transparent and can be run with any operating system.
      </para>
      </listitem>
      <listitem>
      <para>
      AMD Secure Encrypted Virtualization (SEV):
      Uses one key per virtual machine to isolate guests and the hypervisor from one another. The keys are managed by the AMD Secure Processor. SEV requires enablement in the guest operating system and hypervisor. The guest changes allow the VM to indicate which pages in memory should be encrypted. The hypervisor changes use hardware virtualization instructions and communication with the AMD Secure processor to manage the appropriate keys in the memory controller.
      </para>
      </listitem>
      <listitem>
      <para>
      AMD Secure Encrypted Virtualization-Encrypted State (SEV-ES):
      Since SEV only operates when a VM is running, the additional SEV-ES feature encrypts
      all CPU register contents when a VM stops running. This prevents the leakage of information
      in VMs' CPU registers to the hypervisor. SEV-ES can also detect malicious modifications to
      a CPU's register state.
      </para>
      </listitem>
      </itemizedlist>
      -->
  </sect1>
  <!-- MIGRATION IS A VT FEATURE NOT A SCENARIO
    <sect1>
    <title>Migration</title>
    <para>
    Migration is a process to move a running virtual machine to another
    physical machine. Live migration is an extended feature that allows
    this move without disconnection of the client or the application.
    </para>
    </sect1>
    -->
  <sect1>
    <title>災害対策</title>

    <para>ハイパーバイザにはスナップショット機能が用意されていますので、サーバを任意の時点に巻き戻すことができます。 <xref linkend="gloss-vt-virtualized"/> OS は物理サーバで動作する場合とは異なり、実際のハードウエアから独立した存在になっていますので、スナップショットを同じハイパーバイザの動作する別のマシン内に復元すれば、そのままサーバを移行することができます。</para>

    <!--
      use storage replication like drbd, cluster-md, SES product
      system snapshot 
      overlay images and backing images
      recover to any other host
      run workloads on unused hardware
      easily copy data to other sites
      -->
  </sect1>
  <sect1>
    <title>動的な負荷分散</title>

    <para>ライブマイグレーションはお使いのインフラストラクチャの負荷分散を行うための単純な方法です。仮想マシンを負荷の高いホストから負荷の少ないホストに移動させることで、容易に負荷を調整することができます。</para>

    <!--    HA
      The cluster resource manager in the High Availability Extension can recognize, monitor, and manage services running within virtual servers and services running in physical servers. Guest systems can be managed as services by the cluster. 
      -->
  </sect1>
</chapter>
