<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 [
<!ENTITY % entities SYSTEM "generic-entities.ent">
%entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="cha-security-fips">
 <title>FIPS 140-3 準拠機能の有効化</title>
 <info>
  <abstract>
   <para>アメリカ合衆国連邦政府向けの業務を行うような場合、暗号化アプリケーション (OpenSSL, GnuTLS, OpenJDK) の使用にあたっては Federal Information Processing Standards (FIPS) 140-3 に準拠するよう求められることがあります。 FIPS 140-3 は私企業が提供する暗号化モジュールに向けて作られたセキュリティ認定プログラムで、このプログラムへの準拠が求められた場合にのみ有効化すべき仕組みです (求められていない場合は、何もする必要はありません) 。本章では FIPS モードの有効化を行うための手順のほか、より詳しい情報のリンクも示しています。</para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker/>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <important>
  <title>&sles; &productnumber; と FIPS 140-3 について</title>
  <para>&sles; &productnumber; では現在、関連するバイナリに対して FIPS 140-3 標準の認証取得のための実装作業を実施しています。近い将来に更新されることになりますので、もうしばらくお待ちください。</para>
  <para>さらに詳しい情報をお求めの場合は、 &suse; の営業担当者にお尋ねください。</para>
 </important>

<sect1 xml:id="sec-fips-concept">
  <title>FIPS の概要</title>
  <para>組織や企業が暗号化アプリケーションを FIPS 準拠として認定を受けるには、 Cryptographic Module Validation Program (CMVP) (詳しくは <link xlink:href="https://csrc.nist.gov/projects/cryptographic-module-validation-program"/> を参照) への申請を行わなくてはなりません。</para>
  <para>最新の FIPS 140-3 標準は 2019 年の 3 月に承認され、 FIPS 140-2 に置き換えられつつあります。</para>

  <!--taroth 2022-10-17: disabling the following link for now because it
   still is based on FIPS 140-2-->
  <!--<para>
    &suse; maintains a list of certified modules at
    <link xlink:href="https://www.suse.com/support/security/certifications/"/>, along with a lot of other useful information.
  </para>-->
</sect1>

<sect1 xml:id="sec-fips-use-case">
  <title>FIPS モードを必要とする条件</title>

    <warning>
    <title>FIPS の使用には専門知識が必要となる件について</title>
    <para>FIPS の管理は複雑で、専門的な知識が必要となります。適切な実装やテスト、トラブルシューティングの実施の全てにおいて、高度な知識が求められることに注意してください。</para>
  </warning>

  <para>&sle; で FIPS モードを有効化するのは簡単です。準拠が必要なサーバを FIPS モードで動作させるだけです。</para>
  <para>FIPS 準拠を求められていない場合は、 FIPS モードの有効化を行わないほうが適切です。なぜなら、下記のような理由があるからです:</para>
  <itemizedlist>
    <listitem>
      <para>FIPS では制限が強すぎます。特定の暗号化アルゴリズムの使用を強制するばかりか、そのアルゴリズムを適切に実装している認証済みバイナリのみを実行するようにしてしまいます。</para>
    </listitem>
    <listitem>
      <para>アップグレードによって機能が制限されることもあります。</para>
    </listitem>
    <listitem>
      <para>認証にかかる時間が非常に長く、認証された頃には古いリリースになってしまいます。</para>
    </listitem>
    <listitem>
      <para>ssh, sshd, sftp-server などの認証済みバイナリは、その起動時に自分自身をチェックして、それが成功した場合にのみ動作するようになってしまいます。これによって、少ないながらも性能劣化を引き起こしてしまいます。</para>
    </listitem>
    <listitem>
      <para>FIPS の管理は複雑で、比較的高度な知識が必要となります。</para>
    </listitem>
  </itemizedlist>
</sect1>

<sect1 xml:id="sec-fips-install">
  <title>FIPS のインストール</title>
  <para>新規にインストールしている場合は、 <package>patterns-base-fips</package> という名称のパターンをインストールしてください。 <!-- インストールが完了したあとは、 <xref linkend="sec-fips-enable"/> に示された手順に従って、 FIPS を有効化してください。 --></para>
   <important>
    <title>パッケージの不安定性について</title>
    <para>関連するバイナリが FIPS 140-3 の認証を受けるために作業を行っている期間は、パッケージは安定しません。それでも FIPS モードを有効化したい場合は、 &suse; の営業担当者にお尋ねください。</para>
   </important>

  <para>お使いのシステムに <package>patterns-base-fips</package> をインストールして FIPS モードを有効化していても、鍵の再生成や監査システムのセットアップなど、いくつかの調整を行う必要があります。</para>
</sect1>


 <!--<sect1 xml:id="sec-fips-enable">
  <title>Enabling FIPS mode</title>

 <para>
  <remark>The file paths for the two READMEs are different than in earlier
  releases. In SLE 15 SP2 and older the path is /usr/share/doc/packages/openssh/
  cschroder Jan 13, 2022</remark>
  Enabling FIPS takes a few steps. First, read the
  <filename>/usr/share/doc/packages/openssh-common/README.FIPS</filename> and
  <filename>/usr/share/doc/packages/openssh-common/README.SUSE</filename>
  files, from the <package>openssh-common</package> package. These contain
  important information about FIPS on &sle;.
  </para>
  <para>
    Check if FIPS is already enabled:
  </para>
  <screen>&prompt.sudo;<command>sysctl -a | grep fips</command>
crypto.fips_enabled = 0</screen>
  <para>
  <literal>crypto.fips_enabled = 0</literal> indicates that it is not enabled. A return value of 1 means that it is enabled.
  </para>
  <para>
    Then edit <filename>/etc/default/grub</filename>. If
    <filename>/boot</filename> is not on a separate partition, add
    <literal>fips=1</literal> to
    <literal>GRUB_CMDLINE_LINUX_DEFAULT</literal>, like the following
    example:
  </para>
  <screen>GRUB_CMDLINE_LINUX_DEFAULT="splash=silent mitigations=auto quiet fips=1"</screen>
  <para>
    If <filename>/boot</filename> is on a separate partition, specify which
    partition, like the following example, substituting the name of your boot
    partition:
  </para>
  <screen>GRUB_CMDLINE_LINUX_DEFAULT="splash=silent mitigations=auto quiet fips=1 boot=<replaceable>/dev/sda1"</replaceable></screen>
  <para>
    Save your changes, and rebuild your GRUB configuration and initramfs
    image (replace <replaceable>NAME</replaceable>
      with the name of the current initrd and
      <replaceable>KERNELVERSION</replaceable> with the currently running
      kernel):
  </para>
  <screen>&prompt.sudo;<command>grub2-mkconfig -o /boot/grub2/grub.cfg</command>
&prompt.sudo;<command>/usr/bin/dracut -/-logfile /var/log/YaST2/mkinitrd.log -/-force /boot/$initrd-<replaceable>NAME</replaceable> $<replaceable>KERNELVERSION</replaceable></command></screen>
  <para>
  <remark>
  taroth 2022-10-17: remove the slashes for the options in the screen
  above as soon as this section is enabled again - needed to insert slashes
  temporarily to be able to comment the section
  </remark>
  Reboot, then verify your changes. The following example shows that
  FIPS is enabled:
  </para>
<screen>&prompt.sudo;<command>sysctl -a | grep fips</command>
crypto.fips_enabled = 1</screen>
  <para>
  After enabling FIPS it is possible that your system will not boot. If this
  happens, reboot to bring up the GRUB menu. Press <keycap>E</keycap> to edit
  your boot entry, and delete the <literal>fips</literal> entry from the
  <literal>linux</literal> line. Press the <keycap>F10</keycap> key to boot.
  This is a temporary change, and most likely the problem is an error in
  <filename>/etc/default/grub</filename>. Correct it, rebuild GRUB and
  initramfs, then reboot.
  </para>
 </sect1>-->

 <sect1 xml:id="sec-fips-samba-cifs">
  <title>Samba/CIFS での MD5 の使用禁止について</title>
  <para>FIPS 標準において、 MD5 はハッシュアルゴリズムとしては不適切であり、ユーザ認証時に使用してはならないものとされています。 FIPS 準拠のネットワーク環境を運用している場合、クライアントもサーバも FIPS 準拠モードで動作させる必要がありますが、 Samba/CIFS ユーザの認証時には Kerberos サービスを使用しなければなりません。これは、他の全ての Samba 認証モードには MD5 が含まれてしまっているためです。</para>
  <para>&samba; サーバの詳細については、 &storage_guide; の &samba; セクションをお読みください。</para>
 </sect1>
</chapter>
